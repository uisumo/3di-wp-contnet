!function(k){window.gwCopyObj=function(e){var m=this;for(prop in e)e.hasOwnProperty(prop)&&(m[prop]=e[prop]);function I(e){return parseInt(e)!=e}function F(e){if(!(e instanceof Object))return e;var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(e[i]);return t}m.init=function(){gform.addFilter("gpcc_copied_value",function(e,t,i){if(k("#input_{0}_{1}".format(m.formId,i.source)).hasClass("ginput_total")){var r=gf_get_field_number_format(i.source,m.formId);r||(r=gf_get_field_number_format(i.target,m.formId));var n=gformGetDecimalSeparator(r);e=gformCleanNumber(e,"","",n)}return e});var e=k("#gform_wrapper_{0}".format(m.formId));e.off("click.gpcopycat"),e.on("click.gpcopycat",'.gwcopy input[type="checkbox"]',function(){k(this).is(":checked")?m.copyValues(this):m.clearValues(this)}),e.off("change.gpcopycat"),e.on("change.gpcopycat",".gwcopy input:not(:checkbox), .gwcopy textarea, .gwcopy select",function(){m.copyValues(this)}),e.find(".gwcopy").find("input, textarea, select, button").each(function(){if(k(this).is(":checkbox, :radio")||k(this).parents(".gfield_chainedselect").length?k(this).is(":checked")&&m.copyValues(this,m.overwriteOnInit):m.copyValues(this,m.overwriteOnInit),k(this).is("button")){if(!k(this)[0].id.includes("_select_all"))return;var r=k(this).attr("data-label-select"),e=k(this).attr("data-label-deselect");k(this)[0].onclick=null,k(this).on("click",function(){var i=k(this).text();k(this).siblings().each(function(e,t){i==r?k(t).find("input").prop("checked")||k(t).find("input").click():k(t).find("input").prop("checked")&&k(t).find("input").click()}),i==r?k(this).text(e):k(this).text(r)})}}),gform.addAction("gform_list_post_item_delete",function(e){0<e.parents(".gwcopy").length&&(m.clearValues(e),m.copyValues(e))});var p=[];gform.addAction("gform_input_change",function(){p=[]},15),gform.addAction("gform_post_conditional_logic_field_action",function(e,t,i,r,n){if("hide"!==t){var o=gf_get_input_id_by_html_id(i),a=m.getFieldSettings(o);if(a)for(var l=0;l<a.length;l++)if(-1===k.inArray(a[l].trigger,p)){p.push(a[l].trigger);var s=k("#field_{0}_{1}".format(e,a[l].trigger)).find("input, textarea, select"),c=!n;s.is(":checkbox")?s.filter(":checked").length&&m.copyValues(s[0],c):m.copyValues(s[0],c)}}}),e.data("GPCopyCat",m)},m.getFieldSettings=function(e){return void 0!==m.fields[e]?m.fields[e]:!1!==m.getSourceFieldIdByTarget(e,!0)?m.getSourceFieldIdByTarget(e,!0):!1!==m.getSourceField(e,!0)?m.getSourceField(e,!0):[]},m.copyValues=function(r,s,c){var e=gf_get_input_id_by_html_id(k(r).parents(".gfield").attr("id")),t=m.getFieldSettings(e);s=void 0!==s?s:m.overwrite,c=void 0!==c?c:s;for(var i=0,n=t.length;i<n;i++){var p=t[i],o=p.source,u=p.target,a=m.getFieldGroup(p,"source"),f=m.getFieldGroup(p,"target"),d=m.isListField(a)&&m.isListField(f),g=m.getGroupValues(a,"source",{sort:!(d||!m.isListField(f))&&m.getGroupValues(f,"target",{isListToList:d,sourceInputId:u}),isListToList:d,sourceInputId:o,targetInputId:u});if(!window.gform.applyFilters("gpcc_custom_copy",!1,r.id,a,f,p.source))if(a.parents(".gfield_chainedselect").length)a.each(function(e,t){if(r.id===t.id){var i=f.get(e);i.value=r.value,k(i).trigger("change")}});else{if(m.isListField(f)){var l=f.parents(".ginput_list").find(".gfield_list_group").length,h=m.isListField(a)?a.parents(".ginput_list").find(".gfield_list_group").length:a.length,_=Math.floor(h-l),v=m.getMaxRowCount(f);if(_<0&&1<l)f.each(function(){var e=F(g);-1===k.inArray(k(this).val(),e)&&1<k(this).parents(".gfield_list").find(".gfield_list_group").length&&gformDeleteListItem(k(this),v)});else if(0<_)for(var y=0;y<_&&!(0<v&&v<l+y+1);y++)gformAddListItem(f[f.length-1],m.getMaxRowCount(f));f=m.getFieldGroup(p,"target")}targetValues=[],!I(u)&&f.is(":checkbox")&&s&&f.prop("checked",!1),f.each(function(e){var t=k(this),i=t.is(":checkbox, :radio"),r=d?m.getListInputIndex(t):e,n=i||g[r]||k.isArray(g)&&g.join(" "),o=!1,a=null;if(targetValues[e]=t.val(),o=i?f.is(":checked"):t.val(),!s&&o)return!0;if(!n&&!c)return!0;if(m.isListField(f))a=I(u)?g[e]:g[r],a=gform.applyFilters("gppc_copied_value",a,t,p),a=gform.applyFilters("gpcc_copied_value",a,t,p),t.val(a);else if(i)-1!=k.inArray(t.val(),gform.applyFilters("gpcc_copied_value",g,t,p))&&(t.prop("checked",!0),t.trigger("change"),t.parents(".gfield_price").length&&gformCalculateTotalPrice(m.formId));else if(1<f.length)a=gform.applyFilters("gppc_copied_value",g[r],t,p),a=gform.applyFilters("gpcc_copied_value",a,t,p),t.val(a);else if(g=g.filter(function(e,t){return""!=e}),a=gform.applyFilters("gppc_copied_value",m.cleanValueByInputType(g.join(" "),t.attr("type")),t,p,g),a=gform.applyFilters("gpcc_copied_value",a,t,p,g),0<t.parents(".gfield_price:not(.gfield_quantity)").length&&t.is('select, input[type="radio"], input[type="checkbox"]')&&-1===a.indexOf("|"))t.val(t.find('option[value^="'+a+'|"]').attr("value"));else if(t.is("select")&&0===t.find('option[value="'+a+'"]').length&&(a=t.find("option:first").val()),t.val(a),window.tinyMCE){var l=tinyMCE.get(t.attr("id"));l&&l.setContent(a)}a?t.addClass("gpcc-populated-input").parents(".gfield").addClass("gpcc-populated"):t.removeClass("gpcc-populated-input").parents(".gfield").removeClass("gpcc-populated")}),f.is(":checkbox, :radio")?(s||f.filter(":checked"),f.keypress()):f.each(function(e){targetValues[e]!=k(this).val()&&k(this).change().trigger("chosen:updated")}),f.trigger("copy.gpcopycat")}}},m.clearValues=function(e){for(var t=k(e).parents(".gfield").attr("id").replace("field_"+m.formId+"_",""),i=m.getFieldSettings(t),r=0;r<i.length;r++){var a=i[r],l=[],s=m.getFieldGroup(a,"target"),n=m.getFieldGroup(a,"source"),o=m.isListField(s)&&m.isListField(n);if(!window.gform.applyFilters("gpcc_custom_clear",!1,e.id,n,s,a.source)&&!o)if(parseInt(a.source)==t&&k(e).is(":checkbox"))m.overwrite&&s.prop("checked",!1),m.copyValues(e,!0,!0);else if(n.each(function(e){l[e]=k(this).val()}),s.each(function(e){var t=k(this),i=t.val(),r=t.is(":checkbox, :radio"),n=t.is(":checkbox"),o=l[e];1==s.length&&(o=(l=l.filter(function(e,t){return""!=e})).join(" ")),o=m.cleanValueByInputType(o),o=gform.applyFilters("gppc_copied_value",o,t,a),o=gform.applyFilters("gpcc_copied_value",o,t,a),n&&t.is(":checked")?t.prop("checked",-1!==k.inArray(i,l)).change():r&&t.is(":checked")?t.prop("checked",!1).change():""!==i&&i==o&&t.val("").change(),t.removeClass("gpcc-populated-input").parents(".gfield").removeClass("gpcc-populated")}),m.isListField(s)){var c=m.getMaxRowCount(s);s.parents(".ginput_list").find(".gfield_list_group:not(:first)").each(function(){0===k(this).find('.gfield_list_cell input[value!=""]').length&&gformDeleteListItem(k(this).find("input").eq(0),c)})}}},m.cleanValueByInputType=function(e,t){return"number"==t&&(e=gformToNumber(e)),e},m.getFieldGroup=function(e,t){var i=e[t],r=parseInt(i),n=e[t+"FormId"],o=k("#field_"+n+"_"+r),a=o.find('input[name^="input"]:not( :button ), select[name^="input"], textarea[name^="input"]'),l=m.isListField(a);if(l&&(a=a.filter('[name="input_{0}[]"]'.format(r))),I(i)&&!l){var s=i.split(".")[1],c=a.filter('[id^="input_'+n+"_"+r+"_"+s+'"], input[name="input_'+i+'"]');a=c.length<=0?a.filter("#input_"+n+"_"+i):c}else I(i)&&l&&(a=a.filter(function(){var e=m.getListInputIndex(k(this));return e==m.getListInputIndex(i,e)}));return"source"==t&&1<a.length&&k(a[0]).closest(".ginput_container_password").length&&(a=a.filter("#input_"+n+"_"+i)),"source"==t&&a.is("input:radio, input:checkbox")&&(a=a.filter(":checked")),gform.applyFilters("gpcc_field_group",a,e,t,o)},m.getGroupValues=function(e,t,i){void 0===i&&(i={}),i=function(e,t){for(key in t)t.hasOwnProperty(key)&&void 0===e[key]&&(e[key]=t[key]);return e}(i,{sort:!1,isListToList:!1,sourceInputId:!1,targetInputId:!1});var r=[];if(e.each(function(e){var t=e;i.isListToList&&!I(i.targetInputId)&&(t=m.getListInputIndex(k(this))),r[t]=k(this).val()}),!1!==i.sort){for(var n=i.sort.filter(function(e,t){return i.sort.indexOf(e)==t&&""!=e}),o=[],a=0;a<n.length;a++){var l=r.indexOf(n[a]);-1!==l&&(o.push(r[l]),r.splice(l,1))}r=o.concat(r)}return r},m.isListField=function(e){if(void 0!==e.data("isListField"))return e.data("isListField");var t=0<e.parents(".ginput_list").length;return e.data("isListField",t),t},m.getSourceFieldIdByTarget=function(e,t){for(var i in m.fields)if(m.fields.hasOwnProperty(i))for(var r=m.fields[i],n=0;n<r.length;n++){var o=r[n];if(parseInt(o.target)===parseInt(e))return t?r:o.source}return!1},m.getSourceField=function(e,t){for(var i in m.fields)if(m.fields.hasOwnProperty(i))for(var r=m.fields[i],n=0;n<r.length;n++){var o=r[n];if(parseInt(o.source)===parseInt(e))return t?r:o.source}return!1},m.getListInputIndex=function(e,t,i){if(void 0===t?i=!1:"boolean"==typeof t?(i=t,t=!1):void 0===i&&(i=!1),"object"==typeof e)var r=e.attr("name").match(/(\d+)/)[0],n=e.parents(".gfield_list_group"),o=n.find('[name="input_{0}[]"]'.format(r)),a=e.parents(".gfield_list_container").find(".gfield_list_group"),l=o.index(e)+1,s=a.index(n)+1;else{var c=e.split("."),p=t?t.split("."):[1,1];l=c[1],s=c[2]?c[2]:p[1]}var u=l+"."+s;return i?{index:u,column:l,row:s}:u},m.getMaxRowCount=function(e){for(var t=e.parents(".gfield").attr("class").split(" "),i=0;i<t.length;i++)if(-1!==t[i].indexOf("gp-field-maxrows"))return parseInt(t[i].split("-")[3]);return 0},m.init()}}(jQuery);
//# sourceMappingURL=gp-copy-cat.js.map