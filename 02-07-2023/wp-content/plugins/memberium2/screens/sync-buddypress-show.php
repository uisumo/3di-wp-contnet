<?php
/**
 * Copyright (c) 2012-2022 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 */

 class_exists( 'm4is_emz57o' ) || die(); current_user_can( 'manage_options' ) || wp_die( __( 'You do not have sufficient permissions to access this page.' ) ); m4is_p_q15::m4is_burleh(); 
class m4is_p_q15 { private $m4is_ghw0yr = [], $m4is_tvcm = []; static 
function m4is_burleh() : self { static $m4is_jprj8; return $m4is_jprj8 ? $m4is_jprj8 : $m4is_jprj8 = new self; } private 
function __construct() { $this->m4is_gopgz(); $this->m4is_s_9s8(); $this->m4is_zzf9v(); $this->m4is_z8xv(); } private 
function m4is_gopgz() { $this->m4is_tvcm = m4is_f84s3h::m4is_cm6nr( 'Contact', true ); $this->m4is_ghw0yr = $this->m4is_zfd3w( get_option( 'memberium_xprofile_map', [] ) ); }  private 
function m4is_zfd3w( $m4is_u30i ) {  $m4is_u30i = array_filter( $m4is_u30i );  foreach( $m4is_u30i as $m4is_xd3sb => $m4is_tfegb ) { if ( ! array_key_exists( $m4is_xd3sb, $m4is_u30i ) ) { unset( $m4is_u30i[ $m4is_xd3sb ] ); } }  foreach( $m4is_u30i as $m4is_xd3sb => $m4is_tfegb ) { if ( ! in_array( $m4is_tfegb, $m4is_u30i ) ) { unset( $m4is_u30i[ $m4is_xd3sb ] ); } } foreach( $m4is_u30i as $m4is_xd3sb => $m4is_tfegb ) { if ( empty( $m4is_xd3sb ) || empty ($m4is_tfegb ) ) { unset( $m4is_u30i[$m4is_xd3sb] ); } } return $m4is_u30i; } private 
function m4is_s_9s8() { if ( $_SERVER['REQUEST_METHOD'] !== 'POST' ) { return; } $m4is_mtqz = isset( $_POST['xprofile_map_delete'] ) && is_array( $_POST['xprofile_map_delete'] ) ? $_POST['xprofile_map_delete'] : []; $m4is_ixuw8 = isset( $_POST['new_keap_map'] ) ? $_POST['new_keap_map'] : ''; $m4is_ap5xu = (int) isset( $_POST['new_xprofile_map'] ) ? $_POST['new_xprofile_map'] : ''; foreach ( $m4is_mtqz as $m4is_c9dh => $m4is_tfegb ) { unset( $this->m4is_ghw0yr[$m4is_c9dh] ); } if ( $m4is_ixuw8 && $m4is_ap5xu ) { $this->m4is_ghw0yr[$m4is_ixuw8] = $m4is_ap5xu; } update_option( 'memberium_xprofile_map', $this->m4is_ghw0yr ); } private 
function m4is_df1v() { global $wpdb; static $m4is_hvlq4 = null; if ( is_null( $m4is_hvlq4 ) ) {  $m4is_l7ox = buddypress(); $m4is_hvlq4 = []; $m4is_ioxk = "SELECT `id`, `name` FROM `{$m4is_l7ox->profile->table_name_fields}` WHERE 1 "; $m4is_n_bp6 = $wpdb->get_results( $m4is_ioxk, ARRAY_A ); foreach ( $m4is_n_bp6 as $m4is_wo7c93 ) { $m4is_hvlq4[ $m4is_wo7c93['id'] ] = $m4is_wo7c93['name']; } } return $m4is_hvlq4; } private 
function m4is_h5yot() { echo '</table>'; echo '<p><input type="submit" name="save" value="Save BuddyPress Field Sync" class="button-primary" /></p>'; echo '</form>'; echo '</div>'; } private 
function m4is_by18n() { echo '<div class="wrap">'; echo '<form method="POST" action="">'; echo '<input type="hidden" name="formtype" value="', $_GET['tab'], '">'; wp_nonce_field(__FILE__); echo '<table class="widefat">'; echo '<thead><tr></td><th>Keap Field</th><th>BuddyPress XProfile Field</th><th style="width:150px;"></th></tr></thead>'; } private 
function m4is_zzf9v() { $m4is_hvlq4 = $this->m4is_df1v(); $this->m4is_by18n(); foreach ($this->m4is_tvcm as $m4is_dc39 ) { $m4is_rhfd = empty( $this->m4is_ghw0yr[$m4is_dc39] ) ? 0 : $this->m4is_ghw0yr[$m4is_dc39]; if ( $m4is_rhfd ) { echo '<tr>'; echo '<td style="width:300px;">', $m4is_dc39, '</td>'; echo '<td>';  echo '<input disabled type="text" value="', $m4is_hvlq4[ $m4is_rhfd ], '" style="width:300px;">'; echo '</td>'; echo '<td><input type=submit name="xprofile_map_delete[', $m4is_dc39, ']" value="Remove" class="submitdelete"></td>'; echo '</tr>'; } } $this->m4is_c2l1cp(); $this->m4is_h5yot(); } private 
function m4is_c2l1cp() { $m4is__mpqwc = ''; foreach( $this->m4is_tvcm as $m4is_c9dh ) { if ( ! array_key_exists( $m4is_c9dh, $this->m4is_ghw0yr ) ) { $m4is__mpqwc .= '<option value="' . $m4is_c9dh . '">' . $m4is_c9dh . '</option>'; } } echo '<tr style="margin-top:20px;">'; echo '<td>'; echo '<select name="new_keap_map" class="basic-single" style="margin-right: 20px">', $m4is__mpqwc, '</select>'; echo '</td>'; echo '<td>'; echo '<select name="new_xprofile_map" class="requiredtaglistdropdown"></select>'; echo '</td>'; echo '<td></td>'; echo '</tr>'; } private 
function m4is_z8xv() { $m4is_hvlq4 = $this->m4is_df1v(); if (! empty($m4is_hvlq4 ) ) {  $m4is_mpqtb[] = [ 'id' => 0, 'text' => '(Don\'t Sync)' ]; foreach ( (array) $m4is_hvlq4 as $m4is_b40e_m => $m4is_sv3h ) { if ( ! in_array( $m4is_b40e_m, $this->m4is_ghw0yr ) ) { $m4is_mpqtb[] = [ 'id' => $m4is_b40e_m, 'text' => $m4is_sv3h ]; } } $m4is_mpqtb = json_encode($m4is_mpqtb ); unset($m4is_znf9, $m4is_b40e_m, $m4is_w9feq2 ); echo '<script>'; echo 'var requiredtaglist      = ', $m4is_mpqtb, ';'; echo '</script>'; unset($m4is_mpqtb ); } } }
