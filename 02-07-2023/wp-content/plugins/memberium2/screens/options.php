<?php
/**
 * Copyright (c) 2012-2022 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 */

 class_exists( 'm4is_emz57o' ) || die(); current_user_can( 'manage_options' ) || wp_die( __( 'You do not have sufficient permissions to access this page.' ) ); global $wpdb; memberium_app()->m4is_v64c('view_options' ); $_GET['tab'] = isset($_GET['tab'] ) ? $_GET['tab'] : 'login'; $m4is_bd92x = stripslashes_deep(memberium_app()->get_i2sdk_options() ); $m4is_wvk_m = get_option('memberium_pages', [] ); $m4is_tct_hk = memberium_app()->m4is_mmdrl('settings'); $m4is_w5uo = memberium_app()->m4is_mmdrl('infusionsoft'); if ($_SERVER['REQUEST_METHOD'] == 'POST' ) { if (! wp_verify_nonce($_POST['memberium_options_nonce'], memberium_app()->m4is_yl5j8() ) ) { wp_die('nonce error' ); return; } if (isset($_POST['pages'] ) && is_array($_POST['pages'] ) ) { foreach($_POST['pages'] as $m4is_ap3_ => $m4is_rhfd ) { $m4is_wvk_m[$m4is_ap3_] = $m4is_rhfd; } update_option('memberium_pages', $m4is_wvk_m, true ); } $m4is_ql75i = get_option('memberium_extensions', [] ); if (isset($_POST['extensions'] ) ) { foreach($_POST['extensions'] as $m4is_ap3_ => $m4is_rhfd ) { $m4is_ql75i[$m4is_ap3_] = $m4is_rhfd; } } update_option('memberium_extensions', $m4is_ql75i, true );  $m4is_dhrs = [ 'allow_autologin', 'allow_local_logins', 'allow_wpadmin', 'attachment_pages', 'autogenerate_excerpts', 'autoupdate', 'beta_update_check', 'beta/oauth', 'cache_bust', 'cache_flush', 'db_sessions', 'disable_displayname_update', 'disable_lost_password', 'disable_password_reset', 'disable_xframe', 'dynamic_menus', 'enable_slug_update', 'extended_reg_fields', 'fast_user_list', 'force_learndash_inheritance', 'httppost_log', 'known_logins_only', 'local_auth_only', 'login_log', 'microcache_compat_session', 'multi_language', 'page_inheritance', 'persistent_login', 'plaintext_db', 'preview_mode', 'protect_feeds', 'require_membership', 'show_advanced_options', 'show_post_columns', 'simultaneous_logins', 'site_lock_enabled', 'sync_affiliate', 'sync_ecommerce', 'sync_meta_updates', 'sync_new_wp_users', 'sync_tag_details', 'telemetry', 'two_pass_shortcode_filter', ]; foreach($m4is_dhrs as $m4is_ap3_ ) { $m4is_tct_hk[$m4is_ap3_] = isset($_POST[$m4is_ap3_] ) ? (int) (bool) trim($_POST[$m4is_ap3_] ) : $m4is_tct_hk[$m4is_ap3_]; }  $m4is_dhrs = [ 'allow_wpadmin_dashboard', 'allow_wpadmin_role', 'allow_wpadmin_titlebar', 'default_page_redirect', 'default_prohibited_action', 'default_reglink_tag', 'displayname_format', 'facebook_app_id', 'global_excerpt', 'include_default_excerpt', 'last_login_field', 'password_field', 'registration_url', 'spiffy_subdomain', 'username_field', ]; foreach($m4is_dhrs as $m4is_ap3_ ) { $m4is_tct_hk[$m4is_ap3_] = isset($_POST[$m4is_ap3_] ) ? stripslashes(trim($_POST[$m4is_ap3_] ) ) : $m4is_tct_hk[$m4is_ap3_]; }  $m4is_dhrs = [ 'async_limit', 'async_tag', 'autologout_time', 'bruteforce_check', 'excerpt_length', 'first_login_page', 'login_actionset', 'login_tag', 'login_url', 'logout_actionset', 'logout_tag', 'max_affiliate_age', 'max_contact_age', 'maximum_login_ips', 'maximum_login_timeframe', 'min_password_length', 'new_user_registration_tag', 'password_reset_tag', 'password_strength', 'session_timeout', 'site_ban_tag', 'wp_autop',  ]; foreach($m4is_dhrs as $m4is_ap3_ ) { $m4is_tct_hk[$m4is_ap3_] = isset($_POST[$m4is_ap3_] ) ? (int) trim($_POST[$m4is_ap3_] ) : $m4is_tct_hk[$m4is_ap3_]; } if (isset($_POST['autologin_authkeys'] ) ) { $m4is_hak1rj = explode(',', $_POST['autologin_authkeys'] ); $m4is_swucj = explode(',', memberium_app()->m4is_nn6s_()->getConfigurationOption('http_post_key' ) ); $m4is_t5iahc = false; foreach ($m4is_hak1rj as $m4is_b40e_m => $m4is_ap3_ ) { $m4is_ap3_ = trim($m4is_ap3_ ); foreach ($m4is_swucj as $m4is_u31zb9 ) { if (strtolower(trim($m4is_u31zb9 ) == strtolower(trim($m4is_ap3_ ) ) ) ) { $m4is_t5iahc = true; unset($m4is_hak1rj[$m4is_b40e_m] ); } } } $m4is_tct_hk['autologin_authkeys'] = trim(implode(',', $m4is_hak1rj ), ',' ); } memberium_app()->m4is_oqwxk($m4is_w5uo, 'infusionsoft' ); memberium_app()->m4is_oqwxk($m4is_tct_hk, 'settings' ); if (isset($_POST['page_load'] ) ) { if ($_POST['page_load'] == 'Load All Templates' ) { $m4is_hh79 = $this->m4is_ggin(); foreach($m4is_hh79 as $template_id => $template ) { $this->m4is_prf9(0, $template_id ); } } elseif ($_POST['page_load'] == 'Load Single Template' ) { $this->m4is_prf9($_POST['target_post_id'], ($_POST['template_id'] - 1 ) ); } elseif ($_POST['page_load'] == 'Install Email Templates' ) { $m4is_r4xm = $this->m4is_mwom(); } } if (isset($_POST['new_crm_field'] ) ) { $_POST['new_crm_field'] = trim($_POST['new_crm_field'] ); $this->m4is_s46yj($_POST['new_crm_field'] ); } if (isset($_GET['tab'] ) ) { if ($_GET['tab'] == 'general' ) { $m4is_fi64q = explode(',', $m4is_w5uo['ignore_contact_fields'] ); $m4is_fi64q = array_flip($m4is_fi64q ); unset($m4is_fi64q[$m4is_tct_hk['password_field']] ); unset($m4is_fi64q[$m4is_tct_hk['username_field']] ); $m4is_fi64q = array_flip($m4is_fi64q ); $m4is_w5uo['ignore_contact_fields'] = implode(',', $m4is_fi64q ); m4is__95_::m4is_hbfrj('General Options Updated' ); } elseif ($_GET['tab'] == 'extensions' ) { m4is__95_::m4is_hbfrj('Updates Options Updated' ); } elseif ($_GET['tab'] == 'http-post' ) { $_POST['autologin_authkeys'] = trim(implode(',', $m4is_hak1rj ), ',' ); m4is__95_::m4is_hbfrj('Options Updated' ); if ($m4is_t5iahc ) { m4is__95_::m4is_hbfrj('You cannot re-use I2SDK Keys as Autologin Keys for security reasons' . m4is__95_::m4is_d6u3(363 ) ); } else { $m4is_tct_hk['autologin_authkeys'] = $_POST['autologin_authkeys']; } unset($m4is_ap3_, $m4is_u31zb9, $m4is_t5iahc, $m4is_swucj, $m4is_hak1rj ); m4is__95_::m4is_hbfrj('HTTP POST Options Updated' ); } } global $wp_rewrite; $wp_rewrite->flush_rules(); } $m4is_xq5r_m = m4is_zvyj::m4is_a6x52r()->m4is_veu5f();   $m4is_znf9 = memberium_app()->m4is_ee0h(TRUE ); $m4is_znf9 = $m4is_znf9['mc']; $m4is_q4i2j = []; $m4is_q4i2j[] = [ 'id' => 0, 'text' => '(None)' ]; foreach ( (array) $m4is_znf9 as $m4is_b40e_m => $m4is_w9feq2 ) { $m4is_q4i2j[] = [ 'id' => $m4is_b40e_m, 'text' => $m4is_w9feq2 . ' (' . $m4is_b40e_m . ')' ]; } $m4is_q4i2j = json_encode($m4is_q4i2j ); unset($m4is_znf9, $m4is_b40e_m, $m4is_w9feq2 ); $m4is_ioxk = "SELECT `id`, `name` FROM " . MEMBERIUM_DB_ACTIONSETS . " WHERE `appname` = %s AND `name` >  '' ORDER BY `name` ASC"; $m4is_ioxk = $wpdb->prepare($m4is_ioxk, $this->appname ); $m4is_b8ve = $wpdb->get_results($m4is_ioxk, ARRAY_A ); $json_actionsets = []; $json_actionsets[] = [ 'id' => 0, 'text' => '(No Action)' ]; foreach ($m4is_b8ve as $m4is_b40e_m => $row ) { $json_actionsets[] = [ 'id' => $row['id'], 'text' => "{$row['name']} ({$row['id']})", ]; } $json_actionsets = json_encode($json_actionsets ); unset($m4is_b8ve, $m4is_b40e_m, $row, $m4is_ioxk ); echo '<script>'; echo 'var pagelist      = ', $m4is_xq5r_m, ';'; echo 'var actionsetlist = ', $json_actionsets, ';'; echo 'var taglist       = ', $m4is_q4i2j, ';'; echo '</script>'; unset($m4is_q4i2j, $m4is_xq5r_m, $json_actionsets );
