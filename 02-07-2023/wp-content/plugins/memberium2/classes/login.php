<?php
/**
 * Copyright (c) 2012-2022 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

  class_exists('m4is_emz57o') || die(); m4is_pewcid::m4is_gopgz(); final 
class m4is_pewcid { private static $m4is_bxv7u, $m4is_q7m2, $m4is_cpwjsn; static 
function m4is_gopgz() { self::$m4is_bxv7u = memberium_app(); self::$m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x( 'appname' ); self::$m4is_cpwjsn = m4is_pcys::m4is_a6x52r(); }     private static 
function m4is_hycz2() { $m4is_oknpuo = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'bruteforce_check', 0 ); $m4is_uhmj6v = defined( 'MEMBERIUM_BRUTEFORCE_TOKEN' ) ? MEMBERIUM_BRUTEFORCE_TOKEN : ''; $m4is_barze = wp_salt( 'secure_auth' ); if ( $m4is_oknpuo == 1 ) { $m4is_uhmj6v = crc32( $_SERVER['DOCUMENT_ROOT'] . $m4is_barze ); } elseif ($m4is_oknpuo == 2) { $m4is_uhmj6v = crc32( m4is_lr56w2::m4is_nnbp() . $m4is_barze ); } return $m4is_uhmj6v; }  static 
function m4is_dxhlr( $m4is_nzrv1, $m4is_id576 = '', $m4is_p1ug = '' ) { if ( $_SERVER['REQUEST_METHOD'] <> 'POST' ) { return $m4is_nzrv1; } if ( empty( $m4is_id576 ) ) { return $m4is_nzrv1; } if ( defined( 'MEMBERIUM_DISABLE_BOT_CHECK' ) && MEMBERIUM_DISABLE_BOT_CHECK ) { return $m4is_nzrv1; } if ( ! self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'bruteforce_check' ) ) { return $m4is_nzrv1; } $m4is_wwer9z = isset( $_POST['bruteforcecheck'] ) ? $_POST['bruteforcecheck'] : ''; if ( $m4is_wwer9z == self::m4is_hycz2() ) { return $m4is_nzrv1; } self::$m4is_qfa4bd = true; $m4is_fgxy = self::$m4is_bxv7u->m4is_vvsj( 'i18n/loginfailed' ); $m4is_nzrv1 = new WP_Error( 'authentication_failed', $m4is_fgxy ); $m4is_y06x = self::$m4is_bxv7u->m4is_vvsj( 'i18n/contactmemberium' ); http_response_code( 403 ); header( 'HTTP/1.1 403 Forbidden' ); header( 'Status: 403 Forbidden' ); echo '<p>', strtoupper( MEMBERIUM_SKU ), ':', __LINE__, ' Forbidden</p>'; echo '<p>', $m4is_y06x, '</p>'; exit(); }  static 
function m4is_jga1s( $m4is_amunwi = '', array $m4is_w5ky4q = [] ) : string { $m4is_uhmj6v = self::m4is_hycz2(); if (! empty( $m4is_uhmj6v ) ) { $m4is_k2qb08 = "<input name='bruteforcecheck' type='hidden' value='" . self::m4is_hycz2() ."' />"; if (! empty( $m4is_w5ky4q['display'] ) || current_action() == 'login_form') { echo $m4is_k2qb08; return ''; } } else { $m4is_k2qb08 = ''; } return "{$m4is_amunwi}{$m4is_k2qb08}"; }     static 
function m4is_rdoyem( $m4is_nzrv1, string $m4is_id576 = '', string $m4is_p1ug = '' ) {  if ( empty( $m4is_id576 ) || empty( $m4is_p1ug ) ) { return $m4is_nzrv1; } if (! m4is_o5aoir::m4is__qlbej() ) { return $m4is_nzrv1; } if ( self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'known_logins_only' ) ) { return $m4is_nzrv1; } if ( self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'local_auth_only' ) ) { return $m4is_nzrv1; }  $m4is_gwr6j0 = get_user_by( 'email', $m4is_id576 ) or $m4is_gwr6j0 = get_user_by( 'login', $m4is_id576 ); if ( is_a( $m4is_gwr6j0, 'WP_User' ) ) { return $m4is_nzrv1; } $m4is_aicfp = self::$m4is_bxv7u->m4is__k5_q( $m4is_id576, $m4is_p1ug ); $m4is_qlbeg = self::$m4is_bxv7u->m4is_jrjget( $m4is_aicfp ); $m4is_nzrv1 = get_user_by( 'ID', $m4is_qlbeg ); $_SESSION = self::$m4is_bxv7u->m4is_q4nu( $m4is_qlbeg ); return $m4is_nzrv1; }  static 
function m4is_u6id( $m4is_nzrv1, string $m4is_id576 = '', string $m4is_p1ug = '' ) { if ( empty( $m4is_id576 ) || empty( $m4is_p1ug ) ) { return $m4is_nzrv1; } if ( stripos( $m4is_id576, '@' ) === false ) { return $m4is_nzrv1; } if ( ! m4is_o5aoir::m4is__qlbej() ) { return $m4is_nzrv1; } $m4is_wq9e = get_user_by( 'email', $m4is_id576 ) or $m4is_wq9e = get_user_by( 'login', $m4is_id576 ); if ( is_a( $m4is_wq9e, 'WP_User' ) && ! user_can( $m4is_wq9e, 'manage_options' ) ) { self::$m4is_bxv7u->m4is_melv( $m4is_wq9e->user_email ); } return $m4is_nzrv1; }  static 
function m4is_yu4p( $m4is_nzrv1, $m4is_id576 = '', $m4is_p1ug = '' ) { $m4is_qy0cg = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'local_auth_only', false ); if ( $m4is_qy0cg ) { return $m4is_nzrv1; } $m4is_f0y9 = get_user_by( 'email', $m4is_id576 ) or $m4is_f0y9 = get_user_by( 'login', $m4is_id576 ); if ( ! $m4is_f0y9 ) { return $m4is_nzrv1; } $m4is_m2h6b = $m4is_f0y9->user_email; $m4is_ulo1 = m4is_zbyh::m4is_e6ntsy( $m4is_m2h6b ); if ( is_array( $m4is_ulo1 ) ) { $m4is_aicfp = isset( $m4is_ulo1[0] ) ? $m4is_ulo1[0] : 0; } if ( $m4is_aicfp ) { $m4is_nq7s = m4is_zbyh::m4is_w1bfmt( $m4is_aicfp ); $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field' ); if ( $m4is_nq7s[ $m4is_jyx_t ] !== 'PASSWORD_PLACEHOLDER' ) { if ( $m4is_nq7s[ $m4is_jyx_t ] !== $m4is_p1ug || empty( trim( $m4is_p1ug ) ) ) { $m4is_nzrv1 = new WP_Error ( 'authentication_failed', __( '<strong>ERROR</strong>: Incorrect Password.', 'memberium' ) ); } else { $m4is_nzrv1 = $m4is_f0y9; } } } return $m4is_nzrv1; } static 
function m4is_zzomh( $m4is_nzrv1, $m4is_id576 = '', $m4is_p1ug = '' ) { if ( ! is_a( $m4is_nzrv1, 'WP_User' ) ) { return $m4is_nzrv1; } if ( user_can( $m4is_nzrv1, 'manage_options' ) ) { return $m4is_nzrv1; } if ( ! m4is_o5aoir::m4is__qlbej() ) { $m4is_zocyxt = m4is_q1amx::m4is_u4dk( self::$m4is_bxv7u->m4is_w47qdy(), 'loginfail', 'Logins Disabled - Invalid License', m4is_lr56w2::m4is_nnbp(), true ); $m4is_nzrv1 = new WP_Error( 'authentication_failed', __( '<center><strong>All Logins Temporarily Disabled for Maintenance Mode</strong></center>', 'memberium' ) ); } return $m4is_nzrv1; } static 
function m4is_cmns( &$m4is_id576 ) { if ( empty( $m4is_id576 ) ) { return $m4is_id576; } $m4is_nzrv1 = get_user_by( 'email', $m4is_id576 ); if ( ! empty( $m4is_nzrv1->user_login ) ) { $m4is_id576 = $m4is_nzrv1->user_login; } $_POST['log'] = $m4is_id576; return $m4is_id576; } static 
function m4is_t93t4( $m4is_nzrv1, $m4is_w5ky4q = [] ) { global $wpdb; if ( is_a( $m4is_nzrv1, 'WP_Error' ) ) { return $m4is_nzrv1; } $m4is_fidn4 = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'login_log' ); if ( ! $m4is_fidn4 ) { return $m4is_nzrv1; } $m4is_id576 = ''; if ( is_a( $m4is_nzrv1, 'WP_User' ) ) { $m4is_id576 = $m4is_nzrv1->user_login; } elseif ( is_string( $m4is_nzrv1 ) ) { $m4is_id576 = $m4is_nzrv1; } $m4is_p78sgz = [ 'appname' => self::$m4is_bxv7u->m4is_re5x( 'appname' ), 'time' => time(), 'ipaddress' => m4is_lr56w2::m4is_nnbp(), ]; $m4is_w5ky4q = wp_parse_args( $m4is_w5ky4q, $m4is_p78sgz ); $m4is_w6mt = MEMBERIUM_DB_LOGINLOG; $m4is_ioxk = "INSERT INTO `{$m4is_w6mt}` (`appname`, `logintime`, `ipaddress`, `username`) VALUES (%s, %d, %s, %s)"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2, $m4is_w5ky4q['time'], $m4is_w5ky4q['ipaddress'], $m4is_id576 ); $wpdb->query($m4is_ioxk); return $m4is_nzrv1; } static 
function m4is_qz1oy( $m4is_u4dt3v, $m4is_imt_rj, $m4is_nzrv1 ) { if ( is_a( $m4is_nzrv1, 'WP_Error' ) ) { return $m4is_u4dt3v;  if ( empty( $m4is_imt_rj ) ) { $m4is_u4dt3v = get_admin_url(); } return $m4is_u4dt3v; } if ( ! empty( $m4is_imt_rj ) ) { $m4is_u4dt3v = $m4is_imt_rj; } if ( ! is_a( $m4is_nzrv1, 'WP_User' ) ) { return $m4is_u4dt3v; } if ( empty( $_REQUEST['redirect_to'] ) && empty( $m4is_imt_rj ) ) { if ( user_can( $m4is_nzrv1, 'manage_options' ) ) { $m4is_u4dt3v = admin_url(); } if ( $_SESSION['memb_user']['login_page'] == -1 ) { if ( function_exists( 'bbp_get_user_profile_url' ) ) { $m4is_u4dt3v = bbp_get_user_profile_url( $m4is_nzrv1->ID ); } $m4is_u4dt3v = get_permalink( $_SESSION['memb_user']['login_page'] ); } elseif ( $_SESSION['memb_user']['login_page'] > 0 ) { $m4is_u4dt3v = get_permalink( $_SESSION['memb_user']['login_page'] ); } } if ( empty( $m4is_u4dt3v ) ) { $m4is_u4dt3v = admin_url(); } return $m4is_u4dt3v; }  static 
function m4is_e87ze(&$m4is_id576) { global $wpdb; $m4is_mmop = 0; if ( empty( $m4is_id576 ) ) { return false; }  $m4is_o7mygi = get_user_by('login', $m4is_id576); if ( is_a( $m4is_o7mygi, 'WP_User' ) && ( ! empty( $m4is_o7mygi->caps['administrator'] ) ) || ( ! empty( $m4is_o7mygi->caps['super_admin'] ) ) ) { return true; } if (! m4is_o5aoir::m4is__qlbej() ) { return false; } $m4is_p1ug = ''; if (! headers_sent() && session_status() !== PHP_SESSION_ACTIVE) { session_start(); } if (isset($_POST['pwd']) ) { $m4is_p1ug = $_POST['pwd']; } if (isset($_POST['password']) ) { $m4is_p1ug = $_POST['password']; } if (empty($m4is_p1ug) ) { return false; } $m4is_avugd = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'known_logins_only', false ); $m4is_mnbr = self::$m4is_cpwjsn->m4is_jh7yc($m4is_id576); $m4is_o7mygi = get_user_by('email', $m4is_mnbr); $m4is_aicfp = self::$m4is_bxv7u->m4is__k5_q($m4is_id576, $m4is_p1ug); if ( ! $m4is_avugd ) { self::$m4is_bxv7u->m4is_melv( $m4is_mnbr ); } if ($m4is_aicfp > 0) { $m4is_o7mygi = self::$m4is_bxv7u->m4is_f14d7o($m4is_aicfp); if ($m4is_o7mygi) { if (! username_exists($m4is_mnbr) && ! email_exists($m4is_mnbr) ) { if ($m4is_o7mygi->user_email <> $m4is_mnbr) { if ($m4is_o7mygi->user_email == $m4is_o7mygi->user_login) { $m4is_ioxk = "UPDATE `{$wpdb->users}` SET `user_email` = %s, `user_login` = %s WHERE `ID` = %d; "; $m4is_ioxk = $wpdb->prepare($m4is_ioxk, strtolower($m4is_mnbr), strtolower($m4is_mnbr), $m4is_o7mygi->ID); } else { $m4is_ioxk = "UPDATE `{$wpdb->users}` SET `user_email` = %s WHERE `ID` = %d; "; $m4is_ioxk = $wpdb->prepare($m4is_ioxk, strtolower($m4is_mnbr), $m4is_o7mygi->ID); } $wpdb->query($m4is_ioxk); } } } }  $m4is_o7mygi = get_user_by('login', $m4is_id576); if (! $m4is_o7mygi) { $m4is_o7mygi = get_user_by('email', $m4is_id576); } if (! $m4is_aicfp ) { global $user; $user = new WP_Error('authentication_failed', __('ERROR: Unknown Account.', 'memberium') ); return NULL; } $m4is_uu0bf = (int) self::$m4is_bxv7u->m4is_mmdrl('settings', 'max_contact_age'); if ( $m4is_uu0bf == 0 ) { $m4is_uu0bf = 5;  } $m4is_ioxk = 'SELECT `value` FROM `' . MEMBERIUM_DB_CONTACTS . '` WHERE `id` = %d AND `appname` =  %s AND `fieldname` = "!LastUpdated" '; $m4is_ioxk = $wpdb->prepare($m4is_ioxk, $m4is_aicfp, self::$m4is_bxv7u->m4is_re5x('appname') ); $m4is_i8ic4 = $wpdb->get_col($m4is_ioxk); if ($m4is_i8ic4 < (time() - $m4is_uu0bf) ) { self::$m4is_bxv7u->m4is_qjrxkl($m4is_aicfp); } self::$m4is_bxv7u->m4is_jrjget($m4is_aicfp); $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl('settings', 'password_field'); $m4is_nq7s = m4is_zbyh::m4is_w1bfmt($m4is_aicfp); if (stripslashes($m4is_p1ug) != $m4is_nq7s[$m4is_jyx_t]) { $user = new WP_Error('authentication_failed', __('<strong>ERROR</strong>: Incorrect Password.', 'memberium') ); return NULL; } $m4is_nunl = self::$m4is_bxv7u->m4is_mmdrl('settings', 'sync_ecommerce'); $m4is_phjed = self::$m4is_bxv7u->m4is_mmdrl('settings', 'sync_affiliate');  if ( ! empty( self::$m4is_bxv7u->m4is_mmdrl('settings', 'sync_affiliate') )) { self::$m4is_bxv7u->m4is_edes($m4is_aicfp); $m4is_sxfbjo = self::$m4is_cpwjsn->m4is_uzx3($m4is_o7mygi->ID); }  if (! empty($m4is_nunl)) { m4is_s3nu::m4is_vpfcvg($m4is_aicfp); self::$m4is_bxv7u->m4is_u6sg($m4is_aicfp, true); } $m4is_f0y9 = get_user_by('login', $m4is_id576); if (! $m4is_f0y9) { $m4is_f0y9 = get_user_by('email', $m4is_id576); } if ($m4is_f0y9) { $user = $m4is_f0y9; $_POST['username'] = $user->user_login; $m4is_id576 = $user->user_login; wp_set_current_user($user->ID); } self::$m4is_bxv7u->m4is_cxp5eb( true ); if ($m4is_mmop) { $user = wp_set_current_user($m4is_mmop); } $m4is_znf9 = isset($m4is_nq7s['Groups']) ? explode(',', $m4is_nq7s['Groups']) : []; self::$m4is_bxv7u->m4is_cxp5eb( false ); } static 
function m4is_gvh8($m4is_xpfcq, $m4is_nzrv1 = NULL) { if (isset($_POST['firstname']) || isset($_POST['lastname']) ) { if (isset($_POST['firstname']) ) { $m4is_h4qe1_ = $_POST['firstname']; } if (isset($_POST['lastname']) ) { $m4is_u1mgqo = $_POST['lastname']; } } else { $m4is_h4qe1_ = $m4is_nzrv1->first_name; $m4is_u1mgqo = $m4is_nzrv1->last_name; if (strpos($m4is_nzrv1->display_name, ' ') > 0) { $m4is_h4qe1_ = trim(substr($m4is_nzrv1->display_name, 0, strpos($m4is_nzrv1->display_name, ' ') ) ); $m4is_u1mgqo = trim(substr($m4is_nzrv1->display_name, strpos($m4is_nzrv1->display_name, ' ') + 1) ); } } $m4is_nph1 = trim($m4is_h4qe1_ . ' ' . $m4is_u1mgqo); $m4is_q4c_xa = $m4is_nzrv1->ID; $m4is_wxlzb = 0; $m4is_nq7s = [ 'FirstName' => $m4is_h4qe1_, 'LastName' => $m4is_u1mgqo, 'Email' => $m4is_nzrv1->user_email, ]; if ($m4is_wxlzb > 0) { $m4is_nq7s['LeadSourceId'] = $m4is_wxlzb; } if (get_user_meta($m4is_nzrv1->ID, '_fb_is_sync', true) != 1) { if ( self::$m4is_cpwjsn->m4is_wv9c() ) { $m4is_aicfp = m4is_zbyh::m4is_dj3iv($m4is_nq7s); m4is_zbyh::m4is_kbc0w($m4is_nq7s['Email'], 'Membership Site Registration'); $m4is_p1nfgu = self::$m4is_bxv7u->m4is_mmdrl('settings', 'new_user_registration_tag'); if ($m4is_p1nfgu) { self::$m4is_bxv7u->m4is__mkz([$m4is_p1nfgu], $m4is_aicfp); } delete_user_meta($m4is_nzrv1->ID, '_fb_is_sync'); add_user_meta($m4is_nzrv1->ID, '_fb_is_sync', 1); } }  $m4is_nzrv1 = wp_get_current_user(); if (! is_a($m4is_nzrv1, 'WP_User') ) { return $m4is_nzrv1; } self::$m4is_cpwjsn->m4is_uzx3($m4is_nzrv1); } static 
function m4is_qhrbj($m4is_xpfcq, $m4is_nzrv1 = NULL) { if ($m4is_nzrv1 == NULL) { $m4is_nzrv1 = wp_get_current_user(); }  if (user_can($m4is_nzrv1, 'manage_options') ) { return; } if ( self::$m4is_bxv7u->m4is_mmdrl('settings', 'simultaneous_logins', false) ) { self::$m4is_bxv7u->m4is_bids($m4is_nzrv1->ID); }  if (empty($_SESSION['memb_user']) ) { $_SESSION = self::$m4is_bxv7u->m4is_q4nu($m4is_nzrv1->ID); } $_POST['redirect_to'] = empty($_POST['redirect_to']) ? '' : $_POST['redirect_to']; $_POST['redirect_to'] = empty($_POST['redirect']) ? $_POST['redirect_to'] : $_POST['redirect'];  if (0 == self::$m4is_bxv7u->m4is_mmdrl('settings', 'allow_wpadmin') ) { if (stripos($_POST['redirect_to'], '/wp-admin') !== false) { $_POST['redirect_to'] = ''; } } $m4is_q4c_xa = (int) $m4is_nzrv1->ID; $m4is_aicfp = (int) m4is_zbyh::m4is_fhxr6($m4is_q4c_xa); if ($m4is_q4c_xa) {  m4is_s3nu::m4is_p1idj2($m4is_aicfp);  $m4is_fwzrc4 = (int) get_user_meta($m4is_q4c_xa, 'login_count', true) + 1; $m4is_n_bp6 = update_user_meta($m4is_q4c_xa, 'login_count', $m4is_fwzrc4); $m4is_n_bp6 = update_user_meta($m4is_q4c_xa, 'login_ip_address', m4is_lr56w2::m4is_nnbp() ); $m4is_n_bp6 = update_user_meta($m4is_q4c_xa, 'last_login_time', time() ); if ($m4is_aicfp) { $m4is_nq7s = m4is_zbyh::m4is_w1bfmt($m4is_aicfp);  self::$m4is_cpwjsn->m4is_z1x9($m4is_nq7s, $m4is_q4c_xa); $m4is_syxk4 = (int) self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'login_actionset' ); $m4is_i2mvw1 = (int) self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'login_tag' ); $m4is_hh1k = trim( self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'login_goal' ) ); $m4is_apfl = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'last_login_field' ); $m4is_zbg_u4 = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'sync_affiliate' ); if (! empty($m4is_hh1k) ) { self::$m4is_bxv7u->m4is_zox_z5($m4is_aicfp, $m4is_qw8dk); }  if ( $m4is_syxk4 ) { self::$m4is_bxv7u->m4is_evrbh( $m4is_syxk4, (int) $m4is_aicfp ); }  if ( $m4is_i2mvw1 ) { self::$m4is_bxv7u->m4is__mkz( $m4is_i2mvw1, $m4is_aicfp ); } if ( ! empty( $m4is_zbg_u4 ) ) { self::$m4is_bxv7u->m4is_edes( $m4is_aicfp ); }  $m4is_kbu63_ = []; if (! empty($m4is_apfl) ) { $m4is_fj2k = date_default_timezone_get(); date_default_timezone_set('America/New_York'); $m4is_kbu63_[$m4is_apfl] = date('Y-m-d\TH:i:s'); date_default_timezone_set($m4is_fj2k); } if (! empty($m4is_kbu63_) ) { m4is_zbyh::m4is_pp0i($m4is_aicfp, $m4is_kbu63_);  } } } if ( defined( 'DOING_AJAX' ) && DOING_AJAX ) { self::$m4is_cpwjsn->m4is_atalk7(false); }  }     static 
function m4is_l8gbs($m4is_id576, $m4is_p1ug = '', $m4is_us_qv = false) { global $wpdb; if (is_user_logged_in() ) { return false; } $m4is_rz4ur = self::$m4is_bxv7u->m4is_mmdrl('settings', 'username_field'); $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl('settings', 'password_field'); $m4is_avugd = self::$m4is_bxv7u->m4is_mmdrl('settings', 'known_logins_only'); $m4is_q7m2 = self::$m4is_q7m2; $m4is_aicfp = self::$m4is_bxv7u->m4is__k5_q( $m4is_id576, $m4is_p1ug );  if ( $m4is_avugd ) { $m4is_ioxk = 'SELECT id FROM ' . MEMBERIUM_DB_CONTACTS . ' WHERE id = %d AND appname = %s LIMIT 1;'; $m4is_ioxk = $wpdb->prepare($m4is_ioxk, $m4is_aicfp, self::$m4is_q7m2 ); $m4is_z1bo0 = (int) $wpdb->get_var($m4is_ioxk); if ( $m4is_z1bo0 <> $m4is_aicfp ) { return false; } } if ($m4is_aicfp) { $m4is_nq7s = m4is_zbyh::m4is_w1bfmt($m4is_aicfp); self::$m4is_bxv7u->m4is_jrjget($m4is_aicfp); }  if (m4is_lpl4d::m4is_a_2z() == $m4is_aicfp) { if ($m4is_us_qv) { return get_current_user_id(); } else { if (! empty($_SESSION['memb_user']['login_page']) ) {  m4is_d8yr0_::m4is_okts(); wp_redirect(get_permalink($_SESSION['memb_user']['login_page']) ); exit; } else { return; } } } $m4is_owt5 = self::$m4is_cpwjsn->m4is_jh7yc($m4is_id576); self::$m4is_bxv7u->m4is_melv( $m4is_owt5 ); $m4is_nzrv1 = get_user_by('email', $m4is_owt5); $m4is_q4c_xa = $m4is_nzrv1->ID; $_POST['pwd'] = $m4is_nq7s[$m4is_jyx_t]; m4is_pewcid::m4is_e87ze($m4is_id576); if ($m4is_q4c_xa > 0) { wp_set_auth_cookie($m4is_q4c_xa); wp_set_current_user($m4is_q4c_xa); m4is_pewcid::m4is_e87ze($m4is_id576); self::$m4is_cpwjsn->m4is_uzx3($m4is_nzrv1);     if ($m4is_us_qv) { return $m4is_q4c_xa; } else {  m4is_d8yr0_::m4is_okts(); if (! empty( $_SESSION['memb_user']['login_page'] ) ) { wp_redirect( get_permalink( $_SESSION['memb_user']['login_page'] ) ); exit; } else { return; } } } return false; } static 
function m4is_yuohc( $m4is_id576, $m4is_o7mygi = null ) { global $user; $m4is_fgxy = ''; self::$m4is_bxv7u->m4is_ej5_0(); if ( is_a( $m4is_o7mygi, 'WP_Error' ) ) { $m4is_aicfp = empty( $m4is_id576 ) ? 0 : self::$m4is_bxv7u->m4is__yge( (string) $m4is_id576 ); $m4is_fzalfr = empty( $m4is_o7mygi->errors ) ? [] : $m4is_o7mygi->errors; foreach( $m4is_fzalfr as $m4is_ap3_ => $m4is_rhfd ) { $m4is_fgxy .= $m4is_rhfd[0] . ' '; } $m4is_fgxy = trim( strip_tags( $m4is_fgxy ) ); $m4is_zocyxt = m4is_q1amx::m4is_u4dk( $m4is_aicfp, 'loginfail', "({$m4is_id576}) {$m4is_fgxy}", m4is_lr56w2::m4is_nnbp(), true ); setcookie( 'login_error', $m4is_fgxy, ( time() + 60 ) ); }   if ( isset( $_POST['woocommerce-login-nonce'] ) ) { return; } $m4is_tdb7q = isset( $_SERVER['HTTP_REFERER'] ) ? $_SERVER['HTTP_REFERER'] : '';  if ( empty( $refererer ) ) { $m4is_ejy54 = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'login_url' ); $m4is_tdb7q = get_permalink( $m4is_ejy54 ); }  if ( ! empty( $m4is_tdb7q ) && ! strstr( $m4is_tdb7q, 'wp-login' ) && ! strstr( $m4is_tdb7q, 'wp-admin' ) ) { $m4is_stwjyi = []; $m4is_stwjyi['login'] = 'failed'; if ( ! empty( $_POST['redirect_to'] ) && stripos( $_POST['redirect_to'], '/wp-admin/' ) === false ) { $m4is_stwjyi['redirect_to'] = $_POST['redirect_to']; } $m4is_tdb7q = add_query_arg( $m4is_stwjyi, $m4is_tdb7q ); m4is_d8yr0_::m4is_okts(); wp_redirect( $m4is_tdb7q );  exit; } }    static 
function m4is_mlnq( $m4is_nzrv1, $m4is_id576 = '', $m4is_p1ug = '' ) { if ( ! is_a( $m4is_nzrv1, 'WP_User' ) ) { return $m4is_nzrv1; }  if ( user_can( $m4is_nzrv1, 'manage_options' ) ) { return $m4is_nzrv1; } $m4is_nzrv1 = self::m4is_kcws( $m4is_nzrv1, $m4is_id576, $m4is_p1ug ); if ( is_a( $m4is_nzrv1, 'WP_User' ) ) { $m4is_nzrv1 = self::m4is_mytw0r( $m4is_nzrv1, $m4is_id576, $m4is_p1ug ); } if ( is_a( $m4is_nzrv1, 'WP_User' ) ) { $m4is_nzrv1 = self::m4is_vlur( $m4is_nzrv1, $m4is_id576, $m4is_p1ug ); } if ( is_a( $m4is_nzrv1, 'WP_User' ) ) { $m4is_nzrv1 = self::m4is_xazs( $m4is_nzrv1, $m4is_id576, $m4is_p1ug ); } return $m4is_nzrv1; } private static 
function m4is_kcws($m4is_nzrv1, $m4is_id576 = '', $m4is_p1ug = '') { if ( self::$m4is_bxv7u->m4is_mmdrl('settings', 'allow_local_logins') ) { return $m4is_nzrv1; } if (user_can($m4is_nzrv1, 'manage_options')) { return $m4is_nzrv1; } $m4is_aicfp = self::$m4is_bxv7u->m4is__yge($m4is_nzrv1->user_email); if ($m4is_aicfp) { $m4is_nq7s = m4is_zbyh::m4is_w1bfmt($m4is_aicfp); if (empty($m4is_nq7s)) { $m4is_aicfp = false; } }  if ( empty( $m4is_aicfp ) ) { $m4is_nzrv1 = new WP_Error('authentication_failed', __('Local logins not permitted.', 'memberium') ); self::$m4is_bxv7u->m4is_ej5_0(); } return $m4is_nzrv1; } private static 
function m4is_mytw0r($m4is_nzrv1, $m4is_id576 = '', $m4is_p1ug = '') { static $m4is_a2cyoh = []; if ( ! self::$m4is_bxv7u->m4is_mmdrl('settings', 'site_ban_tag') ) { return $m4is_nzrv1; } $m4is_aicfp = self::$m4is_bxv7u->m4is_w47qdy(); if ($m4is_aicfp) { $m4is_nq7s = m4is_zbyh::m4is_w1bfmt($m4is_aicfp); $m4is_znf9 = isset($m4is_nq7s['Groups']) ? explode(',', $m4is_nq7s['Groups']) : []; $m4is_n8wbaf = self::$m4is_bxv7u->m4is_mmdrl('settings', 'site_ban_tag');  if (in_array($m4is_n8wbaf, $m4is_znf9) ) { self::$m4is_bxv7u->m4is_ej5_0(); if (empty($m4is_a2cyoh[$m4is_nzrv1->ID]) ) { $m4is_zocyxt = m4is_q1amx::m4is_u4dk($m4is_aicfp, 'loginfail', 'Site Ban Tag Found - ' . $m4is_nzrv1->user_email, m4is_lr56w2::m4is_nnbp(), true); $m4is_a2cyoh[$m4is_nzrv1->ID] = 1; } $m4is_nzrv1 = new WP_Error( 'authentication_failed', __('Your access is currently suspended. Please contact customer support for further details.', 'memberium') ); } } return $m4is_nzrv1; } private static 
function m4is_vlur($m4is_nzrv1, $m4is_id576 = '', $m4is_p1ug = '') { if ( ! self::$m4is_bxv7u->m4is_mmdrl('settings', 'require_membership') ) { return $m4is_nzrv1; } $m4is_aicfp = self::$m4is_bxv7u->m4is_w47qdy(); if (! $m4is_aicfp) { return $m4is_nzrv1; } if (! empty($_SESSION['memb_user']['membership_tags']) ) { return $m4is_nzrv1; } if (! isset($_SESSION['memb_user']['membership_tags']) ) { $session = self::$m4is_bxv7u->m4is_q4nu($m4is_nzrv1->ID); if (! empty($session['memb_user']['membership_tags']) ) { return $m4is_nzrv1; } } $m4is_zocyxt = m4is_q1amx::m4is_u4dk($m4is_aicfp, 'loginfail', 'No Active Membership Found - ' . $m4is_nzrv1->user_email, m4is_lr56w2::m4is_nnbp(), true); self::$m4is_bxv7u->m4is_ej5_0(); $m4is_nzrv1 = new WP_Error('authentication_failed', __('<strong>Error</strong>: Access Denied - No Active Membership.', 'memberium') ); return $m4is_nzrv1; } private static 
function m4is_xazs( $m4is_nzrv1, $m4is_id576 = '', $m4is_p1ug = '' ) { global $wpdb; $m4is_aicfp = self::$m4is_bxv7u->m4is_w47qdy(); if ( ! $m4is_aicfp ) { return $m4is_nzrv1; } if ( ! apply_filters( 'memberium/loginsecurity/iplimits/precheck', true, $m4is_nzrv1->ID ) ) { return $m4is_nzrv1; } $m4is_xwj7 = (int) apply_filters( 'memberium/loginsecurity/iplimits/maxips', self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'maximum_login_ips' ) ); $m4is_us6lu = (int) apply_filters( 'memberium/loginsecurity/iplimits/hours', self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'maximum_login_timeframe' ) ); if ( $m4is_xwj7 && $m4is_us6lu ) { $m4is_w6mt = MEMBERIUM_DB_LOGINLOG; $m4is_i3i97 = m4is_lr56w2::m4is_nnbp(); $m4is_q7m2 = self::$m4is_q7m2; $m4is_k3fm = time() - (3600 * $m4is_us6lu); $m4is_ioxk = "SELECT count( distinct( `ipaddress` ) ) as `logins` FROM `{$m4is_w6mt}` WHERE `appname` = %s AND `logintime` >= %d AND `username` = %s AND `ipaddress` != %s "; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2, $m4is_k3fm, $m4is_id576, $m4is_i3i97 ); $m4is_n_bp6 = $wpdb->get_col( $m4is_ioxk ); $m4is_fwzrc4 = end( $m4is_n_bp6 ); if ( $m4is_fwzrc4 >= $m4is_xwj7 ) { $m4is_fgxy = self::$m4is_bxv7u->m4is_vvsj( 'i18n/maximumloginsexceeded' ); $m4is_a6g9qj = self::$m4is_bxv7u->m4is_vvsj( 'i18n/error' ); $m4is_m2h6b = isset( $m4is_nzrv1->user_email ) ? $m4is_nzrv1->user_email : ''; $m4is_zocyxt = m4is_q1amx::m4is_u4dk( $m4is_aicfp, 'loginfail', $m4is_fgxy . ' ' . $m4is_m2h6b, $m4is_i3i97, true); $m4is_nzrv1 = new WP_Error( 'authentication_failed', __( "<strong>{$m4is_a6g9qj}</strong>:  {$m4is_fgxy}", 'memberium' ) ); return $m4is_nzrv1; } } return $m4is_nzrv1; } static 
function m4is_i0skt2() { $m4is_aicfp = isset($_SESSION['memb_user']['crm_id']) ? $_SESSION['memb_user']['crm_id'] : 0; self::$m4is_bxv7u->m4is_l04_ip('logout/contact_id', $m4is_aicfp); } private 
function __construct() { } static $m4is_qfa4bd = false; }
