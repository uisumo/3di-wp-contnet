<?php
/**
 * Copyright (c) 2018-2022 David J Bullock
 * Web Power and Light
 */

 class_exists('m4is_emz57o') || die(); m4is_f84s3h::m4is_gopgz(); final 
class m4is_f84s3h { private static $m4is_bxv7u, $m4is_q7m2, $m4is_gwtb03, $m4is_cnpidy; static 
function m4is_gopgz() { self::$m4is_bxv7u = memberium_app(); self::$m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x( 'appname' ); self::$m4is_gwtb03 = self::$m4is_bxv7u->m4is_wnlbj_(); self::$m4is_cnpidy = 1000; }   static 
function m4is_rwkbf() : bool { $m4is_bd92x = self::$m4is_bxv7u->get_i2sdk_options(); return isset( $m4is_bd92x['server_verified'] ) ? (bool) $m4is_bd92x['server_verified'] : false; }      static 
function m4is_cm6nr( string $m4is_hs4_6, bool $m4is_uqxi_ = false, array $m4is_ay7a = [] ) : array { $m4is_hs4_6 = strtolower( trim( $m4is_hs4_6 ) ); $m4is__iftk = 0; $m4is_m_9gr = []; static $m4is_nu7me = [ 'actionsequence' => 'Id,TemplateName,VisibleToTheseUsers', 'affiliate' => 'AffCode,AffName,ContactId,DefCommissionType,Id,LeadAmt,LeadCookieFor,LeadPercent,NotifyLead,NotifySale,ParentId,Password,PayoutType,SaleAmt,SalePercent,Status', 'campaign' => 'Id,Name,Status', 'campaignee' => 'Campaign,CampaignId,ContactId,Status', 'campaignstep' => 'CampaignId,Id,StepStatus,StepTitle,TemplateId', 'ccharge' => 'Amt,ApprCode,CCId,Id,MerchantId,OrderNum,PaymentId,RefNum', 'company' => 'AccountId,Address1Type,Address2Street1,Address2Street2,Address2Type,Address3Street1,Address3Street2,Address3Type,Anniversary,AssistantName,AssistantPhone,BillingInformation,Birthday,City,City2,City3,Company,CompanyID,ContactNotes,ContactType,Country,Country2,Country3,CreatedBy,DateCreated,Email,EmailAddress2,EmailAddress3,Fax1,Fax1Type,Fax2,Fax2Type,FirstName,Groups,Id,JobTitle,LastName,LastUpdated,LastUpdatedBy,Leadsource,LeadSourceId,MiddleName,Nickname,OwnerID,Password,Phone1,Phone1Ext,Phone1Type,Phone2,Phone2Ext,Phone2Type,Phone3,Phone3Ext,Phone3Type,Phone4,Phone4Ext,Phone4Type,Phone5,Phone5Ext,Phone5Type,PostalCode,PostalCode2,PostalCode3,ReferralCode,SpouseName,State,State2,State3,StreetAddress1,StreetAddress2,Suffix,Title,Username,Validated,Website,ZipFour1,ZipFour2,ZipFour3', 'contact' => 'AccountId,Address1Type,Address2Street1,Address2Street2,Address2Type,Address3Street1,Address3Street2,Address3Type,Anniversary,AssistantName,AssistantPhone,BillingInformation,Birthday,City,City2,City3,Company,CompanyID,ContactNotes,ContactType,Country,Country2,Country3,CreatedBy,DateCreated,Email,EmailAddress2,EmailAddress3,Fax1,Fax1Type,Fax2,Fax2Type,FirstName,Groups,Id,JobTitle,Language,LastName,LastUpdated,LastUpdatedBy,Leadsource,LeadSourceId,MiddleName,Nickname,OwnerID,Password,Phone1,Phone1Ext,Phone1Type,Phone2,Phone2Ext,Phone2Type,Phone3,Phone3Ext,Phone3Type,Phone4,Phone4Ext,Phone4Type,Phone5,Phone5Ext,Phone5Type,PostalCode,PostalCode2,PostalCode3,ReferralCode,SpouseName,State,State2,State3,StreetAddress1,StreetAddress2,Suffix,TimeZone,Title,Username,Validated,Website,ZipFour1,ZipFour2,ZipFour3', 'contactaction' => 'Accepted,ActionDate,ActionDescription,ActionType,CompletionDate,ContactId,CreatedBy,CreationDate,CreationNotes,EndDate,Id,IsAppointment,LastUpdated,LastUpdatedBy,OpportunityId,PopupDate,Priority,UserID', 'contactgroup' => 'GroupCategoryId,GroupDescription,GroupName,Id', 'contactgroupassign' => 'ContactGroup,ContactId,DateCreated,GroupId', 'contactgroupcategory' => 'CategoryDescription,CategoryName,Id', 'cprogram' => 'Active,BillingType,DefaultCycle,DefaultFrequency,DefaultPrice,Description,Family,HideInStore,Id,LargeImage,ProductId,ProgramName,ShortDescription,Sku,Status,Taxable', 'creditcard' => 'BillAddress1,BillAddress2,BillCity,BillCountry,BillName,BillState,BillZip,CardType,ContactId,Email,ExpirationMonth,ExpirationYear,FirstName,Id,Last4,LastName,MaestroIssueNumber,NameOnCard,PhoneNumber,ShipAddress1,ShipAddress2,ShipCity,ShipCompanyName,ShipCountry,ShipFirstName,ShipLastName,ShipMiddleName,ShipName,ShipPhoneNumber,ShipState,ShipZip,StartDateMonth,StartDateYear,Status',  'dataformfield' => 'DataType,DefaultValue,FormId,GroupId,Id,Label,ListRows,Name,Values', 'dataformgroup' => 'Id,Name,TabId', 'dataformtab' => 'Id,FormId,TabName', 'emailaddstatus' => 'DateCreated,Email,Id,LastClickDate,LastOpenDate,LastSentDate,Type', 'expense' => 'ContactId,DateIncurred,ExpenseAmt,ExpenseType,Id,TypeId', 'filebox' => 'ContactId,Extension,FileName,FileSize,Id,Public', 'groupassign' => 'Admin,GroupId,Id,UserId', 'invoice' => 'AffiliateId,ContactId,CreditStatus,DateCreated,Description,Id,InvoiceTotal,InvoiceType,JobId,LeadAffiliateId,PayPlanStatus,PayStatus,ProductSold,PromoCode,RefundStatus,Synced,TotalDue,TotalPaid', 'invoiceitem' => 'CommissionStatus,DateCreated,Description,Discount,Id,InvoiceAmt,InvoiceId,OrderItemId', 'invoicepayment' => 'Amt,Id,InvoiceId,PayDate,PaymentId,PayStatus,SkipCommission', 'job' => 'ContactId,DateCreated,DueDate,Id,JobNotes,JobRecurringId,JobStatus,JobTitle,OrderStatus,OrderType,ProductId,ShipCity,ShipCompany,ShipCountry,ShipFirstName,ShipLastName,ShipMiddleName,ShipPhone,ShipState,ShipStreet1,ShipStreet2,ShipZip,StartDate', 'jobrecurringinstance' => 'AutoCharge,DateCreated,Description,EndDate,Id,InvoiceItemId,RecurringId,StartDate,Status', 'lead' => 'AffiliateId,ContactID,CreatedBy,DateCreated,EstimatedCloseDate,Id,LastUpdated,LastUpdatedBy,Leadsource,NextActionDate,NextActionNotes,Objection,OpportunityNotes,OpportunityTitle,ProjectedRevenueHigh,ProjectedRevenueLow,StageID,StatusID,UserID', 'leadsource' => 'CostPerLead,Description,EndDate,Id,LeadSourceCategoryId,Medium,Message,Name,StartDate,Status,Vendor', 'leadsourcecategory' => 'Description,Id,Name', 'leadsourceexpense' => 'Amount,DateIncurred,Id,LeadSourceId,LeadSourceRecurringExpenseId,Notes,Title', 'leadsourcerecurringexpense' => 'Amount,EndDate,Id,LeadSourceId,NextExpenseDate,Notes,StartDate,Title', 'linkedcontacttype' => 'Id,MaxLinked,TypeName', 'orderitem' => 'CPU,Id,ItemDescription,ItemName,ItemType,Notes,OrderId,PPU,ProductId,Qty,SubscriptionPlanId', 'payment' => 'ChargeId,Commission,ContactId,Id,InvoiceId,PayAmt,PayDate,PayNote,PayType,RefundId,Synced,UserId', 'payplan' => 'AmtDue,DateDue,FirstPayAmt,Id,InitDate,InvoiceId,StartDate,Type', 'payplanitem' => 'AmtDue,AmtPaid,DateDue,Id,PayPlanId,Status', 'product' => 'BottomHTML,CityTaxable,CountryTaxable,Description,HideInStore,Id,InventoryLimit,InventoryNotifiee,IsPackage,LargeImage,NeedsDigitalDelivery,ProductName,ProductPrice,Shippable,ShippingTime,ShortDescription,Sku,StateTaxable,Status,Taxable,TopHTML,Weight', 'productcategory' => 'CategoryDisplayName,CategoryImage,CategoryOrder,Id,ParentId', 'productcategoryassign' => 'Id,ProductCategoryId,ProductId', 'productinterest' => 'DiscountPercent,Id,ObjectId,ObjType,ProductId,ProductType,Qty', 'productinterestbundle' => 'BundleName,Description,Id', 'recurringorder' => 'AffiliateId,AutoCharge,BillingAmt,BillingCycle,CC1,CC2,ContactId,EndDate,Frequency,Id,LastBillDate,LeadAffiliateId,MaxRetry,MerchantAccountId,NextBillDate,NumDaysBetweenRetry,OriginatingOrderId,PaidThruDate,ProductId,ProgramId,PromoCode,Qty,ReasonStopped,ShippingOptionId,StartDate,Status,SubscriptionPlanId', 'referral' => 'AffiliateId,ContactId,DateExpires,DateSet,Id,Info,IPAddress,Source,Type', 'savedfilter' => 'FilterName,Id,ReportStoredName,UserId', 'socialaccount' => 'Id,AccountName,AccountType,ContactId,DateCreated,LastUpdated', 'stage' => 'Id,StageName,StageOrder,TargetNumDays', 'stagemove' => 'CreatedBy,DateCreated,Id,MoveDate,MoveFromStage,MoveToStage,OpportunityId,PrevStageMoveDate,UserId', 'subscriptionplan' => 'Active,Cycle,Frequency,Id,PlanPrice,PreAuthorizeAmount,ProductId,Prorate', 'template' => 'Categories,Id,PieceTitle,PieceType', 'user' => 'City,Email,EmailAddress2,EmailAddress3,FirstName,GlobalUserId,HTMLSignature,Id,LastName,MiddleName,Nickname,Partner,Phone1,Phone1Ext,Phone1Type,Phone2,Phone2Ext,Phone2Type,PostalCode,Signature,SpouseName,State,StreetAddress1,StreetAddress2,Suffix,Title,ZipFour1', ]; static $m4is_bazx9 = [ 'affiliate' => -3, 'company' => -6, 'contact' => -1, 'contactaction' => -5, 'job' => -9, 'productinterest' => -4, 'recurringorder' => -10 ]; $m4is_kbu63_ = array_key_exists( $m4is_hs4_6, $m4is_nu7me) ? explode( ',', $m4is_nu7me[ $m4is_hs4_6 ] ): []; $m4is__iftk = array_key_exists( $m4is_hs4_6, $m4is_bazx9) ? $m4is_bazx9[ $m4is_hs4_6 ] : 0; if ( $m4is__iftk !== 0 ) { $m4is_kbu63_ = array_merge( $m4is_kbu63_, m4is_f84s3h::m4is_shna( (int) $m4is__iftk ) ); }  if (! empty( $m4is_ay7a ) ) { $m4is_kbu63_ = array_diff( $m4is_kbu63_, $m4is_ay7a ); } if ( $m4is_uqxi_ ) { if ( $m4is_hs4_6 == 'contact' ) { $m4is_m_9gr = array_filter( explode( ',', self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'ignore_contact_fields', '' ) ) ); } elseif ( $m4is_hs4_6 == 'affiliate' ) { $m4is_m_9gr = array_filter( explode( ',', self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'ignore_affiliate_fields', '' ) ) ); } $m4is_kbu63_ = array_diff( $m4is_kbu63_, $m4is_m_9gr ); } $m4is_kbu63_ = array_filter( $m4is_kbu63_ ); $m4is_kbu63_ = apply_filters( 'memberium/infusionsoft/tables/fieldlist', $m4is_kbu63_, $m4is_hs4_6 ); $m4is_kbu63_ = apply_filters( 'memberium/keap/tables/fieldlist', $m4is_kbu63_, $m4is_hs4_6 ); return array_values( $m4is_kbu63_ ); }  static 
function m4is_shna( int $m4is__iftk ) : array { global $wpdb; static $m4is_gmy1qk = []; if ( array_key_exists( $m4is__iftk, $m4is_gmy1qk ) ) { return $m4is_gmy1qk[ $m4is__iftk ]; } $m4is_bhz0ci = []; $m4is_u13x = MEMBERIUM_DB_DATAFORMFIELDS; $m4is_ioxk = "SELECT concat( '_', `name` ) as `name` FROM `{$m4is_u13x}` WHERE `appname` = %s AND `formid` = %d"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2, $m4is__iftk ); $m4is_jpzyit = $wpdb->get_results( $m4is_ioxk, ARRAY_A ); foreach ( $m4is_jpzyit as $m4is_b40e_m => $m4is_wo7c93 ) { $m4is_bhz0ci[] = $m4is_wo7c93['name']; } return $m4is_gmy1qk[ $m4is__iftk ] = $m4is_bhz0ci; } static 
function m4is_s2yv4( int $m4is_hgime6 = -1 ) : array { global $wpdb;  $m4is_kbu63_ = []; if ( $m4is_kbu63_ == -1 ) { $m4is_kbu63_ = [ 'Anniversary' => 13, 'Birthday' => 13, 'Email' => 5, 'EmailAddress2' => 5, 'EmailAddress3' => 5, ]; } $m4is_wb45r = MEMBERIUM_DB_DATAFORMFIELDS; $m4is_ioxk = "SELECT concat('_', name) as `name`, `datatype` as `type` FROM `{$m4is_wb45r}` WHERE `appname` =  %s AND formid = %d"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2, (int) $m4is_hgime6 ); $m4is_jpzyit = $wpdb->get_results( $m4is_ioxk, ARRAY_A ); foreach( $m4is_jpzyit as $m4is_wo7c93 ) { $m4is_kbu63_[$m4is_wo7c93['name']] = $m4is_wo7c93['type']; } if ( $m4is_hgime6 == -1 ) { $m4is_kbu63_['Birthday'] = 13; $m4is_kbu63_['Anniversary'] = 13; $m4is_kbu63_['DateCreated'] = 14; $m4is_kbu63_['LastUpdated'] = 14; } return $m4is_kbu63_; }  static 
function m4is_br8l() { self::$m4is_bxv7u->m4is_nn6s_()->syncCustomFields(); } static 
function m4is_wv2a5n( string $m4is_u13x, string $m4is_enmq, string $m4is_z4zva_, int $m4is_li3g ) { $m4is_enmq = trim( $m4is_enmq ); return self::$m4is_gwtb03->addCustomField( $m4is_u13x, $m4is_enmq, $m4is_z4zva_, $m4is_li3g ); }     static 
function m4is_l4up1h() { global $wpdb; $m4is_u13x = MEMBERIUM_DB_ACTIONSETS; $m4is_ioxk = "SELECT `id`, `name` FROM `{$m4is_u13x}` WHERE `appname` = %s AND `name` > ''"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2 ); $m4is_n_bp6 = (bool) $wpdb->get_var( $m4is_ioxk ); return $m4is_n_bp6; }   static 
function m4is_miqxc() { global $wpdb; $m4is_yqog2 = get_option( 'memberium_tables_updated', [] ); $m4is_yqog2['actionsets'] = isset( $m4is_yqog2['actionsets'] ) ? $m4is_yqog2['actionsets'] : 0; $m4is_u13x = 'ActionSequence'; $m4is_zvxijt = 0; $m4is__dxt_o = 'Id'; $m4is_v_fri = '%'; $m4is_kc1q = [ 'Id' => '%' ]; $m4is_hkp7s = [ 'Id', 'TemplateName', 'VisibleToTheseUsers' ]; $m4is_w6mt = MEMBERIUM_DB_ACTIONSETS; $m4is_c_3n = 0; $m4is_yp0yx = false;  do { $m4is_jpzyit = self::$m4is_gwtb03->dsQuery( $m4is_u13x, self::$m4is_cnpidy, $m4is_zvxijt, $m4is_kc1q, $m4is_hkp7s, 'Id', true ); if (false) { echo '<Pre>', print_r( $m4is_jpzyit, true ), '</Pre>'; die(); } if ( is_string( $m4is_jpzyit ) ) { $m4is_yp0yx = true; } $m4is_fo1t7s = is_array( $m4is_jpzyit ) ? count($m4is_jpzyit) : 0; if (is_array($m4is_jpzyit) ) { $m4is_s01nl = (int) $m4is_jpzyit[0]['Id']; $m4is_b_d8z = (int) $m4is_jpzyit[(count($m4is_jpzyit) - 1)]['Id']; $m4is_o1af2 = []; $m4is_dhrs = []; foreach ($m4is_jpzyit as $k => $m4is_wo7c93) { $m4is_wo7c93['VisibleToTheseUsers'] = empty($m4is_wo7c93['VisibleToTheseUsers']) ? '' : $m4is_wo7c93['VisibleToTheseUsers']; if ( ($m4is_wo7c93['VisibleToTheseUsers'] == '-1') || empty($m4is_wo7c93['TemplateName']) ) { unset($m4is_jpzyit[$k]); } else {  foreach ($m4is_hkp7s as $m4is_ap3_) { if (empty($m4is_wo7c93[$m4is_ap3_]) ) $m4is_wo7c93[$m4is_ap3_] = ''; } if (empty($m4is_wo7c93['TemplateName']) ) { $m4is_wo7c93['TemplateName'] = 'Unnamed Action Set #' . $m4is_wo7c93['Id']; } $m4is_o1af2[] = $wpdb->prepare("(%d, %s, %s)", intval($m4is_wo7c93['Id']), self::$m4is_q7m2, $m4is_wo7c93['TemplateName']); $m4is_dhrs[] = $m4is_wo7c93['Id']; } } if (! empty( $m4is_o1af2 ) ) { $m4is_ioxk = "INSERT INTO `{$m4is_w6mt}` (id, appname, name) VALUES " . implode( ', ', $m4is_o1af2) . " ON DUPLICATE KEY UPDATE id=VALUES(id), appname=VALUES(appname), name=VALUES(name);"; $wpdb->query( $m4is_ioxk ); } if ( $m4is_s01nl && $m4is_b_d8z && is_array( $m4is_dhrs ) && count( $m4is_dhrs ) ) { $m4is_ioxk = "DELETE FROM `{$m4is_w6mt}` WHERE `appname` = %s AND `id` > %d AND `id` < %d AND `id` NOT IN (" . implode( ', ', $m4is_dhrs) . ")"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2, $m4is_s01nl, $m4is_b_d8z ); $wpdb->query($m4is_ioxk); } } $m4is_zvxijt++; $m4is_c_3n = $m4is_c_3n + $m4is_fo1t7s; } while ($m4is_fo1t7s == self::$m4is_cnpidy && $m4is_yp0yx == false); if ( $m4is_yp0yx === false && $m4is_c_3n > 0 && $m4is_b_d8z > 0 ) { $m4is_ioxk = "DELETE FROM {$m4is_w6mt} WHERE `appname` = %s AND `id` > %d"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2, $m4is_b_d8z ); $wpdb->query( $m4is_ioxk ); } set_transient( 'memberium_actionsets_updated', time() ); $m4is_yqog2['actionsets'] = time(); update_option( 'memberium_tables_updated', $m4is_yqog2, false ); wp_cache_delete( 'actionsets', 'memberium2/keap' ); return $m4is_c_3n; }   static 
function m4is_ot30uq( int $m4is_aicfp, int $m4is_cga2c, bool $m4is_zlyv = false ) { $m4is_n_bp6 = self::$m4is_gwtb03->runAS( $m4is_aicfp, $m4is_cga2c ); if ( $m4is_zlyv ) { self::$m4is_bxv7u->m4is_qjrxkl($m4is_aicfp); } return $m4is_n_bp6; }   static 
function m4is_wl42q6( array $m4is_w5ky4q = [] ) { global $wpdb; $m4is_ppq5 = 'actionsets'; $m4is_nasl4j = 'memberium2/keap'; $m4is_n94k = 7200; $m4is_in0ti = false; $m4is_p78sgz = [ 'format' => '',  'none' => false, ]; $m4is_w5ky4q = wp_parse_args( $m4is_w5ky4q, $m4is_p78sgz ); $m4is_b8ve = wp_cache_get( $m4is_ppq5, $m4is_nasl4j, false, $m4is_in0ti ); if (! $m4is_in0ti) { $el_actionsets = []; $m4is_u13x = MEMBERIUM_DB_ACTIONSETS; $m4is_ioxk = "SELECT `id`, `name` FROM `{$m4is_u13x}` WHERE `appname` = %s AND `name` > '' ORDER BY `name` ASC"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2 ); $m4is_jpzyit = $wpdb->get_results( $m4is_ioxk, ARRAY_A ); foreach($m4is_jpzyit as &$m4is_wo7c93) { $m4is_b8ve[$m4is_wo7c93['id']] = $m4is_wo7c93['name']; unset($m4is_zhk7); } if (! empty($m4is_b8ve) && is_array($m4is_b8ve)) { wp_cache_set( $m4is_ppq5, $m4is_b8ve, $m4is_nasl4j, $m4is_n94k ); } } if ( $m4is_w5ky4q['none'] ) { $m4is_b8ve[0] = '(No Action)'; } if ( $m4is_w5ky4q['format'] == 'json' ) { $m4is_ofi8h = []; foreach ($m4is_b8ve as $m4is_b40e_m => $m4is_ho0w2) { $m4is_ofi8h[] = [ 'id' => $m4is_b40e_m, 'text' => $m4is_ho0w2, ]; } $m4is_b8ve = json_encode( $m4is_ofi8h ); } return $m4is_b8ve; }  static 
function m4is_zox_z5( int $m4is_aicfp, string $m4is_qw8dk, string $m4is__i1sg = '' ) { $m4is_qw8dk = trim( $m4is_qw8dk ); if ( ! empty( $m4is_qw8dk ) && ! empty( $m4is_aicfp ) ) { if ( empty( $m4is__i1sg ) ) { $m4is_fs76o2 = preg_split( "/[^[:alnum:]]/", $m4is_qw8dk ); if ( count( $m4is_fs76o2 ) == 2 ) { $m4is_qw8dk = trim( $m4is_fs76o2[0] ); $m4is__i1sg = empty( $m4is_fs76o2[1] ) ? $m4is__i1sg : trim( $m4is_fs76o2[1] ); } } $m4is__i1sg = empty( $m4is__i1sg ) ? self::$m4is_q7m2 : $m4is__i1sg; return self::$m4is_gwtb03->achieveGoal( $m4is__i1sg, $m4is_qw8dk, $m4is_aicfp ); } }     static 
function m4is_go6re( string $m4is_u13x, int $m4is_b40e_m, array $m4is_kbu63_ ) { return self::$m4is_gwtb03->dsUpdate( $m4is_u13x, $m4is_b40e_m, $m4is_kbu63_ ); }  static 
function m4is_y3qvg( string $m4is_u13x, array $m4is_kbu63_ ) { return self::$m4is_gwtb03->dsAdd( $m4is_u13x, $m4is_kbu63_ ); }  static 
function m4is_yt5p0l( string $m4is_u13x, int $m4is_ltqb = 0, int $m4is_zvxijt = 0, array $m4is_kc1q = [], array $m4is_kbu63_ = [] ) { $m4is_ltqb = empty( $m4is_ltqb ) ? self::$m4is_cnpidy : $m4is_ltqb; if ( empty( $m4is_kbu63_ ) ) { $m4is_kbu63_ = m4is_f84s3h::m4is_cm6nr( $m4is_u13x, true ); } $m4is_zv59 = self::$m4is_gwtb03->dsQuery( $m4is_u13x, $m4is_ltqb, $m4is_zvxijt, $m4is_kc1q, $m4is_kbu63_ ); if ( is_string( $m4is_zv59 ) ) { error_log( 'Memberium Error: Data Query API: ' . $m4is_u13x . "\n" . 'Return Fields: ' . implode( ', ', $m4is_kbu63_ ) . "\n" . 'Query: ' . implode( ', ', $m4is_kc1q) . "\n" . 'Page: ' . $m4is_zvxijt . ' / Size: ' . $m4is_ltqb . "\n" . 'Sort By: ' . $m4is_c0vw8 . ' / Ascending: ' . (int) $m4is_hjx4 . "\n" . ' - ' . $m4is_zv59); $m4is_zv59 = []; } if ( is_a($m4is_zv59, 'WP_Error' ) ) { error_log( 'Memberium Error: Data Query API: ' . $m4is_u13x . "\n" . 'Return Fields: ' . implode( ', ', $m4is_kbu63_ ) . "\n" . 'Query: ' . implode( ',', $m4is_kc1q) . "\n" . 'Page: ' . $m4is_zvxijt . ' / Size: ' . $m4is_ltqb . "\n" . 'Sort By: ' . $m4is_c0vw8 . ' / Ascending: ' . (int) $m4is_hjx4 ); $m4is_zv59 = []; } return $m4is_zv59; }  static 
function m4is_l2n5pg( string $m4is_u13x, int $m4is_ltqb = 0, int $m4is_zvxijt = 0, array $m4is_kc1q = [], array $m4is_kbu63_ = [], string $m4is_c0vw8 = 'Id', bool $m4is_hjx4 = true) { $m4is_ltqb = empty( $m4is_ltqb ) ? self::$m4is_cnpidy : $m4is_ltqb; if ( empty( $m4is_kbu63_ ) ) { $m4is_kbu63_ = self::m4is_cm6nr( $m4is_u13x, true ); } $m4is_zv59 = self::$m4is_gwtb03->dsQueryOrderBy( $m4is_u13x, $m4is_ltqb, $m4is_zvxijt, $m4is_kc1q, $m4is_kbu63_, $m4is_c0vw8, $m4is_hjx4 ); if ( is_string( $m4is_zv59 ) ) { error_log( 'Memberium Sorted Data Query API Error: ' . $m4is_u13x . "\n" . 'Return Fields: ' . implode( ', ', $m4is_kbu63_ ) . "\n" . 'Query: ' . implode( ',', $m4is_kc1q) . "\n" . 'Page: ' . $m4is_zvxijt . ' / Size: ' . $m4is_ltqb . "\n" . 'Sort By: ' . $m4is_c0vw8 . ' / Ascending: ' . (int) $m4is_hjx4 . "\n" . ' - ' . $m4is_zv59); $m4is_zv59 = []; } if ( is_a($m4is_zv59, 'WP_Error' ) ) { error_log( 'Memberium Sorted Data Query API Error: ' . $m4is_u13x . "\n" . 'Return Fields: ' . implode( ', ', $m4is_kbu63_ ) . "\n" . 'Query: ' . implode( ',', $m4is_kc1q) . "\n" . 'Page: ' . $m4is_zvxijt . ' / Size: ' . $m4is_ltqb . "\n" . 'Sort By: ' . $m4is_c0vw8 . ' / Ascending: ' . (int) $m4is_hjx4 ); $m4is_zv59 = []; } return $m4is_zv59; }   static 
function m4is__5wbje( string $m4is_hs4_6, int $m4is_b40e_m, array $m4is_kbu63_ = [] ) { $m4is_kbu63_ = empty( $m4is_kbu63_ ) ? self::m4is_cm6nr( $m4is_hs4_6, false ) : $m4is_kbu63_; $m4is_i2t3ps = self::$m4is_gwtb03->dsLoad( $m4is_hs4_6, $m4is_b40e_m, $m4is_kbu63_); $m4is_i2t3ps = is_array( $m4is_i2t3ps ) ? self::$m4is_bxv7u->m4is_l5kr8_( $m4is_i2t3ps ) : $m4is_i2t3ps; return $m4is_i2t3ps; }     static 
function m4is_bsukpr( string $m4is_j1vz = '%', string $m4is__o_2 = '' ) { global $wpdb; $m4is_hs4_6 = 'SavedFilter'; $m4is_hkp7s = self::m4is_cm6nr( $m4is_hs4_6, false ); $m4is_kc1q = [ 'ReportStoredName' => $m4is_j1vz ]; $m4is_iadb63 = self::$m4is_gwtb03->dsQuery( $m4is_hs4_6, 1000, 0, $m4is_kc1q, $m4is_hkp7s ); if ( $m4is_j1vz == '%' && is_array( $m4is_iadb63 ) ) { update_option( 'memberium_saved_searches', $m4is_iadb63, false ); } return $m4is_iadb63; }    static 
function m4is_omi1x4() { global $wpdb; $m4is_hmeo = self::m4is_sicx(); $m4is_g5o8eq = explode( ',', self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'ignore_tag_categories' ) ); $m4is_g5o8eq = array_filter( $m4is_g5o8eq, function( $v ) { return $v > ''; } ); foreach( $m4is_hmeo as $m4is_e3k_mi => $m4is_waxrhu ) { $m4is_hmeo[$m4is_e3k_mi] = $m4is_waxrhu['id']; } $m4is_jsy7u = array_diff( $m4is_hmeo, $m4is_g5o8eq ); $m4is_m3ba = count( $m4is_jsy7u ); $ignored_cat_count = count( $m4is_g5o8eq ); $m4is_qqzo = self::$m4is_cnpidy; $m4is_zvxijt = 0; $m4is_u13x = 'ContactGroup'; $m4is_w6mt = MEMBERIUM_DB_TAGS; $m4is_luvhw = 0; $m4is_dhrs = []; $m4is_hkp7s = [ 'Id', 'GroupName', 'GroupCategoryId' ]; $m4is_kc1q = [ 'Id' => '%', ]; if (count($m4is_jsy7u) == 1) { reset($m4is_jsy7u); $m4is_kc1q = [ 'GroupCategoryId' => (int) current( $m4is_jsy7u ) ]; }  do { $m4is_znf9 = self::$m4is_gwtb03->dsQueryOrderBy($m4is_u13x, self::$m4is_cnpidy, $m4is_zvxijt, $m4is_kc1q, $m4is_hkp7s, 'Id', true); if ( ! empty( $m4is_znf9) && is_array( $m4is_znf9 ) ) { $m4is_o1af2 = []; foreach ( $m4is_znf9 as $m4is_w9feq2 ) { $m4is_w9feq2['GroupName'] = isset( $m4is_w9feq2['GroupName'] ) ? $m4is_w9feq2['GroupName'] : ''; if ($ignored_cat_count == 0 || $m4is_m3ba == 1 || (in_array($m4is_w9feq2['GroupCategoryId'], $m4is_jsy7u) ) ) { $m4is_o1af2[] = $wpdb->prepare( '( %d, %s, %s, %d )', (int) $m4is_w9feq2['Id'], self::$m4is_q7m2, $m4is_w9feq2['GroupName'], (int) $m4is_w9feq2['GroupCategoryId'] ); $m4is_dhrs[] = (int) $m4is_w9feq2['Id']; } } if ( count( $m4is_o1af2 ) ) { $m4is_ioxk = "INSERT INTO `{$m4is_w6mt}` (id, appname, name, category ) VALUES " . implode( ', ', $m4is_o1af2 ) . " ON DUPLICATE KEY UPDATE id=VALUES(id), appname=VALUES(appname), name=VALUES(name), category=VALUES(category)"; $wpdb->query( $m4is_ioxk ); } $m4is_zvxijt++; } } while ( count( $m4is_znf9 ) == self::$m4is_cnpidy ); if ( count( $m4is_dhrs ) ) { $m4is_ioxk = "DELETE FROM {$m4is_w6mt} WHERE `appname` = %s AND `id` NOT IN ( " . implode( ', ', $m4is_dhrs) . " )"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2 ); $wpdb->query( $m4is_ioxk ); } $m4is_yqog2 = get_option( 'memberium_tables_updated', [] ); $m4is_yqog2['tags'] = isset( $m4is_yqog2['tags'] ) ? $m4is_yqog2['tags'] : 0; $m4is_yqog2['tags'] = time(); set_transient( 'memberium_tags_updated', time() ); update_option( 'memberium_tables_updated', $m4is_yqog2, false ); return $m4is_luvhw; } static 
function m4is_sicx() : array { global $wpdb; $m4is_u13x = MEMBERIUM_DB_CONTACTGROUPCATEGORIES; $m4is_ioxk = "SELECT `id`, `name` FROM `{$m4is_u13x}` WHERE `appname` = %s"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2 ); $m4is_hmeo = $wpdb->get_results( $m4is_ioxk, ARRAY_A ); $m4is_hmeo[-1] = [ 'id' => 0, 'name' => '(Uncategorized)' ]; usort( $m4is_hmeo, function( $m4is_vvu2yt, $m4is_l1tbdi ) { if ( $m4is_vvu2yt['name'] == $m4is_l1tbdi['name'] ) { return 0; } return ( $m4is_vvu2yt['name'] > $m4is_l1tbdi['name'] ) ? 1 : -1; }); return $m4is_hmeo; }  static 
function m4is_faik() { global $wpdb; $m4is_yqog2 = get_option( 'memberium_tables_updated', [] ); $m4is_yqog2['tagcategories'] = isset( $m4is_yqog2['tagcategories']) ? $m4is_yqog2['tagcategories'] : 0; $m4is_zs7_ = ''; $m4is_qqzo = 999; $m4is_zvxijt = 0; $m4is_c_3n = 0; $m4is_u13x = 'ContactGroupCategory'; $m4is_w6mt = MEMBERIUM_DB_CONTACTGROUPCATEGORIES; $m4is_kc1q = [ 'CategoryName' => '%' ]; $m4is_hkp7s = [ 'Id', 'CategoryName' ]; $m4is_jpzyit = self::$m4is_gwtb03->dsQueryOrderBy( $m4is_u13x, $m4is_qqzo, $m4is_zvxijt, $m4is_kc1q, $m4is_hkp7s, 'Id', true ); if ( is_array( $m4is_jpzyit ) && ! empty( $m4is_jpzyit ) ) { $m4is_o1af2 = []; if ( is_array( $m4is_jpzyit ) && ! empty( $m4is_jpzyit ) ) { foreach ( $m4is_jpzyit as $m4is_wo7c93 ) { $m4is_o1af2[] = $wpdb->prepare( "(%d, %s, %s)", intval($m4is_wo7c93['Id']), self::$m4is_q7m2, $m4is_wo7c93['CategoryName'] ); $m4is_zs7_ .= $m4is_wo7c93['Id'] . ','; } } if ( ! empty( $m4is_o1af2 ) ) { $m4is_ioxk = "INSERT INTO {$m4is_w6mt} (id, appname, name) VALUES " . implode( ', ', $m4is_o1af2) . " ON DUPLICATE KEY UPDATE id=VALUES(id), appname=VALUES(appname), name=VALUES(name);"; $wpdb->query($m4is_ioxk); } if (! empty( $m4is_zs7_ ) ) { $m4is_zs7_ = trim( $m4is_zs7_, ',' ); $m4is_ioxk = "DELETE FROM {$m4is_w6mt} WHERE `appname` = %s AND `id` NOT IN ({$m4is_zs7_}) "; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, self::$m4is_q7m2 ); $wpdb->query( $m4is_ioxk ); } set_transient( 'memberium_tagcategories_updated', time() ); } $m4is_yqog2['tagcategories'] = time(); update_option( 'memberium_tables_updated', $m4is_yqog2, false ); return $m4is_c_3n; }  static 
function m4is_pcm12z( $m4is_i2t3ps ) { return is_string( $m4is_i2t3ps) && stripos( $m4is_zc6h5, '[RecordNotFound]' ) !== false ; } }
