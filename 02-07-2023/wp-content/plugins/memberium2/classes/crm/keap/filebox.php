<?php
/**
 * Copyright (c) 2018-2022 David J Bullock
 * Web Power and Light
 */

 class_exists( 'm4is_emz57o' ) || die(); m4is_wdzu::m4is_gopgz(); final 
class m4is_wdzu { private static $m4is_bxv7u, $m4is_q7m2, $m4is_gwtb03, $m4is_ekr0m;  public static 
function m4is_gopgz() { self::$m4is_bxv7u = memberium_app(); self::$m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x( 'appname' ); self::$m4is_gwtb03 = self::$m4is_bxv7u->m4is_wnlbj_(); self::$m4is_ekr0m = [ 'pdf' => 'application/pdf', 'exe' => 'application/octet-stream', 'zip' => 'application/zip', 'docx' => 'application/msword', 'doc' => 'application/msword', 'xls' => 'application/vnd.ms-excel', 'ppt' => 'application/vnd.ms-powerpoint', 'gif' => 'image/gif', 'png' => 'image/png', 'jpeg' => 'image/jpg', 'jpg' => 'image/jpg', 'mp3' => 'audio/mpeg', 'wav' => 'audio/x-wav', 'mpeg' => 'video/mpeg', 'mpg' => 'video/mpeg', 'mpe' => 'video/mpeg', 'mov' => 'video/quicktime', 'avi' => 'video/x-msvideo', '3gp' => 'video/3gpp', 'css' => 'text/css', 'jsc' => 'application/javascript', 'js' => 'application/javascript', 'php' => 'text/html', 'htm' => 'text/html', 'html' => 'text/html', ]; }  public static 
function m4is_epld( int $m4is_aicfp, string $m4is_q7m2 = '' ) : string { $m4is_q7m2 = empty( $m4is_q7m2 ) ? self::$m4is_q7m2 : $m4is_q7m2; return sprintf( 'memberium/filebox/%s/%d', $m4is_q7m2, $m4is_aicfp ); }  public static 
function m4is_dsh3tk( int $m4is_aicfp ) : array { if ( ! $m4is_aicfp ) { return []; } $m4is_u13x = 'FileBox'; $m4is_qqzo = 999; $m4is_zvxijt = 0; $m4is_hkp7s = m4is_f84s3h::m4is_cm6nr( $m4is_u13x, false ); $m4is_c_3n = 0; $m4is_t7i0bz = self::m4is_epld( $m4is_aicfp, self::$m4is_q7m2 ); $m4is_bm6ib = []; $m4is_kc1q = [ 'ContactId' => $m4is_aicfp ]; do { $m4is_jpzyit = self::$m4is_gwtb03->dsQuery( $m4is_u13x, $m4is_qqzo, $m4is_zvxijt, $m4is_kc1q, $m4is_hkp7s ); if ( is_array( $m4is_jpzyit ) ) { foreach ( $m4is_jpzyit as $m4is_wo7c93 ) { if ( $m4is_wo7c93['FileSize'] > 0 ) { $m4is_bm6ib[$m4is_wo7c93['Id']] = $m4is_wo7c93; } } $m4is_zvxijt++; $m4is_c_3n = $m4is_c_3n + count( $m4is_jpzyit ); } } while ( count( $m4is_jpzyit ) == $m4is_qqzo); if ( ! empty( $m4is_bm6ib ) && is_array( $m4is_bm6ib ) ) { set_transient( $m4is_t7i0bz, $m4is_bm6ib, 300 ); } return $m4is_bm6ib; }  public static 
function m4is_o1gmz( int $m4is_zm9jnu, string $m4is_hifj7, bool $m4is_yx4m = false ) { $m4is_hifj7 = trim( $m4is_hifj7 ); $m4is_yx4m = (bool) $m4is_yx4m; $m4is_qiwse4 = $_REQUEST['signature']; if ( ! wp_verify_nonce( $m4is_qiwse4, 'filebox_download::' . $m4is_zm9jnu ) ) { wp_die( 'Invalid Filebox Download Link' ); exit; } if ( is_user_logged_in() && ( $m4is_zm9jnu < 1 || empty( $m4is_hifj7 ) ) ) { return; } $m4is_qagh = $m4is_yx4m ? self::m4is_ztlqyj( $m4is_hifj7 ) : 'application/octet-stream'; m4is_d8yr0_::m4is_okts(); header( 'Content-Type: ' . $m4is_qagh ); header( 'Content-Disposition: attachment; filename="' . $m4is_hifj7 . '"' ); echo base64_decode( memberium_app()->m4is_wnlbj_()->getFile( (int) $_GET['filebox_id'] ) ); exit; }  private static 
function m4is_ztlqyj( string $m4is_hifj7 ) : string { $m4is_jcwivr = strtolower( end( explode( '.', $m4is_hifj7 ) ) ); return array_key_exists( $m4is_jcwivr, self::$m4is_ekr0m ) ? self::$m4is_ekr0m[$m4is_jcwivr] : 'application/octet-stream'; } }
