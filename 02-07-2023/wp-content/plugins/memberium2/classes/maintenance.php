<?php
/**
 * Copyright (c) 2012-2022 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 class_exists('m4is_emz57o') || die(); m4is__4htl6::m4is_gopgz(); final 
class m4is__4htl6 { private static $m4is_bxv7u, $m4is_q7m2; static 
function m4is_gopgz() { self::$m4is_bxv7u = memberium_app(); self::$m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x('appname'); } static 
function m4is_ek8203() { m4is_o5aoir::m4is_s105(); $m4is_nunl = self::$m4is_bxv7u->m4is_mmdrl('settings', 'sync_ecommerce', false); $m4is_yqog2 = get_option('memberium_tables_updated', [] ); $m4is_btcrhn = isset($m4is_yqog2['i2sdk_customfields']) ? $m4is_yqog2['i2sdk_customfields'] : 0; m4is_f84s3h::m4is_br8l(); $m4is_yqog2['i2sdk_customfields'] = time(); update_option('memberium_tables_updated', $m4is_yqog2, false); self::$m4is_bxv7u->m4is_lhu9(); if ($m4is_nunl) { m4is_vvgc8::m4is_z3anvh(); } } static 
function m4is_afk0() { m4is_o5aoir::m4is_qlzwa4(); m4is_n2_bj::m4is_y45p6g(); m4is_f84s3h::m4is_omi1x4(); m4is_f84s3h::m4is_miqxc(); m4is_vvgc8::m4is_m_gb8n(); m4is_vvgc8::m4is_d9auv(); m4is_f84s3h::m4is_faik(); } static 
function m4is_kwmaqg() { global $wpdb; $m4is_ioxk = "SELECT `option_name` AS `key` FROM {$wpdb->options} WHERE `option_name` LIKE '_transient_timeout_%' AND `option_value` < " . time() . " ; "; $m4is_jpzyit = $wpdb->get_col($m4is_ioxk); if (! empty($m4is_jpzyit) ) { $m4is_ioxk = ''; foreach($m4is_jpzyit as $m4is_wo7c93) { $m4is_ap3_ = explode('_transient_timeout_', $m4is_wo7c93); $m4is_ap3_ = $m4is_ap3_[1]; if (substr($m4is_wo7c93, 0, 6) == '_site_') { $wpdb->query("DELETE FROM {$wpdb->options} WHERE `option_name` LIKE '_site_transient_%{$m4is_ap3_}'; "); } else { $wpdb->query("DELETE FROM {$wpdb->options} WHERE `option_name` LIKE '_transient_%{$m4is_ap3_}'; "); } } } }  static 
function m4is_tjvl() { $m4is_q7m2 = self::$m4is_q7m2; $m4is_aaz9 = m4is_q1amx::m4is_u4dk(0, 'cron', 'Expire Subscriptions'); date_default_timezone_set('America/New_York'); $m4is_y_zsb = date('Y-m-d'); $m4is_hkp7s = [ 'Id', ]; $m4is_kc1q = [ 'Status' => 'Active', 'EndDate' => '~<=~' . $m4is_y_zsb, ]; $m4is_i1kh = m4is_f84s3h::m4is_yt5p0l('RecurringOrder', 1000, 0, $m4is_kc1q, $m4is_hkp7s); if (is_array($m4is_i1kh) ){ $m4is_s1r2_l = ['Status' => 'Inactive']; if (empty($m4is_nliy) ) { m4is_q1amx::m4is_rf68r($m4is_aaz9, "No active expired recurring orders found.\n"); } else { foreach($m4is_i1kh as $m4is_jdcg48) { m4is_f84s3h::m4is_go6re('RecurringOrder', (int) $m4is_jdcg48['Id'], $m4is_s1r2_l); m4is_q1amx::m4is_rf68r($m4is_aaz9, "Deactivating Recurring Order #{$m4is_jdcg48['Id']}\n"); usleep(250000); } } } } static 
function m4is_ttv9e() { $m4is_oi68 = (int) self::$m4is_bxv7u->m4is_mmdrl('settings', 'makepass_scan_tag', 0); $m4is_y3cd = (int) self::$m4is_bxv7u->m4is_mmdrl('settings', 'makepass_success_tag', 0); $m4is_ac0z = (int) self::$m4is_bxv7u->m4is_mmdrl('settings', 'makepass_success_actionset', 0); $m4is_i1eard = (int) self::$m4is_bxv7u->m4is_mmdrl('settings', 'makepass_scan_size', 0); $m4is_rz4ur = self::$m4is_bxv7u->m4is_mmdrl('settings', 'username_field', 'Email'); $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl('settings', 'password_field', 'Password'); if ( (! $m4is_oi68) || (! $m4is_y3cd && ! $m4is_ac0z) ) { return; } $m4is_aaz9 = m4is_q1amx::m4is_u4dk(0, 'cron', 'scanMakePass Started');  $m4is_hkp7s = m4is_f84s3h::m4is_cm6nr('Contact', true); $m4is_kc1q = [ 'Groups' => $m4is_oi68, ]; $m4is_oqymz9 = m4is_f84s3h::m4is_l2n5pg('Contact', $m4is_i1eard, 0, $m4is_kc1q, $m4is_hkp7s, 'LastUpdated', false); if (is_array($m4is_oqymz9) ) { foreach($m4is_oqymz9 as $m4is_nq7s) { $m4is_aicfp = isset($m4is_nq7s['Id']) ? (int) $m4is_nq7s['Id'] : 0; $m4is_i1gb = isset($m4is_nq7s[$m4is_rz4ur]) ? strtolower(trim($m4is_nq7s[$m4is_rz4ur]) ) : ''; $m4is_m1rnfk = isset($m4is_nq7s['Email']) ? strtolower(trim($m4is_nq7s['Email']) ) : ''; $m4is_xdtr = isset($m4is_nq7s[$m4is_jyx_t]) ? $m4is_nq7s[$m4is_jyx_t] : ''; $m4is_ce365g = $m4is_nq7s['Groups']; $m4is_npx14 = false; $m4is_h6az4s = false; $m4is_ncgn = []; m4is_q1amx::m4is_rf68r($m4is_aaz9, "Contact ID = {$m4is_aicfp}, Username = {$m4is_i1gb}"); if (empty($m4is_aicfp) ) { break; } if (empty($m4is_i1gb) ) { $m4is_ncgn[$m4is_rz4ur] = $m4is_m1rnfk; $m4is_nq7s[$m4is_rz4ur] = $m4is_m1rnfk; $m4is_id576 = $m4is_m1rnfk; }  if (username_exists($m4is_id576) || email_exists($m4is_id576) ) { $m4is_n_bp6 = m4is_zbyh::m4is_pp0i($m4is_aicfp, $m4is_ncgn);  self::$m4is_bxv7u->m4is__mkz("-{$m4is_oi68}", $m4is_aicfp); self::$m4is_bxv7u->m4is__mkz("{$m4is_y3cd}", $m4is_aicfp); break; } if (empty($m4is_nq7s[$m4is_jyx_t]) ) { $m4is_nq7s[$m4is_jyx_t] = self::$m4is_bxv7u->m4is_v8mw2u(); $m4is_ncgn[$m4is_jyx_t] = $m4is_nq7s[$m4is_jyx_t]; $m4is_n_bp6 = m4is_zbyh::m4is_pp0i($m4is_aicfp, $m4is_ncgn);  } self::$m4is_bxv7u->m4is_ba7dk($m4is_nq7s);  $m4is_fo4eiv = []; $m4is_fo4eiv['user_login'] = $m4is_nq7s[$m4is_rz4ur]; $m4is_fo4eiv['user_pass'] = $m4is_nq7s[$m4is_jyx_t]; $m4is_fo4eiv['first_name'] = isset($m4is_nq7s['FirstName']) ? trim($m4is_nq7s['FirstName']) : ''; $m4is_fo4eiv['last_name'] = isset($m4is_nq7s['LastName']) ? trim($m4is_nq7s['LastName']) : ''; $m4is_fo4eiv['user_url'] = isset($m4is_nq7s['Website']) ? trim($m4is_nq7s['Website']) : ''; $m4is_fo4eiv['user_email'] = isset($m4is_nq7s['Email']) ? strtolower(trim($m4is_nq7s['Email']) ) : ''; $m4is_w5ky4q = [ 'contact' => $m4is_nq7s ]; $_POST['pass1'] = $m4is_nq7s[$m4is_jyx_t]; $m4is_fo4eiv['display_name'] = apply_filters( 'memberium/wpuser/display_name', self::$m4is_bxv7u->m4is_upv1( $m4is_w5ky4q ), $m4is_nq7s ); $m4is_fo4eiv['nickname'] = apply_filters( 'memberium/wpuser/nickname', $m4is_fo4eiv['display_name'], $m4is_nq7s); $m4is_fo4eiv['user_nicename'] = apply_filters( 'memberium/wpuser/nicename', sanitize_title( $m4is_fo4eiv['nickname'], $m4is_fo4eiv['display_name'] ), $m4is_nq7s ); $m4is_mmop = self::$m4is_bxv7u->m4is_jrjget($m4is_aicfp); if (is_int($m4is_mmop) && $m4is_mmop > 0) { self::$m4is_bxv7u->m4is_hhit($m4is_aicfp, $m4is_mmop); do_action('user_register', $m4is_mmop); if (is_multisite() && ! is_user_member_of_blog($m4is_mmop) ) { $m4is_q_to1c = get_current_blog_id(); $m4is_v67fv = get_blog_option( $m4is_q_to1c, 'default_role', 'subscriber' ); add_user_to_blog( $m4is_q_to1c, $m4is_mmop, $m4is_v67fv ); } if (function_exists('WPCW_actions_users_newUserCreated') ) { WPCW_actions_users_newUserCreated($m4is_mmop); } } if (! empty($m4is_oi68) ) { self::$m4is_bxv7u->m4is__mkz("-{$m4is_oi68}", $m4is_aicfp); } if (! empty($m4is_y3cd) ) { self::$m4is_bxv7u->m4is__mkz($m4is_y3cd, $m4is_aicfp); } if (! empty($m4is_ac0z) ) { self::$m4is_bxv7u->m4is_evrbh($m4is_ac0z, $m4is_aicfp); } usleep(250000); if (MEMBERIUM_ERRORLOG) error_log('scanMakePass Contact Id: ' . $m4is_nq7s['Id'], 0);  } } }    private static 
function m4is_vv1r4w() { global $wpdb; $m4is_u13x = MEMBERIUM_DB_QUEUE; $m4is_q7m2 = self::$m4is_q7m2; $m4is_ioxk = "SELECT count(*) FROM `{$m4is_u13x}` WHERE `appname` = '{$m4is_q7m2}' AND `actiontype` = 'contactupdate'"; return $wpdb->get_var($m4is_ioxk); } private static 
function m4is_gy0dhl() { global $wpdb; $m4is_iokn40 = 0; if (self::m4is_vv1r4w() ) { $m4is_u13x = MEMBERIUM_DB_QUEUE; $m4is_ioxk = "SELECT `id`, `data` FROM `{$m4is_u13x}` WHERE `actiontype` = 'contactupdate' ORDER BY `id` ASC "; $m4is_jpzyit = $wpdb->get_results($m4is_ioxk, OBJECT_K); if (is_array($m4is_jpzyit)) { foreach($m4is_jpzyit as $m4is_b40e_m => $m4is_wo7c93) { $m4is_iokn40++; } } } return $m4is_iokn40; } private static 
function m4is_lzw8($m4is_aicfp) { global $wpdb; $m4is_q7m2 = self::$m4is_q7m2; $m4is_u13x = MEMBERIUM_DB_CONTACTS; $m4is_ioxk = "SELECT `value` FROM `{$m4is_u13x}` WHERE `id` = {$m4is_aicfp} AND `appname` = '{$m4is_q7m2}' AND `fieldname` = 'LastUpdated'"; return $wpdb->get_var($m4is_ioxk); } private static 
function m4is_ywrsa($m4is_nq7s) { global $wpdb; $m4is_aicfp = isset($m4is_nq7s['Id']) ? $m4is_nq7s['Id'] : 0; if ($m4is_aicfp) { $m4is_u13x = MEMBERIUM_DB_QUEUE; $m4is_ioxk = "DELETE FROM `{$m4is_u13x}` WHERE `contactid` = {$m4is_aicfp} AND `action` = 'contactupdate';"; $m4is_ioxk = "INSERT INTO `{$m4is_u13x}` () VALUES ()"; } } private static 
function m4is_bvidf() { global $wpdb; $m4is_q0ds9m = get_option('memberium/contact/scan', '2000-01-01T00:00:00'); $m4is_u13x = 'Contact'; $m4is_kbu63_ = m4is_f84s3h::m4is_cm6nr($m4is_u13x, true); $m4is_qqzo = 1000; $m4is_zvxijt = 0; $m4is_lvnith = 'LastUpdated'; $m4is_hjx4 = 1; $m4is_kc1q = [ 'Groups' => '%', 'LastUpdated' => "~>=~ {$m4is_q0ds9m}",  ]; $m4is_oqymz9 = m4is_f84s3h::m4is_l2n5pg($m4is_u13x, $m4is_qqzo, $m4is_zvxijt, $m4is_kc1q, $m4is_kbu63_, $m4is_lvnith, $m4is_hjx4); if (is_array($m4is_oqymz9)) { foreach($m4is_oqymz9 as $m4is_nq7s) { $m4is_aicfp = $m4is_nq7s['Id']; $m4is_i8ic4 = $m4is_nq7s['LastUpdated']; } } echo '<Pre>', count($m4is_oqymz9), '</Pre>'; echo '<Pre>', print_r($m4is_oqymz9, true), '</Pre>'; echo '<Pre>', print_r($m4is_kbu63_, true), '</Pre>'; } static 
function m4is_vqh12() { self::m4is_gy0dhl(); self::m4is_bvidf(); } }
