<?php
/**
* Copyright (c) 2022 David J Bullock
* Web Power and Light, LLC
* https://webpowerandlight.com
* support@webpowerandlight.com
*
*/

 class_exists('m4is_emz57o') || die(); m4is_by_t::m4is_gopgz(); final 
class m4is_by_t {  static private $m4is_xqr1mu = 'production'; static private $m4is_yl8pto = '<a href="https://memberium.com/support/" target="_blank">contact support</a>'; static private $m4is_bxv7u; private 
function __construct() { } static 
function m4is_gopgz() { self::$m4is_bxv7u = memberium_app(); }  static 
function m4is__iluz( array $m4is_anax ) : array { self::$m4is_xqr1mu = defined( 'WP_ENVIRONMENT_TYPE' ) ? WP_ENVIRONMENT_TYPE : self::$m4is_xqr1mu; self::$m4is_xqr1mu = function_exists( 'WP_ENVIRONMENT_TYPE' ) ? wp_get_environment_type() : self::$m4is_xqr1mu; $m4is_n3zp = wp_get_update_data(); $m4is_vqju9 = php_uname( 'n' ); $m4is_us1vby = defined( 'I2SDK_VERSION' ) ? I2SDK_VERSION : 'Unknown'; $m4is_b6m0f = defined( 'MEMBERIUM_SKU' ) ? strtoupper( MEMBERIUM_SKU ) : 'Unknown'; $m4is_s8k6g3 = defined( 'WP_MEMORY_LIMIT' ) ? WP_MEMORY_LIMIT : 'Undefined'; $m4is_o2qgd5 = self::$m4is_bxv7u->m4is_gu3m(); $m4is_ns4d7 = property_exists( 'PhpXmlRpc\PhpXmlRpc', 'xmlrpcVersion' ) ? PhpXmlRpc\PhpXmlRpc::$xmlrpcVersion : 'Unknown'; $m4is__u0k = m4is_o5aoir::m4is_ehns( get_option( self::$m4is_bxv7u->license_key_name, '' ) ); $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x( 'appname' ); $m4is_fdf0v = count( self::$m4is_bxv7u->m4is_mmdrl( 'memberships' ) ); $m4is_vk0m = self::$m4is_bxv7u->m4is_j5scev(); $m4is_k0ilzh = self::m4is_c95pv(); $m4is_wwbkl = self::m4is_iqr47(); $m4is_rtrpm = self::m4is_zf1dv4(); $m4is_g58cd = count( array_filter( explode( ',', self::$m4is_bxv7u->m4is_mmdrl( 'ignore_contact_fields' )['settings'] ) ) ); $m4is_mczj = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'autoupdate' ); $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field' ); $m4is_tpoet = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'local_auth_only' ) ? 'Yes' : 'No'; $m4is_y7ozxq = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'require_membership' ) ? 'Yes' : 'No'; $m4is_w8z7 = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'httppost_log' ) ? 'Yes' : 'No'; if ( isset( $m4is_anax['wp-core']['fields']['version'] ) ) { $m4is_anax['wp-core']['fields']['version']['value'] = $m4is_vk0m; $m4is_anax['wp-core']['fields']['version']['debug'] = $m4is_vk0m; } if ( is_array( $m4is__u0k ) ) { $m4is_onp_u = [ 'Active' => empty( $m4is__u0k['active'] ) ? 'No' : 'Yes', 'Max Users' => empty( $m4is__u0k['max_users'] ) ? 0 : $m4is__u0k['max_users'], 'Hostname' => isset( $m4is__u0k['hostname'] ) ? $m4is__u0k['hostname'] : 'Unknown', 'Owner Email' => isset( $m4is__u0k['owner_email'] ) ? $m4is__u0k['owner_email'] : 'Unknown', 'License Name' => isset( $m4is__u0k['license_name'] ) ? $m4is__u0k['license_name'] : 'Unknown', 'Tags' => isset( $m4is__u0k['tags'] ) ? $m4is__u0k['tags'] : 'None', ]; } else { $m4is_onp_u = 'None'; } $m4is_bwzl7k = [ 'wp-core' => $m4is_anax['wp-core'], 'wpal-memberium' => [ 'label' => 'Memberium', 'fields' => [ 'sku' => [ 'label' => 'SKU', 'value' => $m4is_b6m0f, 'private' => false, ], 'version' => [ 'label' => 'Installed Version', 'value' => $m4is_o2qgd5, 'private' => false, ], 'license' => [ 'label' => 'License', 'value' => $m4is_onp_u, 'private' => false, ], 'autoupdate' => [ 'label' => 'Autoupdate', 'value' => empty($m4is_mczj) ? 'No' : 'Yes', 'private' => false, ], 'i2sdk/version' => [ 'label' => 'Keap Connection Version', 'value' => $m4is_us1vby, 'private' => false, ], 'i2sdk/app' => [ 'label' => 'Keap App Name', 'value' => $m4is_q7m2, 'private' => false, ], 'i2sdk/xmlrpcversion' => [ 'label' => 'XML/RPC Library Version', 'value' => $m4is_ns4d7, 'private' => false, ], 'hostname' => [ 'label' => 'Hostname', 'value' => $m4is_vqju9, 'private' => false, ], 'proxies' => [ 'label' => 'Proxies', 'value' => empty($m4is_k0ilzh['data']) ? 'None' : $m4is_k0ilzh['data'], 'private' => false, ], 'ssl' => [ 'label' => 'SSL', 'value' => is_ssl() ? 'Yes' : 'No', 'private' => false, ], 'php_version' => [ 'label' => 'PHP Version', 'value' => phpversion(), 'private' => false, ], 'wp_version' => [ 'label' => 'WordPress Version', 'value' => self::$m4is_bxv7u->m4is_j5scev(), 'private' => false, ], 'plugins/caching' => [ 'label' => 'Caching Plugins', 'value' => empty($m4is_wwbkl['data']) ? 'None' : $m4is_wwbkl['data'], 'private' => false, ], 'plugins/membership' => [ 'label' => 'Membership Plugins', 'value' => empty($m4is_rtrpm['data']) ? 'None' : $m4is_rtrpm['data'], 'private' => false, ], 'updates/plugins' => [ 'label' => 'Outdated Plugins', 'value' => empty($m4is_n3zp['plugins']) ? 0 : $m4is_n3zp['plugins'], 'private' => false, ], 'updates/themes' => [ 'label' => 'Outdated Themes', 'value' => empty($m4is_n3zp['themes']) ? 0 : $m4is_n3zp['themes'], 'private' => false, ], 'updates/core' => [ 'label' => 'Outdated WordPress Core', 'value' => empty($m4is_n3zp['wordpress']) ? 0 : $m4is_n3zp['wordpress'], 'private' => false, ], 'object_cache' => [ 'label' => 'Object Cache', 'value' => wp_using_ext_object_cache() ? 'Yes' : 'No', 'private' => false, ], 'users' => [ 'label' => 'Users', 'value' => m4is_o5aoir::m4is_i0_t(), 'private' => false, ], 'tags/count' => [ 'label' => 'Tags', 'value' => self::m4is_t76iyf(), 'private' => false, ], 'categories/count' => [ 'label' => 'Tag Categories', 'value' => self::m4is_bx9d(), 'private' => false, ], 'fields/custom/count' => [ 'label' => 'Custom Fields', 'value' => self::m4is_rnziam(), 'private' => false, ], 'fields/synced/count' => [ 'label' => 'Synced Contact Fields', 'value' => count(m4is_f84s3h::m4is_cm6nr('Contact', true) ), 'private' => false, ], 'fields/blocked/count' => [ 'label' => 'Blocked Contact Fields', 'value' => $m4is_g58cd, 'private' => false, ], 'fields/password' => [ 'label' => 'Password Field', 'value' => $m4is_jyx_t, 'private' => false, ], 'settings/secure_password' => [ 'label' => 'Secure Passwords', 'value' => $m4is_tpoet, 'private' => false, ], 'settings/require_membership' => [ 'label' => 'Require Membership', 'value' => $m4is_y7ozxq, 'private' => false, ], 'settings/httppost_log' => [ 'label' => 'HTTP POST Log', 'value' => $m4is_w8z7, 'private' => false, ], 'actionsets/count' => [ 'label' => 'Actionsets', 'value' => self::m4is_fo2t(), 'private' => false, ], 'products/count' => [ 'label' => 'Products', 'value' => self::m4is_s9ku(), 'private' => false, ], 'invoices/count' => [ 'label' => 'Invoices', 'value' => self::m4is_f7d9xe(), 'private' => false, ], 'merchant_id' => [ 'label' => 'Merchant ID', 'value' => self::$m4is_bxv7u->m4is_mmdrl('settings', 'merchant_account_id'), 'private' => false, ], 'memberships/count' => [ 'label' => 'Membership Levels', 'value' => $m4is_fdf0v, 'private' => false, ],               'shortcodes/nesting' => [ 'label' => 'Shortcode Nesting Levels', 'value' => MEMBERIUM_NESTING_LEVELS, 'private' => false, ], ], ] ]; return array_merge($m4is_bwzl7k, $m4is_anax); } static 
function m4is_i6e_do( array $m4is_uv1r ) : array { self::$m4is_xqr1mu = defined( 'WP_ENVIRONMENT_TYPE' ) ? WP_ENVIRONMENT_TYPE : self::$m4is_xqr1mu; self::$m4is_xqr1mu = function_exists( 'WP_ENVIRONMENT_TYPE' ) ? wp_get_environment_type() : self::$m4is_xqr1mu; if ( self::$m4is_xqr1mu === 'staging' || self::$m4is_xqr1mu == 'local' ) { unset( $m4is_uv1r['direct']['wpal/server/phpinfo'] );  } $m4is_uv1r['direct']['wpal/memberium/server/sessions'] = [ 'label' => 'Session Storage', 'test' => [__CLASS__, 'm4is_usdvk'], ]; $m4is_uv1r['direct']['wpal/memberium/wordpress/securitykeys'] = [ 'label' => 'Security Keys', 'test' => [__CLASS__, 'm4is_zxd48l'], ]; $m4is_uv1r['direct']['wpal/memberium/security/plaintext_password'] = [ 'label' => 'Plaintext Password', 'test' => [__CLASS__, 'm4is_hfp4'], ]; $m4is_uv1r['direct']['wpal/memberium/performance/memory'] = [ 'label' => 'Memory Allocation', 'test' => [__CLASS__, 'm4is_in3zwv'], ]; $m4is_uv1r['direct']['wpal/memberium/security/default_role'] = [ 'label' => 'Default Role', 'test' => [__CLASS__, 'm4is_ez1h7'], ]; $m4is_uv1r['direct']['wpal/memberium/security/caching'] = [ 'label' => 'Caching Plugins', 'test' => [__CLASS__, 'm4is_cqdaj'], ]; $m4is_uv1r['direct']['wpal/memberium/security/cloudflare'] = [ 'label' => 'Cloudflare', 'test' => [__CLASS__, 'm4is_c95pv'], ]; $m4is_uv1r['direct']['wpal/memberium/tables'] = [ 'label' => 'Database Tables', 'test' => [__CLASS__, 'm4is_j5ob'], ]; $m4is_uv1r['direct']['wpal/memberium/flywheel'] = [ 'label' => 'FlyWheel Caching', 'test' => [__CLASS__, 'm4is_thpo'], ]; $m4is_uv1r['direct']['wpal/memberiums/security/licenseserver'] = [ 'label' => 'Memberium License Server', 'test' => [__CLASS__, 'm4is_v81y9v'], ]; $m4is_uv1r['direct']['wpal/memberium/network_activation'] = [ 'label' => 'Memberium Network Activation', 'test' => [__CLASS__, 'm4is_axsvuq'], ]; $m4is_uv1r['direct']['wpal/memberium/memberships'] = [ 'label' => 'Membership Setup', 'test' => [__CLASS__, 'm4is_jinb'], ]; $m4is_uv1r['direct']['wpal/memberium/contact/contactnotes'] = [ 'label' => 'ContactNotes Sync', 'test' => [__CLASS__, 'm4is_pbn76s'], ]; $m4is_uv1r['direct']['wpal/memberium/tags'] = [ 'label' => 'CRM Tag Sync', 'test' => [__CLASS__, 'm4is_iewqum'], ]; $m4is_uv1r['direct']['wpal/memberium/installer/active'] = [ 'label' => 'Memberium Installer Plugin', 'test' => [__CLASS__, 'm4is_kj3s'], ]; $m4is_uv1r['direct']['wpal/memberium/file_permissions'] = [ 'label' => 'Memberium File Permissions', 'test' => [__CLASS__, 'm4is_qr89i0'], ]; $m4is_uv1r['direct']['wpal/i2sdk/installed'] = [ 'label' => 'i2SDK Plugin Installed', 'test' => [__CLASS__, 'm4is__nxw2'], ];  $m4is_uv1r['direct']['wpal/memberium/version'] = [ 'label' => 'Memberium Version', 'test' => [__CLASS__, 'm4is_tglm3p'], ]; $m4is_uv1r['direct']['wpal/memberium/autoupdate'] = [ 'label' => 'Memberium Autoupdate', 'test' => [__CLASS__, 'elf_test_memberium_autoupdate'], ]; $m4is_uv1r['direct']['wpal/wordpress/admin_is_admin'] = [ 'label' => 'Admin User should be renamed', 'test' => [__CLASS__, 'm4is_ea4_wf'], ]; $m4is_uv1r['direct']['wpal/memberium/support_account'] = [ 'label' => 'Memberium Support users should be removed', 'test' => [__CLASS__, 'm4is_n4r18'], ]; $m4is_uv1r['direct']['wpal/wordpress/missing_autoincrement'] = [ 'label' => 'WordPress Database Corruption', 'test' => [__CLASS__, 'm4is_tq1vib'], ]; $m4is_uv1r['direct']['wpal/server/phpinfo'] = [ 'label' => 'PHPinfo() Security Issue', 'test' => [__CLASS__, 'm4is_puidlq'], ]; $m4is_uv1r['direct']['wpal/wordpress/open_registration'] = [ 'label' => 'Open Registration', 'test' => [__CLASS__, 'm4is_hu140i'], ]; $m4is_uv1r['direct']['wpal/wordpress/object_cache'] = [ 'label' => 'Object Caching', 'test' => [__CLASS__, 'm4is_wv5pb'], ]; $m4is_uv1r['direct']['wpal/wordpress/administrator_email'] = [ 'label' => 'Site Administrator Email', 'test' => [__CLASS__, 'm4is_renma'], ]; $m4is_uv1r['direct']['wpal/wordpress/goaddy/managed'] = [ 'label' => 'GoDaddy Managed Hosting', 'test' => [__CLASS__, 'm4is_fsa1'], ]; $m4is_uv1r['direct']['wpal/wordpress/plugins/caching'] = [ 'label' => 'Caching Plugins', 'test' => [__CLASS__, 'm4is_iqr47'], ]; $m4is_uv1r['direct']['wpal/wordpress/plugins/membership'] = [ 'label' => 'Membership Plugins', 'test' => [__CLASS__, 'm4is_zf1dv4'], ]; $m4is_uv1r['direct']['wpal/wordpress/plugins/buddypress_private_network'] = [ 'label' => 'Possible BuddyPress Site Security Conflict', 'test' => [__CLASS__, 'm4is_p29i'], ]; $m4is_uv1r['direct']['wpal/memberium/password/blocked'] = [ 'label' => 'Memberium Password Sync', 'test' => [__CLASS__, 'm4is_wydp0t'], ]; return $m4is_uv1r; }  static 
function m4is_t76iyf() : int { global $wpdb; $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x( 'appname' ); $m4is_w6mt = MEMBERIUM_DB_TAGS; $m4is_ioxk = "SELECT count(id) from {$m4is_w6mt} WHERE `appname` = '{$m4is_q7m2}' "; return (int) $wpdb->get_var($m4is_ioxk); } static 
function m4is_bx9d() : int { global $wpdb; $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x('appname'); $m4is_w6mt = MEMBERIUM_DB_CONTACTGROUPCATEGORIES; $m4is_ioxk = "SELECT count(id) from {$m4is_w6mt} WHERE `appname` = '{$m4is_q7m2}' "; return (int) $wpdb->get_var($m4is_ioxk); } static 
function m4is_rnziam() : int { global $wpdb; $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x('appname'); $m4is_w6mt = MEMBERIUM_DB_DATAFORMFIELDS; $m4is_ioxk = "SELECT count(`id`) from `{$m4is_w6mt}` WHERE `appname` = '{$m4is_q7m2}'"; return (int) $wpdb->get_var($m4is_ioxk); } static 
function m4is_fo2t() : int { global $wpdb; $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x('appname'); $m4is_w6mt = MEMBERIUM_DB_ACTIONSETS; $m4is_ioxk = "SELECT count(`id`) from `{$m4is_w6mt}` WHERE `appname` = '{$m4is_q7m2}'"; return (int) $wpdb->get_var($m4is_ioxk); } static 
function m4is_s9ku() : int { global $wpdb; $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x('appname'); $m4is_w6mt = MEMBERIUM_DB_PRODUCTS; $m4is_ioxk = "SELECT count(`id`) from `{$m4is_w6mt}` WHERE `appname` = '{$m4is_q7m2}'"; return (int) $wpdb->get_var($m4is_ioxk); } static 
function m4is_f7d9xe() : int { global $wpdb; $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x('appname'); $m4is_w6mt = MEMBERIUM_DB_INVOICES; $m4is_ioxk = "SELECT count(`id`) from `{$m4is_w6mt}` WHERE `appname` = '{$m4is_q7m2}'"; return (int) $wpdb->get_var($m4is_ioxk); } static 
function m4is_q3m0oa() : string { $m4is_pjyva_ = 'Unknown'; $m4is_pjyva_ = empty($_SERVER['PRESSIDIUM_INSTALL_NAME']) ? $m4is_pjyva_ : 'Pressidium'; $m4is_pjyva_ = empty($_SERVER['PRESSIDIUM_ACCOUNT_NAME']) ? $m4is_pjyva_ : 'Pressidium'; $m4is_pjyva_ = empty($_SERVER['PRESSIDIUM_ENVIRONMENT']) ? $m4is_pjyva_ : 'Pressidium'; return $m4is_pjyva_; }  static 
function m4is_p29i() : array { $m4is_n_bp6 = []; if (function_exists('bp_is_active') || function_exists('buddypress') ) { $m4is_smd48 = get_option('bp-enable-private-network', 1); if ($m4is_smd48 == 0) { $m4is_n_bp6 = [ 'label' => 'BuddyPress Private Networking', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'orange', ], 'description' => "<p>Memberium has detected that you're using BuddyPress/BuddyBoss's private network feature.</p>", 'actions' => "<p>This feature may cause problems with page access controls.  We recommmend disabling this feature and letting Memberium manage site access.</p>", 'test' => 'wpal_wordpress_plugins_buddypress_private_network', ]; } } return $m4is_n_bp6; } static 
function m4is_iqr47() : array { if (! function_exists('get_plugins') ) { require_once ABSPATH . 'wp-admin/includes/plugin.php'; } $m4is_n_bp6 = []; $m4is_q1d6 = array_merge(get_plugins(), get_mu_plugins() ); $m4is_qpq9x6 = []; $m4is_evcj = [ 'endurance-page-cache.php', 'breeze/breeze.php', 'cache-enabler/cache-enabler.php', 'cachify/cachify.php', 'comet-cache/comet-cache.php', 'ezcache/ezcache.php', 'hummingbird-performance/wp-hummingbird.php', 'litespeed-cache/litespeed-cache.php', 'nginx-cache/nginx-cache.php', 'nginx-helper/nginx-helper.php', 'preload-fullpage-cache/preload-fullpage-cache.php', 'purge-varnish/class_purge_varnish.php', 'rapid-cache/rapid-cache.php', 'sg-cachepress/sg-cachepress.php', 'simple-cache/simple-cache.php', 'swift-performance-lite/performance.php', 'vcaching/vcaching.php', 'widget-output-cache/widget-output-cache.php', 'wp-cloudflare-page-cache/wp-cloudflare-super-page-cache.php', 'wp-fastest-cache/wpFastestCache.php', 'wp-super-cache/wp-cache.php', 'wpcacheon/wp-cache-on.php', ]; foreach($m4is_evcj as $m4is_yue86) { if (array_key_exists($m4is_yue86, $m4is_q1d6)) { $m4is_m_21 = $m4is_q1d6[$m4is_yue86]; $m4is_h4dcam = isset($m4is_m_21['Name']) ? $m4is_m_21['Name'] : $m4is_boly5; $m4is_ot4v7 = isset($m4is_m_21['Version']) ? $m4is_m_21['Version'] : ''; $m4is_qpq9x6[] = $m4is_h4dcam . ' v' . $m4is_ot4v7; } } if (! empty($m4is_qpq9x6)) { $m4is_n_bp6 = [ 'label' => 'Caching Plugins Found', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => "<p>The following caching plugins were found installed on your system.  " . "Improper configuration of these plugins can cause problems including access controls being broken, data corruption, and the wrong information displayed to the wrong user.</p>", 'actions' => '<p>We recommend deactivating and removing these plugins.  ' . 'If the plugin is required, please ensure it is not caching logged in users or pages with secure forms.</p>', 'test' => 'wpal_wordpress_plugins_caching', 'data' => $m4is_qpq9x6, ]; foreach($m4is_qpq9x6 as $m4is_pml1) { $m4is_n_bp6['description'] .= $m4is_pml1 . '<br />'; } } return $m4is_n_bp6; } static 
function m4is_pbn76s() : array { $m4is_uo1_su = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'ignore_contact_fields' ); $m4is_uo1_su = array_filter (explode( ',', $m4is_uo1_su ) ); $m4is_hckp9g = count( $m4is_uo1_su ); $m4is_zpbjc = get_admin_url( null, 'admin.php?page=memberium-sync-options&tab=contactfields' ); $m4is_n_bp6 = [ 'label' => 'Contact Field Sync Options', 'status' => 'good', 'badge' => [ 'label' => __('Performance'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_memberium_contact_contactnotes', ]; if (empty($m4is_uo1_su)) { $m4is_n_bp6['status'] = 'recommended'; $m4is_n_bp6['badge']['color'] = 'orange'; $m4is_n_bp6['description'] = '<p>Your system is set to sync all contact fields.  Most sites do not need all fields, and can save memory, disk space, and increase performance by only syncing the needed contact fields from Keap.</p>'; $m4is_n_bp6['description'] .= '<p>At a minimum, the <strong>ContactNotes</strong> field should be blocked from syncing.</p>'; $m4is_n_bp6['actions'] = "<p><a href='{$m4is_zpbjc}'>Click Here</a> to choose which fields to block from being synced.</p>"; } else { if (! in_array('ContactNotes', $m4is_uo1_su) ) { $m4is_n_bp6['status'] = 'recommended'; $m4is_n_bp6['badge']['color'] = 'orange'; $m4is_n_bp6['description'] = '<p>Your Memberium system is set to sync the <strong>ContactNotes</strong> field.  The <strong>ContactNotes</strong> field is almost never used in membership sites, however it can also be very large causing performance and memory problems.</p>'; $m4is_n_bp6['actions'] = "<p><a href='{$m4is_zpbjc}'>Click Here</a> to choose which fields to block from being synced.</p>"; } } if ($m4is_n_bp6['status'] == 'good') { $m4is_n_bp6['description'] = '<p>Your contact field sync options are setup correctly.</p>'; } return $m4is_n_bp6; } static 
function m4is_tq1vib() : array { global $wpdb; $m4is_jr7f6 = []; $m4is_fzalfr = []; $m4is_po4p = [ $wpdb->commentmeta => 'meta_id', $wpdb->comments => 'comment_ID', $wpdb->postmeta => 'meta_id', $wpdb->posts => 'ID', $wpdb->usermeta => 'umeta_id', $wpdb->users => 'ID', ]; foreach($m4is_po4p as $m4is_u13x => $m4is_t1s26) { $m4is_ioxk = "SELECT count(`{$m4is_t1s26}`) FROM `{$m4is_u13x}` WHERE `{$m4is_t1s26}` = 0"; $m4is_ejfox = (int) $wpdb->get_var($m4is_ioxk); if ($m4is_ejfox) { $m4is_fzalfr[$m4is_u13x] = $m4is_t1s26; } } if (count($m4is_fzalfr) ) { $m4is_jr7f6 = [ 'label' => 'WordPress Database AutoIncrement Corruption', 'status' => 'critical', 'badge' => [ 'label' => __('Database'), 'color' => 'red', ], 'description' => "<p>Your WordPress database AutoIncrement columns are corrupted or missing, and is causing data loss.</p><p>The following tables are affected:</p>", 'actions' => '<p>We recommend you contact your hosting service and ask them to repair the damaged columns and indexes.</p>', 'test' => 'wpal_wordpress_autoincrement', ]; foreach($m4is_fzalfr as $m4is_u13x => $m4is_t1s26) { $m4is_jr7f6['description'] .= "Table: '{$m4is_u13x}', on column '{$m4is_t1s26}'<br />"; } } return $m4is_jr7f6; } static 
function m4is_ez1h7() : array { $m4is_v67fv = get_option('default_role'); $m4is_hqmdn = get_role($m4is_v67fv); $m4is_wxopn = $m4is_hqmdn->has_cap('read'); $m4is_oq296 = $m4is_hqmdn->has_cap('manage_options'); $m4is_n_bp6 = null; $m4is_v67fv = ucwords($m4is_v67fv); $m4is_n_bp6 = [ 'label' => 'Default Role Permissions', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green' ], 'description' => '', 'actions' => '', 'test' => 'wpal_default_role', ]; if ($m4is_oq296) { $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['description'] .= "<p>Your default role ({$m4is_v67fv}) appears to be mis-configured as an admin user.  The default role should have minimum access.</p>"; } if (! $m4is_wxopn) { $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['description'] .= "<p>Your default role ({$m4is_v67fv}) appears to be mis-configured without the 'Read' capability.  This capability should be added to the role.</p>"; } if ($m4is_n_bp6['status'] == 'good') { $m4is_n_bp6['description'] = 'Your default role appears to be properly configured.'; } else { $m4is_n_bp6['actions'] = '<p>Please contact <a href="https://memberium.com/support/" target="_blank">Memberium Support</a> for assistance and include a copy of this message.</p>'; } return $m4is_n_bp6; } static 
function m4is__nxw2() : array { $m4is_iko5 = get_option('active_plugins'); $m4is_in0ti = false; $m4is_n_bp6 = []; foreach($m4is_iko5 as $m4is_m_21) { if (stripos($m4is_m_21, 'i2sdk') !== false) { $m4is_in0ti = true; break; } } if ($m4is_in0ti) { $m4is_jrkhw2 = get_admin_url(null, 'plugins.php?s=i2sdk&plugin_status=all'); $m4is_n_bp6 = [ 'label' => 'Deactivate External i2SDK Plugin', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => '<p>Memberium has detected that you have the old version of the i2SDK plugin installed, and activated.  This version is no longer maintained, and is missing performance improvements, features and bug fixes.</p>', 'actions' => "<p>We recommend <a href='{$m4is_jrkhw2}'>deactivating</a> the i2SDK plugin to avoid conflicts.</p>", 'test' => 'wpal_memberium_external_i2sdk', ]; } return $m4is_n_bp6; } static 
function m4is_qr89i0() : array { $m4is_k1dh5 = new RecursiveIteratorIterator(new RecursiveDirectoryIterator( self::$m4is_bxv7u->m4is_pri6vy() ) ); $m4is__oz43 = true; $m4is_n_bp6 = []; foreach ($m4is_k1dh5 as $m4is_qfup8) { $m4is_v6s0qb = $m4is_qfup8->getPathname(); if (! stripos($m4is_v6s0qb, '.git')) { if (! is_writeable($m4is_v6s0qb)) { $m4is__oz43 = false; break; } } } if (! $m4is__oz43) { $m4is_n_bp6 = [ 'label' => 'Memberium Plugin Folder is not Writeable', 'status' => 'recommended', 'badge' => [ 'label' => __('Updates'), 'color' => 'orange', ], 'description' => '<p>One or more files in your Memberium plugin folder are not writeable.</p><p>This may prevent updates or debugging builds from working.</p>', 'actions' => '<p>Reset the permissions on the Memberium plugin folder to be writeable.</p>', 'test' => 'm4is_qr89i0', ]; } return $m4is_n_bp6; } static 
function m4is_thpo() : array { $m4is_ef19 = isset($_SERVER['SERVER_SOFTWARE']) ? $_SERVER['SERVER_SOFTWARE'] : ''; $m4is_n_bp6 = []; if (stripos($m4is_ef19, 'flywheel') !== false) { $m4is_n_bp6 = [ 'label' => 'FlyWheel Hosting detected', 'status' => 'critical', 'badge' => [ 'label' => __('Performance'), 'color' => 'orange' ], 'description' => 'FlyWheel hosting was detected.  Fly/Wheel uses aggressive caching which may display private member info to other members, break autologins, and other problems.  Turning on Dev Mode will often fix these issues.', 'actions' => '', 'test' => 'wpal_healthcheck_flywheel', ]; } return $m4is_n_bp6; } static 
function m4is_fsa1() : array { $m4is_jr7f6 = []; $m4is_in0ti = false; $m4is_bd4w = defined('GD_PLAN_NAME') ? strtolower(GD_PLAN_NAME) : ''; if (strpos($m4is_bd4w, 'managed wordpress') !== false) { $m4is_jr7f6 = [ 'label' => 'GoDaddy Managed WordPress Hosting', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red' ], 'description' => '<p>GoDaddy Managed WordPress hosting was detected.   GoDaddy Managed WordPress is incompatible with Memberium and is not a supported hosting plan.  This will cause Memberium to not work properly.</p>', 'actions' => '<p>We recommend switching to another hosting provider, or to GoDaddy cPanel Linux hosting.</p>', 'test' => 'wpal_hosting_godaddy_managed', ]; } return $m4is_jr7f6; } static 
function m4is_v81y9v() : array {  $m4is_n_bp6 = [ 'label' => 'Can Communicate with Memberium License Server', 'status' => 'good', 'badge' => [ 'label' => __( 'Memberium' ), 'color' => 'green'], 'description' => 'Your connection to the license server appears to be working properly.', 'actions' => '', 'test' => 'wpal_healthcheck_hostblocking', ]; if (defined('WP_HTTP_BLOCK_EXTERNAL') && constant('WP_HTTP_BLOCK_EXTERNAL') == 1) { $m4is_o6cbf = defined('WP_ACCESSIBLE_HOSTS') ? strtolower(constant('WP_ACCESSIBLE_HOSTS') ) : ''; $m4is_tn6t = array_filter(explode(',', $m4is_o6cbf) ); $m4is_tn6t = array_filter($m4is_tn6t); $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x('appname'); $m4is_ym_zgd = [ 'licenseserver.webpowerandlight.com', "{$m4is_q7m2}.infusionsoft.com" ]; foreach($m4is_ym_zgd as $k => $m4is_waxrhu) { if (in_array($m4is_waxrhu, $m4is_tn6t) ) { unset($m4is_ym_zgd[$k]); } } if (! empty($m4is_ym_zgd) ) { $m4is_rdah = trim($m4is_o6cbf . "," . implode(',', $m4is_ym_zgd), ','); $m4is_mn_xj = 'notice notice-error'; $m4is_fgxy = '<h3>External Hosts Blocked</h3>' . '<p>Memberium has detected that you are blocking access to external hosts, through your wp-config.php file.' . 'You will either need to remove the <strong>WP_HTTP_BLOCK_EXTERNAL</strong> setting, or add our hosts to the <strong>WP_ACCESSIBLE_HOSTS</strong> setting.' . 'Leaving this problem unaddressed will cause your plugin to stop working.</p>' . "<p style='font-family:\"courier new\",monospace;font-size:120%;'>define('WP_ACCESSIBLE_HOSTS', '" . $m4is_rdah . "');</p>" . '<p>If you would like assistance, please contact <a target="_blank" href="https://memberium.com/support/">Memberium Support.</a></p>'; $m4is_n_bp6['label'] = 'Memberium License Server is blocked'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] = $m4is_fgxy; } } return $m4is_n_bp6; } static 
function m4is_kj3s() : array {   $m4is_iko5 = get_option('active_plugins'); $m4is_rwn2l = get_plugins(); $m4is_n_bp6 = []; $m4is_a3av7 = []; $m4is_q1d6 = []; $m4is_jrkhw2 = get_admin_url(null, 'plugins.php?s=memberium install&plugin_status=all'); $m4is_n_bp6 = [ 'label' => 'Remove Memberium Installer Plugin', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_memberium_installer', ]; foreach($m4is_rwn2l as $m4is_m_21 => $m4is_qvehs) { if (stripos($m4is_m_21, 'memberium') !== false && (stripos($m4is_m_21, 'install') !== false || stripos($m4is_m_21, 'wizard') !== false) ) { $m4is_a3av7[] = $m4is_m_21; $m4is_n_bp6['status'] = 'recommended'; $m4is_n_bp6['badge']['color'] = 'orange'; } } foreach($m4is_iko5 as $m4is_m_21) { if (stripos($m4is_m_21, 'memberium') !== false && (stripos($m4is_m_21, 'install') !== false || stripos($m4is_m_21, 'wizard') !== false) ) { $m4is_a3av7[] = $m4is_m_21; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; } } if (! empty($m4is_a3av7)) { foreach($m4is_a3av7 as $m4is_m_21) { if (isset($m4is_rwn2l[$m4is_m_21])) { $m4is_q1d6[] = "<em>{$m4is_rwn2l[$m4is_m_21]['Name']}</em> by {$m4is_rwn2l[$m4is_m_21]['Author']}"; } } } if (! empty($m4is_q1d6)) { $m4is_n_bp6['description'] = '<p>The Memberium installation wizard plugin was found in your system.  This plugin is no longer needed once Memberium is installed, and will only slow down your system.</p>'; $m4is_n_bp6['actions'] = '<p>We recommend <a href="' . $m4is_jrkhw2 . '">deactivating and removing</a> the following plugins:</p>'; foreach($m4is_q1d6 as $m4is_m_21) { $m4is_n_bp6['actions'] .= "<p>{$m4is_m_21}</p>"; } } if ($m4is_n_bp6['status'] !== 'good') { return $m4is_n_bp6; } return []; } static 
function m4is_renma() : array { $m4is_n_bp6 = []; if ( self::$m4is_bxv7u->m4is__z7_1k() === 'production' ) { $m4is_krkto6 = false; $m4is_m2h6b = strtolower( trim( get_bloginfo( 'admin_email' ) ) ); $m4is_t2zd = [ '.secureserver.net', '.sg-host.com', '.wpengine.com', 'liquidwebsites.com', '@cloudways', '@example', '@flywheel.local', '@localhost', '@entre.cloud', '@admin.com', '@admin.com', ]; if (empty($m4is_m2h6b) ) { $m4is_krkto6 = true; } foreach($m4is_t2zd as $m4is_d45d8f) { if (stripos($m4is_m2h6b, $m4is_d45d8f) !== false) { $m4is_krkto6 = true; break; } } if ($m4is_krkto6) { $m4is_zpbjc = '<a href="' . get_admin_url(null, 'options-general.php') . '"> target="_blank">here</a>'; $m4is_m2h6b = esc_html($m4is_m2h6b); $m4is_n_bp6 = [ 'label' => 'Invalid Site Administrator Contact Email', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => "<p>An invalid email ({$m4is_m2h6b}) was detected in the site's <strong>Administration Email Address</strong> setting.  This may affect your software license management.</p>", 'actions' => '<p>We recommend setting your Administrator email address to a valid email.  You can update this setting ' . $m4is_zpbjc . '</p>', 'test' => 'wpal_wordpress_administrator_email', ]; } } return $m4is_n_bp6; } static 
function m4is_ea4_wf() : array { $m4is_n_bp6 = []; $m4is_gdx7t = [  'administrator', 'memberium', 'sitemanager', 'support', 'test', ]; foreach ($m4is_gdx7t as $m4is_hhp_) { $m4is_nzrv1 = get_user_by('login', $m4is_hhp_); if ($m4is_nzrv1 && self::$m4is_bxv7u->m4is_fop0d($m4is_nzrv1->ID) ) { break; } $m4is_nzrv1 = false; } if ($m4is_nzrv1 && is_a($m4is_nzrv1, 'WP_User') ) { $m4is_hhp_ = $m4is_nzrv1->user_login; $m4is_vkc5 = '<a href="' . get_admin_url(null, "user-edit.php?user_id={$m4is_nzrv1->ID}") . '">view the user here</a>'; $m4is_n_bp6 = [ 'label' => 'Default Admin Account Logins', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'orange', ], 'description' => "<p>Your install of Memberium has one or more admin user using the default admin name of '{$m4is_hhp_}'.  This increases the exposure of your site to attack by hackers bruteforcing your admin login.</p>", 'actions' => '<p>You can ' . $m4is_vkc5 . '. We recommend changing your WordPress admin username to something non-obvious.</p><p>If you have questions, please ' . self::$m4is_yl8pto . '</p>', 'test' => 'wpal_wordpress_admin_is_admin', ]; } return $m4is_n_bp6; } static 
function m4is_tglm3p() : array { $m4is_n_bp6 = []; $m4is_q26h = self::$m4is_bxv7u->m4is_gu3m(); $m4is_qz_m = m4is_n2_bj::m4is_m7e2(); $m4is_zpbjc = get_admin_url(null, 'admin.php?page=memberium-support&tab=updates'); $m4is_n_bp6 = [ 'label' => 'Memberium Plugin Version', 'status' => 'good', 'badge' => [ 'label' => __('Performance'), 'color' => 'green', ], 'description' => "<p>Your install of Memberium is running the latest available version.</p>", 'actions' => '', 'test' => 'wpal_memberium_outdated', ]; if (version_compare($m4is_qz_m, $m4is_q26h, '>') ) { $m4is_n_bp6['label'] = 'Memberium Plugin Requires Update'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] = "<p>Your install of Memberium is running an older version (v{$m4is_q26h}).  Your version is missing features, performance, and security improvements.   Only current versions are eligible for some kinds of support.</p>"; $m4is_n_bp6['actions'] = "<p>We recommend <a href='{$m4is_zpbjc}'>updating to the latest version</a> v{$m4is_qz_m}.</p><p>If you would like assistance, please contact <a href='https://memberium.com/support/' target='_blank'>Memberium Support</a>.</p>"; } return $m4is_n_bp6; } static 
function m4is_n4r18() : array { $m4is_n_bp6 = []; $m4is_gdx7t = [ 'support@memberium.com', 'support@memberium.zendesk.com', ]; foreach ($m4is_gdx7t as $m4is_hhp_) { $m4is_nzrv1 = get_user_by('email', $m4is_hhp_); if ($m4is_nzrv1 && self::$m4is_bxv7u->m4is_fop0d($m4is_nzrv1->ID) ) { break; } $m4is_nzrv1 = false; } if ($m4is_nzrv1) { $m4is_hhp_ = $m4is_nzrv1->user_login; $m4is_vkc5 = '<a href="' . get_admin_url(null, "user-edit.php?user_id={$m4is_nzrv1->ID}") . '">view the user here</a>'; $m4is_n_bp6 = [ 'label' => 'Memberium Support Admins', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'orange', ], 'description' => "<p>Your install of Memberium has one or more admin users belonging to Memberium support.</p>", 'actions' => "<p>We recommend changing the user's role to 'Subscriber', or deleting the user completely once the login is no longer needed.</p><p>If you have questions, please " . self::$m4is_yl8pto . "</p><p>You can {$m4is_vkc5}.</p>", 'test' => 'wpal_memberium_support_account', ]; } return $m4is_n_bp6; } static 
function m4is_zf1dv4() : array { if (! function_exists('get_plugins') ) { require_once ABSPATH . 'wp-admin/includes/plugin.php'; } $m4is_n_bp6 = []; $m4is_q1d6 = array_merge(get_plugins(), get_mu_plugins() ); $m4is_qpq9x6 = []; $m4is_evcj = [ 'infusion4wp/infusion4wpload.php', 'memberful-wp/memberful-wp.php', 'members/members.php', 'paid-member-subscriptions/index.php', 'paid-memberships-pro/paid-memberships-pro.php', 'restrict-content/restrictcontent.php', 's2member/s2member.php', 'simple-membership-after-login-redirection/swpm-after-login-redirection.php', 'simple-membership/simple-wp-membership.php', 'wishlist-member/wpm.php', 'wp-members/wp-members.php', ]; foreach($m4is_evcj as $m4is_yue86) { if (array_key_exists($m4is_yue86, $m4is_q1d6)) { $m4is_m_21 = $m4is_q1d6[$m4is_yue86]; $m4is_h4dcam = isset($m4is_m_21['Name']) ? $m4is_m_21['Name'] : $m4is_boly5; $m4is_ot4v7 = isset($m4is_m_21['Version']) ? $m4is_m_21['Version'] : ''; $m4is_qpq9x6[] = $m4is_h4dcam . ' v' . $m4is_ot4v7; } } if (! empty($m4is_qpq9x6)) { $m4is_n_bp6 = [ 'label' => 'Conflicting Membership Plugins Found', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => "<p>The following membership plugins were found installed on your system.  " . "Running multiple membership plugins is not supported. " . "Installation and of these plugins can cause problems including access controls being broken, data corruption, and the wrong information displayed to the wrong users.</p>", 'actions' => '<p>We recommend deactivating and removing these plugins.</p>', 'test' => 'wpal_wordpress_plugins_membership', 'data' => $m4is_qpq9x6, ]; foreach($m4is_qpq9x6 as $m4is_pml1) { $m4is_n_bp6['description'] .= $m4is_pml1 . '<br />'; } } return $m4is_n_bp6; } static 
function m4is_jinb() : array { $m4is_fdf0v = self::$m4is_bxv7u->m4is_mmdrl( 'memberships' ); $m4is_ejfox = count( $m4is_fdf0v ); $m4is_n_bp6 = [ 'label' => 'Memberium Membership Levels', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_memberium_membership_levels', ]; if ($m4is_ejfox == 0) { $m4is_n_bp6['status'] = 'recommended'; $m4is_n_bp6['badge']['color'] = 'orange'; $m4is_n_bp6['description'] .= '<p>No Memberium membership levels were found.</p>'; $m4is_n_bp6['actions'] .= '<p>We recommend creating one or more Memberium membership levels to properly secure your site.</p>'; } else { $m4is_znf9 = self::$m4is_bxv7u->m4is_ee0h(false); $m4is_tq6edv = [ 'main_id', 'payf_id', 'cancel_id', 'suspend_id' ]; $m4is_g8ojt = []; $m4is_xy1x = []; foreach($m4is_fdf0v as $m4is_tyoak) { foreach($m4is_tq6edv as $m4is_ap3_) { if (! empty($m4is_tyoak[$m4is_ap3_]) ) { $m4is_w9feq2 = $m4is_tyoak[$m4is_ap3_]; $m4is_g8ojt[$m4is_w9feq2] = $m4is_tyoak['name']; } } if (! empty($m4is_tyoak['addltag_ids'])) { $m4is_qe6cro = explode(',', $m4is_tyoak['addltag_ids']); foreach($m4is_qe6cro as $m4is_w9feq2) { $m4is_g8ojt[$m4is_w9feq2] = $m4is_tyoak['name']; } } } array_unique($m4is_g8ojt); uasort($m4is_g8ojt, function($a, $b) { return (int) ($a > $b); }); foreach($m4is_g8ojt as $m4is_w9feq2 => $m4is_ho0w2) { if (! array_key_exists($m4is_w9feq2, $m4is_znf9['mc'])) { $m4is_xy1x[$m4is_ho0w2][] = $m4is_w9feq2; } } if (! empty($m4is_xy1x)) { $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; foreach($m4is_xy1x as $m4is_tyoak => $m4is_znf9) { if (! empty($m4is_znf9)) { $m4is_n_bp6['description'] .= "<p>Your {$m4is_tyoak} membership level is missing the following tag IDs: " . implode(',', $m4is_znf9) . "</p>"; } } $m4is_n_bp6['actions'] = '<p>Check your tag sync options to ensure you are not blocking any tag categories used by your membership levels.</p>'; $m4is_n_bp6['actions'] .= '<p>If the referenced tags no longer exist, remove them from your membership, or delete the membership level.</p>'; } } if ($m4is_n_bp6['status'] == 'good') { $m4is_n_bp6['description'] = "<p>Your {$m4is_ejfox} membership levels appear to be present and properly configured.</p>"; } return $m4is_n_bp6; } static 
function m4is_in3zwv() : array { $m4is_r3704u = intval(wp_convert_hr_to_bytes(WP_MEMORY_LIMIT) / 1024 / 1024); $m4is_ekozi6 = intval(wp_convert_hr_to_bytes(WP_MAX_MEMORY_LIMIT) / 1024 / 1024); $m4is_n_bp6 = [ 'label' => 'Sufficient Memory Allocated', 'status' => 'good', 'badge' => [ 'label' => __('Performance'), 'color' => 'green', ], 'description' => "You have {$m4is_r3704u}MB allocated to the frontend, and {$m4is_ekozi6}MB allocated to the admin dashboard.", 'actions' => '', 'test' => 'wpal_healthcheck_memory', ]; if ($m4is_r3704u < 41) { $m4is_fgxy = "<p>Your site is configured with a memory limit of {$m4is_r3704u}MB<br />" . 'You can increase your WordPress memory limit by adding or updating the following line in your wp-config.php:<br />' . "<code>define('WP_MEMORY_LIMIT', '64M');</code><br />" . 'For sites with many or complex plugins or themes, you may want to set it to 96M, 128M, 160M or more.</p>'; $m4is_n_bp6['label'] = 'Memory Warning'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] = $m4is_fgxy; } if ($m4is_r3704u > 256) { $m4is_fgxy = "<p>Your site is configured with WP_MEMORY_LIMIT set to {$m4is_r3704u}MB.<br />" . 'Sites needing high memory allocations often can cause performance issues due to misconfiguration and this is not normal even for large sites.  ' . 'We recommend contacting <a href="https:://memberium.com/support/">Memberium support</a> for assistance.</p>'; $m4is_n_bp6['label'] = 'Memory Warning'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] = $m4is_fgxy; } if ($m4is_ekozi6 < 40) { $m4is_fgxy = "<p>Your site is configured with an Admin memory limit of {$m4is_ekozi6}MB<br />" . 'You can increase your WordPress memory limit by adding or updating the following line in your wp-config.php:<br />' . "<code>define('WP_MAX_MEMORY_LIMIT', '64M');</code><br />" . 'For sites with many or complex plugins or themes, you may want to set it to 96M, 128M, 160M or more.</p>'; $m4is_n_bp6['label'] = 'Memory Warning'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] .= $m4is_fgxy; }  return $m4is_n_bp6; } static 
function m4is_j5ob() : array { global $wpdb; $m4is_po4p = get_option('memberium_tables', [] ); $m4is_po4p[] = 'i2sdk_apilog'; $m4is_po4p[] = 'i2sdk_dataformfields'; $m4is_dqth = []; $m4is_n_bp6 = [ 'label' => __('Memberium Database Tables'), 'status' => 'good', 'badge' => [ 'label' => __('Database'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_database_tables', ]; if (is_array($m4is_po4p)) { foreach($m4is_po4p as $m4is_hs4_6) { $m4is_ioxk = "SELECT 1 FROM `{$m4is_hs4_6}` LIMIT 1;"; $wpdb->get_var($m4is_ioxk); $m4is_rr90 = $wpdb->last_error; if ($m4is_rr90) { $m4is_dqth[] = $m4is_hs4_6; } } sort($m4is_dqth); } if (! empty($m4is_dqth)) { $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] = '<p>The following essential database tables are missing or unreadable.</p>'; foreach($m4is_dqth as $m4is_ho0w2) { $m4is_n_bp6['description'] .= "{$m4is_ho0w2}<br />"; } } else { $m4is_n_bp6['description'] = '<p>All Memberium and i2SDK database tables are present.</p>'; } return $m4is_n_bp6; } static 
function m4is_gz3rli() : array { $m4is_iko5 = get_option('active_plugins'); $m4is_in0ti = false; $m4is_n_bp6 = []; foreach($m4is_iko5 as $m4is_m_21) { if (stripos($m4is_m_21, 'menu-items-visibility-control') !== false) { $m4is_in0ti = true; break; } } if ($m4is_in0ti) { $m4is_jrkhw2 = get_admin_url(null, 'plugins.php?s=menu items visibility control&plugin_status=search'); $m4is_n_bp6 = [ 'label' => 'Deactivate Menu Items Visibility Control Plugin', 'status' => 'critical', 'badge' => [ 'label' => __('Performance'), 'color' => 'red', ], 'description' => "<p>Memberium has detected that you have the Menu Items Visibility Control plugin installed.  The function provided by this plugin has been replaced by Memberium's enhanced native Menu visibility controls with more features and better security.</p><p>Memberium has already imported the settings from this plugin.</p>", 'actions' => "<p>We recommend <a href='{$m4is_jrkhw2}'>deactivating</a> this plugin.</p>", 'test' => 'wpal_memberium_mivc_plugin', ]; } return $m4is_n_bp6; } static 
function m4is_axsvuq() : array { $m4is_n_bp6 = []; if (defined('MULTISITE') && MULTISITE) { $m4is_n_bp6 = [ 'label' => 'Memberium is not Network Activated', 'status' => 'good', 'badge' => [ 'label' => __('Performance'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_m4is_network_activation', ]; $m4is_vsnd = (array) get_site_option('active_sitewide_plugins'); $m4is_gba4m7 = isset($m4is_vsnd['memberium2/memberium2.php']) ? $m4is_vsnd['memberium2/memberium2.php'] > 0 : false; if ($m4is_gba4m7) { $m4is_n_bp6['label'] = 'Memberium is Network Activated'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'orange'; $m4is_n_bp6['description'] .= '<p>It is recommended to only activate Memberium only on a per-site basis, unless ALL sites in the network are always actively being used for memberships.</pre>'; $m4is_n_bp6['actions'] .= '<p>We recommend Network Deactivating Memberium, and activating it on any individual network sites it is actively being used on.</p>'; } } return $m4is_n_bp6; }  static 
function m4is_wv5pb() : array { $m4is_n_bp6 = []; $m4is_zntp = function_exists('wp_using_ext_object_cache') ? wp_using_ext_object_cache() : 'production'; $m4is_n_bp6 = [ 'label' => 'Object Caching Missing / Inactive', 'status' => 'recommended', 'badge' => [ 'label' => __('Performance'), 'color' => 'red', ], 'description' => '<p>Object caching was not detected.  Memberium is designed to use object caching to both speed up operations and reduce database loads.</p>', 'actions' => '<p>Install and activate object caching.</p>', 'test' => 'wpal_wordpress_object_cache', ]; if ($m4is_zntp) { $m4is_n_bp6['label'] = 'Object Caching Active'; $m4is_n_bp6['status'] = 'good'; $m4is_n_bp6['badge']['color'] = 'green'; $m4is_n_bp6['description'] = '<p>Object Caching was detected.  Most Excellent!</p>'; $m4is_n_bp6['actions'] = ''; } return $m4is_n_bp6; }  static 
function m4is_hu140i() : array { $m4is_jr7f6 = []; $m4is_zp4kg = get_option('users_can_register', false); if ($m4is_zp4kg) { $m4is_jr7f6 = [ 'label' => 'Open Registration', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => '<p>Your WordPress site has been configured to allow any user to register.</p>', 'actions' => '<p>It is recommended that you disable this setting, and use Keap to handle new user registrations.</p>' . '<p>You can change this setting <a href="options-general.php">here</a>, by unchecking "<strong>Anyone can register</strong>".</p>', 'test' => 'wpal_wordpress_open_registration', ]; } return $m4is_jr7f6; }  static 
function m4is_puidlq() : array { $m4is_jr7f6 = []; if ( self::$m4is_bxv7u->m4is__z7_1k() === 'production' ) { $m4is_npwiyu = array_diff( scandir( ABSPATH ), ['.', '..'] ); $m4is_htynz = []; foreach($m4is_npwiyu as $m4is_qfup8) { $m4is_qfup8 = ABSPATH . $m4is_qfup8; if (! is_dir($m4is_qfup8)) { if (stripos(file_get_contents($m4is_qfup8, false, null, 0, 256), '<?') !== false) { if (stripos(file_get_contents($m4is_qfup8, false, null, 0, 256), 'phpinfo(') !== false) { $m4is_htynz[] = $m4is_qfup8; } } } } if (count($m4is_htynz) ) { $m4is_jr7f6 = [ 'label' => 'PHPinfo() Security Issue', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => "<p>Files with the phpinfo() debug code have been detected in your top level WordPress directory.  These files are not used by WordPress, and they expose sensitive security information about your server and site that can be used by attackers.</p>", 'actions' => '<p>Please ask your web host to review and remove the following files:</p>', 'test' => 'wpal_server_phpinfo', ]; foreach($m4is_htynz as $m4is_qfup8) { $m4is_jr7f6['actions'] .= "{$m4is_qfup8}<br>"; } } } return $m4is_jr7f6; } static 
function m4is_hfp4() : array { $m4is_n_bp6 = [ 'label' => 'Membership Password Security', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green', ], 'description' => 'Passwords are securely stored in WordPress only.', 'actions' => '', 'test' => 'wpal_memberium_plaintext_password', ]; $m4is_zpbjc = get_admin_url(null, 'admin.php?page=memberium-options'); $m4is_bqdvu = 'https://memberium.com/?p=6818'; $m4is_s6iyu = self::$m4is_bxv7u->m4is_mmdrl('settings', 'local_auth_only'); if (empty($m4is_s6iyu) ) { $m4is_n_bp6['status'] = 'recommended'; $m4is_n_bp6['badge']['color'] = 'orange'; $m4is_n_bp6['description'] = '<p>Your Memberium system is set to sync passwords in plaintext from WordPress to Keap.  '; $m4is_n_bp6['description'] .= 'This may put members at risk who carelessly re-use passwords on multiple sites.  '; $m4is_n_bp6['description'] .= 'It may also not be compliant with various privacy regulations and laws governing you or your members.</p>'; $m4is_n_bp6['actions'] = "<p><strong>Please review our <a href='{$m4is_bqdvu}' target='_blank'>documentation</a> and <a href='https://memberium.com/support/' target='_blank'>contact support</a> to understand this feature <span style='color:red;'>before</span> making any changes.</strong></p>"; $m4is_n_bp6['actions'] .= "<p><a href='{$m4is_zpbjc}'>Click Here</a> to review your setting for 'Secure Passwords / Local Auth Only'.</p>"; } return $m4is_n_bp6; } static 
function m4is_c95pv() : array { $m4is_n_bp6 = [ 'label' => 'No Proxies detected', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green' ], 'description' => 'No web proxies were detected.  Web Proxies like Cloudflare and Securi are services to secure and speed up your website, however they may interfere with HTTP POSTs coming from Keap.', 'actions' => '', 'test' => 'wpal_healthcheck_cloudflare', ]; if (! empty($_SERVER['HTTP_CF_RAY']) ) { $m4is_fgxy = '<p>Memberium has detected that you are using CloudFlare.  We recommend reviewing your CloudFlare configuration to ensure that page caching is disabled.</p>'; $m4is_n_bp6['label'] = 'CloudFlare Detected'; $m4is_n_bp6['status'] = 'recommended'; $m4is_n_bp6['badge']['color'] = 'orange'; $m4is_n_bp6['description'] = $m4is_fgxy; $m4is_n_bp6['data'] = 'CloudFlare'; } return $m4is_n_bp6; }  static 
function m4is_iewqum() : array { $m4is_znf9 = self::$m4is_bxv7u->m4is_ee0h(false); $m4is_ejfox = isset($m4is_znf9['mc']) && is_array($m4is_znf9['mc']) ? count($m4is_znf9['mc']) : 0; $m4is_yqog2 = get_option('memberium_tables_updated', [] ); $m4is_r7k_h = empty($m4is_yqog2['tags']) ? 0 : $m4is_yqog2['tags']; $m4is_n_bp6 = [ 'label' => 'Memberium Tags', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green', ], 'description' => "<p>We found {$m4is_ejfox} tags synced from Keap.</p>", 'actions' => '', 'test' => 'wpal_memberium_tags', ]; if ($m4is_ejfox) { $m4is_zpbjc = get_admin_url(null, 'admin.php?page=memberium-support&tab=dashboard'); $m4is_n_bp6['actions'] = '<p>If you are missing some tags, you can <a href="' . $m4is_zpbjc . '"> resynchronize the tag list here</a>:</p>'; if ($m4is_r7k_h) { $m4is_n_bp6['description'] .= '<p>Your tags were last synced ' . human_time_diff($m4is_r7k_h) . ' ago.</p>'; } } else { $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] = '<p>No tags have been synced from Keap.</p>'; $m4is_n_bp6['actions'] = ''; } return $m4is_n_bp6; }   static 
function m4is_zxd48l() : array { $m4is_dhrs = [ 'AUTH_KEY', 'AUTH_SALT', 'LOGGED_IN_KEY', 'LOGGED_IN_SALT', 'NONCE_KEY', 'NONCE_SALT', 'SECURE_AUTH_KEY', 'SECURE_AUTH_SALT', ]; $m4is_fzalfr = 0; $m4is_n_bp6 = [ 'label' => 'WordPress Security Keys', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green', ], 'description' => "<p>Your WordPress security keys need to be defined with unique, secure values.</p>", 'actions' => '', 'test' => 'wpal_wp_security_keys', ]; foreach($m4is_dhrs as $m4is_ap3_) { if ( ! defined($m4is_ap3_) ) { $m4is_fzalfr++; } else { $m4is_rhfd = trim( strtolower( constant($m4is_ap3_) ) ); if ( empty($m4is_rhfd) || $m4is_rhfd == 'put your unique phrase here' ) { $m4is_fzalfr++; } } } if ($m4is_fzalfr) { $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['actions'] = 'Please review your wp-config.php file to update your KEYS and SALTS.  ' . 'You can find a new set of keys here <a href="https://api.wordpress.org/secret-key/1.1/salt/" target="_blank">here</a>. ' . 'Please contact your webhost if you would like assistance making thsi change.'; } return $m4is_n_bp6; }     static 
function m4is_cqdaj() : array { $m4is_n_bp6 = [ 'label' => 'No Page Caching Plugins Found', 'status' => 'good', 'badge' => [ 'label' => __( 'Security' ), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_healthcheck_caching', ]; if (function_exists('wpsc_init')) { $m4is_n_bp6['label'] = 'Page Caching Plugins Found'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] .= '<p>WP Super Cache is installed and active.</p>'; } if (defined('W3TC')) { $m4is_n_bp6['label'] = 'Page Caching Plugins Found'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] .= '<p>W3 Total Cache is installed and active.</p>p>'; } if (defined('WP_ROCKET_VERSION') ) { $m4is_n_bp6['label'] = 'Page Caching Plugins Found'; $m4is_n_bp6['status'] = 'critical'; $m4is_n_bp6['badge']['color'] = 'red'; $m4is_n_bp6['description'] .= '<p>WP Rocket is installed and active.</p>'; } if (empty($m4is_n_bp6['description'])) { $m4is_n_bp6['description'] = '<p>No caching plugin conflicts detected.<br />Installing Caching plugins can cause data corruption and security issues.</p>'; } else { $m4is_n_bp6['description'] .= '<p>Running caching plugins with your membership site can cause corruption and security problems.  To fix this problem, disable your caching plugins.</p>'; } return $m4is_n_bp6; } static 
function m4is_usdvk() : array { $m4is_sh48 = self::$m4is_bxv7u->m4is_mmdrl( 'db_sessions' ); $m4is_n_bp6 = []; if ( $m4is_sh48) { return $m4is_n_bp6; } $m4is_fzalfr = []; $m4is_l926 = []; $m4is_k_4n = session_save_path(); if ( $m4is_k_4n == false ) { $m4is_fzalfr[] = 'The session path is not set in your server PHP configuration.'; $m4is_l926[] = 'Your PHP installation is misconfigured and does not have a session path set.  Please fix the configuration, or switch to database backed sessions.'; } else { if ( ! file_exists( $m4is_k_4n ) ) { $m4is_fzalfr[] = sprintf( 'The session directory does not exist.  Please create the "<strong>%s</strong>" directory and make sure your website can write to it', $m4is_k_4n ); $m4is_l926[] = 'Your PHP installation is misconfigured and points to a non-existent directory.  Please fix the configuration, create the directory, or switch to database backed sessions.'; } elseif ( ! is_writeable( $m4is_k_4n ) ) { $m4is_fzalfr[] = sprintf( 'The session directory  "<strong>%s</strong>" exists, but is not writeable.', $m4is_k_4n ); $m4is_l926[] = 'The read/write permissions of your PHP session directory prevent your webserver from writing to it. Please fix the directory permissions, or switch to database backed sessions.'; } } if ( count( $m4is_fzalfr ) ) { $m4is_uhe6wj = ''; foreach ( $m4is_fzalfr as $m4is_a6g9qj ) { $m4is_uhe6wj .= '<p>' . $m4is_a6g9qj . '</p>'; } foreach ( $m4is_l926 as $m4is_edow ) { $m4is_fyci8 .= '<p>' . $m4is_edow . '</p>'; } $m4is_n_bp6 = [ 'actions' => $m4is_fyci8, 'description' => "<p>There appears to be a problem with your Website Session Storage.</p>" . $m4is_uhe6wj, 'label' => 'PHP Session Storage', 'status' => 'critical', 'test' => 'wpal_memberium_session_storage', 'badge' => [ 'label' => __('Server'), 'color' => 'red', ], ]; } return $m4is_n_bp6; } static 
function m4is_wydp0t() : array { $m4is_ay7a = array_filter( explode( ',', self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'ignore_contact_fields' ) ) ); $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field', 'Password' ); $m4is_n_bp6 = []; $m4is_l926 = []; if ( in_array( $m4is_jyx_t, $m4is_ay7a ) ) { $m4is_l926[] = sprintf( '<p>You need to unblock the <em>%s</em> field from being synced with your CRM, or choose a different password field.</p>', $m4is_jyx_t ); $m4is_l926[] = sprintf( '<p>Password field settings are <strong><a href="%s">here</a></strong>.</p>', admin_url( 'admin.php?page=memberium-options' ) ); $m4is_l926[] = sprintf( '<p>Blocked field settings are <strong><a href="%s">here</a></strong>.</p>', admin_url( 'admin.php?page=memberium-sync-options&tab=contactfields' ) ); $m4is_l926[] = '<p></p>'; $m4is_n_bp6 = [ 'actions' => implode( "\n", $m4is_l926 ), 'description' => "<p>The CRM field you are using to store the password has been blocked from syncing.  This may cause problems with the password being generated or updated.</p>", 'label' => 'Memberium Password Field Sync Blocked', 'status' => 'critical', 'test' => 'wpal_memberium_password_blocked', 'badge' => [ 'label' => __('Server'), 'color' => 'red', ], ]; } return $m4is_n_bp6; }         }
