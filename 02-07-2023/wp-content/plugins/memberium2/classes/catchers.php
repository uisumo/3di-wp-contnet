<?php
/**
 * Copyright (c) 2012-2019 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 class_exists('m4is_emz57o') || die(); m4is_ek6hn::m4is_gopgz(); final 
class m4is_ek6hn { private static $m4is_bxv7u, $m4is_q7m2, $m4is_cpwjsn, $m4is_gwtb03, $m4is_uuzl0e, $m4is_ahusy0; static 
function m4is_gopgz() { self::$m4is_bxv7u = memberium_app(); self::$m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x( 'appname' ); self::$m4is_cpwjsn = m4is_pcys::m4is_a6x52r(); self::$m4is_gwtb03 = self::$m4is_bxv7u->m4is_wnlbj_(); self::$m4is_uuzl0e = ! m4is_o5aoir::m4is_du5icq(); self::$m4is_ahusy0 = 'memberium'; } static 
function m4is_gtm57() { if ( self::$m4is_uuzl0e) { return; } m4is_d8yr0_::m4is_vsv0mr(); if ( ! wp_verify_nonce( $_POST['_wpnonce'], 'place_order_button-' . $_POST['form_id'] ) ) { wp_die( 'Security Check Failed - Nonce Validation Error' ); } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['digital_signature'], $_POST['order_settings'] ) ) { wp_die( 'Security Check Failed - Signature Validation Error' ); } $m4is_aicfp = (int) self::$m4is_bxv7u->m4is_w47qdy(); $m4is__iftk = (int) $_POST['form_id']; $m4is_y0gcr4 = unserialize( base64_decode( $_POST['order_settings'] ) ); $m4is_zcyj = self::$m4is_bxv7u->m4is_e39uf( $m4is_y0gcr4 ); if ( $m4is_zcyj ) { if ( $m4is_y0gcr4['success_url'] > '' ) { $m4is_pizyx = $m4is_y0gcr4['success_url']; } } else { if ( $m4is_y0gcr4['fail_url'] > '' ) { $m4is_pizyx = $m4is_y0gcr4['fail_url']; } } self::$m4is_bxv7u->m4is_qjrxkl( $m4is_aicfp ); self::$m4is_bxv7u->m4is_l41p7r( $m4is_aicfp ); if ( $m4is_pizyx > '' ) { m4is_d8yr0_::m4is_okts(); wp_redirect( $m4is_pizyx, 302, 'Memberium - Order Catcher' ); exit; } } static 
function m4is_cngf() { if ( self::$m4is_uuzl0e) { return; } if ( ! self::$m4is_bxv7u->m4is_w47qdy() ) { return; } $m4is_y0i2 = 'memb_actionset_button'; m4is_d8yr0_::m4is_vsv0mr(); if ( ! wp_verify_nonce( $_POST['_wpnonce'], 'memb_actionset_' . $_POST['form_id'] ) ) { wp_die( _x( 'Security Check Failed - Nonce Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['signature'], $_POST['action'] ) ) { wp_die( _x( 'Security Check Failed - Signature Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); } $m4is_edow = unserialize( base64_decode( $_POST['action'] ) ); $m4is_aicfp = isset( $m4is_edow['contact_id'] ) ? $m4is_edow['contact_id'] : self::$m4is_bxv7u->m4is_w47qdy(); $m4is__iftk = isset( $_POST['form_id'] ) ? (int) $_POST['form_id'] : 0; $m4is_cmat = isset( $_POST['order_id'] ) ? (int) $_POST['order_id'] : 0; $m4is_pizyx = isset( $m4is_edow['redirect'] ) ? $m4is_edow['redirect'] : ''; if ( empty( $m4is_pizyx ) ) { $m4is_pizyx = isset( $_SERVER['HTTP_REFERER'] ) ? $_SERVER['HTTP_REFERER'] : $_SERVER['REQUEST_URI']; } if ( $m4is_aicfp > 0 ) { self::$m4is_bxv7u->m4is_qv5mn( $m4is_edow['tokens'] ); self::$m4is_bxv7u->m4is_qrlqb6( $m4is_edow['fus'], $m4is_aicfp ); self::$m4is_bxv7u->m4is_rctzo( $m4is_edow['goals'], $m4is_aicfp ); self::$m4is_bxv7u->m4is__mkz( $m4is_edow['tags'], $m4is_aicfp ); self::$m4is_bxv7u->m4is_evrbh( $m4is_edow['action_id'], $m4is_aicfp) ; } $m4is_w5ky4q = [ 'action_id' => $m4is_edow['action_id'], 'contact_id' => $m4is_edow['contact_id'], 'fus' => $m4is_edow['fus'], 'goals' => $m4is_edow['goals'], 'tags' => $m4is_edow['tags'], 'redirect' => $m4is_pizyx, ]; do_action( 'memberium/actionset_button/clicked', $m4is_w5ky4q ); if ( $m4is_edow['debug'] ) { echo '<pre>'; echo __LINE__, " - Set ActionSet = {$m4is_edow['action_id']}<br />"; echo __LINE__, " - Set ContactId = {$m4is_edow['contact_id']}<br />"; echo __LINE__, " - Set FUS       = {$m4is_edow['fus']}<br />"; echo __LINE__, " - Set Goals     = {$m4is_edow['goals']}<br />"; echo __LINE__, " - Set Tags      = {$m4is_edow['tags']}<br />"; echo __LINE__, " - Set Tokens    = {$m4is_edow['tokens']}<br />"; echo __LINE__, " - Set Redirect  = {$m4is_pizyx}<br />"; echo '</pre>'; echo '<a href="', $m4is_pizyx, '">', _x('Continue...', $m4is_y0i2, self::$m4is_ahusy0 ), '</a>'; exit; } if ( $m4is_pizyx > '' ) { m4is_d8yr0_::m4is_okts(); wp_redirect( $m4is_pizyx, 302, 'Memberium Actionset Button' ); exit; } } static 
function m4is_iwd9() { if ( empty( $_FILES['uploadedfiles'] ) ) { return; } m4is_d8yr0_::m4is_vsv0mr(); $m4is_y0i2 = 'memb_filebox_upload'; $m4is_bxv7u = memberium_app(); if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['signature'], $_POST['params'] ) ) { wp_die( _x( 'Security Check Failed - Signature Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); exit; } $m4is_rxc9n1 = unserialize( base64_decode( $_POST['params'] ) ); $m4is_aicfp = (int) $m4is_rxc9n1['contact_id']; $m4is_bvl06 = $m4is_rxc9n1['rename']; $m4is_ufg13 = count( $_FILES['uploadedfiles']['name'] ); $m4is_fa195d = 0; $m4is_oeh9j0 = ''; $m4is_npwiyu = []; for ( $m4is_ll9yd5 = 0; $m4is_ll9yd5 < $m4is_ufg13; $m4is_ll9yd5++ ) { $m4is_ho0w2 = $_FILES['uploadedfiles']['name'][$m4is_ll9yd5]; $m4is_j1vz = $_FILES['uploadedfiles']['type'][$m4is_ll9yd5]; $m4is_pcqn = $_FILES['uploadedfiles']['tmp_name'][$m4is_ll9yd5]; $m4is_a6g9qj = $_FILES['uploadedfiles']['error'][$m4is_ll9yd5]; $m4is_rd185_ = $_FILES['uploadedfiles']['size'][$m4is_ll9yd5]; if ( $m4is_rd185_ > $m4is_rxc9n1['maxsize'] || $m4is_a6g9qj == 2 ) { $m4is_fa195d++; $m4is_oeh9j0 .= sprintf( '<p class="filebox_upload_error">File size of "%s" exceeded the %s limit.</p>', $m4is_ho0w2, size_format( $m4is_rxc9n1['maxsize'] ) ); continue; } if (! empty($m4is_a6g9qj) ) { $m4is_fa195d++; $m4is_oeh9j0 .= sprintf( '<p class="filebox_upload_error">Upload of %s failed (%s).</p>', $m4is_ho0w2, $m4is_a6g9qj ); continue; } $m4is_npwiyu[] = [ 'name' => $m4is_ho0w2, 'type' => $m4is_j1vz, 'size' => $m4is_rd185_, 'error' => $m4is_a6g9qj, 'tmp_name' => $m4is_pcqn, ]; } if ($m4is_rxc9n1['no_errors'] && $m4is_fa195d) { $m4is_oeh9j0 .= '<p class="filebox_upload_error">Some uploads failed.  No files saved.</p>'; $m4is_fa195d++; } else { foreach($m4is_npwiyu as $m4is_qfup8) {  if (! empty($m4is_bvl06) ) { $m4is_qfup8['name'] = $m4is_bvl06 . '.' . pathinfo( $m4is_qfup8['name'], PATHINFO_EXTENSION ); }  $m4is_pz6p17 = base64_encode( file_get_contents( $m4is_qfup8['tmp_name'] ) ); $m4is_n_bp6 = self::$m4is_gwtb03->uploadFile( $m4is_qfup8['name'], $m4is_pz6p17, $m4is_aicfp ); if ( $m4is_n_bp6 < 1 ) { $m4is_oeh9j0 .= substr( $m4is_n_bp6, strpos($m4is_n_bp6, ']') + 1, -1 ) . ' for ' . $m4is_qfup8['name']; } unset($m4is_pz6p17); unlink($m4is_qfup8['tmp_name']); if (! (int) $m4is_n_bp6) { $m4is_fa195d++; } } $m4is_t7i0bz = m4is_wdzu::m4is_epld( $m4is_aicfp, self::$m4is_q7m2 ); delete_transient($m4is_t7i0bz); } $m4is_ap3_ = 'memberium::file_upload_msg::' . get_current_user_id(); if ( $m4is_fa195d ) {   $m4is_n_bp6 = set_transient( $m4is_ap3_, $m4is_oeh9j0, 3600 ); self::$m4is_cpwjsn->m4is_es90( $m4is_oeh9j0 ); self::$m4is_bxv7u->m4is_rctzo( $m4is_rxc9n1['failure_goals'], $m4is_aicfp ); self::$m4is_bxv7u->m4is_evrbh( $m4is_rxc9n1['failure_actionsets'], $m4is_aicfp ); self::$m4is_bxv7u->m4is__mkz( $m4is_rxc9n1['failure_tags'], $m4is_aicfp ); if ( ! empty( $m4is_rxc9n1['failure_url'] ) ) { wp_redirect( $m4is_rxc9n1['failure_url'], 302 ); die(); } } else {   $m4is_n_bp6 = set_transient( $m4is_ap3_, $m4is_rxc9n1['success_msg'], 3600 ); self::$m4is_cpwjsn->m4is_es90( $m4is_rxc9n1['success_msg'] ); self::$m4is_bxv7u->m4is_rctzo( $m4is_rxc9n1['success_goals'], $m4is_aicfp ); self::$m4is_bxv7u->m4is_evrbh( $m4is_rxc9n1['success_actionsets'], $m4is_aicfp ); self::$m4is_bxv7u->m4is__mkz( $m4is_rxc9n1['success_tags'], $m4is_aicfp ); if ( ! empty( $m4is_rxc9n1['success_url'] ) ) { wp_redirect( $m4is_rxc9n1['success_url'], 302 ); die(); } } } static 
function m4is_bwget_() { m4is_d8yr0_::m4is_vsv0mr(); $m4is__iftk = $_POST['form_id']; if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_placeorder_' . $m4is__iftk) ) { wp_die( 'Security Check Failed - Nonce Validation Error' ); } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['digital_signature'], $_POST['params'] ) ) { wp_die( 'Security Check Failed - Signature Validation Error' ); } $m4is_oqzu1 = unserialize( base64_decode( $_POST['params'] ) ); if ( empty( $m4is_oqzu1['lead_affiliate_id'] ) || empty( $m4is_oqzu1['sale_affiliate_id'] ) ) {  $m4is_u13x = 'Invoice'; $m4is_kbu63_ = [ 'AffiliateId', 'LeadAffiliateId' ]; $m4is_kc1q = [ 'ContactId' => (int) $m4is_oqzu1['contact_id'] ]; $m4is_lvnith = 'Id'; $m4is_hjx4 = false; $m4is_w1agy = m4is_f84s3h::m4is_l2n5pg( $m4is_u13x, 1, 0, $m4is_kc1q, $m4is_kbu63_, $m4is_lvnith, $m4is_hjx4 ); if ( count( $m4is_w1agy ) ) { if ( empty( $m4is_oqzu1['lead_affiliate_id'] ) ) { $m4is_oqzu1['lead_affiliate_id'] = isset( $invoice[0]['LeadAffiliateId'] ) ? $invoice[0]['LeadAffiliateId'] : 0; } if (empty($m4is_oqzu1['sale_affiliate_id']) ) { $m4is_oqzu1['sale_affiliate_id'] = isset( $invoice[0]['AffiliateId'] ) ? $invoice[0]['AffiliateId'] : 0; } } } $m4is_rprd_t = self::$m4is_gwtb03->placeOrder( (int) $m4is_oqzu1['contact_id'], (int) $m4is_oqzu1['creditcard_id'], (int) $m4is_oqzu1['payplan_id'], (array) $m4is_oqzu1['product_ids'], (array) $m4is_oqzu1['subscription_ids'], (bool) $m4is_oqzu1['process_specials'], (array) $m4is_oqzu1['promo_codes'], (int) $m4is_oqzu1['lead_affiliate_id'], (int) $m4is_oqzu1['sale_affiliate_id'] );  $m4is_zcyj = (int) $m4is_rprd_t['InvoiceId']; $m4is_ccru2k = (int) $m4is_rprd_t['OrderId']; if ( $m4is_rprd_t['Successful'] == 'true' ) { $m4is_zhk7 = $m4is_oqzu1['success_actionset']; $m4is_qw8dk = $m4is_oqzu1['success_goal']; $m4is_w9feq2 = $m4is_oqzu1['success_tag']; $m4is__mto = $m4is_oqzu1['success_url']; if ( ! empty( $m4is_oqzu1['order_title'] ) ) { m4is_f84s3h::m4is_go6re( 'Job', $m4is_ccru2k, ['JobTitle' => $m4is_oqzu1['order_title']] ); } } else { $m4is_zhk7 = $m4is_oqzu1['failure_actionset']; $m4is_qw8dk = $m4is_oqzu1['failure_goal']; $m4is_w9feq2 = $m4is_oqzu1['failure_tag']; $m4is__mto = $m4is_oqzu1['failure_url']; if ( $m4is_oqzu1['delete_failed'] ) { self::$m4is_gwtb03->deleteInvoice( $m4is_zcyj ); if ( ! empty( $m4is_oqzu1['subscription_ids'] ) ) { m4is_vvgc8::m4is_vzxm9q( $m4is_ccru2k ); } } } self::$m4is_bxv7u->m4is_i1wc( $m4is_oqzu1['contact_id'], $m4is_w9feq2, $m4is_zhk7, $m4is_qw8dk ); if ( ! empty( $m4is__mto ) ) { m4is_d8yr0_::m4is_okts(); $m4is_rxc9n1 = [ 'orderId' => rawurlencode( $m4is_ccru2k ), 'invoiceId' => rawurlencode( $m4is_zcyj ), ]; $m4is__mto = add_query_arg( $m4is_rxc9n1, $m4is__mto ); wp_redirect( $m4is__mto, 302 ); exit; } } static 
function m4is__q1mxb() {  $m4is_y0i2 = 'memb_resetfeedurl_button'; m4is_d8yr0_::m4is_vsv0mr(); if ( ! wp_verify_nonce( $_POST['_wpnonce'], 'memb_resetfeedurl_' . $_POST['form_id'] ) ) { wp_die( _x('Security Check Failed - Nonce Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); exit; } m4is_xon4yh::m4is_osy_17(); return; } static 
function m4is_ou3wp_() { if ( self::$m4is_uuzl0e) { return; } if (! self::$m4is_bxv7u->m4is_w47qdy() ) { return; } m4is_d8yr0_::m4is_vsv0mr(); $m4is_y0i2 = 'memb_list_subscriptions'; $m4is_dn09xt = unserialize( base64_decode( $_POST['parameters'] ) ); if ( ! wp_verify_nonce( $_POST['_wpnonce'], 'memb_cancelsubscription_' . $m4is_dn09xt['recurringorder_id'] ) ) { wp_die( _x( 'Security Check Failed - Nonce Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); exit; } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['signature'], $_POST['parameters'] ) ) { wp_die( _x( 'Security Check Failed - Signature Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); exit; } $m4is_aicfp = self::$m4is_bxv7u->m4is_w47qdy(); $m4is_wmzqp = self::$m4is_bxv7u->m4is_mmdrl(); $m4is_a6vo = (int) $m4is_dn09xt['recurringorder_id']; $m4is_vcfm8 = (int) $m4is_dn09xt['subscriptionplan_id']; $m4is_sebzfh = (bool) $m4is_dn09xt['immediate']; $m4is_cvr53 = $m4is_dn09xt['cancel_text']; $m4is_l926 = isset( $m4is_wmzqp['ecommerce']['actions'][$m4is_vcfm8] ) ? $m4is_wmzqp['ecommerce']['actions'][$m4is_vcfm8] : []; $m4is_tci0 = isset( $m4is_l926['cancel_action'] ) ? $m4is_l926['cancel_action'] : 0; $m4is_ts5qpx = isset( $m4is_l926['cancel_goal'] ) ? $m4is_l926['cancel_goal'] : ''; $m4is_d36l0 = isset( $m4is_l926['end_action'] ) ? $m4is_l926['end_action'] : 0; $m4is_zv9_o = isset( $m4is_l926['end_goal'] ) ? $m4is_l926['end_goal'] : ''; $m4is_y_zsb = date( 'Ymd' ); $m4is_tjumdy = date( 'Ymd', strtotime( $m4is_dn09xt['next_bill_date'] . ' - 1 day' ) ); $m4is_v8om = $m4is_sebzfh ? $m4is_y_zsb : $m4is_tjumdy;  $m4is_ncgn = [ 'AutoCharge' => 0, 'ReasonStopped' => sprintf( _x( 'Cancelled through Memberium on %s.  Old End Date: %s, New End Date: %s', $m4is_y0i2, self::$m4is_ahusy0 ), date( 'Y-m-d' ), $m4is_tjumdy, $m4is_v8om ), 'EndDate' => $m4is_v8om . 'T23:59:59', ]; if ( $m4is_v8om <= $m4is_y_zsb ) { $m4is_ncgn['Status'] = 'Inactive'; } $m4is_n_bp6 = m4is_f84s3h::m4is_go6re( 'RecurringOrder', $m4is_a6vo, $m4is_ncgn );  if ( $m4is_tci0 > 0 ) { m4is_f84s3h::m4is_ot30uq( $m4is_aicfp, (int) $m4is_tci0 ); } if ( $m4is_ts5qpx > '' ) { m4is_f84s3h::m4is_zox_z5( $m4is_aicfp, $m4is_ts5qpx, self::$m4is_q7m2 ); }  if ( $m4is_d36l0 > 0 || $m4is_zv9_o > '' ) { $m4is_j0n7 = [ 'recurringorder_id' => $m4is_a6vo, 'end_action' => $m4is_d36l0, 'end_goal' => $m4is_zv9_o, ]; if ( $m4is_d36l0 > 0 ) { self::$m4is_bxv7u->m4is__th3u( 'actionset', $m4is_tjumdy, $m4is_j0n7 ); } if ( $m4is_zv9_o > '' ) { self::$m4is_bxv7u->m4is__th3u( 'achievegoal', $m4is_tjumdy, $m4is_j0n7 ); } }  self::$m4is_bxv7u->m4is_w1e0wk( $m4is_aicfp ); $m4is_uke5g = self::$m4is_bxv7u->m4is_u6sg( $m4is_aicfp, true ); $m4is_uoc8 = [ 'action' => 'Cancel', 'subscription_id' => $m4is_a6vo, 'end_date' => date( 'Y-m-d', strtotime( $m4is_tjumdy ) ), 'future_expiry' => date( 'Ymd' ) <= $m4is_v8om ? 0 : 1, ]; $m4is__mto = add_query_arg( $m4is_uoc8, $_SERVER['REQUEST_URI'] ); m4is_d8yr0_::m4is_okts(); wp_redirect( $m4is__mto ); exit; } static 
function m4is_dwvrhl() { if ( self::$m4is_uuzl0e) { return; } if ( ! self::$m4is_bxv7u->m4is_w47qdy() ) { return; } m4is_d8yr0_::m4is_vsv0mr(); $m4is_y0i2 = 'memb_add_creditcard';  if ( ! wp_verify_nonce( $_POST['_wpnonce'], 'creditcard_add_' . $_POST['form_id'] ) ) { wp_die( _x( 'Security Check Failed - Nonce Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['signature'], $_POST['parameters'] ) ) { wp_die( _x( 'Security Check Failed - Signature Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); } $m4is_qwab = true; $m4is_fbn3 = false; $m4is__iftk = (int) $_POST['form_id']; $m4is_dn09xt = unserialize( base64_decode( $_POST['parameters'] ) ); $m4is_iryl1 = (bool) $m4is_dn09xt['backcharge']; $m4is__dxr0 = (int) $m4is_dn09xt['creditcard_id']; $m4is_zh_r = array_filter( explode( ',', $m4is_dn09xt['plan_ids'] ) ); $m4is_dx1afq = (bool) $m4is_dn09xt['set_default']; $m4is_aicfp = (int) $m4is_dn09xt['contact_id'];  $m4is_rs7v = trim( $m4is_dn09xt['successurl'] ); $m4is_k2gqvf = trim( $m4is_dn09xt['failureurl'] ); $m4is_pizyx = $m4is_k2gqvf; $m4is_adiq = (bool) $m4is_dn09xt['debug']; $m4is_fsavg = $m4is_dn09xt['debug_ip'] === m4is_lr56w2::m4is_nnbp(); if ( $m4is_aicfp < 1 ) { $m4is_qwab = false; $_SESSION['flash']['add_creditcard'] = _x( 'Invalid User ID', $m4is_y0i2, self::$m4is_ahusy0 ); } $_SESSION['flash']['add_creditcard'] = $m4is_dn09xt['success_msg'];  if ( empty( $_POST['cardtype']) && ! empty( $_POST['cc-number'] ) ) { $_POST['cardtype'] = m4is_mk38::m4is_hs_f5( $_POST['cc-number'] ); }  $m4is_kbu63_ = [ 'city', 'country', 'firstname', 'lastname', 'nameoncard', 'state', 'streetaddress1', 'streetaddress2', ]; foreach($_POST as $m4is_ap3_ => $m4is_rhfd) { $_POST[$m4is_ap3_] = stripslashes( $m4is_rhfd ); }   if ( ! $m4is__dxr0 ) { $m4is_b9nqt = [ 'cardtype', 'cc-number', 'city', 'country', 'cvv2', 'expirationmonth', 'expirationyear', 'nameoncard', 'phonenumber', 'streetaddress1', ]; } else { $m4is_b9nqt = [ 'city', 'country', 'cvv2', 'expirationmonth', 'expirationyear', 'nameoncard', 'phonenumber', 'streetaddress1', ]; } if ( is_array( $m4is_b9nqt ) ) { foreach ($m4is_b9nqt as $m4is_tenvhx) { if ( empty( $_POST[$m4is_tenvhx] ) || trim( $_POST[$m4is_tenvhx] ) == '') { $_SESSION['flash']['add_creditcard'] = _x( 'You need to fill out all required fields.', $m4is_y0i2, self::$m4is_ahusy0 ); $m4is_qwab = false; break; } } }  if ( $m4is_qwab ) { if ( ( date( 'Ym' ) > ( $_POST['expirationyear'] . $_POST['expirationmonth'] ) ) ) { $_SESSION['flash']['add_creditcard'] = _x( 'The credit card is expired.', $m4is_y0i2, self::$m4is_ahusy0 ); $m4is_qwab = false; } }  if ( $m4is__dxr0 == 0 ) { if ( $m4is_qwab ) { if ( ! m4is_mk38::m4is_tzba0p( $_POST['cc-number'] ) ){ $_SESSION['flash']['add_creditcard'] = _x( 'The credit card number is invalid.', 'memb_add_creditcard', self::$m4is_ahusy0 ); $m4is_qwab = false; } } }  if ( isset( $_POST['cc-number'] ) && $m4is_qwab ) { $m4is_weixn5 = substr( $_POST['cc-number'], -4 ); $alt_card_id = self::$m4is_gwtb03->locateCard( $m4is_aicfp, $m4is_weixn5 ); if ( $alt_card_id > 0 ) { $m4is_c7_g = m4is_s3nu::m4is_or9mj( $m4is_aicfp ); if ( isset( $m4is_c7_g[$alt_card_id] ) ) { $m4is__dxr0 = (int) $alt_card_id; } } } if ( $m4is_qwab ) { if ( $m4is__dxr0 == 0 ) { $m4is_yi1y = [ 'ContactId' => $m4is_aicfp, 'BillName' => wp_strip_all_tags( $_POST['nameoncard'] ), 'BillAddress1' => wp_strip_all_tags( $_POST['streetaddress1'] ), 'BillAddress2' => wp_strip_all_tags( $_POST['streetaddress2'] ), 'BillCity' => wp_strip_all_tags( $_POST['city'] ), 'BillCountry' => wp_strip_all_tags( $_POST['country'] ), 'BillState' => wp_strip_all_tags( $_POST['state'] ), 'BillZip' => wp_strip_all_tags( $_POST['postalcode'] ), 'CardNumber' => wp_strip_all_tags( $_POST['cc-number'] ), 'CardType' => wp_strip_all_tags( $_POST['cardtype'] ), 'CVV2' => (string) $_POST['cvv2'],  'FirstName' => m4is_lpl4d::m4is_bfi49( 'firstname' ), 'LastName' => m4is_lpl4d::m4is_bfi49( 'lastname' ), 'ExpirationMonth' => wp_strip_all_tags( $_POST['expirationmonth'] ), 'ExpirationYear' => wp_strip_all_tags( $_POST['expirationyear'] ), 'NameOnCard' => wp_strip_all_tags( $_POST['nameoncard'] ), 'Email' => strtolower( m4is_lpl4d::m4is_bfi49( 'email' ) ), 'PhoneNumber' => wp_strip_all_tags($_POST['phonenumber']), 'ShipAddress1' => m4is_lpl4d::m4is_bfi49( 'address2street1' ), 'ShipAddress2' => m4is_lpl4d::m4is_bfi49( 'address2street2' ), 'ShipCity' => m4is_lpl4d::m4is_bfi49( 'city2' ), 'ShipCompanyName' => m4is_lpl4d::m4is_bfi49( 'company' ), 'ShipCountry' => m4is_lpl4d::m4is_bfi49( 'country2' ), 'ShipFirstName' => m4is_lpl4d::m4is_bfi49( 'firstname' ), 'ShipLastName' => m4is_lpl4d::m4is_bfi49( 'lastname' ), 'ShipMiddleName' => '', 'ShipName' => wp_strip_all_tags( $_POST['nameoncard'] ), 'ShipPhoneNumber' => wp_strip_all_tags( $_POST['phonenumber'] ), 'ShipState' => m4is_lpl4d::m4is_bfi49( 'state2' ), 'ShipZip' => m4is_lpl4d::m4is_bfi49( 'postalcode2' ), ]; $m4is__dxr0 = m4is_f84s3h::m4is_y3qvg( 'CreditCard', $m4is_yi1y ); if ( $m4is__dxr0 > 0 ) { $m4is_fbn3 = true; } } else { $m4is_s1r2_l = [ 'BillName' => wp_strip_all_tags( $_POST['nameoncard']), 'BillAddress1' => wp_strip_all_tags( $_POST['streetaddress1']), 'BillAddress2' => wp_strip_all_tags( $_POST['streetaddress2']), 'BillCity' => wp_strip_all_tags( $_POST['city']), 'BillCountry' => wp_strip_all_tags( $_POST['country']), 'BillState' => wp_strip_all_tags( $_POST['state'] ), 'BillZip' => wp_strip_all_tags( $_POST['postalcode'] ), 'ExpirationMonth' => wp_strip_all_tags( $_POST['expirationmonth'] ), 'ExpirationYear' => wp_strip_all_tags( $_POST['expirationyear'] ), 'NameOnCard' => wp_strip_all_tags( $_POST['nameoncard'] ), 'PhoneNumber' => wp_strip_all_tags( $_POST['phonenumber'] ), 'ShipName' => wp_strip_all_tags( $_POST['nameoncard'] ), 'ShipPhoneNumber' => wp_strip_all_tags( $_POST['phonenumber'] ), 'CVV2' => (string) trim( $_POST['cvv2'] ), 'Email' => strtolower( m4is_lpl4d::m4is_bfi49( 'email' ) ), 'FirstName' => m4is_lpl4d::m4is_bfi49( 'firstname' ), 'LastName' => m4is_lpl4d::m4is_bfi49( 'lastname' ), 'ShipAddress1' => m4is_lpl4d::m4is_bfi49( 'address2street1' ), 'ShipAddress2' => m4is_lpl4d::m4is_bfi49( 'address2street2' ), 'ShipCity' => m4is_lpl4d::m4is_bfi49( 'city2' ), 'ShipCompanyName' => m4is_lpl4d::m4is_bfi49( 'company' ), 'ShipCountry' => m4is_lpl4d::m4is_bfi49( 'country2' ), 'ShipFirstName' => m4is_lpl4d::m4is_bfi49( 'firstname' ), 'ShipLastName' => m4is_lpl4d::m4is_bfi49( 'lastname' ), 'ShipState' => m4is_lpl4d::m4is_bfi49( 'state2' ), 'ShipZip' => m4is_lpl4d::m4is_bfi49( 'postalcode2' ), 'MaestroIssueNumber' => '', 'ShipMiddleName' => '', ]; $m4is__dxr0 = (int) m4is_f84s3h::m4is_go6re( 'CreditCard', (int) $m4is__dxr0, $m4is_s1r2_l ); $m4is_fbn3 = (bool) ( $m4is__dxr0 > 0 ); } if ( $m4is__dxr0 > 0 ) { self::$m4is_gwtb03->validateCard( (int) $m4is__dxr0); } delete_transient( m4is_s3nu::m4is_cd2zws( $m4is_aicfp, self::$m4is_q7m2 ) ); if ( $m4is__dxr0 ) {  if ( $m4is_dx1afq ) { $m4is_hkp7s = [ 'AutoCharge', 'CC1', 'ContactId', 'Id', 'MerchantAccountId', 'OriginatingOrderId', 'Status', 'SubscriptionPlanId', ]; $m4is_kc1q = [ 'ContactId' => $m4is_aicfp,   ]; $m4is_qqzo = 1000; $m4is_zvxijt = 0; $m4is_jpzyit = m4is_f84s3h::m4is_l2n5pg( 'RecurringOrder', $m4is_qqzo, $m4is_zvxijt, $m4is_kc1q, $m4is_hkp7s, 'Id', false ); $m4is_y9la = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'merchant_account_id' ); foreach( $m4is_jpzyit as $m4is_wo7c93 ) { if ( empty( $m4is_zh_r ) || in_array( $m4is_wo7c93['SubscriptionPlanId'], $m4is_zh_r ) ) { $m4is_i1kh[$m4is_wo7c93['Id']] = [ 'CC1' => isset( $m4is_wo7c93['CC1'] ) ? $m4is_wo7c93['CC1'] : 0, 'Id' => isset( $m4is_wo7c93['Id'] ) ? $m4is_wo7c93['Id'] : 0, 'MerchantAccountId' => empty( $m4is_wo7c93['MerchantAccountId'] ) ? $m4is_y9la : $m4is_wo7c93['MerchantAccountId'], 'OriginatingOrderId' => isset( $m4is_wo7c93['OriginatingOrderId'] ) ? $m4is_wo7c93['OriginatingOrderId'] : 0, 'Status' => isset( $m4is_wo7c93['Status'] ) ? $m4is_wo7c93['Status'] : 0, 'ContactId' => isset( $m4is_wo7c93['ContactId'] ) ? $m4is_wo7c93['ContactId'] : 0, 'AutoCharge' => isset( $m4is_wo7c93['AutoCharge'] ) ? $m4is_wo7c93['AutoCharge'] : 0, ]; } } unset($m4is_jpzyit, $m4is_wo7c93);  if ( is_array( $m4is_i1kh ) ) { foreach ( $m4is_i1kh as $m4is_ap3_ => $m4is_jdcg48 ) { $m4is_ep1bq = false; $m4is_ep1bq = $m4is_ep1bq || $m4is_jdcg48['Status'] !== 'Active'; $m4is_ep1bq = $m4is_ep1bq || $m4is_jdcg48['CC1'] == $m4is__dxr0; if ( ! $m4is_ep1bq ) { $m4is_b40e_m = (int) $m4is_jdcg48['Id']; $m4is_ncgn = [ 'CC1' => (int) $m4is__dxr0, 'MerchantAccountId' => (int) $m4is_jdcg48['MerchantAccountId'],  'AutoCharge' => 1, ]; m4is_f84s3h::m4is_go6re( 'RecurringOrder', $m4is_b40e_m, $m4is_ncgn ); } } } unset($m4is_jdcg48, $m4is_ncgn, $m4is_hkp7s, $m4is_kc1q, $m4is_ap3_); }   if ( $m4is_iryl1 ) { if ( $m4is_fsavg ) echo 'Starting Backcharge<br>'; $m4is_y9la = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'merchant_account_id' ); $m4is_w1agy = self::$m4is_bxv7u->m4is_w1e0wk( $m4is_aicfp, false, true, true );  $m4is_yqjfs3 = is_array( $m4is_w1agy ) ? count( $m4is_w1agy ) : 0;  $m4is_hkp7s = [ 'Id', 'JobRecurringId', ]; $m4is_kc1q = [ 'ContactId' => (int) $m4is_aicfp, ]; $m4is_qqzo = 1000; $m4is_zvxijt = 0; $m4is_jpzyit = m4is_f84s3h::m4is_yt5p0l( 'Job', $m4is_qqzo, $m4is_zvxijt, $m4is_kc1q, $m4is_hkp7s ); $m4is_icdqo = []; if ( $m4is_adiq ) { error_log( 'Memberium Credit Card Update - found ' . count($m4is_w1agy) . ' orders' ); } foreach( $m4is_jpzyit as $m4is_wo7c93 ) { $m4is_icdqo[$m4is_wo7c93['Id']] = isset( $m4is_wo7c93['JobRecurringId'] ) ? $m4is_wo7c93['JobRecurringId'] : 0; } unset($m4is_jpzyit, $m4is_wo7c93); $m4is_cesjr = []; $m4is_kb4ky = count( $m4is_icdqo ); if ( $m4is_fsavg ) { echo "Parameters: <pre>", print_r( $m4is_dn09xt, true ), "</pre>"; echo "Default Merchant ID: {$m4is_y9la}<br>"; echo "Unpaid Invoices Found: {$m4is_yqjfs3}<br>"; echo "Unpaid Jobs Found: {$m4is_kb4ky}<br>"; echo "Invoices: <pre>", print_r( $m4is_w1agy, true ), "</pre>"; echo "Jobs: <pre>", print_r( $m4is_icdqo, true ), "</pre>"; } if ( $m4is_yqjfs3 ) { foreach( $m4is_w1agy as $m4is_ra9j4 ) { if ( $m4is_adiq ) { } if ( ( $m4is_ra9j4['TotalPaid'] < $m4is_ra9j4['TotalDue'] ) and ( $m4is_ra9j4['PayStatus'] == '0' ) and ( $m4is_ra9j4['TotalDue'] > 0 ) ) { $m4is_xvu2b = $m4is_ra9j4['Id']; $m4is_f65a4j = $m4is_ra9j4['JobId']; if ( isset( $m4is_icdqo[$m4is_f65a4j] ) ) { $m4is_icgsn = $m4is_icdqo[$m4is_f65a4j]; if ( ! empty( $m4is_i1kh[$m4is_icgsn] ) && $m4is_i1kh[$m4is_icgsn]['Status'] == 'Active' ) { $m4is_cesjr[$m4is_xvu2b] = [ 'invoice_id' => (int) $m4is_xvu2b, 'recurringorder_id' => (int) $m4is_icgsn, 'merchant_id' => $m4is_i1kh[$m4is_icgsn]['MerchantAccountId'] ? (int) $m4is_i1kh[$m4is_icgsn]['MerchantAccountId'] : 0, 'total_due' => $m4is_ra9j4['TotalDue'], ]; } elseif ( isset( $m4is_icdqo[$m4is_f65a4j] ) && $m4is_icdqo[$m4is_f65a4j] == 0) { $m4is_cesjr[$m4is_xvu2b] = [ 'invoice_id' => (int) $m4is_xvu2b, 'recurringorder_id' => 0, 'merchant_id' => $m4is_y9la, 'total_due' => $m4is_ra9j4['TotalDue'], ]; } } } } }  usort($m4is_cesjr, function($a, $b) { if ( $a['total_due'] > $b['total_due'] ) return -1; if ( $a['total_due'] < $b['total_due'] ) return 1; if ( $a['invoice_id'] < $b['invoice_id'] ) return -1; if ( $a['invoice_id'] > $b['invoice_id'] ) return 1; return 0; }); if ( $m4is_fsavg ) { echo "elv_invoices: <pre>", print_r( $m4is_w1agy, true ), "</pre>"; echo "elv_items: <pre>", print_r( $m4is_cesjr, true ), "</pre>"; }  foreach( $m4is_cesjr as $m4is_u7wr1f ) { if ( $m4is_u7wr1f['merchant_id'] ) { $m4is_n_bp6 = self::$m4is_gwtb03->chargeInvoice( $m4is_u7wr1f['invoice_id'], 'Updated Credit Card Back Charge', (int) $m4is__dxr0, $m4is_u7wr1f['merchant_id'], false ); if ( is_string( $m4is_n_bp6 ) ) { error_log( "Memberium (" . __LINE__ . ' ' . __FUNCTION__ . "):  Error Charging Invoice ID {$m4is_u7wr1f['invoice_id']} - {$m4is_n_bp6}" ); } } else { error_log( "Memberium (" . __LINE__ . ' ' . __FUNCTION__ . "):  Error Charging Invoice ID {$m4is_u7wr1f['invoice_id']} - No Merchant ID" ); } } }  } } if ($m4is_fbn3) { self::$m4is_bxv7u->m4is_evrbh( $m4is_dn09xt['action_ids'], $m4is_aicfp ); self::$m4is_bxv7u->m4is_rctzo( $m4is_dn09xt['goals'], $m4is_aicfp ); self::$m4is_bxv7u->m4is__mkz( $m4is_dn09xt['tag_ids'], $m4is_aicfp ); self::$m4is_bxv7u->m4is_l41p7r( $m4is_aicfp ); self::$m4is_bxv7u->m4is_qjrxkl( $m4is_aicfp ); m4is_s3nu::m4is_vpfcvg( $m4is_aicfp ); $m4is_pizyx = $m4is_rs7v; } else { $m4is_pizyx = $m4is_k2gqvf; } if (! empty( $m4is_pizyx ) ) { m4is_d8yr0_::m4is_okts(); wp_redirect( $m4is_pizyx ); exit; } } static 
function m4is_wonzb() { $m4is_y0i2 = 'memb_registration_form'; if ( ! wp_verify_nonce( $_POST['_wpnonce'], $_POST['params'] ) ) { wp_die( _x( 'Invalid Registration Submission', $m4is_y0i2, self::$m4is_ahusy0 ) ); } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['signature'], $_POST['params'] ) ) { wp_die( _x( 'Security Check Failed - Signature Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); } m4is_d8yr0_::m4is_vsv0mr(); global $wpdb;  $m4is_ay7a = [ '_wp_http_referer', '_wpnonce', 'memb_form_type', 'params', 'signature' ]; $m4is_a6g9qj = false; $m4is_r5xk = []; $m4is_cnc5 = false; $m4is_q1pw3c = true; $m4is_o2td = false; $m4is_lbtvz4 = []; $m4is_s2pm = false; $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field' ); $m4is_rumbl = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'min_password_length' ); $m4is_rz4ur = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'username_field' ); $m4is_qy0cg = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'local_auth_only' ); $m4is_pgsbl = apply_filters( 'memberium/registration_form/post/pre', $_POST ); $m4is_rxc9n1 = unserialize( base64_decode( $m4is_pgsbl['params'] ) ); $m4is_o1xs = array_filter( explode( ',', $m4is_rxc9n1['date_fields'] ) ); $m4is_b9nqt = array_filter( explode( ',', $m4is_rxc9n1['required_fields'] ) ); $m4is_azivab = ! $m4is_qy0cg; $m4is_dpe61k = $m4is_jyx_t . '_confirmation';  if ( $m4is_rxc9n1['remove_accents'] ) { foreach( $m4is_pgsbl as $m4is_e3k_mi=>$m4is_waxrhu ) { $m4is_pgsbl[$m4is_e3k_mi] = trim( remove_accents( $m4is_waxrhu ) ); } }  if ( ! isset( $m4is_pgsbl[$m4is_jyx_t] ) && ! isset( $m4is_pgsbl[$m4is_dpe61k] ) ) { $m4is_pgsbl[$m4is_dpe61k] = $m4is_pgsbl[$m4is_jyx_t] = self::$m4is_bxv7u->m4is_v8mw2u(); $m4is_azivab = true; $m4is_s2pm = true; }  if ( is_array( $m4is_b9nqt ) ) { foreach ( $m4is_b9nqt as $m4is_aue2i9 ) { if ( ! isset( $m4is_pgsbl[$m4is_aue2i9] ) ) { $m4is_q1pw3c = false; $m4is_a6g9qj = true; $m4is_r5xk[] = _x( 'You are missing required fields.', 'memb_registration_form', self::$m4is_ahusy0 ); } } }  if ( ! empty( $m4is_pgsbl[$m4is_jyx_t] ) && strlen( $m4is_pgsbl[$m4is_jyx_t]) < $m4is_rumbl ) { $m4is_a6g9qj = true; $m4is_r5xk[] = sprintf( _x( 'Your password must be at least %d characters long.', 'memb_registration_form', self::$m4is_ahusy0 ), $m4is_rumbl ); }  if ( strpos( $m4is_pgsbl[$m4is_jyx_t], '\\' ) !== false ) { $m4is_a6g9qj = true; $m4is_r5xk[] = _x( 'You may not use the backslash (\\) character in passwords.', 'memb_registration_form', self::$m4is_ahusy0 ); }  if ( is_array( $m4is_pgsbl ) ) { foreach ( $m4is_pgsbl as $m4is_ap3_ => $m4is_rhfd ) { $m4is_dfmw = $m4is_ap3_ . '_confirmation'; if ( isset( $m4is_pgsbl[$m4is_dfmw] ) && $m4is_pgsbl[$m4is_ap3_] <> $m4is_pgsbl[$m4is_dfmw] ) { $m4is_a6g9qj = true; $m4is_r5xk[] = _x( 'Your confirmed fields do not match.', 'memb_registration_form', self::$m4is_ahusy0 ); } } unset( $m4is_ap3_, $m4is_rhfd, $m4is_rk678 ); } $m4is_pgsbl[$m4is_rz4ur] = stripslashes( $m4is_pgsbl[$m4is_rz4ur] ); $m4is_cnc5 = self::m4is_o7kev4( $m4is_pgsbl[$m4is_rz4ur] );  if ( ! $m4is_cnc5 ) { $m4is_hkp7s = [ $m4is_jyx_t, 'Groups' ]; $m4is_kc1q = [ $m4is_rz4ur => $m4is_pgsbl[$m4is_rz4ur] ]; $m4is_mrnh7 = m4is_f84s3h::m4is_yt5p0l( 'Contact', 1000, 0, $m4is_kc1q, $m4is_hkp7s ); if ( is_array( $m4is_mrnh7 ) ) { foreach ( $m4is_mrnh7 as $m4is_nq7s ) { if ( ! empty( $m4is_nq7s[$m4is_jyx_t] ) ) { $m4is_cnc5 = true; } } } }  if ( ! $m4is_cnc5 && $m4is_rz4ur <> 'Email' && isset( $m4is_pgsbl['Email'] ) ) { $m4is_hkp7s = [ $m4is_jyx_t, 'Groups', 'Id', 'Email' ]; $m4is_kc1q = [ 'Email' => $m4is_pgsbl[$m4is_rz4ur] ]; $m4is_mrnh7 = m4is_f84s3h::m4is_yt5p0l( 'Contact', 1000, 0, $m4is_kc1q, $m4is_hkp7s ); if ( is_array( $m4is_mrnh7 ) ) { foreach ( $m4is_mrnh7 as $m4is_nq7s ) { if ( $m4is_nq7s[$m4is_jyx_t] > '' ) { $m4is_cnc5 = true; } }  } }  if ( $m4is_cnc5 ) { $m4is_a6g9qj = true; $m4is_r5xk[] = _x( 'That username is not available.', 'memb_registration_form', self::$m4is_ahusy0 ); }  if ( ! $m4is_a6g9qj && ! $m4is_cnc5 ) { if ( empty( $m4is_pgsbl[$m4is_jyx_t] ) ) { $m4is_pgsbl[$m4is_jyx_t] = self::$m4is_bxv7u->m4is_v8mw2u(); $m4is_s2pm = true; $m4is_azivab = true; } $m4is_vh_1bx = m4is_f84s3h::m4is_cm6nr('Contact', true); $m4is_nq7s = []; foreach ( $m4is_pgsbl as $m4is_ap3_ => $m4is_rhfd ) { if ( in_array( $m4is_ap3_, $m4is_o1xs ) ) { $m4is_rhfd = date( 'Ymd\Th:i:s', strtotime( $m4is_rhfd ) ); } if ( in_array( $m4is_ap3_, $m4is_vh_1bx ) ) { $m4is_nq7s[$m4is_ap3_] = $m4is_rhfd; } }  if ( $m4is_qy0cg == true && $m4is_azivab == false ) { unset( $m4is_nq7s[$m4is_jyx_t] ); } if ( $m4is_rxc9n1['pass_password'] == false ) { $m4is_ay7a[] = $m4is_jyx_t; $m4is_ay7a[] = $m4is_dpe61k; }  if ( is_array( $m4is_nq7s ) && ! empty( $m4is_nq7s ) && $m4is_rxc9n1['pass_fields'] ) { foreach ( $m4is_nq7s as $m4is_ap3_ => $m4is_rhfd ) { if ( ! in_array( $m4is_ap3_, $m4is_ay7a ) ) { $m4is_eg2e = ''; if ( $m4is_rxc9n1['inf_fields'] ) { $m4is_ap3_ = substr( $m4is_ap3_, 0, 1 ) == '_' ? 'inf_custom' . $m4is_ap3_ : 'inf_field_' . $m4is_ap3_; } $m4is_lbtvz4[$m4is_ap3_] = urlencode( $m4is_rhfd ); } } foreach ( $m4is_pgsbl as $m4is_ap3_ => $m4is_rhfd ) { if ( ! isset( $m4is_nq7s[$m4is_ap3_] ) ) { if ( ! in_array( $m4is_ap3_, $m4is_ay7a ) ) { $m4is_lbtvz4[$m4is_ap3_] = urlencode( $m4is_rhfd ); } } } }  if ( ! empty( $m4is_nq7s ) ) {  $m4is_aicfp = m4is_zbyh::m4is_dj3iv( $m4is_nq7s ); $m4is_kgtwp = _x( 'Membership Signup New User', 'memb_registration_form', self::$m4is_ahusy0 ); m4is_zbyh::m4is_pp0i( $m4is_aicfp, $m4is_nq7s ); $m4is_atkj4 = ['Email', 'EmailAddress2', 'EmailAddress3']; foreach( $m4is_atkj4 as $m4is_cdpe6a ) { if ( ! empty( $m4is_nq7s[$m4is_cdpe6a] ) ) { $m4is_nq7s[$m4is_cdpe6a] = sanitize_email( $m4is_nq7s[$m4is_cdpe6a] ); m4is_zbyh::m4is_kbc0w( $m4is_nq7s[$m4is_cdpe6a], $m4is_kgtwp ); } } if ( $m4is_aicfp ) { self::$m4is_bxv7u->m4is_rctzo( $m4is_rxc9n1['goal'], $m4is_aicfp ); self::$m4is_bxv7u->m4is__mkz( $m4is_rxc9n1['tagids'], $m4is_aicfp ); self::$m4is_bxv7u->m4is_evrbh( $m4is_rxc9n1['action_id'], $m4is_aicfp ); $rows = self::$m4is_bxv7u->m4is_qjrxkl( $m4is_aicfp ); $user_id = self::$m4is_bxv7u->m4is_jrjget( $m4is_aicfp, $m4is_pgsbl[$m4is_jyx_t] );  if ( $m4is_rxc9n1['autologin'] ) { $m4is_nzrv1 = get_user_by( 'id', $user_id ); $m4is_xpfcq = $m4is_nq7s[$m4is_rz4ur]; if ( ! empty( $m4is_rxc9n1['success_url'] ) ) { self::$m4is_cpwjsn->m4is_syn0_4( add_query_arg( $m4is_lbtvz4, $m4is_rxc9n1['success_url'] ) ); } wp_set_auth_cookie( $user_id ); wp_set_current_user( $user_id ); m4is_pewcid::m4is_e87ze( $m4is_xpfcq ); do_action( 'wp_login', $m4is_xpfcq, $m4is_nzrv1 ); self::$m4is_cpwjsn->m4is_z1x9( $m4is_nq7s, $user_id ); self::$m4is_cpwjsn->m4is_uzx3(); } } else { $m4is_a6g9qj = true; } } }  if ( $m4is_a6g9qj || $m4is_cnc5 ) { $m4is_pizyx = $m4is_rxc9n1['failure_url']; } else { $m4is_pizyx = $m4is_rxc9n1['success_url']; }  if ( ! empty( $m4is_r5xk ) ) { $_SESSION['error_message'] = $m4is_r5xk; }  if ( ! empty( $m4is_pizyx ) ) { m4is_d8yr0_::m4is_okts(); $m4is_pizyx = add_query_arg( $m4is_lbtvz4, $m4is_pizyx ) ; wp_redirect( $m4is_pizyx ); exit; } } static 
function m4is_xw9sip() { if ( ! m4is_o5aoir::m4is_du5icq() ) { return; } $m4is_bxv7u = memberium_app(); $m4is_gwtb03 = self::$m4is_bxv7u->m4is_wnlbj_(); $m4is_cpwjsn = m4is_pcys::m4is_a6x52r(); $m4is_qxtoe = base64_decode( $_POST['tag_id'] ); m4is_d8yr0_::m4is_vsv0mr(); if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['signature'], $_POST['template_id'] . $m4is_qxtoe ) ) { wp_die( _x( 'Security Check Failed - Signature Validation Error', 'memb_send_password', self::$m4is_ahusy0 ) ); exit; } self::$m4is_cpwjsn->m4is_w5v3i('There was an error Looking up that account.'); $m4is_qwab = true; $m4is__iftk = (int) $_POST['form_id']; $m4is_hzmk = (int) $_POST['template_id']; $m4is_m2h6b = strtolower(trim($_POST['email']) ); $m4is_lcxf = base64_decode($_POST['successurl']); $m4is_ygxthj = base64_decode($_POST['failureurl']); $m4is_qxtoe = base64_decode($_POST['tag_id']); $m4is_o2td = false; $m4is__7j1k = false; $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field' ); $m4is_qy0cg = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'local_auth_only' ); if ( trim( $_POST['email'] ) == '' ) { self::$m4is_cpwjsn->m4is_w5v3i('You must submit an email address.'); return; } $m4is_nzrv1 = get_user_by('email', $m4is_m2h6b); if ($m4is_nzrv1) { $m4is_aicfp = m4is_zbyh::m4is_fhxr6($m4is_nzrv1->ID); if (! $m4is_aicfp) { self::$m4is_bxv7u->m4is_wqve( $m4is_m2h6b ); $m4is_aicfp = m4is_zbyh::m4is_fhxr6($m4is_nzrv1->ID); } if ($m4is_aicfp) { $m4is_nq7s = m4is_zbyh::m4is_w1bfmt($m4is_aicfp); } } if (empty($m4is_nq7s) ) { self::$m4is_bxv7u->m4is_wqve($m4is_m2h6b); $m4is_ulo1 = m4is_zbyh::m4is_e6ntsy($m4is_m2h6b); if (is_array($m4is_ulo1) ) { $m4is_aicfp = $m4is_ulo1[0]; } } if ( empty( $m4is_qy0cg ) ) { if ($m4is_aicfp > 0) { if ( isset( $m4is_nq7s[$m4is_jyx_t] ) && $m4is_nq7s[$m4is_jyx_t] == 'PASSWORD_PLACEHOLDER') { $m4is_ohey = self::$m4is_bxv7u->m4is_v8mw2u(); $m4is_nq7s[$m4is_jyx_t] = $m4is_ohey; self::$m4is_bxv7u->m4is_ba7dk($m4is_nq7s); m4is_zbyh::m4is_pp0i($m4is_aicfp, [$m4is_jyx_t => $m4is_ohey]); self::$m4is_bxv7u->m4is_jrjget( $m4is_aicfp ); } } } if ( $m4is_aicfp > 0 ) { if ( $m4is_qxtoe > 0 ) { self::$m4is_bxv7u->m4is__mkz( $m4is_qxtoe, $m4is_aicfp ); $m4is_o2td = true; $m4is__7j1k = true; } } if ($m4is_hzmk) { if ($m4is_aicfp > 0) { $m4is_smne = [$m4is_aicfp]; } if ( ! empty( $m4is_smne) ) { $m4is_rr90 = $m4is_gwtb03->sendTemplate( $m4is_smne, $m4is_hzmk ); $m4is_o2td = true; } } else { if ( ! $m4is__7j1k ) { if (! empty( $m4is_nq7s ) ) { $m4is_p1ug = empty( $m4is_nq7s[$m4is_jyx_t] ) ? '' : $m4is_nq7s[$m4is_jyx_t]; $m4is_h4qe1_ = empty( $m4is_nq7s['FirstName'] ) ? '' : $m4is_nq7s['FirstName']; $m4is_d_f21o = get_bloginfo( 'admin_email' ); $m4is_auvxt = $m4is_m2h6b; $m4is_jiat = sprintf( _x( 'Your Password for %s', 'memb_send_password', self::$m4is_ahusy0 ), get_bloginfo( 'name' ) ); $m4is_fgxy = sprintf( _x( "<html><body><p>Dear %s</p>\n\n<p>Your password is: %s\n\n</p><p>- %s\n</p></body></html>", 'memb_send_password', self::$m4is_ahusy0 ), $m4is_h4qe1_, $m4is_p1ug, get_bloginfo('name') ); $m4is_jiat = apply_filters( 'memberium/email/send_password/subject', $m4is_jiat, $m4is_nq7s, $m4is_nzrv1 ); $m4is_fgxy = apply_filters( 'memberium/email/send_password/message', $m4is_fgxy, $m4is_nq7s, $m4is_p1ug, $m4is_nzrv1 ); $m4is_auvxt = apply_filters( 'memberium/email/send_password/to', $m4is_auvxt ); $m4is_d_f21o = apply_filters( 'memberium/email/send_password/from', $m4is_d_f21o ); $m4is_o2td = true; $m4is_rw49h = function() { return 'text/html'; }; add_filter( 'wp_mail_content_type', $m4is_rw49h ); wp_mail( $m4is_auvxt, $m4is_jiat, $m4is_fgxy ); remove_filter( 'wp_mail_content_type', $m4is_rw49h ); } else { self::$m4is_cpwjsn->m4is_w5v3i('Account not found.'); } } } if ($m4is_o2td) { $m4is_cpwjsn->m4is_w5v3i(_x('Your password has been emailed to you.  Please be sure to check your spam folder.', 'memb_send_password', self::$m4is_ahusy0 ) ); if (! empty($m4is_lcxf) ) { m4is_d8yr0_::m4is_okts(); wp_redirect($m4is_lcxf); exit; } } if ( ! $m4is_o2td ) { if ( ! empty( $m4is_ygxthj ) ) { m4is_d8yr0_::m4is_okts(); wp_redirect( $m4is_ygxthj ); exit; } } self::$m4is_bxv7u->m4is_l41p7r(); } static 
function m4is_aiujg() { global $wpdb; $m4is_y0i2 = 'memb_registration_form'; if ( ! wp_verify_nonce( $_POST['_wpnonce'], $_POST['params'] ) ) { wp_die( 'Invalid Update Form Submission' ); } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['signature'], $_POST['params'] ) ) { wp_die( 'Security Check Failed - Signature Validation Error' ); exit; } m4is_d8yr0_::m4is_vsv0mr();  $m4is_r5xk = []; $m4is_a6g9qj = false; $m4is_cnc5 = false; $m4is_q1pw3c = true; $m4is_o2td = false; $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field' ); $m4is_rz4ur = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'username_field' ); $m4is_rxc9n1 = unserialize( base64_decode( $_POST['params'] ) ); $m4is_aicfp = (int) $m4is_rxc9n1['contact_id']; $m4is_o94u5p = m4is_f84s3h::m4is_s2yv4( -1 ); if ( self::$m4is_bxv7u->m4is_w47qdy() <> $m4is_aicfp ) { wp_die('Security Check Failed - Signature Validation Error'); exit; }  foreach( $m4is_o94u5p as $m4is_enmq => $m4is_oro4 ) { if ( isset( $_POST[$m4is_enmq] ) ) { $m4is_rhfd = $_POST[$m4is_enmq]; if ( $m4is_oro4 == 5 ) {  if ( strlen( $m4is_rhfd ) < 4 ) { $m4is_rhfd = strtoupper( $m4is_rhfd ); } } elseif ( $m4is_oro4 == 13 || $m4is_oro4 == 14 ) {  $m4is_hpgx6w = strtotime( $m4is_rhfd ); if ( $m4is_hpgx6w > 0 ) { $m4is_rhfd = date( 'Ymd\TH:i:s', strtotime( $m4is_rhfd ) ); } else { unset( $_POST[$m4is_enmq] ); } } elseif ( $m4is_oro4 == 17 || $m4is_oro4 == 20 || $m4is_oro4 == 23 ) {  if ( is_array( $m4is_rhfd) ) { $m4is_rhfd = implode( ',', $m4is_rhfd ); } } elseif ( $m4is_oro4 == 19 ) {  if ( strpos( $m4is_rhfd, '@' ) !== false ) { $m4is_rhfd = strtolower( trim( $m4is_rhfd ) ); } else { $m4is_rhfd = ''; } } $_POST[$m4is_enmq] = stripslashes($m4is_rhfd); } else { } }  if ( ! empty( $m4is_rxc9n1['required_fields'] ) ) { $m4is_b9nqt = explode( ',', $m4is_rxc9n1['required_fields'] ); if ( is_array( $m4is_b9nqt ) ) { foreach ( $m4is_b9nqt as $m4is_aue2i9 ) { if ( ! isset( $_POST[$m4is_aue2i9] ) ) { $m4is_q1pw3c = false; $m4is_a6g9qj = true; $m4is_r5xk[] = 'You are missing required fields.'; } } } }  foreach ($_POST as $m4is_ap3_ => $m4is_rhfd) { if (isset($_POST[$m4is_ap3_ . '_confirmation']) && $_POST[$m4is_ap3_] <> $_POST[$m4is_ap3_ . '_confirmation']) { $m4is_a6g9qj = true; $m4is_r5xk[] = 'Your confirmed fields do not match.'; } }  if (! empty($m4is_rxc9n1['date_fields']) ) { $m4is_o1xs = explode(',', $m4is_rxc9n1['date_fields']); if (is_array($m4is_o1xs) ) { foreach($m4is_o1xs as $m4is_ij6rg) { if (isset($_POST[$m4is_ij6rg]) ) { $m4is_hpgx6w = strtotime($_POST[$m4is_ij6rg]); $_POST[$m4is_ij6rg] = date('Ymd\TH:i:s', $m4is_hpgx6w); } } } }  if (! $m4is_a6g9qj) { $m4is_vh_1bx = m4is_f84s3h::m4is_cm6nr('Contact'); $m4is_nq7s = []; foreach ($_POST as $m4is_ap3_ => $m4is_rhfd) { if (in_array($m4is_ap3_, $m4is_vh_1bx) ) { $m4is_nq7s[$m4is_ap3_] = $m4is_rhfd; } } if (! empty($m4is_nq7s) ) { m4is_zbyh::m4is_pp0i($m4is_aicfp, $m4is_nq7s);  if ($m4is_aicfp > 0) { if (! empty($m4is_rxc9n1['goal']) ) { self::$m4is_bxv7u->m4is_rctzo($m4is_rxc9n1['goal'], $m4is_aicfp); } if (! empty($m4is_rxc9n1['tagids']) ) { self::$m4is_bxv7u->m4is__mkz($m4is_rxc9n1['tagids'], $m4is_aicfp); } self::$m4is_bxv7u->m4is_qjrxkl($m4is_aicfp); $_SESSION = self::$m4is_bxv7u->m4is_q4nu();   $m4is_w5ky4q = [ 'table' => -1,  'type' => 19,  ]; $m4is_s2e0 = memberium_app()->m4is_sn3ph($m4is_w5ky4q); $m4is_s2e0[] = 'Email'; $m4is_s2e0[] = 'EmailAddress2'; $m4is_s2e0[] = 'EmailAddress3'; $m4is_z54v = []; foreach($m4is_nq7s as $m4is_sv3h => $m4is_ywklcb) { if (in_array($m4is_sv3h, $m4is_s2e0) ) { if (! empty($m4is_ywklcb) ) { $m4is_z54v[] = strtolower(trim($m4is_ywklcb) ); } } } $m4is_z54v = array_unique($m4is_z54v); foreach($m4is_z54v as $m4is_m2h6b) { m4is_zbyh::m4is_kbc0w($m4is_m2h6b, 'Memberium Update Form'); } } else { $m4is_a6g9qj = true; } } }  if ($m4is_a6g9qj || $m4is_cnc5) { $m4is_pizyx = $m4is_rxc9n1['failure_url']; } else { $m4is_pizyx = $m4is_rxc9n1['success_url']; }   if (! empty($m4is_nq7s) && $m4is_rxc9n1['pass_fields']) { $m4is_px2j = (strpos($m4is_pizyx, '?') === false) ? '?' : '&'; if ($m4is_aicfp > 0) { $m4is_px2j .= 'id=' . $m4is_aicfp . '&'; } foreach ($m4is_nq7s as $m4is_ap3_ => $m4is_rhfd) { if ($m4is_ap3_ <> $m4is_jyx_t || $m4is_rxc9n1['pass_password'] == true) { $m4is_px2j .= $m4is_ap3_ . '=' . urlencode($m4is_rhfd) . '&'; } } } $m4is_pizyx = trim($m4is_pizyx . $m4is_px2j, '&');  if (! empty($m4is_r5xk) ) { $_SESSION['error_message'] = $m4is_r5xk; } if (! empty($m4is_pizyx) ) { session_write_close(); m4is_d8yr0_::m4is_okts(); wp_redirect($m4is_pizyx, 302, 'Memberium Update Form Redirect'); exit; } } static 
function m4is_dzio() { $m4is_bxv7u = memberium_app(); $m4is_gwtb03 = self::$m4is_bxv7u->m4is_wnlbj_(); if (! m4is_o5aoir::m4is_du5icq() ) { return; } if ( ! self::$m4is_bxv7u->m4is_w47qdy()) { return; } m4is_d8yr0_::m4is_vsv0mr(); if ( ! self::$m4is_bxv7u->m4is_c479wl($_POST['signature'], $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_list_invoices', self::$m4is_ahusy0 ) ); exit; } $m4is_dn09xt = unserialize(base64_decode($_POST['parameters']) ); $m4is_zcyj = (int) $m4is_dn09xt['invoice_id']; if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_payinvoice_' . $m4is_zcyj) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_list_invoices', self::$m4is_ahusy0 ) ); exit; } $m4is_aicfp = (int) self::$m4is_bxv7u->m4is_w47qdy(); $m4is__dxr0 = (int) $_POST['creditcard_id']; $m4is_zcyj = (int) $m4is_dn09xt['invoice_id']; $m4is_qkiet = (int) $m4is_dn09xt['merchant_id']; $m4is_qxtoe = $m4is_dn09xt['tag_id']; $m4is_qw8dk = $m4is_dn09xt['goal']; $m4is_b8ve = ''; $m4is_w1agy = self::$m4is_bxv7u->m4is_w1e0wk($m4is_aicfp, false, true); $m4is_ra9j4 = isset($m4is_w1agy[$m4is_zcyj]) ? $m4is_w1agy[$m4is_zcyj] : []; $m4is_cbvnf1 = [ 'pay_action' => '', 'pay_goal' => '', ]; $m4is_n_bp6 = $m4is_gwtb03->chargeInvoice( $m4is_zcyj, _x('Memberium Customer Care', 'memb_list_invoices', self::$m4is_ahusy0 ), $m4is__dxr0, $m4is_qkiet, false); if (isset($m4is_n_bp6['Successful']) && $m4is_n_bp6['Successful']) { $m4is_qj8o = self::$m4is_bxv7u->m4is_houdcg( (int) $m4is_ra9j4['JobId']); $m4is_umtk = self::$m4is_bxv7u->m4is_mmdrl('ecommerce', 'actions'); foreach($m4is_qj8o as $m4is_b40e_m => $m4is_f3o6) { $m4is_l926 = isset($m4is_umtk[$m4is_f3o6['SubscriptionPlanId']]) ? $m4is_umtk[$m4is_f3o6['SubscriptionPlanId']] : false; if ($m4is_l926) { $m4is_cbvnf1['pay_action'] .= empty($m4is_l926['pay_action']) ? '' : ',' . $m4is_l926['pay_action']; $m4is_cbvnf1['pay_goal'] .= empty($m4is_l926['pay_goal']) ? '' : ',' . $m4is_l926['pay_goal']; } } foreach($m4is_cbvnf1 as $m4is_e3k_mi => $m4is_waxrhu) { $m4is_cbvnf1[$m4is_e3k_mi] = trim($m4is_cbvnf1[$m4is_e3k_mi], ','); } $m4is_b8ve = trim($m4is_b8ve . ',' . $m4is_cbvnf1['pay_action'], ','); $m4is_qw8dk = trim($m4is_qw8dk . ',' . $m4is_cbvnf1['pay_goal'], ','); self::$m4is_bxv7u->m4is__mkz($m4is_qxtoe, $m4is_aicfp); self::$m4is_bxv7u->m4is_evrbh($m4is_b8ve, $m4is_aicfp); self::$m4is_bxv7u->m4is_rctzo($m4is_qw8dk, $m4is_aicfp);  $_SESSION['flash']['invoice_payment'] = $m4is_dn09xt['success_msg'];  delete_transient('Memberium::' . self::$m4is_q7m2 . '::Invoices::' . $m4is_aicfp); delete_transient('Memberium::' . self::$m4is_q7m2 . '::PayPlans::' . $m4is_aicfp); delete_transient('Memberium::' . self::$m4is_q7m2 . '::PayPlanItems::' . $m4is_aicfp); m4is_d8yr0_::m4is_okts(); wp_redirect($m4is_dn09xt['redirect_url']); exit; } else { $_SESSION['flash']['invoice_payment'] = _x('Payment failed.', 'memb_list_invoices', self::$m4is_ahusy0 ); } } static 
function m4is_tpu0() { if (! m4is_o5aoir::m4is_du5icq() ) { return; } if (! wp_verify_nonce($_POST['_wpnonce'], 'oneclick_sale_' . $_POST['form_id']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_one_click_sale', self::$m4is_ahusy0 ) ); exit; } if (! self::$m4is_bxv7u->m4is_c479wl($_POST['digital_signature'], $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_one_click_sale', self::$m4is_ahusy0 ) ); exit; } m4is_d8yr0_::m4is_vsv0mr(); $m4is_hd84f9 = $m4is_dn09xt['action_id']; $m4is_aicfp = self::$m4is_bxv7u->m4is_w47qdy(); $m4is_dn09xt = unserialize(base64_decode($_POST['parameters']) ); $m4is_cmat = (int) $m4is_dn09xt['order_id']; if ($m4is_hd84f9 > '') { self::$m4is_bxv7u->m4is_evrbh($m4is_hd84f9, $m4is_aicfp); } } static 
function m4is_bk8oda() { $m4is_y0i2 = 'memb_change_email'; if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_email_change_' . $_POST['form_id']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); exit; } if (! self::$m4is_bxv7u->m4is_c479wl($_POST['signature'], $_POST['actions']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', $m4is_y0i2, self::$m4is_ahusy0 ) ); exit; } m4is_d8yr0_::m4is_vsv0mr(); if ($_POST['email1'] <> $_POST['email2']) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x("Your new email addresses don't match.", 'memb_change_email', self::$m4is_ahusy0 ) . '</p>'; return; } if ($_POST['email1'] == m4is_lpl4d::m4is_bfi49('email') ) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x('Your email address is already ', 'memb_change_email', self::$m4is_ahusy0 ) . $_POST['email1'] . '</p>'; return; } $_POST['email1'] = stripslashes($_POST['email1']); $m4is_l926 = unserialize(base64_decode($_POST['actions']) ); $m4is_gwr6j0 = get_user_by('email', $_POST['email1']); if ($m4is_gwr6j0) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x('That email address is already used on another member.', 'memb_change_email', self::$m4is_ahusy0 ) . '</p>'; return; }  $m4is_w5ky4q = [ 'email' => $_POST['email1'], 'return' => 'contact_count', ]; $m4is_oqymz9 = self::$m4is_bxv7u->m4is_wqve($m4is_w5ky4q); if (! empty($m4is_oqymz9) ) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x('That email address is already on our list.', 'memb_change_email', self::$m4is_ahusy0 ) . '</p>'; return; } $m4is_q4c_xa = (int) get_current_user_id(); $m4is_aicfp = m4is_zbyh::m4is_fhxr6($m4is_q4c_xa);  $m4is_n_bp6 = false; if ($m4is_aicfp) { $m4is_n_bp6 = self::$m4is_bxv7u->m4is_yvxkt($m4is_q4c_xa, $_POST['email1'], $m4is_aicfp);  } if ($m4is_n_bp6) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x('Your email address has been changed to', 'memb_change_email', self::$m4is_ahusy0 ) . ' ' . $_POST['email1'] . '</p>';  if (! empty($m4is_l926['actionset_id']) ) { self::$m4is_bxv7u->m4is_evrbh($m4is_l926['actionset_id']); } if (! empty($m4is_l926['goal']) ) { self::$m4is_bxv7u->m4is_rctzo($m4is_l926['goal']); } self::$m4is_bxv7u->m4is_ej5_0(); wp_clear_auth_cookie(); $_SESSION = memberium_app()->m4is_q4nu($m4is_q4c_xa); wp_set_current_user($m4is_q4c_xa); wp_set_auth_cookie($m4is_q4c_xa, true, false); if (! empty($m4is_l926['success_url']) ){ wp_redirect($m4is_l926['success_url']); exit; } if ( ! empty($_SERVER['REQUEST_URI']) ) { wp_redirect( $_SERVER['REQUEST_URI'] ); exit; } return; } else { $_SESSION['flash']['email_change_message'] = '<p>Your email address could not be changed to ' . $_POST['email1'] . '</p>'; if (! empty($m4is_l926['failure_url']) ){ wp_redirect($m4is_l926['failure_url']); exit; } } } static 
function m4is_cnx75() { if ( self::$m4is_uuzl0e) { return; } if ( ! is_user_logged_in() ) { return; } if ( ! wp_verify_nonce( $_POST['_wpnonce'], 'password_change_' . $_POST['form_id'] . $_POST['parameters'] ) ) { wp_die( _x( 'Security Check Failed - Nonce Validation Error', 'memb_change_password', self::$m4is_ahusy0 ) ); exit; } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['signature'], $_POST['parameters'] ) ) { wp_die( _x( 'Security Check Failed - Signature Validation Error', 'memb_change_password', self::$m4is_ahusy0 ) ); exit; } m4is_d8yr0_::m4is_vsv0mr(); $m4is_wh297 = 'memb_change_password'; $m4is_qwab = true; $m4is_cpwjsn = m4is_pcys::m4is_a6x52r(); $m4is_rumbl = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'min_password_length' ); $m4is_q4c_xa = get_current_user_id(); $m4is_dn09xt = unserialize( base64_decode( $_POST['parameters'] ) ); $m4is_p1ug = stripslashes( $_POST['password1'] ); $m4is__iftk = isset( $_POST['form_id'] ) ? (int) $_POST['form_id'] : 0; $m4is_qw8dk = isset( $m4is_dn09xt['goal'] ) ? $m4is_dn09xt['goal'] : ''; $m4is_wtg_l8 = isset( $m4is_dn09xt['tagids'] ) ? $m4is_dn09xt['tagids'] : ''; $m4is_cga2c = isset( $m4is_dn09xt['actionset_id'] ) ? $m4is_dn09xt['actionset_id'] : ''; $m4is_pizyx = isset( $m4is_dn09xt['redirect_url'] ) ? $m4is_dn09xt['redirect_url'] : ''; $m4is_gd17 = isset( $m4is_dn09xt['confirm_template_id'] ) ? (int) $m4is_dn09xt['confirm_template_id'] : 0; $m4is_lcxf = isset( $m4is_dn09xt['successurl'] ) ? $m4is_dn09xt['successurl'] : ''; if ( ! $m4is_dn09xt['contact_id']) { $m4is_cpwjsn->m4is_w5v3i( _x( 'You are not an Keap User.', $m4is_wh297, self::$m4is_ahusy0 ) ); return; } if ( empty( $m4is_p1ug ) ) { $m4is_cpwjsn->m4is_w5v3i( _x('You cannot set your password to an Empty Password.', $m4is_wh297, self::$m4is_ahusy0 ) ); return; } if ( strpos( $m4is_p1ug, '\\' ) !== false ) { $m4is_cpwjsn->m4is_w5v3i( _x( 'The backslash character may not be used in passwords.', $m4is_wh297, self::$m4is_ahusy0 ) ); return; } if (strlen($m4is_p1ug) < $m4is_rumbl) { $m4is_cpwjsn->m4is_w5v3i( sprintf( _x( 'Your password must be at least %d characters long.', $m4is_wh297, self::$m4is_ahusy0 ), $m4is_rumbl) ); return; } if ( ! empty( $m4is_p1ug ) && $m4is_p1ug != $_POST['password2'] ) { $m4is_cpwjsn->m4is_w5v3i( _x('The passwords entered do not match.', $m4is_wh297, self::$m4is_ahusy0 ) ); return; } $m4is_pizyx = empty( $m4is_pizyx ) ? $_SERVER['REQUEST_URI'] : $m4is_pizyx; $m4is_o2td = self::$m4is_bxv7u->m4is_z4o9( $m4is_p1ug ); if ( $m4is_o2td ) { $m4is_cpwjsn->m4is_w5v3i( _x( 'Password Changed Successfully.', $m4is_wh297, self::$m4is_ahusy0 ) ); self::$m4is_bxv7u->m4is__mkz( $m4is_wtg_l8 ); self::$m4is_bxv7u->m4is_evrbh( $m4is_cga2c ); self::$m4is_bxv7u->m4is_rctzo( $m4is_qw8dk ); $m4is_pizyx = empty( $m4is_lcxf ) ? $m4is_pizyx : $m4is_lcxf; $m4is_pizyx = remove_query_arg( ['passwordchange'], $m4is_pizyx ); $m4is_pizyx = add_query_arg( ['passwordchange' => 'success'], $m4is_pizyx ); if ( $m4is_gd17 > 0 ) { self::$m4is_gwtb03->sendTemplate( [$m4is_aicfp], $m4is_gd17 ); } if ( ! empty( $m4is_pizyx ) ) { session_write_close(); wp_redirect( $m4is_pizyx, 302, 'Memberium Password Change Redirect' ); exit; } } else { self::$m4is_cpwjsn->m4is_w5v3i( _x( 'Password Change Failed.', $m4is_wh297, self::$m4is_ahusy0 ) ); $m4is_pizyx = add_query_arg( ['passwordchange' => 'failed'], $m4is_pizyx ); } session_write_close(); nocache_headers(); if ( ! empty( $m4is_pizyx ) ) { wp_redirect( $m4is_pizyx, 302, 'Memberium Password Change Redirect' ); exit; } }  static 
function m4is_dea_() { if ( self::$m4is_uuzl0e) { return; } m4is_d8yr0_::m4is_vsv0mr(); if ( is_user_logged_in() ) { return; } $m4is_m2h6b = sanitize_email( trim( wp_unslash( $_POST['user_login'] ) ) ); if ( empty( $m4is_m2h6b ) ) { return; } $m4is_nzrv1 = self::$m4is_bxv7u->m4is__c4p7( $m4is_hhp_ ); if ( ! is_a( $m4is_nzrv1, 'WP_User' ) ) { return; } $m4is_ap3_ = get_password_reset_key( $m4is_nzrv1 ); $m4is_hhp_ = $m4is_nzrv1->user_login; $m4is__mto = site_url( 'wp-login.php?action=rp&key=' . rawurlencode( $m4is_ap3_ ) . '&login=' . rawurlencode( $m4is_hhp_ ) ); $m4is_e4fp0 = is_multisite() ? get_network()->site_name : wp_specialchars_decode( get_option( 'blogname' ), ENT_QUOTES ); $m4is_it_fe = sprintf(__('Password Reset for %s'), $m4is_e4fp0); $m4is_fgxy = __('Someone has requested a password reset for the following account:') . "\r\n\r\n"; $m4is_fgxy .= sprintf(__('Site Name: %s'), $m4is_e4fp0) . "\r\n\r\n"; $m4is_fgxy .= sprintf(__('Username: %s'), $m4is_m2h6b) . "\r\n\r\n"; $m4is_fgxy .= __('If you did not request a new password, just ignore this email and nothing will happen.') . "\r\n\r\n"; $m4is_fgxy .= __('To reset your password, please click the link below:') . "\r\n\r\n"; $m4is_fgxy .= $m4is__mto . "\r\n"; $m4is_it_fe = apply_filters('retrieve_password_title', $m4is_it_fe, $m4is_nzrv1->user_login, $m4is_nzrv1); $m4is_fgxy = apply_filters('retrieve_password_message', $m4is_fgxy, $m4is_ap3_, $m4is_nzrv1->user_login, $m4is_nzrv1); if ($m4is_fgxy && ! wp_mail($m4is_m2h6b, wp_specialchars_decode($m4is_it_fe), $m4is_fgxy) ) { wp_die(__('The email could not be sent.') . "<br />\n" . __('Possible reason: your host may have disabled the mail() function.') ); } }  private static 
function m4is_o7kev4( string $m4is_m2h6b ) : bool { global $wpdb; $m4is_m2h6b = sanitize_email( $m4is_m2h6b ); $m4is_ioxk = "SELECT COUNT(*) FROM `{$wpdb->users}` WHERE `user_login` = %s OR `user_email` = %s"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, $m4is_m2h6b, $m4is_m2h6b ); $m4is_ejfox = $wpdb->get_col( $m4is_ioxk, 0 ); return (boolean) array_shift( $m4is_ejfox ); } }
