<?php
/**
 * Copyright (c) 2012-2022 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 class_exists('m4is_emz57o') || die(); m4is_cwzpq::m4is_gopgz(); final 
class m4is_cwzpq { private static $m4is_bxv7u; static 
function m4is_gopgz() { self::$m4is_bxv7u = memberium_app(); } private 
function __construct() { } static 
function m4is_ma9pcq( int $m4is_q4c_xa, array $m4is_li4oh7 = [] ) { global $wpdb; if ( self::$m4is_bxv7u->m4is_b0w3() ) { return; } if ( isset( $_POST['createaccount'] ) && empty( $_POST['createaccount'] ) ) { return; }  if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset( $_POST['memberium_add_contact'] ) && is_admin() ) { if ( $_POST['memberium_add_contact'] <> 'on' ) { return; } } if ( empty( self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'sync_new_wp_users' ) ) ) { return; }  if ( user_can( $m4is_q4c_xa, 'edit_others_posts' ) ) { return; } $m4is_rz4ur = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'username_field' ); $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field' ); $m4is_qy0cg = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'local_auth_only' ); $m4is_mjg48 = (int) self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'new_user_registration_tag' ); $m4is_q7m2 = self::$m4is_bxv7u->m4is_re5x( 'appname' ); $m4is_nzrv1 = get_userdata( $m4is_q4c_xa ); $m4is_galwv0 = get_user_meta( $m4is_q4c_xa ); $m4is_xk6a = isset( $_POST['action'] ) && ( $_POST['action'] == 'createuser' ) && isset( $_POST['createuser'] ); $m4is_nq7s = []; $m4is_wxlzb = 0; $m4is_znoa3z = MEMBERIUM_DB_CONTACTS; $m4is_tsra = [ 'first_name' => 'FirstName', 'last_name' => 'LastName', 'user_email' => 'Email', 'user_pass' => $m4is_jyx_t, 'user_url' => 'Website', ]; foreach( $m4is_tsra as $m4is_i47cz => $m4is_c9dh ) { if ( ! empty( $m4is_li4oh7[$m4is_i47cz]) ) { $m4is_nq7s[$m4is_c9dh] = $m4is_li4oh7[$m4is_i47cz]; } } if ( empty( $m4is_nq7s[$m4is_jyx_t] ) ) { $m4is_nq7s[$m4is_jyx_t] = self::$m4is_bxv7u->m4is_ne9xaj(); }  if ( isset( $_POST['wp-submit'] ) && $_POST['wp-submit'] == 'Register' ) { $m4is_nq7s['FirstName'] = isset( $_POST['firstname'] ) ? trim( $_POST['firstname'] ) : $m4is_nq7s['FirstName']; $m4is_nq7s['LastName'] = isset( $_POST['lastname'] ) ? trim( $_POST['lastname'] ) : $m4is_nq7s['LastName']; } $m4is_nu7me = apply_filters( 'memberium_registration_field_map', [] ); foreach( $m4is_nu7me as $m4is_p8larn => $m4is_dbhgd ) { if ( isset( $m4is_galwv0[$m4is_p8larn][0]) ) { $m4is_nq7s[$m4is_dbhgd] = trim( $m4is_galwv0[$m4is_p8larn][0] ); } } foreach( $m4is_nu7me as $m4is_x85e => $m4is_u31zb9 ) { if ( isset( $_POST[$m4is_x85e] ) ) { $m4is_nq7s[$m4is_u31zb9] = $_POST[$m4is_x85e]; } } if ( ! empty( $m4is_wxlzb ) ) { $m4is_nq7s['LeadSourceId'] = $m4is_wxlzb; } $m4is_nq7s = apply_filters( 'memberium/user/register/fields', $m4is_nq7s, $m4is_nzrv1 ); $m4is_nq7s = array_filter( $m4is_nq7s ); if ( $m4is_qy0cg ) { unset( $m4is_nq7s[$m4is_jyx_t] ); } if ( empty( $m4is_nq7s['Email'] ) ) { return; } $m4is_aicfp = m4is_zbyh::m4is_dj3iv( $m4is_nq7s ); if ( empty( $m4is_aicfp ) ) { return; } $m4is__5zch = m4is_zbyh::m4is_n0_ck( $m4is_aicfp ); m4is_zbyh::m4is_kbc0w( $m4is_nq7s['Email'], 'Membership Site Registration' ); self::$m4is_bxv7u->m4is_ba7dk( $m4is__5zch ); if ( $m4is_mjg48 ) { self::$m4is_bxv7u->m4is__mkz( [$m4is_mjg48], $m4is_aicfp ); } if ( $m4is_aicfp ) {  self::$m4is_bxv7u->m4is_hhit( $m4is_aicfp, $m4is_q4c_xa ); } if ( get_user_meta( $m4is_q4c_xa, '_fb_is_sync', true ) != 1) { delete_user_meta( $m4is_q4c_xa, '_fb_is_sync' ); add_user_meta( $m4is_q4c_xa, '_fb_is_sync', 1 ); }    } static 
function m4is_cfbim1( int $m4is_aicfp, string $m4is_p1ug = '' ) { global $wpdb; $m4is_nq7s = m4is_zbyh::m4is_w1bfmt( $m4is_aicfp ); $m4is_m2h6b = isset( $m4is_nq7s['Email'] ) ? $m4is_nq7s['Email'] : ''; if ( empty( $m4is_m2h6b ) ) { return false; } $m4is_rz4ur = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'username_field', 'Email' ); $m4is_id576 = isset( $m4is_nq7s[$m4is_rz4ur] ) ? $m4is_nq7s[$m4is_rz4ur] : ''; $m4is_id576 = apply_filters( 'memberium_wordpress_username', $m4is_id576, $m4is_nq7s ); if ( empty( $m4is_id576 ) ) { return false; } $m4is_qy0cg = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'local_auth_only', 0); $m4is_jyx_t = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field', 'Password' ); $m4is_p1ug = isset( $m4is_nq7s[$m4is_jyx_t] ) ? $m4is_nq7s[$m4is_jyx_t] : '';  if ( empty( $m4is_p1ug ) && empty( $m4is_qy0cg ) ) { return false; }  $m4is_nzrv1 = get_user_by( 'email', $m4is_m2h6b ) or $m4is_nzrv1 = get_user_by( 'login', $m4is_m2h6b ) or $m4is_nzrv1 = get_user_by( 'login', $m4is_id576 ) or $m4is_nzrv1 = get_user_by( 'id', m4is_zbyh::m4is__nfdz9( $m4is_aicfp ) ); if ( ! is_a( $m4is_nzrv1, 'WP_User' ) ) { return false; } $m4is_q4c_xa = $m4is_nzrv1->ID; $m4is_g68c = []; $m4is_kbu63_ = [ 'Email' => 'user_email', 'FirstName' => 'first_name', 'LastName' => 'last_name', 'Website' => 'user_url', ]; foreach( $m4is_kbu63_ as $m4is_dc39 => $m4is_ven8 ) { if ( isset( $m4is_nq7s[$m4is_dc39] ) ) { $m4is_u1l2 = isset( $m4is_nzrv1->$m4is_ven8 ) ? $m4is_nzrv1->$m4is_ven8 : ''; $m4is_j83ml = isset( $m4is_nq7s[$m4is_dc39] ) ? $m4is_nq7s[$m4is_dc39] : ''; if ( $m4is_u1l2 <> $m4is_j83ml ) { $m4is_g68c[$m4is_ven8] = $m4is_nq7s[$m4is_dc39]; } } }  $m4is_f9c4 = self::$m4is_bxv7u->m4is_mmdrl( 'settings', 'disable_displayname_update', 0 );  $m4is_fo4eiv = []; $m4is_x4bj30 = get_user_by( 'id', $m4is_qlbeg ); if ( is_a( $m4is_x4bj30, 'WP_User' ) && strtolower( $m4is_x4bj30->user_email ) == strtolower( $m4is_nq7s['Email'] ) ) { $m4is_nq7s['Email'] = $m4is_x4bj30->user_email; } $m4is_u1l2['display_name'] = $m4is_x4bj30->display_name; $m4is_u1l2['first_name'] = $m4is_x4bj30->first_name; $m4is_u1l2['last_name'] = $m4is_x4bj30->last_name; $m4is_u1l2['nickname'] = $m4is_x4bj30->nickname; $m4is_u1l2['user_email'] = $m4is_x4bj30->user_email; $m4is_u1l2['user_nicename'] = $m4is_x4bj30->user_nicename; $m4is_u1l2['user_url'] = wp_specialchars_decode($m4is_x4bj30->user_url); $m4is_j83ml = []; $m4is_j83ml['first_name'] = isset($m4is_nq7s['FirstName']) ? $m4is_nq7s['FirstName'] : $m4is_u1l2['display_name']; $m4is_j83ml['last_name'] = isset($m4is_nq7s['LastName']) ? $m4is_nq7s['LastName'] : $m4is_u1l2['last_name']; $m4is_j83ml['user_email'] = strtolower(trim($m4is_nq7s['Email']) ); $m4is_j83ml['user_url'] = empty($m4is_nq7s['Website']) ? $m4is_u1l2['user_url'] : trim(substr($m4is_nq7s['Website'], 0, 94));  if (empty($m4is_f9c4) ) { $m4is_w5ky4q = [ 'contact' => $m4is_nq7s, 'user_id' => $m4is_qlbeg, ]; $m4is_j83ml['display_name'] = apply_filters('memberium/wpuser/display_name', self::$m4is_bxv7u->m4is_upv1($m4is_w5ky4q), $m4is_nq7s); $m4is_j83ml['nickname'] = apply_filters('memberium/wpuser/nickname', $m4is_u1l2['display_name'], $m4is_nq7s); }  if ( self::$m4is_bxv7u->m4is_mmdrl('settings', 'enable_slug_update', false) ) { $m4is_j83ml['user_nicename'] = apply_filters('memberium/wpuser/nicename', sanitize_title($m4is_j83ml['display_name']), $m4is_nq7s); } if (empty($m4is_qy0cg) ) { $m4is_q2z1bm = isset($_POST['pwd']) ? $_POST['pwd'] : ''; $m4is_q2z1bm = isset($_POST['password']) && isset($_POST['woocommerce-login-nonce']) ? $_POST['password'] : $m4is_q2z1bm; if (! empty(trim($m4is_q2z1bm))) { if (in_array($m4is_p1ug, ['', 'PASSWORD_PLACEHOLDER']) ) { if (! empty($m4is_q2z1bm)) { if ( (! @wp_check_password($m4is_q2z1bm, $m4is_x4bj30->data->user_pass, $m4is_qlbeg) ) ) { $m4is_fo4eiv['user_pass'] = $m4is_nq7s[$m4is_jyx_t]; } } } else { if ( (! @wp_check_password($m4is_p1ug, $m4is_x4bj30->data->user_pass, $m4is_qlbeg) ) ) { $m4is_fo4eiv['user_pass'] = $m4is_nq7s[$m4is_jyx_t]; } } } } foreach ($m4is_j83ml as $m4is_ap3_ => $m4is_rhfd ) { if (isset($m4is_u1l2[$m4is_ap3_]) && $m4is_u1l2[$m4is_ap3_] !== $m4is_rhfd && ! empty($m4is_rhfd)) { $m4is_fo4eiv[$m4is_ap3_] = $m4is_rhfd; } } if (! empty($m4is_fo4eiv)) { $m4is_fo4eiv['ID'] = $m4is_qlbeg;  self::$m4is_bxv7u->m4is_di35eu(true); add_filter('send_password_change_email', [ self::$m4is_bxv7u, 'm4is_pp54t'], PHP_INT_MAX, 3); wp_update_user($m4is_fo4eiv); remove_filter('send_password_change_email', [ self::$m4is_bxv7u, 'm4is_pp54t'], PHP_INT_MAX);  if (stripos($m4is_x4bj30->user_login, '@') !== false) { $m4is_qxfj9 = sanitize_user($m4is_nq7s['Email'], true); if ($m4is_x4bj30->user_login <> $m4is_qxfj9) { self::$m4is_bxv7u->m4is__670($m4is_qlbeg, $m4is_qxfj9); } } } self::$m4is_bxv7u->m4is_hhit( $m4is_aicfp, $m4is_qlbeg ); self::$m4is_bxv7u->m4is_di35eu( false ); return $m4is_qlbeg; } static 
function m4is_fu9or( int $m4is_aicfp, $m4is_p1ug = '' ) { } }
