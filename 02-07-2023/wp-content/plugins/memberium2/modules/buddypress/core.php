<?php
/**
* Copyright (c) 2018-2022 David J Bullock
* Web Power and Light
*/

  class_exists('m4is_emz57o') || die(); final 
class m4is_pdbmcu { private $m4is__3anb = []; private $m4is_bxv7u; static 
function m4is_a6x52r() : self { static $m4is_jprj8 = false; return $m4is_jprj8 ? $m4is_jprj8 : $m4is_jprj8 = new self; } private 
function __construct() { $this->m4is_ap508(); $this->m4is_bxv7u = memberium_app(); if ( is_admin() ) { require_once __DIR__ . '/admin.php'; m4is_nkew7::m4is_a6x52r(); } else { require_once __DIR__ . '/frontend.php'; m4is__pn2::m4is_a6x52r(); }  } private 
function m4is_ap508() {  $this->m4is_l8k6o(); add_action( 'init', [$this, 'm4is_lkdub'], 10 ); add_action( 'bp_init', [$this, 'm4is_fxz524'] ); add_action( 'xprofile_updated_profile', [$this, 'm4is_hwe4g'], 0, 5 ); add_action( 'memberium/session/updated', [$this, 'm4is_rhivj'], 11, 2 ); add_action( 'memberium/session/updated', [$this, 'm4is_f58d'], 10, 2 ); add_action( 'after_setup_theme', [$this, 'm4is_g9tk'] );  add_filter( 'memberium/modules/active/names', [$this, 'm4is_hj92e'], 10, 1 ); add_filter( 'memberium/user/register/fields', [$this, 'm4is_aehl4x'], 10, 2 ); add_filter( 'memberium/wpuser/nickname', [$this, 'm4is_d67smq'], PHP_INT_MAX, 2 ); } 
function m4is_lkdub() { if ( bp_is_active('friends') ) { } } private 
function m4is_l8k6o() { if ( bp_is_active( 'groups' ) ) { require_once __DIR__ . '/groups.php'; m4is_cmztug::m4is_a6x52r(); } } 
function m4is_f58d( int $m4is_q4c_xa, array $m4is_sxfbjo ) { $this->m4is__3anb[ $m4is_q4c_xa ] = $m4is_sxfbjo; if ( ! did_action( 'bp_init' ) ) { add_action( 'bp_init', [$this, 'm4is_fxz524'] ); } else { $this->m4is_fxz524(); } } 
function m4is_fxz524() { $this->m4is_l8k6o(); foreach( $this->m4is__3anb as $m4is_q4c_xa => $m4is_sxfbjo ) { if ( ! empty( $m4is_sxfbjo['keap']['contact'] ) ) { $this->m4is_xdub( $m4is_sxfbjo['keap']['contact'], $m4is_q4c_xa ); } } } 
function m4is_d67smq( string $m4is_mtz6 = '', array $m4is_nq7s = [] ) { $m4is_mtz6 = sanitize_title_with_dashes( $m4is_mtz6, null, 'save' ); return $m4is_mtz6; } 
function m4is_aehl4x($m4is_nq7s, $m4is_nzrv1) { if ( is_a( $m4is_nzrv1, 'WP_User' ) ) { $m4is_q4c_xa = $m4is_nzrv1->ID; $m4is_jyx_t = $this->m4is_bxv7u->m4is_mmdrl( 'settings', 'password_field' );  $m4is_s6iyu = $this->m4is_bxv7u->m4is_mmdrl( 'settings', 'local_auth_only' ); if ( function_exists( 'bp_xprofile_firstname_field_id' ) && function_exists( 'bp_xprofile_lastname_field_id' ) ) { $m4is_mq28a_ = bp_xprofile_firstname_field_id(); $m4is_h1re8 = bp_xprofile_lastname_field_id(); $m4is_qf3qp8 = bp_xprofile_nickname_field_id(); $m4is_sok8 = empty( $_POST["field_{$m4is_mq28a_}"]) ? '' : $_POST["field_{$m4is_mq28a_}"]; $m4is_z2pukd = empty( $_POST["field_{$m4is_h1re8}"]) ? '' : $_POST["field_{$m4is_h1re8}"]; $m4is_mtz6 = empty( $_POST["field_{$m4is_qf3qp8}"]) ? '' : $_POST["field_{$m4is_qf3qp8}"]; $m4is_nq7s['FirstName'] = empty( $m4is_nq7s['FirstName'] ) ? $m4is_sok8 : $m4is_nq7s['FirstName']; $m4is_nq7s['LastName'] = empty( $m4is_nq7s['LastName'] ) ? $m4is_z2pukd : $m4is_nq7s['LastName']; $m4is_nq7s['Nickname'] = empty( $m4is_nq7s['Nickname'] ) ? $m4is_mtz6 : $m4is_nq7s['Nickname']; if ( ! $m4is_s6iyu ) { $m4is_p1ug = empty( $_POST['signup_password'] ) ? '' : trim( $_POST['signup_password'] ); $m4is_nq7s[$m4is_jyx_t] = empty( $m4is_nq7s[$m4is_jyx_t] ) ? $m4is_p1ug : $m4is_nq7s[$m4is_jyx_t]; } } } return $m4is_nq7s; } 
function m4is_tabu1p( $m4is_q4c_xa ) { $m4is_nzrv1 = get_user_by('id', $m4is_q4c_xa); if ( is_a( $m4is_nzrv1, 'WP_User' ) ) { $m4is_hhp_ = $m4is_nzrv1->user_login; $m4is_eydtx = new BP_Signup; $m4is_j0n7 = $m4is_eydtx->get( ['user_login' => $m4is_hhp_] ); $m4is_t_2u1 = isset( $m4is_j0n7['signups'][0]->signup_id ) ? $m4is_j0n7['signups'][0]->signup_id : 0; if ($m4is_t_2u1) { $m4is_eydtx->activate([$m4is_t_2u1]); } } } 
function m4is_g9tk() { remove_filter( 'login_redirect', 'buddyboss_redirect_previous_page', 10 , 3 ); } 
function m4is_hj92e( $m4is_its6y ) { global $buddyboss_platform_plugin_file; if (! empty( $buddyboss_platform_plugin_file ) ) { $m4is_ho0w2 = 'BuddyBoss Platform Support'; } else { $m4is_ho0w2 = 'BuddyPress Support'; } return array_merge( $m4is_its6y, [ $m4is_ho0w2, ] ); } 
function m4is_wid81( $user_id ) { } 
function m4is_hwe4g( $m4is_q4c_xa, $m4is_ohp9d, $m4is_fzalfr, $m4is_j8dm0f, $m4is_x_6j ) { if ( ! class_exists( 'BP_XProfile_Field' ) ) { return; } $m4is_h_1s = get_option( 'memberium_xprofile_map', [] ); $m4is_o94u5p = m4is_f84s3h::m4is_s2yv4(); foreach ( $m4is_h_1s as $m4is_tl5js => $m4is_ajrs5 ) { if ( ! empty( $m4is_ajrs5 ) && ! empty( $m4is_tl5js ) ) { $m4is_z4zva_ = empty( $m4is_o94u5p[$m4is_tl5js] ) ? 15 : $m4is_o94u5p[$m4is_tl5js]; $m4is_njoq5 = empty( $m4is_x_6j[$m4is_ajrs5]['value'] ) ? '' : $m4is_x_6j[$m4is_ajrs5]['value']; $m4is_p8larn = 'memb_' . $m4is_tl5js; if ( $m4is_z4zva_ == 13 || $m4is_z4zva_ == 14 ) { if ( ! empty( $m4is_njoq5 ) ) { $m4is_njoq5 = date( 'Y-m-d\TH:i:s', strtotime( $m4is_njoq5 ) ); } } update_user_meta( $m4is_q4c_xa, $m4is_p8larn, $m4is_njoq5 ); } }  } 
function m4is_rhivj($m4is_q4c_xa, $m4is_sxfbjo) { if ( function_exists( 'bp_set_member_type' ) && function_exists( 'bp_get_member_type' ) ) { $m4is_zvtn2w = isset( $m4is_sxfbjo['memb_user']['membership_id'] ) ? $m4is_sxfbjo['memb_user']['membership_id'] : ''; $m4is_pfjwap = bp_get_member_type($m4is_q4c_xa); if ( $m4is_zvtn2w ) { $m4is_tyoak = (array) $this->m4is_bxv7u->m4is_mmdrl( 'memberships' )[$m4is_zvtn2w]; if (! empty($m4is_tyoak['buddypress_profile_type'])) { $m4is_dv_1 = $m4is_tyoak['buddypress_profile_type']; if ($m4is_dv_1 !== $m4is_pfjwap) { bp_set_member_type($m4is_q4c_xa, $m4is_dv_1); } } } } } 
function m4is_xdub( array $m4is_nq7s, int $m4is_q4c_xa ) { if ( ! function_exists( 'xprofile_set_field_data' ) ) { return; } if ( empty( $m4is_nq7s ) ) { return; } $m4is_h_1s = get_option( 'memberium_xprofile_map', [] ); $m4is_o94u5p = m4is_f84s3h::m4is_s2yv4(); if ( empty( $m4is_h_1s ) || empty( $m4is_o94u5p ) || ! is_array( $m4is_o94u5p ) || ! is_array( $m4is_h_1s ) ) { return; } $m4is_h_1s = array_change_key_case( $m4is_h_1s, CASE_LOWER ); $m4is_o94u5p = array_change_key_case( $m4is_o94u5p, CASE_LOWER ); foreach ( $m4is_h_1s as $m4is_tl5js => $m4is_ajrs5 ) { if ( $m4is_ajrs5 ) { $m4is_z4zva_ = empty( $m4is_o94u5p[ $m4is_tl5js ] ) ? 15 : $m4is_o94u5p[ $m4is_tl5js ]; $m4is_rhfd = empty( $m4is_nq7s[$m4is_tl5js] ) ? '' : $m4is_nq7s[ $m4is_tl5js ]; if ( in_array( $m4is_z4zva_, [ 13, 14 ] ) ) { if ( ! empty( $m4is_rhfd ) ) { $m4is_rhfd = date( 'Y-m-d H:i:s', strtotime( $m4is_rhfd ) ); } } $m4is_n_bp6 = xprofile_set_field_data( $m4is_ajrs5, $m4is_q4c_xa, $m4is_rhfd ); } } } }
