<?php
 class_exists('m4is_pdbmcu') || die(); final 
class m4is_c0wil7 extends BP_Group_Extension { 
function __construct() { add_filter('memberium/enhanced_admin_scripts', [$this, 'm4is_qxg4'], 10, 1); $m4is_w5ky4q = [ 'access' => 'noone', 'name' => 'BuddyPress Groups for Memberium', 'slug' => 'bp-groups-for-memberium', ]; parent::init($m4is_w5ky4q); } 
function m4is_qxg4($m4is_njbq) { $m4is_njbq[] = 'toplevel_page_bp-groups';  $m4is_njbq[] = 'buddyboss_page_bp-groups';  return $m4is_njbq; } 
function display( $m4is_xe9a = null ) { $m4is_xe9a = bp_get_group_id(); } 
function settings_screen($m4is_xe9a = null) { if ( empty($m4is_xe9a) ) { return; } $m4is_qs_o1n = groups_get_groupmeta($m4is_xe9a, '_is4wp_autojoin'); $m4is_qs_o1n = empty( $m4is_qs_o1n ) ? [] : $m4is_qs_o1n; $m4is_qs_o1n['autojoin_admin'] = isset( $m4is_qs_o1n['autojoin_admin'] ) ? $m4is_qs_o1n['autojoin_admin'] : ''; $m4is_qs_o1n['autojoin_moderator'] = isset( $m4is_qs_o1n['autojoin_moderator'] ) ? $m4is_qs_o1n['autojoin_moderator'] : ''; $m4is_qs_o1n['autojoin_member'] = isset( $m4is_qs_o1n['autojoin_member'] ) ? $m4is_qs_o1n['autojoin_member'] : ''; $m4is_qs_o1n['autoban'] = isset( $m4is_qs_o1n['autoban'] ) ? $m4is_qs_o1n['autoban'] : ''; echo '<style>'; echo ' .memberium_label { display:inline-block; width:175px; margin-right: 20px; }'; echo ' .multitaglist .tag-selector { margin-bottom:6px; }'; echo '</style>'; echo '<label class="memberium_label">Autojoin as Admin:</label>'; echo '<input type="text" id="is4wp_autojoin_admin" name="is4wp_autojoin_admin" value="', $m4is_qs_o1n['autojoin_admin'], '" class="multitaglist" style="width:500px;">'; echo '<br>'; echo '<label class="memberium_label">Autojoin as Moderator:</label>'; echo '<input type="text" id="is4wp_autojoin_moderator"  name="is4wp_autojoin_moderator" value="', $m4is_qs_o1n['autojoin_moderator'], '" class="multitaglist" style="width:500px;">'; echo '<br>'; echo '<label class="memberium_label">Autojoin as Member:</label>'; echo '<input type="text" name="is4wp_autojoin_member" value="', ( $m4is_qs_o1n['autojoin_member'] > '' ? $m4is_qs_o1n['autojoin_member'] : '' ), '" class="multitaglist" style="width:500px;">'; echo '<br>'; echo '<label class="memberium_label">Auto-Ban:</label>'; echo '<input type="text" name="is4wp_autoban" value="', ( $m4is_qs_o1n['autoban'] > '' ? $m4is_qs_o1n['autoban'] : '' ), '" class="multitaglist" style="width:500px;">'; echo '<br>'; return; $m4is_znf9 = memberium_app()->m4is_ee0h( true ); $m4is_znf9 = $m4is_znf9['mc']; $m4is_q4i2j = []; foreach ( (array) $m4is_znf9 as $m4is_b40e_m => $m4is_w9feq2 ) { $m4is_q4i2j[] = [ 'id' => $m4is_b40e_m, 'text' => $m4is_w9feq2 . ' (' . $m4is_b40e_m . ')' ]; } $m4is_q4i2j = json_encode( $m4is_q4i2j ); unset( $m4is_znf9, $m4is_b40e_m, $m4is_w9feq2 ); echo '<script>'; echo '	var taglist = ', $m4is_q4i2j, ';'; echo '</script>'; unset( $m4is_znf9, $m4is_q4i2j ); echo '<script> '; echo '	jQuery(document).ready( function() { '; echo '		jQuery(".multitaglist").wpalSelect2({ '; echo '			placeholder: "Select the tags for this role.", '; echo '			tags: taglist '; echo '		}); '; echo '}); '; echo '</script>'; } 
function settings_screen_save( $m4is_xe9a = NULL ) { $m4is_qs_o1n = []; $m4is_qs_o1n['autojoin_admin'] = isset( $_POST['is4wp_autojoin_admin'] ) ? $_POST['is4wp_autojoin_admin'] : ''; $m4is_qs_o1n['autojoin_moderator'] = isset( $_POST['is4wp_autojoin_moderator'] ) ? $_POST['is4wp_autojoin_moderator'] : ''; $m4is_qs_o1n['autojoin_member'] = isset( $_POST['is4wp_autojoin_member'] ) ? $_POST['is4wp_autojoin_member'] : ''; $m4is_qs_o1n['autoban'] = isset( $_POST['is4wp_autoban'] ) ? $_POST['is4wp_autoban'] : ''; groups_update_groupmeta( $m4is_xe9a, '_is4wp_autojoin', $m4is_qs_o1n ); } } final 
class m4is_cmztug { private $m4is_q4c_xa = 0; static 
function m4is_a6x52r() : self { static $m4is_jprj8 = false; return $m4is_jprj8 ? $m4is_jprj8 : $m4is_jprj8 = new self; } private 
function __construct() { if ( ( ! class_exists( 'BP_Groups_Group' ) ) || ( ! class_exists( 'BP_Group_Extension' ) ) ) { return; } if ( function_exists( 'bp_register_group_extension' ) ) { if ( is_admin() ) { bp_register_group_extension( 'm4is_c0wil7' ); } } $this->m4is_ap508(); } private 
function m4is_ap508() { add_action( 'memberium/session/updated', [$this, 'm4is_y9o6h3'], 20, 2 ); } private 
function m4is_vqkv9( $m4is_ixyb ) { $m4is_h9ti6y = []; if ( is_array( $m4is_ixyb ) ) { foreach( $m4is_ixyb as $m4is_gbok ) { $m4is_h9ti6y[] = $m4is_gbok->id; } } return $m4is_h9ti6y; } 
function m4is_s4ox( $m4is_q4c_xa ) { $this->m4is_q4c_xa = $m4is_q4c_xa; } 
function m4is_ll_5o( $m4is_b40e_m ) { return empty( $this->m4is_q4c_xa ) ? $m4is_b40e_m : $this->m4is_q4c_xa; }  
function m4is_y9o6h3( $m4is_q4c_xa, $m4is_sxfbjo ) { if ( ! function_exists( 'groups_get_groups' ) || ! class_exists( 'bp_groups_group' ) ) { return $m4is_sxfbjo; } if ( ! defined( 'BP_GROUPS_SLUG' ) ) { return $m4is_sxfbjo; } if ( user_can( $m4is_q4c_xa, 'manage_options' ) ) { return; } $m4is_w5ky4q = [ 'show_hidden' => true, 'per_page' => 0, 'page' => 0, ]; $m4is_ixyb = groups_get_groups( $m4is_w5ky4q ); $m4is_ixyb = isset( $m4is_ixyb['groups'] ) ? $m4is_ixyb['groups'] : []; $m4is_znf9 = isset( $m4is_sxfbjo['memb_user']['tags'] ) ? array_filter( explode( ',', $m4is_sxfbjo['memb_user']['tags'] ) ) : []; if ( is_array( $m4is_ixyb ) ) { $this->m4is_s4ox( $m4is_q4c_xa ); add_filter( 'bp_loggedin_user_id', [$this, 'm4is_ll_5o'], PHP_INT_MAX, 1 ); $m4is_xed02 = BP_Groups_Member::get_group_ids( $m4is_q4c_xa )['groups']; $m4is_s2qv1l = $this->m4is_vqkv9( BP_Groups_Member::get_is_banned_of( $m4is_q4c_xa )['groups'] ); $m4is_ktu9k6 = $this->m4is_vqkv9( BP_Groups_Member::get_is_admin_of( $m4is_q4c_xa )['groups'] ); $m4is_p6yb = $this->m4is_vqkv9( BP_Groups_Member::get_is_mod_of( $m4is_q4c_xa )['groups'] ); remove_filter( 'bp_loggedin_user_id', [$this, 'm4is_ll_5o'] ); $this->m4is_s4ox( 0 ); foreach ( $m4is_ixyb as $m4is_gbok ) { $m4is_cm34jp = new BP_Groups_Member( $m4is_q4c_xa, $m4is_gbok->id ); $m4is_qs_o1n = groups_get_groupmeta( $m4is_gbok->id, '_is4wp_autojoin' ); $m4is_qs_o1n = is_array( $m4is_qs_o1n ) ? $m4is_qs_o1n : []; if ( ! empty( $m4is_qs_o1n ) ) { $m4is_qs_o1n['autoban'] = isset( $m4is_qs_o1n['autoban'] ) ? array_filter( explode( ',', $m4is_qs_o1n['autoban'] ) ) : []; $m4is_qs_o1n['autojoin_admin'] = isset( $m4is_qs_o1n['autojoin_admin'] ) ? array_filter( explode( ',', $m4is_qs_o1n['autojoin_admin'] ) ) : []; $m4is_qs_o1n['autojoin_moderator'] = isset( $m4is_qs_o1n['autojoin_moderator'] ) ? array_filter( explode( ',', $m4is_qs_o1n['autojoin_moderator'] ) ) : []; $m4is_qs_o1n['autojoin_member'] = isset( $m4is_qs_o1n['autojoin_member'] ) ? array_filter( explode( ',', $m4is_qs_o1n['autojoin_member'] ) ) : []; $m4is_enkwa = ! empty( $m4is_qs_o1n['autoban'] ); $m4is_kq6d = ! empty( $m4is_qs_o1n['autojoin_moderator'] ); $m4is_r_8q = ! empty( $m4is_qs_o1n['autojoin_admin'] ); $m4is_icl51j = $m4is_r_8q || $m4is_kq6d || ( ! empty($m4is_qs_o1n['autojoin_member'] ) ); $m4is_vx5t = in_array( $m4is_gbok->id, $m4is_s2qv1l ); $m4is_rgya7 = in_array( $m4is_gbok->id, $m4is_p6yb ); $m4is_s0gl = in_array( $m4is_gbok->id, $m4is_ktu9k6 ); $m4is_ff7q = $m4is_s0gl || $m4is_rgya7 || in_array( $m4is_gbok->id, $m4is_xed02 ); $m4is_b53eat = ! empty( array_intersect( $m4is_qs_o1n['autoban'], $m4is_znf9 ) ); $m4is__5vzn = ! empty( array_intersect( $m4is_qs_o1n['autojoin_moderator'], $m4is_znf9 ) ); $m4is_f8oa = ! empty( array_intersect( $m4is_qs_o1n['autojoin_admin'], $m4is_znf9 ) ); $m4is_ajr1g = $m4is__5vzn || $m4is_f8oa || ( ! empty( array_intersect( $m4is_qs_o1n['autojoin_member'], $m4is_znf9 ) ) );  if ( $m4is_enkwa ) { if ( $m4is_b53eat && ! $m4is_vx5t ) { $m4is_cm34jp->demote(); $m4is_cm34jp->ban(); $m4is_vx5t = true; } if ( ( ! $m4is_b53eat ) && $m4is_vx5t ) { $m4is_cm34jp->unban(); $m4is_vx5t = false; } } if ( ! $m4is_vx5t ) { if ( $m4is_icl51j ) { if ( ( ! $m4is_ff7q ) && $m4is_ajr1g ) { groups_join_group( $m4is_gbok->id, $m4is_q4c_xa ); $m4is_ff7q = true; } elseif ( $m4is_ff7q && ( ! $m4is_ajr1g ) ) { $m4is_cm34jp->remove(); $m4is_ff7q = false; } } } if ((! $m4is_vx5t) && $m4is_icl51j) { if ($m4is_kq6d) { if ($m4is__5vzn && (! $m4is_f8oa) ) { $m4is_cm34jp->promote('mod'); } elseif ($m4is_rgya7 && ! $m4is__5vzn && ! $m4is_f8oa) { $m4is_cm34jp->demote('mod'); } } if ($m4is_r_8q) { if (! $m4is_s0gl && $m4is_f8oa) { $m4is_cm34jp->promote('admin'); } elseif ($m4is_s0gl && ! $m4is_f8oa) { $m4is_cm34jp->demote('admin'); } } } } } } } }
