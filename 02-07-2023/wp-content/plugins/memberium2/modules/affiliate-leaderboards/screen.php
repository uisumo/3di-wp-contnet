<?php
 class_exists( 'm4is_emz57o' ) || die(); current_user_can( 'manage_options' ) || wp_die( __( 'You do not have sufficient permissions to access this page.' ) ); m4is_xguyv8::m4is_y3z1(); 
class m4is_xguyv8 { private $m4is_shny = '', $m4is_m_fnw0 = [], $m4is_mej_t0; static 
function m4is_y3z1() : self { static $m4is_jprj8 = false; return $m4is_jprj8 ? $m4is_jprj8 : $m4is_jprj8 = new self(); } private 
function __construct() { $this->m4is_mej_t0 = m4is_mifz::m4is_a6x52r(); $this->m4is_m_fnw0 = $this->m4is_nqbg(); $this->m4is_shny = $this->m4is_j_qc4( $_GET );  $this->m4is_s_9s8( $_POST ); $this->m4is_qfg13(); } 
function m4is_nqbg() { $m4is_m_fnw0 = [ 'leaderboards' => '<i class="fa fa-list-ol"></i> Create Leaderboards', 'about' => '<i class="fa fa-users"></i> About',  ]; return $m4is_m_fnw0; } 
function m4is_j_qc4( $m4is_ssdxa6 ) { return isset( $_GET['tab'] ) ? $_GET['tab'] : 'leaderboards'; } 
function m4is_s_9s8( $m4is_pgsbl ) { if ( $_SERVER['REQUEST_METHOD'] !== 'POST' ) { return; } if ( isset( $m4is_pgsbl['create-leaderboard'] ) ) { $this->m4is_ngli( $m4is_pgsbl ); } elseif ( isset( $m4is_pgsbl['update-leaderboard'] ) ) { $this->m4is_whw_c( $m4is_pgsbl ); } elseif ( isset( $m4is_pgsbl['refresh'] ) ) { $this->m4is_kje5s( $m4is_pgsbl ); } } private 
function m4is_kje5s( $m4is_pgsbl ) { $m4is_b40e_m = (int) $_POST['refresh']; $m4is_g8qm = $this->m4is_mej_t0->m4is_owh5(); $m4is_g8qm[$m4is_b40e_m] = m4is_i6vs::m4is_uhdub5( $m4is_g8qm[$m4is_b40e_m] ); $m4is_ye72pa = require_once __DIR__ . '/cron.php'; $this->m4is_mej_t0->m4is_co90ks( $m4is_g8qm ); m4is_i6vs::m4is_uhdub5( $m4is_g8qm[$m4is_b40e_m] ); } private 
function m4is_whw_c( $m4is_pgsbl ) { $m4is_g8qm = $this->m4is_mej_t0->m4is_owh5(); foreach( $m4is_pgsbl['profile'] as $m4is_ap3_ => $m4is_gmihzr ) { $m4is_g8qm[$m4is_ap3_]['slots'] = $m4is_gmihzr['slots']; $m4is_g8qm[$m4is_ap3_]['start_date'] = $m4is_gmihzr['start_date']; $m4is_g8qm[$m4is_ap3_]['end_date'] = $m4is_gmihzr['end_date']; $m4is_g8qm[$m4is_ap3_]['last_updated'] = 0;  if ( ! empty( $m4is_gmihzr['delete'] ) ) { unset( $m4is_g8qm[$m4is_ap3_] ); } } $this->m4is_mej_t0->m4is_co90ks( $m4is_g8qm ); } private 
function m4is_ngli( $m4is_pgsbl ) { $m4is_g8qm = $this->m4is_mej_t0->m4is_owh5(); $m4is_u2a3d5 = []; $m4is_u2a3d5['name'] = empty( $m4is_pgsbl['name'] ) ? '' : substr( trim( $m4is_pgsbl['name'] ), 0, 40 ); $m4is_u2a3d5['type'] = empty( $m4is_pgsbl['type'] ) ? 'leads' : $m4is_pgsbl['type']; $m4is_u2a3d5['slots'] = empty( $m4is_pgsbl['slots'] ) ? 0 : $m4is_pgsbl['slots']; $m4is_u2a3d5['start_date'] = empty( $m4is_pgsbl['start_date'] ) ? '' : $m4is_pgsbl['start_date']; $m4is_u2a3d5['end_date'] = empty( $m4is_pgsbl['end_date'] ) ? '' : $m4is_pgsbl['end_date']; $m4is_u2a3d5['products'] = empty( $m4is_pgsbl['products'] ) ? '' : trim( $m4is_pgsbl['products'], ',' ); $m4is_u2a3d5['last_updated'] = 0; $m4is_u2a3d5['cache'] = []; if ( empty( $m4is_u2a3d5['name'] ) ) { return; } $m4is_g8qm[] = $m4is_u2a3d5; $this->m4is_mej_t0->m4is_co90ks( $m4is_g8qm ); } 
function m4is_qfg13() { m4is__95_::m4is_r6_jy(); $this->m4is_by18n(); if ($this->m4is_shny == 'about' ) { $this->m4is_j2rol(); } elseif ( $this->m4is_shny == 'leaderboards' ) { $this->m4is_sx0q(); } $this->m4is_z8xv(); } private 
function m4is_by18n() { echo '</h2>'; echo '<div class="memberium_tabcontent" style="margin-top:10px;">'; echo '<div class="wrap">'; echo '<h2>', _( 'Affiliate Leaderboard Settings' ), '</h2>'; echo '<h2 class="nav-tab-wrapper">'; foreach ( $this->m4is_m_fnw0 as $m4is_obgvz => $m4is_ho0w2 ) { $m4is_mn_xj = ( $m4is_obgvz == $this->m4is_shny ) ? ' nav-tab-active' : ''; if ( $m4is_obgvz == $this->m4is_shny ) { echo "<span class='nav-tab$m4is_mn_xj'>$m4is_ho0w2</span>"; } else { echo "<a class='nav-tab{$m4is_mn_xj}' href='?page=", $_GET['page'], "&tab={$m4is_obgvz}'>{$m4is_ho0w2}</a>"; } } echo '</h2>'; echo '<div class="memberium_tabcontent" style="margin-top:10px;">'; } 
function m4is_j2rol() { echo '<h2>Memberium Affiliate Leaderboard Extension for Keap</h2>'; echo '<p>', _( 'Version' ), ' ', $this->m4is_mej_t0->m4is_gu3m(), '</p>'; echo '<p>Copyright &copy; 2017-2022 David Bullock</p>'; } 
function m4is_sx0q() { $m4is_g8qm = $this->m4is_mej_t0->m4is_owh5(); $m4is_ye72pa = m4is_i6vs::m4is_a6x52r(); $m4is_yar3 = m4is_vvgc8::m4is_yelt(); if ( ! empty( $m4is_g8qm ) ) { echo '<h3>Live Leaderboards</h3>'; echo '<form method="post">'; echo '<table class="widefat">'; echo '<tr>'; echo '<td style="width:50px;">Delete</td>'; echo '<td>Name</td>'; echo '<td style="width:50px;">Type</td>'; echo '<td style="width:50px;">Slots</td>'; echo '<td style="width:75px;">Start</td>'; echo '<td style="width:75px;">End</td>'; echo '<td>Products</td>'; echo '<td style="width:75px;">&nbsp;</td>'; echo '</tr>'; foreach( $m4is_g8qm as $m4is_ap3_ => $m4is_g4ulmz ) { echo '<tr>'; echo '<td><input type="checkbox" name="profile[',$m4is_ap3_,'][delete]" value="1"></td>'; echo '<td>', $m4is_g4ulmz['name'] ,'</td>'; echo '<td>', ucwords( $m4is_g4ulmz['type'] ) ,'</td>'; echo '<td><input type="number" style="width:50px;" value="', $m4is_g4ulmz['slots'], '" step="1" min="1" name="profile[',$m4is_ap3_,'][slots]"></td>'; echo '<td><input type="date" value="', $m4is_g4ulmz['start_date'], '" name="profile[',$m4is_ap3_,'][start_date]"></td>'; echo '<td><input type="date" value="', $m4is_g4ulmz['end_date'], '" name="profile[',$m4is_ap3_,'][end_date]"></td>'; echo '<td>'; $m4is_b9tyc = empty( $m4is_g4ulmz['products'] ) ? [] : array_filter( explode( ',', $m4is_g4ulmz['products'] ) ); $m4is_k2qb08 = ''; if ( ! empty( $m4is_b9tyc ) ) { foreach( $m4is_b9tyc as $m4is_b40e_m ) { $m4is_k2qb08 .= $m4is_yar3[$m4is_b40e_m]['ProductName'] . ', '; } unset( $m4is_b9tyc, $m4is_b40e_m ); } echo trim( $m4is_k2qb08, ', ' ); echo '</td>'; echo '<td><button name="refresh" class="button button-primary" value="', $m4is_ap3_, '">Refresh</button></td>';  echo '</tr>'; } echo '</table>'; echo '<p><input type="submit" name="update-leaderboard" value="Update Leaderboards" class="button-primary"></p>'; echo '</form>'; } else { echo '<p>You have no affiliate leaderboards created.  Create one now!</p>'; } echo '<form method="post" id="newprofile">'; echo '<ul>'; echo '<h3>Create New Leaderboard</h3>'; $m4is_w5ky4q = [ 'id' => 'newprofile_name', 'label' => 'Profile Name', 'placeholder' => 'Enter a name for your Leaderboard here', 'required' => true, 'size' => 40, ]; echo m4is__95_::m4is_sjcz54('name', $m4is_w5ky4q); $m4is_wmzqp = [ 'leads' => 'Most Leads', 'dollars' => 'Most Sales by Dollar Amount', 'invoices' => 'Most Sales by Invoice Count', ]; $m4is_w5ky4q = [ 'id' => 'newprofile_type', 'class' => 'basic-single', 'style' => 'width:250px;', ]; $m4is_qs_o1n = null; echo '<li><label>Leaderboard Type</label>'; echo m4is_zvyj::m4is_a6x52r()->m4is_ak52('type', $m4is_wmzqp, $m4is_qs_o1n, $m4is_w5ky4q); echo m4is__95_::m4is_d6u3( 0000 ), '</li>'; $m4is_w5ky4q = [ 'id' => 'newprofile_slots', 'label' => 'Slots', 'placeholder' => '', 'type' => 'number', 'min' => 1, 'step' => 1, 'value' => 10, 'style' => 'width:50px;', 'required' => true, ]; echo m4is__95_::m4is_sjcz54( 'slots', $m4is_w5ky4q ); $m4is_w5ky4q = [ 'id' => 'newprofile_start_date', 'label' => 'Start Date', 'placeholder' => 'mm/dd/yyyy', 'size' => 10, 'type' => 'date', 'required' => true, ]; echo m4is__95_::m4is_sjcz54( 'start_date', $m4is_w5ky4q ); $m4is_w5ky4q = [ 'id' => 'newprofile_end_date', 'label' => 'End Date', 'placeholder' => 'mm/dd/yyyy', 'size' => 10, 'type' => 'date', 'required' => true, ]; echo m4is__95_::m4is_sjcz54( 'end_date', $m4is_w5ky4q ); $m4is_w5ky4q = [ 'id' => 'newprofile_products', 'label' => 'Products', 'placeholder' => 'Select the products for your leaderboard, or leave blank for all', 'type' => 'text', 'class' => 'multiproductlistdropdown', 'style' => 'width:500px;', 'required' => false, ]; echo m4is__95_::m4is_sjcz54( 'products', $m4is_w5ky4q ); echo '</ul>'; echo '<p><input type="submit" name="create-leaderboard" value="Create Leaderboard" class="button-primary"></p>'; echo '</form>'; echo '<hr>'; echo '</div>'; echo '</div>'; } 
function m4is_z8xv() { $m4is_yar3 = m4is_vvgc8::m4is_yelt(); $m4is_v6yp = []; if ( empty( $m4is_yar3) || ! is_array( $m4is_yar3 ) ) { return; }  foreach( $m4is_yar3 as $m4is_jfohk ) { $m4is_v6yp[] = [ 'id' => $m4is_jfohk['Id'], 'text' => $m4is_jfohk['ProductName'] . ' (' . $m4is_jfohk['Id'] . ')' ]; } $m4is_v6yp = json_encode( $m4is_v6yp ); echo '<script>'; echo 'var productlist = ', $m4is_v6yp, ';'; echo '</script>'; } } ?>
<script>
	jQuery( '#newprofile').change( function() {
		var profile_type = jQuery( '#newprofile_type' ).val();
		if ( profile_type == 'leads' ) {
			jQuery(".filteroptions").prop( 'disabled', true );
			jQuery(".filteroptions").hide();
		}
		else {
			jQuery(".filteroptions").prop( 'disabled', false );
			jQuery(".filteroptions").show();
		}
	});

</script>
