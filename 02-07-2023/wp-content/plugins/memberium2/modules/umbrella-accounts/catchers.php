<?php
/**
 * Copyright (c) 2012-2022 David J Bullock
 * Web Power and Light
 */

 class_exists('m4is_emz57o') || die(); m4is_oid6::m4is_gopgz(); final 
class m4is_oid6 { static private $m4is_bxv7u, $m4is_ahusy0, $m4is_xwyj; private 
function __construct() {} static 
function m4is_gopgz() { self::$m4is_bxv7u = memberium_app(); self::$m4is_ahusy0 = 'memberium'; self::$m4is_xwyj = m4is_skoru::m4is_a6x52r(); } static 
function m4is_ch26r() { global $memb_messages; m4is_d8yr0_::m4is_vsv0mr(); $m4is_cl51 = (int) $_POST['contact_id']; if ( md5( wp_salt( 'nonce' ) . $m4is_cl51 ) <> $_POST['signature'] ) { return; } $m4is_kbu63_ = [ self::$m4is_xwyj->m4is_vwpz() => '', ]; $m4is_cl51 = (int) $m4is_cl51; $m4is_g3ea2 = (int) self::$m4is_xwyj->m4is_z06f2(); $m4is_ts5qpx = self::$m4is_xwyj->m4is_nt0r_(); m4is_zbyh::m4is_pp0i( $m4is_cl51, $m4is_kbu63_ );  m4is_f84s3h::m4is_zox_z5( $m4is_cl51, $m4is_ts5qpx ); m4is_f84s3h::m4is_ot30uq( $m4is_cl51, $m4is_g3ea2 ); self::$m4is_bxv7u->m4is_qjrxkl($m4is_cl51); $memb_messages['flash']['create_child_result'] = '<p style="color:green;font-weight:bold;">' . _x( 'Child Account removed.', 'umbrella_list_children', 'memberium' ) . '</p>'; } static 
function m4is_c7i0g() { m4is_d8yr0_::m4is_vsv0mr(); global $memb_messages; if ( ! wp_verify_nonce( $_POST['_wpnonce'], 'memb_childenroll' ) ) { wp_die( 'Security Check Failed - Nonce Validation Error' ); exit; } if ( ! self::$m4is_bxv7u->m4is_c479wl( $_POST['digital_signature'], $_POST['params'] ) ) { wp_die( 'Security Check Failed - Signature Validation Error'); exit; } $_SESSION = self::$m4is_bxv7u->m4is_q4nu( get_current_user_id() ); $m4is_h028 = self::$m4is_xwyj->m4is_evz8xq(); $m4is_ptl_ = self::$m4is_xwyj->m4is_vwpz(); $m4is_h89ijm = (int) self::$m4is_xwyj->m4is_j2ualz('child_added_actionset'); $m4is_np38n = (int) self::$m4is_xwyj->m4is_j2ualz('parent_added_actionset'); $m4is_lc3k = (string) self::$m4is_xwyj->m4is_j2ualz('child_added_goal'); $m4is_lj07 = (string) self::$m4is_xwyj->m4is_j2ualz('parent_added_goal'); $m4is_rxc9n1 = unserialize( base64_decode( $_POST['params'] ) ); $m4is_zoamug = strtolower( $m4is_h028 ); $m4is_k51joe = (int) $m4is_rxc9n1['contact_id']; $m4is_cl51 = 0; $m4is_rdle = explode( ',', $m4is_rxc9n1['allowed_actions'] ); $m4is_r10ye = isset( $_POST['actions'] ) ? (int) $_POST['actions'] : 0; $m4is_pdbhlw = isset( $_POST['goal'] ) ? trim( $_POST['goal'] ) : ''; $m4is_m2h6b = strtolower( trim( $_POST['Email'] ) );  if ( ! in_array( $m4is_r10ye, $m4is_rdle ) ) { $m4is_r10ye = 0; } if ( empty( $m4is_m2h6b ) ) { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( 'Email is Required', 'umbrella_enroll_child', 'memberium' ) . '</p>'; return; } if ( empty( $_POST['FirstName'] ) ) { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( 'First Name is Required', 'umbrella_enroll_child', 'memberium' ) . '</p>'; return; }  $m4is_o7mygi = get_user_by( 'email', $m4is_m2h6b ); if ($m4is_o7mygi && user_can($m4is_o7mygi, 'edit_others_posts')) { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( 'You cannot add site staff members.', 'umbrella_enroll_child', 'memberium' ) . '</p>'; return; }  if ( $m4is_m2h6b == strtolower(trim( m4is_lpl4d::m4is_bfi49( $m4is_ptl_ ) ) ) ) { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( "You can't add yourself.", 'umbrella_enroll_child', 'memberium' ) . '</p>'; return; }  $m4is_hkp7s = [ 'Id', $m4is_h028, $m4is_ptl_ ]; $m4is_bhufw = m4is_zbyh::m4is_tukr( $m4is_m2h6b, $m4is_hkp7s ); foreach( $m4is_bhufw as $m4is_b40e_m => $child_contact ) { if (! empty($child_contact[$m4is_ptl_]) || ! empty($child_contact[$m4is_h028]) ) { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x("You can't add this account.", 'umbrella_enroll_child', 'memberium' ) . '</p>'; return; } if ( isset($child_contact[$m4is_ptl_]) && $child_contact[$m4is_ptl_] == m4is_lpl4d::m4is_bfi49( $m4is_zoamug ) ) { $m4is_cl51 = $child_contact['Id']; } if ( empty( $child_contact[$m4is_ptl_] ) ) { $m4is_cl51 = $child_contact['Id']; } } $m4is_vh_1bx = m4is_f84s3h::m4is_cm6nr( 'Contact', false );   if ( $m4is_cl51 == 0 ) {  $m4is_kbu63_ = []; $m4is_kbu63_[$m4is_ptl_] = self::$m4is_xwyj->m4is_kmxvt(m4is_lpl4d::m4is_bfi49($m4is_zoamug), 'child'); foreach ( $_POST as $m4is_sv3h => $m4is_rhfd ) { if ( in_array( $m4is_sv3h, $m4is_vh_1bx ) ) { $m4is_kbu63_[$m4is_sv3h] = stripslashes($m4is_rhfd); } } $m4is_cl51 = m4is_zbyh::m4is_dj3iv($m4is_kbu63_); m4is_zbyh::m4is_pp0i($m4is_cl51, $m4is_kbu63_); if ( $m4is_cl51 > 0 ) { m4is_zbyh::m4is_kbc0w($m4is_m2h6b, 'Added by Memberium Umbrella Account System'); m4is_f84s3h::m4is_zox_z5($m4is_cl51, $m4is_lc3k); m4is_f84s3h::m4is_zox_z5($m4is_cl51, $m4is_pdbhlw); m4is_f84s3h::m4is_zox_z5($m4is_k51joe, $m4is_lj07); self::$m4is_bxv7u->m4is_evrbh($m4is_h89ijm, $m4is_cl51); self::$m4is_bxv7u->m4is_evrbh($m4is_np38n, $m4is_k51joe); self::$m4is_bxv7u->m4is_evrbh($m4is_r10ye, $m4is_cl51); $memb_messages['flash']['create_child_result'] = '<p style="color:green;font-weight:bold;">' . _x( 'Child Account added.', 'umbrella_enroll_child', 'memberium' ) . '</p>'; } } else { foreach ( $_POST as $m4is_sv3h => $m4is_rhfd ) { if ( in_array( $m4is_sv3h, $m4is_vh_1bx ) ) { $m4is_kbu63_[$m4is_sv3h] = stripslashes($m4is_rhfd); } } if ( empty( $child_contact[$m4is_ptl_] ) ) { $m4is_kbu63_[$m4is_ptl_] = self::$m4is_xwyj->m4is_kmxvt( m4is_lpl4d::m4is_bfi49( $m4is_zoamug ), 'child' ); m4is_zbyh::m4is_pp0i($m4is_cl51, $m4is_kbu63_ );  m4is_f84s3h::m4is_zox_z5($m4is_cl51, $m4is_lc3k); m4is_f84s3h::m4is_zox_z5($m4is_cl51, $m4is_pdbhlw); m4is_f84s3h::m4is_zox_z5($m4is_k51joe, $m4is_lj07); m4is_f84s3h::m4is_ot30uq((int) $m4is_cl51, (int) $m4is_h89ijm); m4is_f84s3h::m4is_ot30uq((int) $m4is_k51joe, (int) $m4is_np38n); m4is_f84s3h::m4is_ot30uq((int) $m4is_cl51, (int) $m4is_r10ye); $memb_messages['flash']['create_child_result'] = '<p style="color:green;font-weight:bold;">' . _x( 'Child Account assigned.', 'umbrella_enroll_child', 'memberium' ) . '</p>'; } else { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( 'That account already assigned to a user.', 'umbrella_enroll_child', 'memberium' ) . '</p>'; } }  if ( $m4is_cl51 ) { sleep(1); self::$m4is_bxv7u->m4is_qjrxkl( $m4is_cl51 ); } do_action( 'memberium_umbrella_add_child', $m4is_cl51, $m4is_k51joe ); do_action( 'memberium/umbrella/add_child', $m4is_cl51, $m4is_k51joe ); return; } static 
function m4is_n05bs3() { m4is_d8yr0_::m4is_vsv0mr();  if (! wp_verify_nonce($_POST['umbrella_transfer_points_wpnonce'], $_POST['signature']) ) { wp_die( 'Security Check Failed - Nonce Validation Error' ); exit; } $m4is_a6g9qj = false; $m4is_rxc9n1 = unserialize(base64_decode($_POST['signature']) ); $m4is_lx0o = (int) $_POST['points']; $m4is__9rq = sanitize_email($_POST['recipient']); $m4is_tenvhx = $m4is_rxc9n1['field']; $m4is_zv59 = new stdclass; $m4is_zv59->max_points = $m4is_rxc9n1['max_points']; $m4is_zv59->points = $m4is_lx0o; $parent_contact_id = $m4is_rxc9n1['pcid']; $child_contact_id = memberium_app()->m4is__yge($m4is__9rq);  if ($m4is_lx0o == 0) { $m4is_a6g9qj = true; $m4is_zv59->error_type = 'no_points_transferred'; } if ($m4is_lx0o > $m4is_rxc9n1['max_points'] || $m4is_lx0o < 1) { $m4is_a6g9qj = true; $m4is_zv59->error_type = 'invalid_points'; } if (! $parent_contact_id || ! $child_contact_id) { $m4is_a6g9qj = true; $m4is_zv59->error_type = 'invalid_users'; } if ( ! $m4is_a6g9qj) { $m4is_flxjy = memberium_app()->m4is_gnk8qe($child_contact_id, $m4is_tenvhx); $m4is_k4if = $m4is_zv59->max_points - $m4is_lx0o; $m4is_hv15lm = $m4is_flxjy + $m4is_lx0o; memberium_app()->m4is_g1svi($m4is_tenvhx, $m4is_k4if, $parent_contact_id ); memberium_app()->m4is_g1svi($m4is_tenvhx, $m4is_hv15lm, $child_contact_id ); $m4is_zv59->error_type = false; $m4is_zv59->points = $m4is_lx0o; } $_SESSION['flash']['umbrella_transfer_points'] = m4is_qipkj::m4is_jers4('umbrella_transfer_points_result', null, null, null, $m4is_zv59); } static 
function m4is_xoitp() { m4is_d8yr0_::m4is_vsv0mr(); $m4is_q4c_xa = get_current_user_id(); $m4is_yj5ls9 = []; $m4is_bhbc = m4is_skoru::m4is_a6x52r()->m4is_ngh7p(); $m4is_rxc9n1 = isset($_POST['params']) ? unserialize(base64_decode($_POST['params']) ) :[];  $m4is_bhbc = apply_filters('memberium/umbrella/download_csv', $m4is_bhbc); $m4is_bhbc = apply_filters("memberium/umbrella/download_csv/{$m4is_rxc9n1['filter_name']}", $m4is_bhbc); foreach($m4is_bhbc as $k => $v) { } } }
