<?php
/**
 * Copyright (c) 2012-2022 David J Bullock
 * Web Power and Light
 */

 class_exists('m4is_emz57o') || die(); final 
class m4is_skoru { static 
function m4is_a6x52r() : self { static $m4is_jprj8 = false; return $m4is_jprj8 ? $m4is_jprj8 : $m4is_jprj8 = new self; } private 
function __construct() { $this->settings = $this->m4is_zld3p(); $this->m4is_ap508(); $this->m4is_gg_4(); } 
function m4is_zld3p() { $this->settings = get_option('memberium_umbrella_settings', []); $m4is_p78sgz = [ 'add_child_actionset' => 0, 'child_added_goal' => '', 'child_cancel_goal' => '', 'parent_added_goal' => '', 'child_cancel_actionset' => 0, 'child_field' => 'ReferralCode', 'ecommerce' => 1, 'inherited_fields' => '', 'ld_quiz_notify_parent' => 0, 'max_child_accounts' => 10, 'parent_added_actionset' => 0, 'parent_cache_ttl' => 86400, 'parent_field' => 'ReferralCode', 'parent_tags' => '', 'tag_mask' => '', 'tag_mask_field' => '', 'tag_translation' => [], ]; $this->settings = wp_parse_args($this->settings, $m4is_p78sgz); foreach( $this->settings as $m4is_ap3_ => $m4is_rhfd ) { $this->$m4is_ap3_ = $this->settings[$m4is_ap3_]; } return $this->settings; } private 
function m4is_ap508() {  add_action('init', [$this, 'm4is_xk1l9']); add_action('memberium_email_change', [$this, 'm4is_ppzu67']); add_filter('learndash_get_report_user_ids', [$this, 'm4is_qh2ds_'], 10, 1 ); add_filter('memberium_contact_load', [$this, 'm4is_flrqhn'], 10, 1 ); add_filter('memberium/umbrella/child_contact_ids', [$this, 'm4is_tq2sjc'], 10, 1 ); add_filter('memberium/umbrella/child_count', [$this, 'm4is_xye8'], 10, 1 ); add_filter('memberium/umbrella/child_wpuser_ids', [$this, 'm4is_ngh7p'], 10, 1 ); add_filter('memberium/umbrella/parent_wpuser_id', [$this, 'm4is_l14dih'], 10, 1 ); if ( defined( 'DOING_CRON' ) ) { add_action('memberium_maintenance12', [$this, 'm4is_gt3ufa']); } } private 
function m4is_gg_4() { if (wp_doing_ajax() || ! is_admin() ) { $m4is_zugtql = 'm4is_iapi21'; memberium_app()->m4is_wdf4zp( $m4is_zugtql, __DIR__ . '/shortcodes' ); add_shortcode('umbrella_child_count', [$m4is_zugtql, 'm4is_u9voj']); add_shortcode('umbrella_download_csv', [$m4is_zugtql, 'm4is_zq1pos']); add_shortcode('umbrella_enroll_child', [$m4is_zugtql, 'm4is_d7bd']); add_shortcode('umbrella_ld_course_info', [$m4is_zugtql, 'm4is_k8xrl']); add_shortcode('umbrella_list_children', [$m4is_zugtql, 'm4is_d7o2ys']); add_shortcode('umbrella_list_children_nav', [$m4is_zugtql, 'm4is_jt18ui']); add_shortcode('umbrella_lms_dashboard', [$m4is_zugtql, 'm4is_rpnktu']); add_shortcode('umbrella_transfer_points', [$m4is_zugtql, 'm4is_tqa8']); } } 
function m4is_gu3m() { return $this->version; } 
function m4is__qy9a3($m4is_tct_hk = false) { if ( $m4is_tct_hk === false ) { $m4is_tct_hk = $this->settings; } update_option('memberium_umbrella_settings', $m4is_tct_hk, 'yes'); }  
function m4is_gy539($m4is_sfxdru = 86400) { $this->parent_cache_ttl = (int) $m4is_sfxdru; $this->settings['parent_cache_ttl'] = $this->parent_cache_ttl; }  
function m4is_x6xqbo() { return $this->settings['parent_tags']; } 
function m4is_p7ho() { return $this->settings['tag_mask']; } 
function m4is_k9h2() { return $this->settings['parent_cache_ttl']; } 
function m4is_f8rn() { return $this->settings['tag_mask_field']; } 
function m4is_evz8xq() { return $this->settings['parent_field']; } 
function m4is_vwpz() { return $this->settings['child_field']; } 
function m4is_qkoil() {  $m4is_ejfox = (int) $this->settings['max_child_accounts'];  if ( ! empty( $this->settings['child_count_add'] ) ) { $m4is_ap3_ = strtolower( $this->settings['child_count_add'] ); $m4is_ejfox = $m4is_ejfox + (int) m4is_lpl4d::m4is_bfi49( $m4is_ap3_ ); }  if ( ! empty( $this->settings['tag_grants'] ) ) { foreach( $this->settings['tag_grants'] as $m4is_qxtoe => $m4is_rhfd ) { if ( memberium_app()->m4is_ww6ul( $m4is_qxtoe ) ) { $m4is_ejfox = $m4is_ejfox + $m4is_rhfd; } } }  if ( $this->settings['ecommerce'] ) { $m4is_uke5g = memberium_app()->m4is_u6sg(); if ( ! empty( $m4is_uke5g ) ) { $m4is_ndw7 = date('Ymd') . 'T23:59:59'; foreach( $m4is_uke5g as $m4is_ie4p50 ) { $m4is_ie4p50['EndDate'] = isset($m4is_ie4p50['EndDate']) ? $m4is_ie4p50['EndDate'] : ''; $m4is_ie4p50['Active'] = isset($m4is_ie4p50['Active']) ? $m4is_ie4p50['Active'] : ''; if ($m4is_ie4p50['Status'] == 'Active' || $m4is_ie4p50['EndDate'] > $m4is_ndw7) { $m4is_z2ra_ = $m4is_ie4p50['SubscriptionPlanId']; $m4is_ejfox = $m4is_ejfox + ( empty( $this->settings['subscriptions'][$m4is_z2ra_] ) ? 0 : ($this->settings['subscriptions'][$m4is_z2ra_] * $m4is_ie4p50['Qty']) ); } } } }  $m4is_ejfox = apply_filters( 'umbrella_child_count', $m4is_ejfox ); return $m4is_ejfox; } 
function m4is_z06f2() { return $this->settings['child_cancel_actionset']; } 
function m4is_nt0r_() { return $this->settings['child_cancel_goal']; }    
function m4is_xk1l9() {  if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['formtype']) ) { $m4is_ieg4s = 'm4is_oid6'; memberium_app()->m4is_wdf4zp( $m4is_ieg4s, __DIR__ . '/catchers' ); if ($_POST['formtype'] == 'childdisconnect') { $m4is_ieg4s::m4is_ch26r(); } elseif ($_POST['formtype'] == 'childenroll') { $m4is_ieg4s::m4is_c7i0g(); } elseif ($_POST['formtype'] == 'umbrella_points_transfer') { $m4is_ieg4s::m4is_n05bs3(); } elseif ($_POST['formtype'] == 'umbrella_csv_download') { $m4is_ieg4s::m4is_xoitp(); } } }    
function m4is_gt3ufa() { }    
function m4is_qh2ds_( $m4is_g2prf ) { if ( ! is_super_admin() ) { $m4is_bhbc = $this->m4is_ngh7p(); $m4is_g2prf = array_merge( $m4is_g2prf, $m4is_bhbc ); } return $m4is_g2prf; } private 
function m4is_ci6o_() { return ! in_array($this->m4is_evz8xq(), ['Email', 'EmailAddress2', 'EmailAddress3']); } private 
function m4is_n8m7wy($m4is_znf9) { $m4is_ruatp3 = array_filter(explode(',', $this->m4is_x6xqbo() ) ); return (bool) array_intersect($m4is_ruatp3, $m4is_znf9); } private 
function m4is_eins($m4is_nq7s) { $m4is_h028 = $this->m4is_evz8xq(); $m4is_nlo6n = ''; if (empty($m4is_nq7s[$m4is_h028]) ) { if ($this->m4is_ci6o_() ) { $m4is_nlo6n = $this->m4is_yujb0(); } if (! empty($m4is_nlo6n)) { $m4is_nq7s[$m4is_h028] = $m4is_nlo6n; memberium_app()->m4is_g1svi($m4is_h028, $m4is_nlo6n, $m4is_nq7s['Id']); } } return $m4is_nq7s; } 
function m4is_flrqhn($m4is_nq7s = []) { if ( empty( $m4is_nq7s ) ) { return $m4is_nq7s; } if ( $this->doing_raw_load ) { return $m4is_nq7s; } $m4is_znf9 = isset( $m4is_nq7s['Groups'] ) ? array_filter( explode( ',', $m4is_nq7s['Groups'] ) ) : []; if ( $this->m4is_n8m7wy( $m4is_znf9 ) ) { $m4is_nq7s = $this->m4is_eins( $m4is_nq7s ); return $m4is_nq7s; } $m4is_qp8a1f = $this->m4is_vwpz(); $this->settings = $this->m4is_zld3p(); $m4is_c_ch0 = $this->m4is_evz8xq(); $m4is_ukic = $this->m4is_f8rn(); $m4is_hh70 = empty( $m4is_nq7s[$m4is_qp8a1f] ) ? '' : $m4is_nq7s[$m4is_qp8a1f];  if ( ! empty( $m4is_hh70 ) ) { $m4is_w5ky4q = [ 'parent_id' => $m4is_hh70, 'contact_id' => $m4is_nq7s['Id'], 'contact' => $m4is_nq7s, ]; $m4is_cq506e = $this->m4is_i54q9w( $m4is_w5ky4q ); if ( $m4is_cq506e > 0 ) { $m4is_w5ky4q = [ 'contact_id' => $m4is_cq506e, 'cache_ttl' => $this->m4is_k9h2() ]; memberium_app()->m4is_gd_az( $m4is_w5ky4q ); $m4is_nq7s['!parent_id'] = $m4is_cq506e; $this->doing_raw_load = true; $m4is_tzbqa = m4is_zbyh::m4is_w1bfmt( $m4is_cq506e ); $this->doing_raw_load = false; $m4is_fn4a9 = explode( ',', $this->settings['parent_tags'] ); $m4is_ruatp3 = isset( $m4is_tzbqa['Groups'] ) ? array_filter( explode( ',', $m4is_tzbqa['Groups'] ) ) : []; $m4is_mc8m0 = isset( $m4is_tzbqa[$m4is_ukic] ) ? array_filter( explode( ',', $m4is_tzbqa[$m4is_ukic] ) ) : []; $m4is_dnib = array_filter( explode( ',', $this->m4is_p7ho() ) ); $m4is_k9ahz = $this->settings['tag_translation']; $m4is_ac1bdn = isset( $this->settings['whitelist_memberships'] ) ? explode( ',', $this->settings['whitelist_memberships'] ) : []; $m4is_ruatp3 = array_diff( $m4is_ruatp3, $m4is_fn4a9 );   if ( ! empty( $this->settings['tag_whitelist'] ) || ! empty( $this->settings['whitelist_memberships'] ) ) { $m4is_ac1bdn = array_filter( explode( ',', $this->settings['tag_whitelist'] ) ); if ( ! empty( $this->settings['whitelist_memberships'] ) ) { $m4is_fdf0v = memberium_app()->m4is_mmdrl(); $m4is_fdf0v = $m4is_fdf0v['memberships']; foreach( $m4is_fdf0v as $m4is_tyoak ) { $m4is_ac1bdn[] = (int) $m4is_tyoak['main_id']; $m4is_ac1bdn[] = (int) $m4is_tyoak['addltag_ids']; $m4is_ac1bdn[] = (int) $m4is_tyoak['payf_id']; $m4is_ac1bdn[] = (int) $m4is_tyoak['cancel_id']; $m4is_ac1bdn[] = (int) $m4is_tyoak['suspend_id']; } unset( $m4is_fdf0v, $m4is_tyoak ); $m4is_ac1bdn = array_filter( $m4is_ac1bdn ); } $m4is_ruatp3 = array_intersect( $m4is_ruatp3, $m4is_ac1bdn ); } else {   $m4is_ruatp3 = array_diff( $m4is_ruatp3, $m4is_dnib, $m4is_mc8m0 ); }  if ( is_array( $m4is_k9ahz ) ) { foreach( $m4is_k9ahz as $m4is_o2mf => $m4is_dyseo ) { $m4is_ap3_ = array_search( $m4is_o2mf, $m4is_ruatp3 ); if ( $m4is_ap3_ !== false ) { $m4is_ruatp3[$m4is_ap3_] = $m4is_dyseo; } } } $m4is_nq7s['Groups'] = implode( ',', array_unique( array_filter( array_merge( explode( ',', $m4is_nq7s['Groups'] ), $m4is_ruatp3 ) ) ) ); $m4is_u_ipv = array_filter( explode( ',', $this->inherited_fields ) );  if ( ! empty( $m4is_u_ipv ) ) { foreach( $m4is_u_ipv as $m4is_sv3h ) { if ( empty( $m4is_nq7s[$m4is_sv3h] ) ) { $m4is_nq7s[$m4is_sv3h] = $m4is_tzbqa[$m4is_sv3h]; } } } } } return $m4is_nq7s; } 
function m4is_ppzu67( $m4is_aicfp = 0, $m4is_q4c_xa = 0, $m4is_iz4s = '', $m4is_m2h6b = '' ) { $m4is_ptl_ = $this->m4is_vwpz(); $lparent_field = strtolower( $this->m4is_evz8xq() ); if ( ! in_array( $lparent_field, ['email', 'emailaddress2', 'emailaddress3']) ) { return; } if ( empty( $m4is_iz4s ) || empty( $m4is_m2h6b ) ) { return; } $m4is_w5ky4q = [ $m4is_ptl_ => $m4is_iz4s ]; $m4is_ulo1 = $this->m4is_tq2sjc( $m4is_w5ky4q ); if ( is_array( $m4is_ulo1 ) && ! empty( $m4is_ulo1 ) ) { foreach( $m4is_ulo1 as $m4is_aicfp ) { $m4is_kbu63_ = [ $m4is_ptl_ => $m4is_m2h6b, ]; m4is_zbyh::m4is_pp0i($m4is_aicfp, $m4is_kbu63_);  } } }    
function m4is_yujb0() { return uniqid( 'prnt-', true ); } 
function m4is_i54q9w($m4is_w5ky4q = []) { global $wpdb; if ( empty( $m4is_w5ky4q['contact_id'] ) ) { return false; } $m4is_nq7s = empty( $m4is_w5ky4q['contact'] ) ? [] : $m4is_w5ky4q['contact']; $m4is_aicfp = empty( $m4is_w5ky4q['contact_id'] ) ? 0 : $m4is_w5ky4q['contact_id']; $m4is_cq506e = empty( $m4is_w5ky4q['parent_id'] ) ? 0 : $m4is_w5ky4q['parent_id']; $m4is_nhse_0 = $this->settings['child_field']; $m4is_y2o04 = explode( ',', $this->settings['parent_tags'] ); $m4is_k51joe = false; if ( empty( $m4is_nq7s[$m4is_nhse_0] ) ) { return false; } $m4is_p78sgz = [ 'appname' => memberium_app()->m4is_re5x('appname'), 'contact_id' => isset( $m4is_nq7s['Id'] ) ? $m4is_nq7s['Id'] : 0, 'child_field' => $this->settings['child_field'], 'parent_id' => isset( $m4is_nq7s[$m4is_nhse_0] ) ? $m4is_nq7s[$m4is_nhse_0] : '', ]; $m4is_w5ky4q = wp_parse_args($m4is_w5ky4q, $m4is_p78sgz); $m4is_w5ky4q['parent_id'] = $this->m4is_kmxvt( $m4is_w5ky4q['parent_id'], 'parent' ); $m4is_u13x = MEMBERIUM_DB_CONTACTS; $m4is_ioxk = "SELECT `c1`.`id`, `c2`.`value` as `tags` FROM `{$m4is_u13x}` AS `c1`, `{$m4is_u13x}` AS `c2` WHERE `c1`.`appname` = %s AND `c1`.`fieldname` = %s AND `c1`.`value` = %s AND `c1`.`id` <> %d AND `c2`.`id` = `c1`.`id` AND `c2`.`fieldname` = 'Groups' ORDER BY `c1`.`id`; "; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, $m4is_w5ky4q['appname'], $m4is_w5ky4q['child_field'], $m4is_w5ky4q['parent_id'], $m4is_w5ky4q['contact_id'] ); $m4is_tzbqa = $wpdb->get_row( $m4is_ioxk ); $m4is_znf9 = isset($m4is_tzbqa->tags) ? explode(',', $m4is_tzbqa->tags) : []; if ( array_intersect( $m4is_y2o04, $m4is_znf9 ) ) { $m4is_k51joe = $m4is_tzbqa->id; } return $m4is_k51joe; } 
function m4is_xye8($m4is_w5ky4q = []) { global $wpdb; $m4is_q7m2 = memberium_app()->m4is_re5x('appname'); $m4is_ptl_ = $this->settings['child_field']; $m4is_pzoaep = m4is_lpl4d::m4is_a_2z(); $m4is_el3g = strtolower( $this->settings['parent_field'] ); $m4is_aicfp = isset( $m4is_w5ky4q['contact_id'] ) ? $m4is_w5ky4q['contact_id'] : $m4is_pzoaep; $m4is_cq506e = memberium_app()->m4is_gnk8qe( $m4is_aicfp, $m4is_ptl_ ); $m4is_znoa3z = MEMBERIUM_DB_CONTACTS; $m4is_p78sgz = [ 'appname' => $m4is_q7m2, 'child_field' => $m4is_ptl_, 'contact_id' => $m4is_aicfp, 'limit' => 0, 'offset' => 0, 'parent_id' => $m4is_cq506e, ]; $m4is_w5ky4q = wp_parse_args( $m4is_w5ky4q, $m4is_p78sgz ); if ( $m4is_w5ky4q['parent_id'] <> $this->m4is_kmxvt( $m4is_w5ky4q['parent_id'], 'parent' ) ) { return 0; } $m4is_w5ky4q['parent_id'] = $this->m4is_kmxvt( $m4is_w5ky4q['parent_id'], 'child' ); $m4is_ioxk = "SELECT count(*) FROM `{$m4is_znoa3z}` WHERE `appname` = %s AND `fieldname` = %s AND `value` = %s AND `id` <> %d "; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, $m4is_w5ky4q['appname'], $m4is_w5ky4q['child_field'], $m4is_w5ky4q['parent_id'], $m4is_w5ky4q['contact_id'] ); $m4is_ejfox = $wpdb->get_var( $m4is_ioxk ); return $m4is_ejfox; } 
function m4is_l14dih($m4is_w5ky4q = []) { $m4is_p78sgz = [ 'user_id' => get_current_user_id(), ]; $m4is_w5ky4q = wp_parse_args($m4is_w5ky4q, $m4is_p78sgz); if ( memberium_app()->m4is_hlxrc($m4is_w5ky4q['user_id'])) { return isset($_SESSION['keap']['contact']['!parent_id']) ? $_SESSION['keap']['contact']['!parent_id'] : 0; } } 
function m4is_tq2sjc($m4is_w5ky4q = []) { global $wpdb; $m4is_q7m2 = memberium_app()->m4is_re5x('appname'); $m4is_ptl_ = $this->settings['child_field']; $m4is_pzoaep = m4is_lpl4d::m4is_a_2z(); $m4is_el3g = strtolower( $this->settings['parent_field'] ); $m4is_aicfp = isset( $m4is_w5ky4q['contact_id'] ) ? $m4is_w5ky4q['contact_id'] : $m4is_pzoaep; $m4is_cq506e = memberium_app()->m4is_gnk8qe( $m4is_aicfp, $m4is_ptl_ ); $m4is_znoa3z = MEMBERIUM_DB_CONTACTS; $m4is_p78sgz = [ 'appname' => $m4is_q7m2, 'child_field' => $m4is_ptl_, 'contact_id' => $m4is_aicfp, 'limit' => 0, 'offset' => 0, 'parent_id' => $m4is_cq506e, ]; $m4is_w5ky4q = wp_parse_args( $m4is_w5ky4q, $m4is_p78sgz ); if ( $m4is_w5ky4q['parent_id'] <> $this->m4is_kmxvt( $m4is_w5ky4q['parent_id'], 'parent' ) ) { return []; } $m4is_w5ky4q['parent_id'] = $this->m4is_kmxvt( $m4is_w5ky4q['parent_id'], 'child' ); $m4is_sl6k2 = ( $m4is_w5ky4q['limit'] > 0 ) ? " LIMIT {$m4is_w5ky4q['limit']} OFFSET {$m4is_w5ky4q['offset']} " : ''; $m4is_ioxk = "
			SELECT `c1`.`id`
			FROM `{$m4is_znoa3z}` AS `c1`
			LEFT JOIN `{$m4is_znoa3z}` AS `c2`
			ON ( `c2`.`id` = `c1`.`id` AND `c2`.`appname` = %s AND `c2`.`fieldname` = 'LastName' )
			LEFT JOIN `{$m4is_znoa3z}` AS `c3`
			ON ( `c3`.`id` = `c1`.`id` AND `c3`.`appname` = %s AND `c3`.`fieldname` = 'FirstName' )
			WHERE `c1`.`appname` = %s
			AND `c1`.`fieldname` = %s
			AND `c1`.`value` = %s
			AND `c1`.`id` <> %d
			ORDER BY `c2`.`value`, `c3`.`value`, `c1`.`id` ASC
			{$m4is_sl6k2}
		"; $m4is_ioxk = $wpdb->prepare( $m4is_ioxk, $m4is_w5ky4q['appname'], $m4is_w5ky4q['appname'], $m4is_w5ky4q['appname'], $m4is_w5ky4q['child_field'], $m4is_w5ky4q['parent_id'], $m4is_w5ky4q['contact_id'] ); $m4is_ulo1 = $wpdb->get_col( $m4is_ioxk ); return $m4is_ulo1; } 
function m4is_ngh7p( $m4is_w5ky4q = [] ) { $m4is_ulo1 = $this->m4is_tq2sjc( $m4is_w5ky4q ); if ( empty( $m4is_ulo1 ) ) { return []; } $wp_user_ids = []; foreach( $m4is_ulo1 as $m4is_aicfp ) { $m4is_q4c_xa = m4is_zbyh::m4is__nfdz9( $m4is_aicfp ); if ( $m4is_q4c_xa ) { $wp_user_ids[] = $m4is_q4c_xa; } } return $wp_user_ids; } 
function m4is_ilxab() { $m4is_ulo1 = $this->m4is_tq2sjc(); return (int) count( $m4is_ulo1 ); }   
function m4is__bhnz6( $m4is_w5ky4q = [] ) { global $wpdb; $m4is_p78sgz = [ 'child_contact' => [], 'm4is_v8mw2u' => true, 'optin' => true, 'parent_contact_id' => 0, 'parent_contact' => [], ]; $m4is_w5ky4q = wp_parse_args( $m4is_w5ky4q, $m4is_p78sgz );   if ( $m4is_w5ky4q['parent_contact_id'] ) { $m4is_w5ky4q['parent_contact'] = m4is_zbyh::m4is_w1bfmt( $m4is_w5ky4q['parent_contact_id'] ); }  if ( $m4is_w5ky4q['child_contact_id'] ) { $m4is_w5ky4q['child_contact'] = m4is_zbyh::m4is_w1bfmt( $m4is_w5ky4q['child_contact_id'] ); } if ( empty( $m4is_w5ky4q['child_contact'] ) || empty( $m4is_w5ky4q['parent_contact'] ) ) { return -1; }  $m4is_h028 = $this->m4is_evz8xq(); $m4is_aj8b = isset( $m4is_w5ky4q['parent_contact'][$m4is_h028] ) ? $m4is_w5ky4q['parent_contact'][$m4is_h028] : ''; if ( empty( $m4is_aj8b ) ) { return -2; }  $m4is_ptl_ = $this->m4is_vwpz(); if ( ! empty( $m4is_w5ky4q['child_contact'][$m4is_ptl_] ) ) { return -3; }  $m4is_wmzqp = memberium_app()->m4is_mmdrl(); $m4is_jyx_t = isset( $m4is_wmzqp['settings']['password_field']) ? $m4is_wmzqp['settings']['password_field'] : ''; if ( $m4is_w5ky4q['m4is_v8mw2u'] && empty( $m4is_w5ky4q['child_contact'][$m4is_jyx_t] ) ) { $m4is_w5ky4q['child_contact'][$m4is_jyx_t] = memberium_app()->m4is_v8mw2u(); } $m4is_cl51 = (int) $m4is_w5ky4q['child_contact']['Id']; $m4is_k51joe = (int) $m4is_w5ky4q['parent_contact_id']['Id'];  if ( empty( $m4is_w5ky4q['child_contact']['Id'] ) && ! empty( $m4is_w5ky4q['child_contact_id']['Email'] ) ) { $m4is_kbu63_ = $m4is_w5ky4q['child_contact']; $m4is_kbu63_[$m4is_ptl_] = $this->m4is_kmxvt( $m4is_aj8b, 'child' ); $m4is_cl51 = (int) m4is_zbyh::m4is_dj3iv($m4is_kbu63_); if ( $m4is_cl51 ) { $m4is_w5ky4q = [ 'contact_id' => $m4is_cl51, 'cache_ttl' => 0 ]; memberium_app()->m4is_gd_az( $m4is_w5ky4q ); $m4is_w5ky4q['child_contact_id'] = $m4is_cl51; $m4is_w5ky4q['child_contact']['Id'] = $m4is_cl51; $m4is_w5ky4q['parent_contact_id'] = (int) $m4is_w5ky4q['parent_contact_id']; if ( $m4is_w5ky4q['optin'] ) { m4is_zbyh::m4is_kbc0w( $m4is_w5ky4q['child_contact']['Email'], 'Added by Memberium Umbrella Account System' ); } m4is_f84s3h::m4is_zox_z5($m4is_cl51, $this->settings['child_added_goal']); m4is_f84s3h::m4is_zox_z5($m4is_k51joe, $this->settings['parent_added_goal']); m4is_f84s3h::m4is_ot30uq($m4is_cl51, (int) $this->settings['add_child_actionset'] ); m4is_f84s3h::m4is_ot30uq($m4is_k51joe, (int) $this->settings['parent_added_actionset'] ); } } return $m4is_cl51; } 
function m4is_kmxvt( $m4is_rz70ok = '', $m4is_oknpuo = 'raw' ) { if ( ! in_array( substr( $m4is_rz70ok, 0, 5 ), ['chld-', 'prnt-']) ) { $m4is_oknpuo = 'raw'; } $m4is_oknpuo = strtolower( trim( $m4is_oknpuo ) ); if ( $m4is_oknpuo == 'parent' ) { return 'prnt-' . substr( $m4is_rz70ok, 5 ); } elseif ( $m4is_oknpuo == 'child' ) { return 'chld-' . substr( $m4is_rz70ok, 5 ); } else { return $m4is_rz70ok; } }  public 
function m4is_j2ualz($m4is_ap3_ = '') { if (empty($m4is_ap3_)) { return $this->settings; } return isset($this->settings[$m4is_ap3_]) ? $this->settings[$m4is_ap3_] : null; } private $add_child_actionset = 0;  private $child_cancel_actionset = 0;  private $child_field = 'ReferralCode';  private $core = null; private $enabled = false;  private $inherited_fields = '';  private $max_child_accounts = 10;  private $max_child_field = '';  private $parent_added_actionset = 0;  private $parent_cache_ttl = 86400;  private $parent_field = 'ReferralCode';  private $settings = []; private $tag_mask = '';  private $tag_mask_field = '';  private $tag_translation = [];  private $version = '2.4'; private $doing_raw_load = false;  
function m4is_pas9q( $m4is_znf9 = '' ) { $this->tag_mask = trim( $m4is_znf9 ); $this->settings['tag_mask'] = $this->tag_mask; } 
function m4is_odgbi( $m4is_utu8 = '' ) { $this->tag_mask_field = $m4is_utu8; $this->settings['tag_mask_field'] = $this->tag_mask_field; } 
function m4is_ectsx8( $m4is_tenvhx = 'Email' ) { $this->child_field = $m4is_tenvhx; $this->settings['child_field'] = $this->child_field; } 
function m4is_cpl43($m4is_sv3h, $m4is_sw4b = true) { if ( $m4is_sw4b === null ) { unset( $this->inherited_fields[$m4is_sv3h] ); } else { $this->inherited_fields[$m4is_sv3h] = (boolean) $m4is_sw4b; } $this->settings['inherited_fields'] = $this->inherited_fields; } 
function m4is_r5ikft( $m4is_y2sw = 0, $m4is_km74 = 0 ) { if ( ! $m4is_y2sw && ! $m4is_km74 ) { return; } if ( $m4is_km74 == 0 ) { unset( $this->tag_translation[$m4is_y2sw] ); } if ( $m4is_km74 > 0 ) { $this->tag_translation[$m4is_y2sw] = $m4is_km74; } $this->settings['tag_translation'] = $this->tag_translation; } 
function m4is_ede7( $m4is_h028 = 'Email3' ) { $this->parent_field = $m4is_h028; $this->settings['parent_field'] = $this->parent_field; } 
function m4is_tjah( $m4is_hd84f9 ) { $m4is_hd84f9 = (int) $m4is_hd84f9; $this->add_child_actionset = (int) $m4is_hd84f9; $this->settings['add_child_actionset'] = $this->add_child_actionset; } 
function m4is_z19e( $m4is_hd84f9 ) { $m4is_hd84f9 = (int) $m4is_hd84f9; $this->parent_added_actionset = (int) $m4is_hd84f9; $this->settings['parent_added_actionset'] = $this->parent_added_actionset; } 
function m4is_pd9vo6( $m4is_hd84f9 ) { $m4is_hd84f9 = (int) $m4is_hd84f9; $this->child_cancel_actionset = (int) $m4is_hd84f9; $this->settings['child_cancel_actionset'] = $this->child_cancel_actionset; } 
function m4is_rvg6() { return $this->settings['add_child_actionset']; } 
function m4is_wz1b6k() { return $this->settings['parent_added_actionset']; } }
