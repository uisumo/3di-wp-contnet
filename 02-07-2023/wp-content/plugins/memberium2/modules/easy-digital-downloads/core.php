<?php
/**
 * Copyright (c) 2012-2022 David J Bullock
 * Web Power and Light
 */

 class_exists('m4is_p7r6h') || die(); final 
class m4is_p7r6h {    
function m4is_a7i_0() { return [ '_memberium_access_tag', '_memberium_canc_tag', '_memberium_main_tag', '_memberium_payf_tag', '_memberium_trial_tag', ]; } 
function m4is_zx1ak($m4is__xysg) { return [ 'main' => (string) get_post_meta($m4is__xysg, '_memberium_access_tag', true), 'trial' => (string) get_post_meta($m4is__xysg, '_memberium_trial_tag', true), 'payf' => (string) get_post_meta($m4is__xysg, '_memberium_payf_tag', true), 'canc' => (string) get_post_meta($m4is__xysg, '_memberium_canc_tag', true), ]; } 
function m4is__hzgu( $m4is_sdob0, $m4is_q4c_xa = 0 ) { $m4is__ntc3 = [ 'active', 'trialling', 'failing', ]; $m4is_q4c_xa = empty($m4is_q4c_xa) ? get_current_user_id() : $ev_user_id; $m4is_v7xvse = new EDD_Recurring_Subscriber( $m4is_q4c_xa, true ); $m4is_uke5g = $m4is_v7xvse->get_subscriptions( $m4is_sdob0, $m4is__ntc3 ); return count($m4is_uke5g) > 1; }    
function m4is_ckcq($m4is_x75t2) { $m4is_aicfp = 0; $m4is__u6f = edd_get_payment_meta($m4is_x75t2); $m4is_q4c_xa = empty($m4is__u6f['user_info']['id']) ? 0 : $m4is__u6f['user_info']['id']; $m4is_qj8o = edd_get_payment_meta_cart_details($m4is_x75t2);  if (! $m4is_q4c_xa) { $m4is_ijvi = empty($m4is__u6f['user_info']['email']) ? '' : $m4is__u6f['user_info']['email']; if ($m4is_ijvi) { $m4is_nzrv1 = get_user_by('email', $m4is_ijvi); $m4is_q4c_xa = is_a( $m4is_nzrv1, 'WP_User' ) ?$m4is_nzrv1->ID : 0; } }  if ($m4is_q4c_xa) { $m4is_aicfp = (int) memberium_app()->m4is_r231y($m4is_q4c_xa); if ($m4is_aicfp) { $m4is_o3mwus = []; foreach ($m4is_qj8o as $m4is_f3o6) { $m4is_wfopb = empty($m4is_f3o6['id']) ? 0 : $m4is_f3o6['id']; $m4is_l926 = $this->m4is_zx1ak($m4is_wfopb); $m4is_o3mwus[] = $m4is_l926['main']; $m4is_o3mwus[] = (0 - $m4is_l926['canc']); $m4is_o3mwus[] = (0 - $m4is_l926['payf']); } $m4is_o3mwus = array_unique($m4is_o3mwus, SORT_NUMERIC); memberium_app()->m4is__mkz( $m4is_o3mwus, $m4is_aicfp ); } } } 
function m4is_yo7xef($m4is_jc9gya, $m4is_j0n7) { $m4is_kwhzt = empty($m4is_j0n7['customer_id']) ? 0 : $m4is_j0n7['customer_id']; $m4is_rr90 = empty($m4is_j0n7['status']) ? '' : $m4is_j0n7['status']; $m4is_sdob0 = empty($m4is_j0n7['product_id']) ? 0 : $m4is_j0n7['product_id']; $m4is_q4c_xa = empty($m4is_j0n7['user_id']) ? 0 : $m4is_j0n7['user_id']; if ($m4is_q4c_xa) { $m4is_aicfp = (int) memberium_app()->m4is_r231y($m4is_q4c_xa); if ($m4is_aicfp) { $m4is_l926 = $this->m4is_zx1ak($m4is_sdob0); $m4is_o3mwus = []; if ($m4is_rr90 == 'trialling') { $m4is_o3mwus[] = $m4is_l926['trial']; } $m4is_o3mwus = array_unique($m4is_o3mwus, SORT_NUMERIC); memberium_app()->m4is__mkz( $m4is_o3mwus, $m4is_aicfp ); } } } 
function m4is_dunz8k( $m4is_bd4j, $m4is_ytwk3, $m4is_ie4p50 ) { if ($m4is_bd4j !== $m4is_ytwk3) { $m4is_kwhzt = $m4is_ie4p50->customer_id; $m4is_m86kw = new EDD_Customer($m4is_kwhzt); $m4is_q4c_xa = $m4is_m86kw->user_id; $m4is_sdob0 = $m4is_ie4p50->product_id; $m4is_f6dx = $self->m4is__hzgu( $m4is_sdob0, $m4is_q4c_xa ); if ($m4is_q4c_xa) { $m4is_aicfp = (int) memberium_app()->m4is_r231y($m4is_q4c_xa); if ($m4is_aicfp) { $m4is_o3mwus = []; $m4is_l926 = $this->m4is_zx1ak($m4is_sdob0); if ($m4is_ytwk3 == 'active') { $m4is_o3mwus[] = $m4is_l926['main']; $m4is_o3mwus[] = ( 0 - $m4is_l926['trial'] ); $m4is_o3mwus[] = ( 0 - $m4is_l926['canc'] ); $m4is_o3mwus[] = ( 0 - $m4is_l926['payf'] ); } elseif ($m4is_ytwk3 == 'cancelled') { $m4is_o3mwus[] = $m4is_l926['canc']; $m4is_o3mwus[] = ( 0 - $m4is_l926['trial'] ); } elseif ($m4is_ytwk3 == 'expired') { $m4is_o3mwus[] = $m4is_l926['payf']; $m4is_o3mwus[] = ( 0 - $m4is_l926['trial'] ); } elseif ($m4is_ytwk3 == 'completed') { $m4is_o3mwus[] = ( 0 - $m4is_l926['main'] ); $m4is_o3mwus[] = ( 0 - $m4is_l926['trial'] ); } elseif ($m4is_ytwk3 == 'failing') {  } memberium_app()->m4is__mkz( $m4is_o3mwus, $m4is_aicfp ); } } } }    private 
function m4is_ap508() { add_action( 'edd_complete_purchase', [$this, 'm4is_ckcq'] ); add_action( 'edd_subscription_post_create', [$this, 'm4is_yo7xef'], 10, 2); add_action( 'edd_subscription_status_change', [$this, 'm4is_dunz8k'], 10, 3 ); } private 
function m4is_k1r9t() { if (is_admin() ) { include_once __DIR__ . '/admin.php'; m4is_gnbz::m4is_a6x52r(); } } private 
function __construct() { $this->m4is_ap508(); $this->m4is_k1r9t(); } static 
function m4is_a6x52r() : self { static $m4is_jprj8 = false; return $m4is_jprj8 ? $m4is_jprj8 : $m4is_jprj8 = new self; } }
