<?php
 class_exists('m4is_emz57o') || die(); final 
class m4is_jjqsd { 
function m4is_x2lz($m4is_dmesa) { return 'course'; } 
function m4is_hhyk($m4is_qmxu) { return 'course-category'; } 
function m4is_n0s4i($m4is_w9feq2) { return 'module';  } private 
function m4is_pu6max($m4is_q4c_xa, $m4is_qoed9n) { global $wpdb; $m4is_qoed9n = (int) $m4is_qoed9n; $m4is_q4c_xa = (int) $m4is_q4c_xa; $m4is_ioxk = "SELECT `comment_ID` FROM `{$wpdb->comments}` WHERE `comment_post_ID` = {$m4is_qoed9n} AND `user_id` = {$m4is_q4c_xa} AND `comment_approved` = 'passed' AND `comment_type` = 'sensei_lesson_status';"; $m4is_cxkb72 = (int) $wpdb->get_var($m4is_ioxk); if ($m4is_cxkb72) { $m4is_ru548 = get_comment_meta($m4is_cxkb72); } else { $m4is_ru548 = []; } return $m4is_ru548; } private 
function m4is_erf24($m4is_q4c_xa, $m4is_u6ixo) { global $wpdb; $m4is_u6ixo = (int) $m4is_u6ixo; $m4is_q4c_xa = (int) $m4is_q4c_xa; $m4is_ioxk = "SELECT `comment_ID` FROM `{$wpdb->comments}` WHERE `comment_post_ID` = {$m4is_u6ixo} AND `user_id` = {$m4is_q4c_xa} AND `comment_approved` = 'complete' AND `comment_type` = 'sensei_course_status';"; $m4is_cxkb72 = (int) $wpdb->get_var($m4is_ioxk); if ($m4is_cxkb72) { $m4is_ru548 = get_comment_meta($m4is_cxkb72); } else { $m4is_ru548 = []; } return $m4is_ru548; } private 
function m4is_j18n($m4is_q4c_xa, $m4is_j1vz, $m4is_wf67cd) { $m4is_aicfp = m4is_zbyh::m4is_fhxr6($m4is_q4c_xa); if (! $m4is_aicfp) { return; } if ($m4is_j1vz == 'course') { $m4is_phu4s9 = $this->m4is_erf24($m4is_q4c_xa, $m4is_wf67cd); } elseif ($m4is_j1vz == 'lesson') { $m4is_phu4s9 = $this->m4is_pu6max($m4is_q4c_xa, $m4is_wf67cd); } else { return; } $m4is_galwv0 = get_post_meta($m4is_wf67cd); if (! empty($m4is_galwv0['_is4wp_lms_start_date'][0]) ) { $m4is_sv3h = isset($m4is_galwv0['_is4wp_lms_start_date'][0]) ? $m4is_galwv0['_is4wp_lms_start_date'][0] : ''; $m4is_ob5p_ = isset($m4is_phu4s9['start'][0]) ? $m4is_phu4s9['start'][0] : ''; memberium_app()->m4is_iu612c($m4is_aicfp, $m4is_sv3h, $m4is_ob5p_); } if (! empty($m4is_galwv0['_is4wp_lms_complete_percent'][0]) ) { $m4is_sv3h = isset($m4is_galwv0['_is4wp_lms_complete_percent'][0]) ? $m4is_galwv0['_is4wp_lms_complete_percent'][0] : ''; $m4is_ob5p_ = isset($m4is_phu4s9['percent'][0]) ? $m4is_phu4s9['percent'][0] : ''; memberium_app()->m4is_iu612c($m4is_aicfp, $m4is_sv3h, $m4is_ob5p_); } if ( ! empty( $m4is_galwv0['_is4wp_learndash_goals'][0] ) ) { memberium_app()->m4is_rctzo( $m4is_galwv0['_is4wp_learndash_goals'][0], $m4is_aicfp ); } if ( ! empty( $m4is_galwv0['_is4wp_learndash_tags'][0] ) ) { memberium_app()->m4is__mkz( $m4is_galwv0['_is4wp_learndash_tags'][0], $m4is_aicfp ); } if ( ! empty( $m4is_galwv0['_is4wp_learndash_actions'][0] ) ) { memberium_app()->m4is_evrbh( $m4is_galwv0['_is4wp_learndash_actions'][0], $m4is_aicfp ); } do_action('memberium/lms/completion', $m4is_q4c_xa, $m4is_wf67cd); } private 
function m4is_jfels_() { global $wpdb; $m4is_muiw6b = '_is4wp_learndash_autoenroll'; $m4is_f9av2 = $wpdb->posts; $m4is_zs2va = $wpdb->postmeta; $m4is_ioxk = "SELECT `ID`, `meta_value` FROM `{$m4is_f9av2}`, `{$m4is_zs2va}` WHERE post_status = 'publish' AND post_type = 'course' AND  post_id = ID AND meta_key = '{$m4is_muiw6b}' AND meta_value > '' "; $m4is__jp4yb = $wpdb->get_results($m4is_ioxk, ARRAY_A); return $m4is__jp4yb; } private 
function m4is_yn5p() { return (int) sensei()->version; } private 
function m4is_a4ln_v($m4is_q4c_xa, $m4is_u6ixo) { $m4is_hsyp0 = $this->m4is_yn5p(); if ($m4is_hsyp0 == 2) { Sensei_Utils::user_start_course($m4is_q4c_xa, $m4is_u6ixo);  } else { try { $m4is_y1i_ = new Sensei_Frontend; $m4is_y1i_->manually_enrol_learner($m4is_q4c_xa, $m4is_u6ixo); } catch (exception $m4is_sz3f) { $this->m4is_ki_b[] = [ 'action' => 'add', 'user_id' => $m4is_q4c_xa, 'course_id' => $m4is_u6ixo, ]; } } } private 
function m4is_uhb_fo($m4is_q4c_xa, $m4is_u6ixo) { $m4is_hsyp0 = $this->m4is_yn5p(); if ($m4is_hsyp0 == 2) { sensei_utils::sensei_remove_user_from_course($m4is_u6ixo, $m4is_q4c_xa);  } else { try { $m4is_y1i_ = new Sensei_Frontend; $m4is_bet7fq = Sensei_Course_Manual_Enrolment_Provider::instance();  sensei_utils::sensei_remove_user_from_course($m4is_u6ixo, $m4is_q4c_xa);  $m4is_bet7fq->withdraw_learner( $m4is_q4c_xa, $m4is_u6ixo);  } catch (Exception $m4is_sz3f) { $this->m4is_ki_b[] = [ 'action' => 'remove', 'user_id' => $m4is_q4c_xa, 'course_id' => $m4is_u6ixo, ]; } } } 
function m4is_gsfc6e() { if (empty($this->m4is_ki_b)) { return; } foreach($this->m4is_ki_b as $m4is_ap3_ => $m4is_rhfd) { if ($m4is_rhfd['action'] == 'add') { $this->m4is_a4ln_v($m4is_rhfd['user_id'], $m4is_rhfd['course_id']); unset($m4is_ki_b[$m4is_ap3_]); } if ($m4is_rhfd['action'] == 'remove') { $this->m4is_uhb_fo($m4is_rhfd['user_id'], $m4is_rhfd['course_id']); unset($m4is_ki_b[$m4is_ap3_]); } } } 
function m4is_ckch7($m4is_q4c_xa, $m4is_sxfbjo) { if (user_can($m4is_q4c_xa, 'manage_options')) { return; } $m4is__jp4yb = $this->m4is_jfels_(); if (empty($m4is__jp4yb) || ! is_array($m4is__jp4yb)) { return; } $m4is_h0dl8 = $this->m4is_yn5p(); $m4is_v369 = empty($m4is_sxfbjo['keap']['contact']['groups']) ? '' : $m4is_sxfbjo['keap']['contact']['groups']; foreach ($m4is__jp4yb as $m4is_pgsbl) { $m4is_d7d2w = $m4is_pgsbl['meta_value']; $m4is_u6ixo = $m4is_pgsbl['ID']; $m4is_ypu1m = memberium_app()->m4is_c8ie6($m4is_d7d2w, $m4is_v369); $m4is_skh0p = sensei_utils::has_started_course($m4is_u6ixo, $m4is_q4c_xa); if ($m4is_skh0p !== $m4is_ypu1m) { if ($m4is_ypu1m) {  $this->m4is_a4ln_v($m4is_q4c_xa, $m4is_u6ixo); } else {  $this->m4is_uhb_fo($m4is_q4c_xa, $m4is_u6ixo); } } } } 
function m4is_xwkv9x($m4is_q4c_xa, $m4is_uoj5, $m4is_n81u, $m4is_x1mrxz, $m4is_frvoc6) { $m4is_aicfp = m4is_zbyh::m4is_fhxr6($m4is_q4c_xa); if (! $m4is_aicfp) { return; } $m4is__8p6 = wp_get_post_parent_id($m4is_uoj5);  $m4is_j1vz = get_post_type($m4is__8p6); $m4is_galwv0 = get_post_meta($m4is_uoj5); if ( ! empty($m4is_galwv0['_is4wp_lms_grade'][0]) ) { $m4is_sv3h = isset($m4is_galwv0['_is4wp_lms_grade'][0]) ? $m4is_galwv0['_is4wp_lms_grade'][0] : ''; $m4is_ob5p_ = $m4is_n81u; memberium_app()->m4is_iu612c($m4is_aicfp, $m4is_sv3h, "{$m4is_ob5p_}"); } if (! empty($m4is_galwv0['_is4wp_lms_completed'][0]) ) { $m4is_sv3h = isset($m4is_galwv0['_is4wp_lms_completed'][0]) ? $m4is_galwv0['_is4wp_lms_completed'][0] : ''; $m4is_ob5p_ = (int) ($m4is_n81u >= $m4is_x1mrxz); memberium_app()->m4is_iu612c($m4is_aicfp, $m4is_sv3h, $m4is_ob5p_); } do_action('memberium/lms/completion', $m4is_q4c_xa, $m4is_wf67cd); } 
function m4is_knw483($m4is_q4c_xa, $m4is_qoed9n) { $this->m4is_j18n($m4is_q4c_xa, 'lesson', $m4is_qoed9n); } 
function m4is_nnkw($m4is_q4c_xa, $m4is_u6ixo) { $this->m4is_j18n($m4is_q4c_xa, 'course', $m4is_u6ixo); }   
function m4is_mirntk(array $m4is_j0n7, int $m4is__xysg) { if (get_post_type($m4is__xysg) !== 'course') { return $m4is_j0n7; } $m4is_q4c_xa = get_current_user_id();  $m4is_j0n7['access'] = m4is_pcys::m4is_a6x52r()->m4is_whka($m4is__xysg, $m4is_q4c_xa); if( ! $m4is_j0n7['access'] ){ $m4is_j0n7['status'] = 'locked'; return $m4is_j0n7; }  $m4is_j0n7['access'] = Sensei()->course->is_user_enrolled( $m4is__xysg, $m4is_q4c_xa ); if( ! $m4is_j0n7['access'] ){ if( ! Sensei()->course->can_current_user_manually_enrol($m4is__xysg) ){ $m4is_j0n7['status'] = 'locked'; return $m4is_j0n7; } else{ $m4is_j0n7['access'] = 1; $m4is_j0n7['status'] = 'not_enrolled'; } }  if( ! Sensei()->course->is_prerequisite_complete($m4is__xysg) ){ $m4is_j0n7['access'] = 0; $m4is_j0n7['status'] = 'locked'; return $m4is_j0n7; } $m4is_j0n7['progress'] = Sensei()->course->get_completion_percentage( $m4is__xysg, $m4is_q4c_xa ); return $m4is_j0n7; } 
function m4is_rb068($m4is_dm7i1c = []) { return array_merge($m4is_dm7i1c, [ 'course', 'lesson', ]); } 
function m4is_whpnx($m4is_ho0w2) { return 'Sensei'; } private 
function m4is_ap508() { add_action('memberium/session/updated', [$this, 'm4is_ckch7'], 10, 2); add_action('init', [$this, 'm4is_gsfc6e'], PHP_INT_MAX); add_action('sensei_user_lesson_end', [$this, 'm4is_knw483'], 10, 2); add_action('sensei_user_course_end', [$this, 'm4is_nnkw'], 10, 2); add_action('sensei_user_quiz_grade', [$this, 'm4is_xwkv9x'], 100, 5); add_filter('memberium/lms/name', [$this, 'm4is_whpnx']); add_filter('memberium/lms/module_post_types', [$this, 'm4is_rb068']); add_filter('memberium/lms/course_type', [$this, 'm4is_x2lz']); add_filter('memberium/lms/course_category', [$this, 'm4is_hhyk']); add_filter('memberium/lms/course_tag', [$this, 'm4is_n0s4i']); add_filter('memberium/lms/user/course/progress', [$this, 'm4is_erf24'], 100, 2); add_filter('memberium/lms/course/item/data', [$this, 'm4is_mirntk'], 10, 2); add_filter('memberium/modules/active/names', function($m4is_its6y) { return array_merge($m4is_its6y, ['WooSensei for Memberium']); }); } private 
function __construct() { $this->m4is_ap508(); if (is_admin() ) { require_once __DIR__ . '/admin.php'; m4is_ajxw::m4is_a6x52r(); } } static 
function m4is_a6x52r() : self { return self::$m4is_jprj8 ? self::$m4is_jprj8 : self::$m4is_jprj8 = new self; } private static $m4is_jprj8 = false; private $m4is_ki_b = []; }
