<?php
 class_exists('m4is_emz57o') || die(); if (! current_user_can('manage_options') ) { wp_die(__('You do not have sufficient permissions to access this page.') ); } global $wpdb, $wpcwdb; $m4is_zp7my = get_option('memberium_wpcw', [] ); if ($_SERVER['REQUEST_METHOD'] == 'POST') { if ($_POST['type'] == 'courses') { $m4is_zp7my['courses']['access_tags'] = $_POST['access_tags']; $m4is_zp7my['courses']['completion_tag'] = $_POST['completion_tag']; } elseif ($_POST['type'] == 'modules') { $m4is_zp7my['modules']['completion_tag'] = $_POST['completion_tag']; } update_option('memberium_wpcw', $m4is_zp7my); } $m4is_ioxk = "SELECT `course_id`, `course_title`, `course_desc`, `course_opt_user_access` FROM `{$wpcwdb->courses}` WHERE '1' ORDER BY `course_opt_user_access` ASC, `course_id` DESC;"; $m4is_oo43y = $wpdb->get_results($m4is_ioxk, ARRAY_A); if (count($m4is_oo43y) ) { echo '<h2>WP Courseware Courses</h2>'; echo '<form method="post" action="">'; echo '<input type="hidden" name="type" value="courses">'; echo '<table class="widefat" style="white-space:nowrap;">'; echo '<tr>'; echo '<td>Title</td>'; echo '<td>Mode</td>'; echo '<td>Access Tag</td>'; echo '<td>Completion Tag</td>'; echo '</tr>'; foreach($m4is_oo43y as $m4is_l6omu9) { $m4is_rap5m = (bool) ($m4is_l6omu9['course_opt_user_access'] == 'default_hide'); $m4is_pt056i = isset($m4is_zp7my['courses']['access_tags'][$m4is_l6omu9['course_id']]) ? $m4is_zp7my['courses']['access_tags'][$m4is_l6omu9['course_id']] : ''; $m4is_oc985x = isset($m4is_zp7my['courses']['completion_tag'][$m4is_l6omu9['course_id']]) ? $m4is_zp7my['courses']['completion_tag'][$m4is_l6omu9['course_id']] : ''; echo '<tr>'; echo '<td><strong>', $m4is_l6omu9['course_title'], '</strong><br>', $m4is_l6omu9['course_desc'], '</td>'; echo '<td>', $m4is_rap5m ? '<strong style="color:red;">Protected</strong>' : '<strong style="color:green;">Public</strong>', '</td>'; if ($m4is_rap5m) { echo '<td><input style="width:300px;" type="text" class="multitaglist" value="', $m4is_pt056i, '" name="access_tags[', $m4is_l6omu9['course_id'], ']"></td>'; } else { echo '<td><em>Automatic</em>'; echo '<input type="hidden" value="0" name="access_tags[', $m4is_l6omu9['course_id'], ']"></td>'; } echo '<td><input type="text" style="width:300px;" class="multitaglist" value="', $m4is_oc985x, '" name="completion_tag[', $m4is_l6omu9['course_id'], ']"></td>'; echo '</tr>'; } unset($m4is_l6omu9, $m4is_rap5m, $m4is_pt056i, $m4is_oc985x, $m4is_oo43y); echo '</table>'; echo '<p><input type="submit" class="button-primary"value="Update" /></p>'; echo '</form>'; $m4is_ioxk = "SELECT * FROM {$wpcwdb->modules} WHERE 1 ORDER BY parent_course_id ASC, module_order ASC;"; $m4is_its6y = $wpdb->get_results($m4is_ioxk, ARRAY_A); if (count($m4is_its6y) ) { echo '<h2>WP Courseware Modules</h2>'; echo '<form method="post" action="">'; echo '<input type="hidden" name="type" value="modules">'; echo '<table class="widefat" style="white-space:nowrap;">'; echo '<tr>'; echo '<td>Title</td>'; echo '<td>Completion Tag</td>'; echo '</tr>'; foreach($m4is_its6y as $m4is_r19fjb) { $m4is_oc985x = isset($m4is_zp7my['modules']['completion_tag'][$m4is_r19fjb['module_id']]) ? $m4is_zp7my['modules']['completion_tag'][$m4is_r19fjb['module_id']] : ''; echo '<tr>'; echo '<td><strong>', $m4is_r19fjb['module_title'], '</strong><br>', $m4is_r19fjb['module_desc'], '</td>'; echo '<td><input type="text" style="width:300px;" class="multitaglist" value="', $m4is_oc985x, '" name="completion_tag[', $m4is_r19fjb['module_id'], ']"></td>'; echo '</tr>'; } unset($m4is_r19fjb, $m4is_oc985x, $m4is_its6y); echo '</table>'; echo '<p><input type="submit" class="button-primary"value="Update" /></p>'; echo '</form>'; } else { echo '<p>No modules found.</p>'; } } else { echo '<p>No courses found.</p>'; } $m4is_yta_se = []; $m4is_znf9 = memberium_app()->m4is_ee0h(true); $m4is_znf9 = $m4is_znf9['mc']; $m4is_w190f4 = []; $m4is_w190f4[] = [ 'id' => 0, 'text' => '(None)' ]; if (is_array($m4is_znf9) ) { foreach ( (array) $m4is_znf9 as $m4is_b40e_m => $m4is_w9feq2) { if (! in_array($m4is_b40e_m, $m4is_yta_se) ) { $m4is_w190f4[] = [ 'id' => $m4is_b40e_m, 'text' => $m4is_w9feq2 . ' (' . $m4is_b40e_m . ')' ]; } } } $m4is_w190f4 = json_encode($m4is_w190f4); echo '<script>'; echo 'var taglist = ', $m4is_w190f4, ';'; echo '</script>';
