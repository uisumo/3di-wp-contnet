<?php
 class_exists( 'm4is_emz57o' ) || die(); final 
class m4is_gn_0e2 { static 
function m4is_a6x52r() : self { static $m4is_jprj8 = false; return $m4is_jprj8 ? $m4is_jprj8 : $m4is_jprj8 = new self; } 
function __construct() { $this->m4is_ap508(); if ( is_admin() ) { require __DIR__ . '/admin.php'; m4is_ghrz0o::m4is_a6x52r(); } } private 
function m4is_ap508() { add_action( 'learn-press/user-completed-lesson', [$this, 'm4is_szpn'], 10, 3 );  add_action( 'learn-press/user-course-finished', [$this, 'm4is_r498p'], 10, 3 );  add_action( 'learn-press/user/quiz-finished', [$this, 'm4is_qch9qo'], 10, 3 );  add_action( 'memberium_session_created', [$this, 'm4is_ku_80'], 10, 1 ); add_filter( 'learn-press/has-enrolled-course', [$this, 'm4is_wbjvm4'], 10, 3 ); add_filter( 'memberium/posts/unenhanced', [$this, 'm4is_q24lu'], 10, 1 ); add_filter( 'memberium/lms/module_post_types', [$this, 'm4is_rb068'] ); add_filter( 'memberium/lms/name', [$this, 'm4is_whpnx'] ); } private 
function m4is_ymvpx() { static $m4is__jp4yb = []; if ( empty( $m4is__jp4yb ) ) { global $wpdb; $m4is_f9av2 = $wpdb->posts; $m4is_zs2va = $wpdb->postmeta; $m4is_ioxk = "SELECT `ID`, `meta_value` FROM `{$m4is_f9av2}`, `{$m4is_zs2va}` WHERE `post_status` = 'publish' AND `post_type` = 'lp_course' AND `post_id` = `ID` AND `meta_key` = '_is4wp_learndash_autoenroll' AND `meta_value` > '' "; $m4is__jp4yb = $wpdb->get_results( $m4is_ioxk, ARRAY_A ); } return $m4is__jp4yb; } private 
function m4is_m2bd( int $m4is_q4c_xa ) { if ( empty( $m4is_q4c_xa ) ) { return []; } if ( ! method_exists( 'lp_user', 'get_orders') ) { error_log('Memberium LearnPress Integration:  LP_User get_orders() method missing.'); return []; } $m4is_u4g3 = new lp_user( $m4is_q4c_xa ); $m4is_s53h4j = $m4is_u4g3->get_orders(); $m4is_oo43y = []; foreach ( $m4is_s53h4j as $m4is_u6ixo => $m4is_cmat ) { $m4is_oo43y[] = $m4is_u6ixo; } return $m4is_oo43y; } 
function m4is_q24lu( $m4is_i8_ymd ) { $m4is_i8_ymd[] = 'lp_order'; return $m4is_i8_ymd; } 
function m4is_ku_80( $m4is_sxfbjo = false ) { if (empty($m4is_sxfbjo['keap']['contact']['groups']) ) { return; } global $wpdb; static $m4is_pv58x3 = []; $m4is_q4c_xa = isset( $m4is_sxfbjo['memb_user']['user_id'] ) ? $m4is_sxfbjo['memb_user']['user_id'] : 0; $m4is__jp4yb = $this->m4is_ymvpx(); if (empty($m4is__jp4yb) ) { return; } $m4is_d_3e = $this->m4is_m2bd( $m4is_q4c_xa ); foreach ( $m4is__jp4yb as $m4is_pgsbl ) { $m4is__xysg = $m4is_pgsbl['ID']; $m4is_tkws8 = in_array($m4is__xysg, $m4is_d_3e) || in_array($m4is__xysg, $m4is_pv58x3); $m4is_gse8i = trim($m4is_pgsbl['meta_value'], ','); if ( ! $m4is_tkws8 ) { if ( memberium_app()->m4is_ww6ul($m4is_gse8i, $m4is_sxfbjo) ) { $this->m4is_vlzqey( $m4is_q4c_xa, $m4is__xysg ); $m4is_pv58x3[] = $m4is__xysg; } } } } 
function m4is_vlzqey( $m4is_q4c_xa, $m4is_u6ixo ) { if ( empty($m4is_u6ixo) || empty($m4is_q4c_xa) ) { return false; } if ( ! function_exists( 'learn_press_create_order' ) ) { error_log('Memberium LearnPress Integration:  learn_press_create_order() function missing.'); return false; } if ( ! function_exists( 'learn_press_add_order_item' ) ) { error_log('Memberium LearnPress Integration:  learn_press_add_order_item() function missing.'); return false; } if ( ! function_exists( 'learn_press_update_order_status' ) ) { error_log('Memberium LearnPress Integration:  learn_press_update_order_status() function missing.'); return false; } if ( ! class_exists( 'lp_user' ) ) { error_log('Memberium LearnPress Integration:  lp_user class missing.'); return false; } $m4is_u4g3 = new lp_user($m4is_q4c_xa); $m4is_rprd_t = learn_press_create_order(null); $m4is_cmat = $m4is_rprd_t->get_id(); $m4is_rprd_t->set_user_id($m4is_q4c_xa); $m4is_rprd_t->save(); learn_press_add_order_item( $m4is_cmat, $m4is_u6ixo ); learn_press_update_order_status( $m4is_cmat, 'lp-completed' );  return $m4is_cmat; } 
function m4is_wbjvm4( $m4is_hjd3sv, $m4is_q4c_xa, $m4is_u6ixo ) { $m4is_gse8i = get_post_meta($m4is_u6ixo, '_is4wp_learndash_autoenroll', true); if (! empty($m4is_gse8i) ) { $m4is_sxfbjo = (isset($_SESSION['memb_user']['user_id']) && $m4is_q4c_xa == $_SESSION['memb_user']['user_id']) ? $_SESSION : memberium_app()->m4is_q4nu($m4is_q4c_xa); if (isset($_SESSION['keap']['contact']['id']) ) { $m4is_hjd3sv = memberium_app()->m4is_ww6ul( $m4is_gse8i, $m4is_sxfbjo ); } } return $m4is_hjd3sv; } 
function m4is_szpn( $m4is_qoed9n, $m4is_n_bp6, $m4is_q4c_xa ) { $m4is_aicfp = (int) m4is_zbyh::m4is_fhxr6( $m4is_q4c_xa ); if ( ! $m4is_aicfp || ! $m4is_q4c_xa ) { return; } $m4is_ti8od = get_post_meta( $m4is_qoed9n ); if ( ! empty( $m4is_ti8od['_is4wp_learndash_goals'][0] ) ) { memberium_app()->m4is_rctzo( $m4is_ti8od['_is4wp_learndash_goals'][0], $m4is_aicfp ); } if ( ! empty( $m4is_ti8od['_is4wp_learndash_tags'][0] ) ) { memberium_app()->m4is__mkz( $m4is_ti8od['_is4wp_learndash_tags'][0], $m4is_aicfp ); } if ( ! empty( $m4is_ti8od['_is4wp_learndash_actions'][0] ) ) { memberium_app()->m4is_evrbh( $m4is_ti8od['_is4wp_learndash_actions'][0], $m4is_aicfp ); } do_action('memberium/lms/completion', $m4is_q4c_xa, $m4is_qoed9n); } 
function m4is_qch9qo( $m4is_uoj5, $m4is_u6ixo, $m4is_q4c_xa ) { $m4is_aicfp = (int) m4is_zbyh::m4is_fhxr6( $m4is_q4c_xa ); if ( $m4is_aicfp && $m4is_uoj5 ) { $m4is_etkg = get_post_meta( $m4is_uoj5, '_lp_passing_grade', true ); if ( $m4is_etkg !== false ) {  $m4is_etkg = (int) $m4is_etkg; $m4is_u4g3 = new LP_User( $m4is_q4c_xa ); $m4is_q723g = $m4is_u4g3->get_quiz_results( $m4is_uoj5, $m4is_u6ixo ); $m4is_j8pk = (int) $m4is_q723g; $m4is_nvcwlo = ( $m4is_j8pk >= $m4is_etkg ); $m4is_ti8od = get_post_meta( $m4is_uoj5 ); if ( $m4is_nvcwlo ) { if ( ! empty( $m4is_ti8od['_is4wp_learndash_goals'][0] ) ) { memberium_app()->m4is_rctzo( $m4is_ti8od['_is4wp_learndash_goals'][0], $m4is_aicfp ); } if ( ! empty( $m4is_ti8od['_is4wp_learndash_tags'][0] ) ) { memberium_app()->m4is__mkz( $m4is_ti8od['_is4wp_learndash_tags'][0], $m4is_aicfp ); } if ( ! empty( $m4is_ti8od['_is4wp_learndash_actions'][0] ) ) { memberium_app()->m4is_evrbh( $m4is_ti8od['_is4wp_learndash_actions'][0], $m4is_aicfp ); } do_action('memberium/lms/completion', $m4is_q4c_xa, $m4is_uoj5); } else { if ( ! empty( $m4is_ti8od['_is4wp_learndash_fail_goals'][0] ) ) { memberium_app()->m4is_rctzo( $m4is_ti8od['_is4wp_learndash_fail_goals'][0], $m4is_aicfp ); } if ( ! empty( $m4is_ti8od['_is4wp_learndash_fail_tags'][0] ) ) { memberium_app()->m4is__mkz( $m4is_ti8od['_is4wp_learndash_fail_tags'][0], $m4is_aicfp ); } if ( ! empty( $m4is_ti8od['_is4wp_learndash_fail_actions'][0] ) ) { memberium_app()->m4is_evrbh( $m4is_ti8od['_is4wp_learndash_fail_actions'][0], $m4is_aicfp ); } } } }  } 
function m4is_r498p( $m4is_u6ixo, $m4is_q4c_xa, $m4is_ov38n ) { $m4is_aicfp = (int) m4is_zbyh::m4is_fhxr6( $m4is_q4c_xa ); if ( ! $m4is_aicfp || ! $m4is_q4c_xa ) { return; } $m4is_ti8od = get_post_meta($m4is_u6ixo); if ( ! empty( $m4is_ti8od['_is4wp_learndash_goals'][0] ) ) { memberium_app()->m4is_rctzo( $m4is_ti8od['_is4wp_learndash_goals'][0], $m4is_aicfp ); } if ( ! empty( $m4is_ti8od['_is4wp_learndash_tags'][0] ) ) { memberium_app()->m4is__mkz( $m4is_ti8od['_is4wp_learndash_tags'][0], $m4is_aicfp ); } if ( ! empty( $m4is_ti8od['_is4wp_learndash_actions'][0] ) ) { memberium_app()->m4is_evrbh( $m4is_ti8od['_is4wp_learndash_actions'][0], $m4is_aicfp ); } do_action('memberium/lms/completion', $m4is_q4c_xa, $m4is_u6ixo); } 
function m4is_rb068( $m4is_dm7i1c = [] ) { return array_merge($m4is_dm7i1c, [ 'lp_course', 'lp_lesson', 'lp_quiz', ]); } 
function m4is_whpnx( $m4is_ho0w2 ) { return 'LearnPress'; } }
