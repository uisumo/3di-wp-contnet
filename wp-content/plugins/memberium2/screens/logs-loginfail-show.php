<?php
 if (! defined('ABSPATH' ) ) { die(); } if (!current_user_can('manage_options' ) ) { wp_die(__('You do not have sufficient permissions to access this page.' ) ); } $vwplnzlj0t = MEMBERIUM_DB_HTTPPOST; $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwpljupbl4 = ''; $vwplanieul = empty($_GET['limit'] ) ? 15 : (int) trim($_GET['limit'] ); $vwplx5d8 = empty($_GET['start'] ) ? 0 : (int) trim($_GET['start'] ); $vwplvakx = empty($_GET['search'] ) ? '' : trim ($_GET['search'] ); $vwplw894 = empty($_GET['ip'] ) ? '' : trim($_GET['ip'] ); $vwpljupbl4 .= empty($vwplvakx ) ? '' : " AND `log` LIKE '%" . $wpdb->esc_like($vwplvakx ) . "%' "; $vwpljupbl4 .= empty($vwplw894 ) ? '' : " AND `ipaddress` LIKE '%" . $wpdb->esc_like($vwplw894 ) . "%' "; $vwplx1ap5_ = "SELECT UNIX_TIMESTAMP(`time`) as `time`, `ipaddress`, `contactid`, `log` FROM `{$vwplnzlj0t}` WHERE `type` = 'loginfail' AND `appname` = '{$vwplw5rgd3}' {$vwpljupbl4} ORDER BY `id` DESC LIMIT {$vwplanieul} ;"; $vwply4j8x = $wpdb->get_results($vwplx1ap5_, ARRAY_A ); if (! is_array($vwply4j8x ) || empty($vwply4j8x ) ) { echo '<p>The Login Failure log is empty.</p>'; } else { $vwpli_ys = get_option('timezone_string'); $vwplvu0pn = date_default_timezone_get(); date_default_timezone_set($vwpli_ys ); echo '<table class="widefat">'; echo '<tr>'; echo '<td width="175">Login Time</td>'; echo '<td width="125">IP Address</td>'; echo '<td width="100">Contact Id</td>'; echo '<td>Log</td>'; echo '</tr>'; foreach($vwply4j8x as $vwplheakg ) { echo '<tr>'; echo '<td>', date('Y-m-d H:i:s', $vwplheakg['time'] ), '</td>'; echo '<td>', $vwplheakg['ipaddress'], '</td>'; echo '<td>', $vwplheakg['contactid'], '</td>'; echo '<td>', $vwplheakg['log'], '</td>'; echo '</tr>'; } echo '</table>'; date_default_timezone_set($vwplvu0pn ); } echo '<form method="get" style="margin-top:12px;display:inline-block;">'; echo '<input type="hidden" name="page" value="memberium-logs">'; echo '<input type="hidden" name="tab" value="loginfail">'; echo "Search: <input type='text' name='search' value='{$vwplvakx}' placeholder='Search'>"; echo "IP Address: <input type='text' name='ip' value='{$vwplw894}' placeholder='IP Address'>"; echo "Limit: <input type='text' name='limit' value='{$vwplanieul}' placeholder='# Results'>"; echo '<input type="submit" value="Search" class="button-primary" style="margin-left:15px;">'; echo '</form>';
