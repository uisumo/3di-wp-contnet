<?php
 if (!defined('ABSPATH' ) ) { die(); } if (!current_user_can('manage_options' ) ) { wp_die(__('You do not have sufficient permissions to access this page.' ) ); }  global $wpdb, $i2sdk; $vwplfqgl3j = get_option('i2sdk' ); if ($_SERVER['REQUEST_METHOD'] == 'POST' ) { if (isset($_POST['delete'] ) ) { foreach ($_POST['delete'] as $vwplebey => $vwpll1_x ) { if ($vwpll1_x == 'on' ) { unset($this->settings['remote_files'][$vwplebey] ); wpljwbf2::wplc1on7('Remote Storage Profile Deleted', 'error' ); } } } if (isset($_POST['add-profile'] ) && trim($_POST['profile_name'] ) > '' ) { $vwplebey = strtolower(trim($_POST['profile_name'] ) ); $vwpld_gmv5 = array(); $vwpld_gmv5['name'] = trim($_POST['profile_name'] ); $vwpld_gmv5['type'] = 's3'; $vwpld_gmv5['access_key'] = trim($_POST['s3_access_key'] ); $vwpld_gmv5['expiration'] = ( (int)$_POST['expiration'] > 0 ) ? (int)$_POST['expiration'] : 300; $vwpld_gmv5['secret_key'] = trim($_POST['s3_secret_key'] ); $vwpld_gmv5['host'] = (trim($_POST['default_host'] ) > '' ) ? trim($_POST['default_host'] ) : 's3.amazonaws.com'; $vwpld_gmv5['bucket'] = trim($_POST['default_bucket'] ); $vwpld_gmv5['region'] = isset($_POST['region']) ? trim($_POST['region'] ) : 'us-east-1'; $this->settings['remote_files'][$vwplebey] = $vwpld_gmv5; } update_option('memberium', $this->settings ); } $vwplqb7j = !empty($this->settings['remote_files'] ) ? $this->settings['remote_files'] : array(); $vwplubhx5 = count($vwplqb7j ); wpljwbf2::wplyb40j1(); echo '<h1>Memberium Remote Files</h1>'; echo '<h3>Current Remote Storage Profiles', wpljwbf2::wplypewkt(2578 ), '</h3>'; echo '<div class="wrap">'; echo '<hr />'; echo '<form method="POST" action="" autocomplete="off">'; echo '<table class="widefat" style="white-space:nowrap;">'; echo '<tr>'; echo '<th nowrap="nowrap">Profile Name</th>'; echo '<th nowrap="nowrap">Default Host</th>'; echo '<th nowrap="nowrap">Default Bucket</th>'; echo '<th nowrap="nowrap">Region</th>'; echo '<th nowrap="nowrap">S3 Access Key</th>'; echo '<th nowrap="nowrap">S3 Secret Key</th>'; echo '<th nowrap="nowrap">Expiration</th>'; echo '<th>Delete?</th>'; echo '</tr>'; if ($vwplubhx5 == 0 ) { echo '<tr><td colspan="99">You have no remote storage defined.</td></tr>'; } else { foreach ($vwplqb7j as $vwplu206 => $vwplvkv3 ) { if ($vwplvkv3['type'] == 's3' ) { echo '<tr>'; echo '<td><i class="fab fa-aws"></i> ', $vwplvkv3['name'], '</td>'; echo '<td>', $vwplvkv3['host'], '</td>'; echo '<td>', $vwplvkv3['bucket'], '</td>'; echo '<td>', isset($vwplvkv3['region']) ? $vwplvkv3['region'] : 'Default', '</td>'; echo '<td>', $vwplvkv3['access_key'], '</td>'; echo '<td>', substr($vwplvkv3['secret_key'], 0, 8 ), '********</td>'; echo '<td>', (int)$vwplvkv3['expiration'], '</td>'; echo '<td>'; echo '<input type="checkbox" name="delete[' . $vwplu206 . ']">'; echo '</td>'; echo '</tr>'; } } } echo '</table>'; echo '&nbsp;<br />'; if ($vwplubhx5 > 0 ) { echo '<input type="submit" name="delete-profiles" value="Delete Profiles" class="button-secondary" />'; } echo '</form>'; echo '</div>'; echo '<h3>Add New S3 Profile</h3>'; echo '<div style="width:800px;">'; echo '<form method="POST" action="">'; echo '<table class="widefat">'; echo '<input type="hidden" name="type" value="s3">'; echo '<tr>'; echo '<th nowrap="nowrap">Profile Name</th>'; echo '<th nowrap="nowrap">Profile Type</th>'; echo '<th nowrap="nowrap">Default Host</th>'; echo '<th nowrap="nowrap">Default Bucket</th>'; echo '<th nowrap="nowrap">Region</th>'; echo '<th nowrap="nowrap">Access Key</th>'; echo '<th nowrap="nowrap">S3 Secret Key</th>'; echo '<th nowrap="nowrap">Expiration</th>'; echo '</tr>'; echo '<tr>'; echo '<td><input name="profile_name" type="text" size="10" autocomplete="off"/></td>'; echo '<td><select name="profile_type"><option value="s3">Amazon S3</option></select></td>'; echo '<td><input name="default_host" type="text" size="20" placeholder="s3.amazonaws.com" autocomplete="off"/></td>'; echo '<td><input name="default_bucket" type="text" size="20" autocomplete="off"/></td>'; $vwplz29dq1 = wpll72jhi::wplhymf3s(); echo '<td><select name="region"/>'; foreach($vwplz29dq1 as $vwplyq9i7o => $vwplcjpa) { echo "<option value='{$vwplcjpa}' ".($vwplcjpa == 'us-east-1' ? ' selected ' : '') . ">{$vwplyq9i7o}</option>"; } echo '</select></td>'; echo '<td><input name="s3_access_key" type="text" size="20" autocomplete="off"/></td>'; echo '<td><input name="s3_secret_key" type="text" size="20" autocomplete="off"/></td>'; echo '<td><input name="expiration" type="text" size="4" autocomplete="off"/></td>'; echo '</tr>'; echo '</table>'; echo '&nbsp;<br />'; echo '<input type="submit" name="add-profile" value="Add Remote Profile" class="button-primary" />'; echo '<hr />'; echo '</form>'; echo '</div>';
