<?php
if (!defined('ABSPATH' ) ) { die(); } if (! current_user_can('manage_options' ) ) { wp_die(__('You do not have sufficient permissions to access this page.' ) ); } if (user_can($vwplgogvie, 'manage_options' ) ) { echo '<tr>'; echo '<th>WARNING:</th>'; echo '<td><p style="font-weight:bold;color:red;">This user has the Admin / "manage_options" capability.</p></td>'; echo '</tr>'; return; } $vwplyg7o = memberium_app()->wplqvqrie($vwplgogvie->user_email ); $vwplkhcx = (int) wpllbej::wplbmo_1($vwplgogvie->ID ); $vwplc0nobe = memberium_app()->wplyte2($vwplgogvie->ID); if (! $vwplkhcx ) { return; } if (empty($vwplc0nobe['memb_db_fields']['id'] ) || $vwplc0nobe['memb_db_fields']['id'] < 1 ) { return; } if ( (int) $vwplkhcx > 0 || $vwplc0nobe['memb_db_fields']['id'] > 0 ) { $vwplrp9u24 = wpllbej::wplrande($vwplkhcx ); $vwplsdamhf = (int) get_user_meta($vwplgogvie->ID, 'memberium_private_comments', true ); $vwplw9md3t = strtolower(trim($vwplrp9u24['Email']) ); $vwplziyq1 = strtolower(trim($vwplgogvie->user_email) ); $vwplc_uoh4 = strtolower(trim($vwplgogvie->user_login) ); echo '<h3>Memberium User Data</h3>'; echo '<table class="form-table">'; echo '<tr>'; echo '<th><label for="infusionsoft_id">Infusionsoft Contact ID</label></th>'; echo '<td><input name="infusionsoft_id" id="description" disabled="disabled" size="10" value="', $vwplkhcx, '"></td>'; echo '</tr>'; echo '<tr>'; echo '<th><label for="memberium_private_comments">Private Comments</label></th>'; echo '<td>'; echo '<input name="memberium_private_comments" type="hidden" value="0">'; echo '<input name="memberium_private_comments" id="memberium_private_comments" ', ( ($vwplsdamhf == 1 ) ? ' checked="checked" ' : '' ), 'type="checkbox" value="1"> Enable Private Comments<br />'; echo '</td>'; echo '</tr>'; echo '<h3>Sync Username and Email</h3>'; echo '<tr>'; echo '<th><label for="new_emailaddress">Update Email Address</label></th>'; echo '<td>'; echo '<input name="memb_update_email_confirm" id="memb_update_email_confirm" ', ($vwplc_uoh4 === $vwplziyq1) ? ' checked=checked ' : '', ' type="checkbox" value="1"> Update Username to match email address<br />'; echo '</td>'; echo '</tr>'; if (user_can($vwplgogvie, 'manage_options' ) ) { echo '<tr>'; echo '<th>WARNING:</th>'; echo '<td><p style="font-weight:bold;color:red;">This user has the "manage_options" capability.</p></td>'; echo '</tr>'; } if (! empty($vwplc0nobe['memb_user']['theme'] ) ) { echo '<tr>'; echo '<th>WARNING:</th>'; echo "<td><p style='font-weight:bold;color:red;'>This user's membership level is set to use the \"{$vwplc0nobe['memb_user']['theme']}\" theme.</p></td>"; echo '</tr>'; }  echo '<tr>'; echo '<th valign="top"><label for="rss_user_id">RSS User ID</label></th>'; echo '<td>'; echo '<input disabled=disabled size="30" value="', wplutf3y::wplr4pur($vwplgogvie->ID), '">'; echo '</td>'; echo '</tr>'; if (wpllbej::wplcoujw6($vwplgogvie->user_email ) > 1 ) { echo '<tr>'; echo '<th>WARNING:</th>'; echo '<td><p style="font-weight:bold;color:red;">DUPLICATE INFUSIONSOFT CONTACT RECORDS FOUND</p></td>'; echo '</tr>'; } echo '<tr>'; echo '<th><label for="infusionsoft_fields">Fields</label></th>'; echo '<td>'; if (! empty($vwplrp9u24 ) ) { foreach ($vwplrp9u24 as $vwply17edn => $vwplph268z ) { if ($vwply17edn != 'Groups' && $vwplph268z <> 'null' && $vwplph268z > '' && $vwply17edn != $this->settings['settings']['password_field'] ) {  echo '<input style="color:#000;width:200px;margin-right:25px;" disabled value="',$vwply17edn,'"> <input disabled style="color:#000;width:300px;" value="', $vwplph268z,'"><br>'; } if ($vwply17edn == $this->settings['settings']['password_field'] ) { echo '<!-- CRM Password:  ', $vwply17edn, ' = |', $vwplph268z, '| -->'; } } } echo '</td>'; echo '</tr>'; echo '<tr>'; echo '<th valign="top"><label for="infusionsoft_memberships">Memberships</label></th>'; echo '<td>'; if (empty($vwplc0nobe['memb_user']['membership_names'] ) ) { echo '<em>(None)</em>'; } else { echo str_replace(',', ', ', $vwplc0nobe['memb_user']['membership_names'] ); } echo '<br>'; echo 'Level: ', (isset($vwplc0nobe['memb_user']['membership_level'] ) ? $vwplc0nobe['memb_user']['membership_level'] : '' ), '<br />'; echo '<br />'; echo '</td>'; echo '</tr>'; echo '<tr>'; echo '<th><label for="infusionsoft_tags">Tags</label></th>'; echo '<td>'; echo '<input type="text" disabled value="', (isset($vwplrp9u24['Groups'] ) ? $vwplrp9u24['Groups'] : '' ), '" id="current_tags" class="multitaglist" style="width:600px !important;"><br>';  $vwple5y1zo = explode(',', $vwplrp9u24['Groups'] ); $vwpls0hwb5 = wplj_l2t::wplaajf(TRUE ); $vwpls0hwb5 = $vwpls0hwb5['mc']; $vwplechli = array(); foreach ( (array) $vwpls0hwb5 as $vwplopnf => $vwpltmveju ) { $vwplechli[] = array('id' => $vwplopnf, 'text' => $vwpltmveju . ' (' . $vwplopnf . ')' ); if (in_array($vwplopnf, $vwple5y1zo ) ) { $vwplechli[] = array('id' => '-' . $vwplopnf, 'text' => 'Remove ' . $vwpltmveju . ' (-' . $vwplopnf . ')' ); } else { } } unset($vwpls0hwb5, $vwplopnf, $vwpltmveju ); $vwplechli = json_encode($vwplechli ); echo '<script>'; echo 'var taglist = ', $vwplechli, ';'; echo '</script>'; unset($vwplechli ); echo '<br />'; echo '<span class="description">Add/Remove Tags:</span><br />'; echo '<input type="text" value="" id="updated_tags" name="updated_tags" class="multitaglist" style="width:600px !important;"><br>'; echo '</td>'; echo '</tr>'; unset($vwplrp9u24, $vwply17edn, $vwplph268z ); echo '</table>'; } else { }  if ( (int) $vwplkhcx > 0 ) { $vwplrp9u24 = wpllbej::wplrande($vwplkhcx ); if (empty($vwplrp9u24 ) ) { memberium_app()->wplj9ye($vwplkhcx, true ); $vwplrp9u24 = wpllbej::wplrande($vwplkhcx ); } if (is_array($vwplrp9u24 ) && count($vwplrp9u24 ) > 0 ) { $vwpls0hwb5 = explode(',', empty($vwplrp9u24['Groups'] ) ? '' : $vwplrp9u24['Groups'] ); echo '<table class="form-table">'; echo '<tr>'; echo '<th><label>Last Login:</label></th>'; echo '<td>'; $vwplc1zlt = get_user_meta($vwplgogvie->ID, 'last_login_time', TRUE ); $vwpli_ys = get_option('timezone_string'); $vwplvu0pn = date_default_timezone_get(); if (! empty($vwpli_ys)) { date_default_timezone_set($vwpli_ys ); } echo 'Date: ', $vwplc1zlt > 1 ? date('Y-m-d h:i:s', $vwplc1zlt ) : 'None'; echo '<br>'; date_default_timezone_set($vwplvu0pn ); $vwplc1zlt = get_user_meta($vwplgogvie->ID, 'login_ip_address', TRUE ); echo 'IP Address: ', $vwplc1zlt > '' ? $vwplc1zlt : 'None'; echo '<br>'; $vwplc1zlt = get_user_meta($vwplgogvie->ID, 'login_count', TRUE ); echo 'Total Logins: ', (int)$vwplc1zlt; echo '<br>'; echo '</td>'; echo '</tr>'; echo '</table>'; } } echo '<table class="form-table">'; echo '<tr>'; echo '<th>'; echo '<label for="infusionsoft_tags">Synchronize Contact</label>'; echo '</th>'; echo '<td>'; echo '<input type="submit" name="memberium_sync" value="Re-Synchronize Contact" class="button-secondary"><br />'; echo '<span class="description">Synchronizing will delete any local records, and resync the data from Infusionsoft</span>'; echo '</td>'; echo '</tr>'; echo '</table>'; remove_action('admin_footer', array($this, 'wplyo590_' ) );
