<?php
if (!defined('ABSPATH' ) ) { die(); } if (! current_user_can('manage_options' ) ) { wp_die(__('You do not have sufficient permissions to access this page.' ) ); } global $i2sdk, $wpdb; $vwplfq7r19 = 'memberium_sync_api'; $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplfqgl3j = get_option('i2sdk' ); $this->settings = wplz8bid::wplvf1d(); memberium_app()->wplaw3p(); $i2sdk->syncCustomFields(); $_GET['tab'] = isset($_GET['tab'] ) ? $_GET['tab'] : 'operations'; if ($_SERVER['REQUEST_METHOD'] == 'POST' ) {  if (! wp_verify_nonce($_POST[$vwplfq7r19], MEMBERIUM_LIB ) ) { wp_die('nonce error' ); return; } if ($_POST['formtype'] == 'operations' ) { $vwplmu62n = array( 'makepass_scan_size', 'makepass_scan_tag', 'makepass_success_tag', 'makepass_success_actionset', ); foreach($vwplmu62n as $vwpl_s6l ) { $this->settings['settings'][$vwpl_s6l] = isset($_POST[$vwpl_s6l] ) ? (int) $_POST[$vwpl_s6l] : $this->settings['settings'][$vwpl_s6l]; } } elseif ($_POST['formtype'] == 'categories' ) { $_POST['is4wp_ignore_tag_categories'] = empty($_POST['is4wp_ignore_tag_categories'] ) ? array() : $_POST['is4wp_ignore_tag_categories']; $vwplu8vy = array(); $vwplawkh = wpllbej::wplcil75(); foreach($vwplawkh as $vwplyq9i7o => $vwplcjpa ) { if (! in_array($vwplcjpa['id'], $_POST['is4wp_ignore_tag_categories'] ) ) { $vwplu8vy[] = $vwplcjpa['id']; } } $vwplu8vy = implode(',', $vwplu8vy ); if (! empty($vwplu8vy ) ) { $vwplnzlj0t = MEMBERIUM_DB_TAGS; $vwplx1ap5_ = "DELETE FROM `{$vwplnzlj0t}` WHERE category in ({$vwplu8vy} ) AND `appname` = '{$vwplw5rgd3}'"; $wpdb->query($vwplx1ap5_ ); } $this->settings['settings']['ignore_tag_categories'] = $vwplu8vy; memberium_app()->wplaw3p(); wpljwbf2::wplc1on7('Tag Categories Ignore List Updated.' ); } elseif ($_POST['formtype'] == 'contactfields' ) { if (empty($_POST['is4wp_ignore_contact_fields'] ) ) { $_POST['is4wp_ignore_contact_fields'] = array(); } $this->settings['settings']['ignore_contact_fields'] = (is_array($_POST['is4wp_ignore_contact_fields'] ) ) ? implode(',', $_POST['is4wp_ignore_contact_fields'] ) : ''; if ($this->settings['settings']['ignore_contact_fields'] > '' ) { $vwplx1ap5_ = 'DELETE FROM `' . MEMBERIUM_DB_CONTACTS . '` WHERE fieldname in (\'' . $this->settings['settings']['ignore_contact_fields'] . '\') AND `appname` = "' . $this->appname . '" '; $wpdb->query($vwplx1ap5_ ); } $i2sdk->syncCustomFields(); wpljwbf2::wplc1on7('Contact Fields Ignore List Updated.' ); } elseif ($_POST['formtype'] == 'buddypress' ) { $vwpll_bod = get_option('memberium_xprofile_map', array() ); update_option('memberium_xprofile_map', $_POST['fieldmap'] ); } wplz8bid::wplqsxd($this->settings ); } wpljwbf2::wplyb40j1(); $vwpln5qyc = array( 'operations' => '<i class="fa fa-plug"></i> Operations', 'categories' => '<i class="fa fa-tags"></i> Tag Categories', 'contactfields' => '<i class="fa fa-user"></i> Contact Fields', ); if (function_exists('bp_is_active' ) && bp_is_active('xprofile' ) ) { $vwpln5qyc['buddypress'] = '<i class="fa fa-user-plus"></i> BuddyPress Fields'; } $vwpl_qd2 = empty($_GET['tab'] ) ? 'categories' : strtolower($_GET['tab'] ); echo '<div class="wrap">'; echo '<h1>', _('Sync Options' ), '</h1>'; echo '<h3 class="nav-tab-wrapper">'; foreach ($vwpln5qyc as $vwplesora => $vwplso1pw ) { $class = ($vwplesora == $vwpl_qd2 ) ? ' nav-tab-active' : ''; if ($vwplesora == $vwpl_qd2 ) { echo "<span class='nav-tab{$class}'>{$vwplso1pw}</span>"; } else { echo "<a class='nav-tab{$class}' href='?page={$_GET['page']}&tab={$vwplesora}'>{$vwplso1pw}</a>"; } } echo '</h3>'; echo '<div class="tabcontent" style="margin-top:10px;">'; echo '<div class="wrap">'; echo '<form method="POST" action="">'; echo '<input type="hidden" name="formtype" value="', $_GET['tab'], '">'; wp_nonce_field(MEMBERIUM_LIB, $vwplfq7r19 ); $vwplelob86 = $this->settings['settings']; if ($vwpl_qd2 == 'operations' ) { include_once(MEMBERIUM_SCREEN_DIR . 'sync-operations-show.php' ); } elseif ($vwpl_qd2 == 'categories' ) { include_once(MEMBERIUM_SCREEN_DIR . 'sync-categories-show.php' ); } elseif ($vwpl_qd2 == 'contactfields' ) { include_once(MEMBERIUM_SCREEN_DIR . 'sync-contactfields-show.php' ); } elseif ($vwpl_qd2 == 'buddypress' ) { include_once(MEMBERIUM_SCREEN_DIR . 'sync-buddypress-show.php' ); } else { memberium_app()->wpllfqh_('easter_egg' ); echo wp_oembed_get('https://www.youtube.com/watch?v=zgvXtexdgAM', array('autoplay' => '1' ) ); echo '<p>Klaatu Barada N... Necktie... Neckturn... Nickel...</p><p>It\'s an "N" word, it\'s definitely an "N" word!</p><p>Klaatu... Barada... N...</p>'; } echo '</form>'; echo '</div>'; echo '</div>'; echo '</div>'; if (! empty($vwplsgs_o ) ) {  $vwpli9j0t[] = array('id' => 0, 'text' => '(Don\'t Sync)' ); foreach ( (array) $vwplsgs_o as $vwplopnf => $vwple2yn ) { $vwpli9j0t[] = array('id' => $vwplopnf, 'text' => $vwple2yn ); } $vwpli9j0t = json_encode($vwpli9j0t ); unset($vwpls0hwb5, $vwplopnf, $vwpltmveju ); echo '<script>'; echo 'var requiredtaglist      = ', $vwpli9j0t, ';'; echo '</script>'; unset($vwpli9j0t ); } $vwpls0hwb5 = wplj_l2t::wplaajf(true ); $vwpls0hwb5 = $vwpls0hwb5['mc']; $vwplechli = array(); $vwplechli[] = array('id' => 0, 'text' => '(None)' ); foreach ( (array) $vwpls0hwb5 as $vwplopnf => $vwpltmveju ) { $vwplechli[] = array('id' => $vwplopnf, 'text' => $vwpltmveju . ' (' . $vwplopnf . ')' ); } $vwplechli = json_encode($vwplechli ); unset($vwpls0hwb5, $vwplopnf, $vwpltmveju ); $vwplvmes5 = wpllbej::wpletmsz(array('none' => true, 'format' => 'json' ) ); echo '<script>'; echo 'var actionsetlist = ', $vwplvmes5, ";\n"; echo 'var taglist = ', $vwplechli, ";\n"; echo '</script>'; unset($vwplechli );
