<?php
 if (!defined('ABSPATH' ) ) { die(); } ?>
<style>
	.membWarning {
		font-weight:bold;
		color:red;
	}
	.membGood {
		font-weight:bold;
		color:green;
	}
</style>
<?php
 global $wpdb; memberium_app()->wpllfqh_('view_dashboard' ); $vwplelob86 = wplz8bid::wplvf1d('settings' ); $vwplgxrbm = wplz8bid::wplvf1d('memberships' ); $vwplw5rgd3 = wplz8bid::wplm3z9k('appname' ); $vwplfqgl3j = get_option('i2sdk' ); $vwplw95_k2 = wpln9_s::wplahoe0(); $vwplufm82 = (! empty($vwplgxrbm ) ) ? count($vwplgxrbm ) : 0; $vwplktq3k = get_option('memberium_tables_updated', array() ); $vwply2zs = wpliebn::wplgc765(); if (class_exists('wplmu94w' ) ) { $vwplmjze = empty($vwplelob86['session_timeout'] ) ? ini_get('session.gc_maxlifetime' ) : $vwplelob86['session_timeout']; wplmu94w::wpl_yq_2($vwplelob86['session_timeout'] ); } if (count($vwply2zs) > 0 ) { wple8cx::wplbq5x9(); } $vwplktq3k['tags'] = isset($vwplktq3k['tags'] ) ? $vwplktq3k['tags'] : 0; $vwplktq3k['tagcategories'] = isset($vwplktq3k['tagcategories'] ) ? $vwplktq3k['tagcategories'] : 0; $vwplktq3k['actionsets'] = isset($vwplktq3k['actionsets'] ) ? $vwplktq3k['actionsets'] : 0; $vwplktq3k['i2sdk_customfields'] = isset($vwplktq3k['i2sdk_customfields'] ) ? $vwplktq3k['i2sdk_customfields'] : 0; $vwplktq3k['products'] = isset($vwplktq3k['products'] ) ? $vwplktq3k['products'] : 0; $vwplktq3k['affiliates'] = isset($vwplktq3k['affiliates'] ) ? $vwplktq3k['affiliates'] : 0; $vwplktq3k['invoices'] = isset($vwplktq3k['invoices'] ) ? $vwplktq3k['invoices'] : 0; $vwpltbkve0 = false; set_time_limit(30 ); if (empty($_GET['nosync'] ) ) { $vwpli31x0l = isset($vwplktq3k['tags'] ) ? $vwplktq3k['tags'] : 0; if ($vwpli31x0l == 0 || (time() - $vwpli31x0l ) > 1800 ) { wpllbej::wplwwbm9(); $vwplktq3k['tags'] = time(); $vwpltbkve0 = true; update_option('memberium_tables_updated', $vwplktq3k, false ); set_time_limit(30 ); } $vwpli31x0l = isset($vwplktq3k['tagcategories'] ) ? $vwplktq3k['tagcategories'] : 0; if (! $vwpltbkve0 ) { if ($vwpli31x0l == 0 || (time() - $vwpli31x0l ) > 1800 ) { memberium_app()->wplaw3p(); $vwplktq3k['tagcategories'] = time(); $vwpltbkve0 = true; update_option('memberium_tables_updated', $vwplktq3k, false ); set_time_limit(30 ); } } $vwpli31x0l = isset($vwplktq3k['actionsets'] ) ? $vwplktq3k['actionsets'] : 0; if (! $vwpltbkve0 ) { if ($vwpli31x0l == 0 || (time() - $vwpli31x0l ) > 3600 ) { memberium_app()->wplgfugwo(); $vwplktq3k['actionsets'] = time(); set_time_limit(30 ); $vwpltbkve0 = true; } update_option('memberium_tables_updated', $vwplktq3k, false ); } $vwpli31x0l = isset($vwplktq3k['i2sdk_customfields'] ) ? $vwplktq3k['i2sdk_customfields'] : 0; if (! $vwpltbkve0 ) { if ($vwpli31x0l == 0 || (time() - $vwpli31x0l ) > 3600 ) { global $i2sdk; $i2sdk->syncCustomFields(); $vwplktq3k['i2sdk_customfields'] = time(); set_time_limit(30 ); $vwpltbkve0 = true; } update_option('memberium_tables_updated', $vwplktq3k, false ); } $vwpli31x0l = isset($vwplktq3k['products'] ) ? $vwplktq3k['products'] : 0; if (! $vwpltbkve0 ) { if ($vwpli31x0l == 0 || (time() - $vwpli31x0l ) > 3600 ) { wpllbej::wplctzj(); $vwplktq3k['products'] = time(); set_time_limit(30 ); $vwpltbkve0 = true; } update_option('memberium_tables_updated', $vwplktq3k, false ); } $vwpli31x0l = isset($vwplktq3k['invoices'] ) ? $vwplktq3k['invoices'] : 0; if (! empty($vwplelob86['sync_ecommerce'] ) ) { if (! $vwpltbkve0 ) { if ($vwpli31x0l == 0 || (time() - $vwpli31x0l ) > 3600 ) { memberium_app()->wplblz7(); $vwplktq3k['invoices'] = time(); set_time_limit(30 ); $vwpltbkve0 = true; } update_option('memberium_tables_updated', $vwplktq3k, false ); } }  } set_time_limit(30 ); $vwplx21cf = array(); foreach($vwplktq3k as $vwply17edn => $vwplph268z ) { $vwplx21cf[$vwply17edn] = abs(intval( ($vwplph268z - time() ) / 3600 ) ); } $vwpla54ov0 = $wpdb->postmeta; $vwplx1ap5_ = "SELECT count(DISTINCT `post_id` ) FROM `{$vwpla54ov0}` WHERE meta_key LIKE '_is4wp%' AND meta_value > '';"; $vwplpy7o = (int)$wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_CONTACTS; $vwplx1ap5_ = "SELECT count(`id`) from `{$vwpla54ov0}` WHERE `fieldname` = 'Id' AND `appname` = '{$vwplw5rgd3}' "; $vwplilw7 = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_SESSIONS; $vwplx1ap5_ = "SELECT count(`session_key`) from `{$vwpla54ov0}` WHERE `email_key` > '' "; $vwpliwdq = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_ACTIONSETS; $vwplx1ap5_ = "SELECT count(`id`) from `{$vwpla54ov0}` WHERE `appname` = '{$vwplw5rgd3}'"; $vwpli86g = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_PRODUCTS; $vwplx1ap5_ = "SELECT count(`id`) from `{$vwpla54ov0}` WHERE `appname` = '{$vwplw5rgd3}'"; $vwplfly4 = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_DATAFORMFIELDS; $vwplx1ap5_ = "SELECT count(`id`) from `{$vwpla54ov0}` WHERE `appname` = '{$vwplw5rgd3}'"; $vwpllxznr = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_CONTACTGROUPCATEGORIES; $vwplx1ap5_ = "SELECT count(`id`) from `{$vwpla54ov0}` WHERE `appname` = '{$vwplw5rgd3}'"; $vwpllpn03l = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_TAGS; $vwplx1ap5_ = "SELECT count(id) from {$vwpla54ov0} WHERE `appname` = '{$vwplw5rgd3}' "; $vwpliilvm = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = i2sdk_class::DB_API_LOG; $vwplx1ap5_ = "SELECT count(*) from {$vwpla54ov0} WHERE `appname` = '{$vwplw5rgd3}' "; $vwplc7kawq = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_AFFILIATES; $vwplx1ap5_ = "SELECT count(*) from `{$vwpla54ov0}` WHERE `fieldname` = 'Id' AND `appname` = '{$vwplw5rgd3}'"; $vwplufdak = $wpdb->get_var($vwplx1ap5_ ); $vwpla54ov0 = MEMBERIUM_DB_INVOICES; $vwplx1ap5_ = "SELECT count(*) from `{$vwpla54ov0}` WHERE `appname` = '{$vwplw5rgd3}'"; $vwpltxkz4m = $wpdb->get_var($vwplx1ap5_ ); $vwpl_5tj6l = count(array_filter(explode(',', trim($vwplelob86['ignore_tag_categories'], ',' ) ) ) ); $vwplibiu = count(array_filter(explode(',', $vwplelob86['ignore_contact_fields'] ) ) ); if (wpln9_s::wplio5sck() ) { $vwploa8hy = '<strong class="membGood">Active</strong>'; $vwpldu3vq1 = wpln9_s::wplc2v0sx(get_option(memberium_app()->license_key_name, '' ) ); if ($vwpldu3vq1['trial_mode'] ) { $vwploa8hy = '<strong class="membGood">Trial Mode</strong> <strong class="membWarning">(Limited to ' . $vwpldu3vq1['max_users'] . ' Users )</strong>'; } } else { $vwploa8hy = '<strong class="membWarning">Inactive</strong> '; } unset($vwplyysi_, $vwpldu3vq1 ); $vwply0v3j = (wpll72jhi::wplol_bad() <> $_SERVER['REMOTE_ADDR'] ); if (empty($vwplfqgl3j['app_name'] ) || empty($vwplfqgl3j['api_key'] ) ) { $vwplfqgl3j['server_verified'] = false; } $vwpld78sfj = count(get_option('cron', array() ) ); echo '<h3>Infusionsoft Connection</h3>'; echo '<form method="post" action="">'; echo '<label>App Name</label><strong>', empty($vwplfqgl3j['app_name'] ) ? '<span class="membWarning">Missing</span>' : strtoupper($vwplfqgl3j['app_name'] ), '</strong><br />'; echo '<label>API Status</label>', (boolean) $vwplfqgl3j['server_verified'] ? '<strong class="membGood">Connected</strong>' : '<strong class="membWarning">Not Connected</strong>', '<br />'; echo '<label>License Status</label>', $vwploa8hy, '<br />'; echo '<p>'; echo '<input type="submit" name="save" value="Renew License" class="button-primary" style="margin-right:20px;">'; echo '<input type="submit" name="save" value="Re-Activate Plugin" class="button-primary">'; echo '</p>'; echo '<h3>Infusionsoft Data Metrics</h3>'; echo '<label>Synced Actionsets</label><span class="metric">', $vwpli86g, '</span> (', wpljwbf2::wpl_c867($vwplktq3k['actionsets'] ), ')<br />'; echo '<label>Synced Custom Fields</label><span class="metric">', $vwpllxznr, '</span> (', wpljwbf2::wpl_c867($vwplktq3k['i2sdk_customfields'] ), ')<br />'; echo '<label>Synced Tag Categories</label><span class="metric">', $vwpllpn03l, '</span> (', wpljwbf2::wpl_c867($vwplktq3k['tagcategories'] ), ')<br />'; echo '<label>Synced Tags</label><span class="metric">', $vwpliilvm, '</span> (', wpljwbf2::wpl_c867($vwplktq3k['tags'] ), ')<br />'; echo '<label>Synced Invoices</label><span class="metric">', $vwpltxkz4m, '</span> (', wpljwbf2::wpl_c867($vwplktq3k['invoices'] ), ')<br />'; echo '<label>Blocked Fields</label><span class="metric">', (empty($vwplibiu ) ? 0 : '<strong class="membWarning">' . $vwplibiu .'</strong>' ), '</span><br />'; echo '<label>Blocked Tag Categories</label><span class="metric">', (empty($vwpl_5tj6l ) ? 0 : '<strong class="membWarning">' . $vwpl_5tj6l .'</strong>' ), '</span><br />'; echo '<label>Cached Affiliates</label><span class="metric">', $vwplufdak, '</span><br />'; echo '<label>Cached Contacts</label><span class="metric">', $vwplilw7, '</span><br />'; echo '<label>Active Sessions</label><span class="metric">', $vwpliwdq, '</span><br />'; echo '<label>API Log Entries</label><span class="metric">', $vwplc7kawq, '</span><br />'; echo '<p>'; echo '<input type="submit" name="save" value="Synchronize Infusionsoft" class="button-primary"> ', wpljwbf2::wplypewkt(8470 ); echo '</p>'; echo '<h3>System Metrics</h3>'; if (MEMBERIUM_BETA ) { echo '<label>Beta Mode</label><span class="metric"><strong class="membWarning">Beta</strong></span><br />'; } if (MEMBERIUM_DEBUG ) { echo '<label>Debug Mode</label><span class="metric"><strong class="membWarning">ON</strong></span><br />'; } if (WP_DEBUG ) { echo '<label>WordPress Debug Mode</label><span class="metric"><strong class="membWarning">ON</strong></span><br />'; } $vwplip3fnx = false; $vwplfkojlf = wp_login_url() . '?action=override&affiliate=0'; $vwplgitq = array( 'sslverify' => false, ); $vwplz4g7n = wp_remote_get($vwplfkojlf, $vwplgitq ); if (is_array($vwplz4g7n ) ) { $vwplip3fnx = stripos($vwplz4g7n['body'], '<meta name="generator" content="Memberium v' ); } unset($vwplz4g7n ); $vwplix_ar = count(get_plugin_updates() ); $vwplfdh9e = count(get_theme_updates() ); $vwpld7rj = get_core_updates(); $vwplj62mg = get_bloginfo('version'); $vwplm2gd1 = 0; if (is_array($vwpld7rj ) ) { foreach($vwpld7rj as $vwpljvo4 ) { $vwplm2gd1 += (int) version_compare($vwpljvo4->version, $vwplj62mg, '>' ); } } unset($vwpld7rj, $vwpljvo4, $vwplj62mg ); echo '<hr>'; if ($vwplm2gd1 ) echo '<label>Missing Core Updates</label><span class="metric membWarning">', $vwplm2gd1, '</span><br />'; if ($vwplix_ar ) echo '<label>Missing Plugin Updates</label><span class="metric membWarning">', $vwplix_ar, '</span><br />'; if ($vwplfdh9e ) echo '<label>Missing Theme Updates</label><span class="metric membWarning">', $vwplfdh9e, '</span><br />'; if ($vwplm2gd1 || $vwplix_ar || $vwplfdh9e ) { echo '<hr>'; } echo '<label>Memberium Running on Front End</label><span class="metric">', ($vwplip3fnx ) ? '<strong class="membGood">Yes' : '<strong class="membWarning">No/Unknown', '</strong></span><br />'; echo '<label>Membership Levels</label><span class="metric">', $vwplufm82, '</span><br />'; echo '<label>Protected Pages/Posts</label><span class="metric">', $vwplpy7o, '</span><br />'; echo '<hr>'; echo '<label>WordPress SSL</label><span class="metric">', is_ssl() ? '<strong style="color:green;">Yes</strong>' : '<strong style="color:red;">No</strong>', '</span><br />'; echo '<label>WordPress User Count</label><span class="metric">', $vwplw95_k2, '</span><br />'; echo '<label>Wordpress Multisite</label><span class="metric"><strong>', is_multisite() ? 'Yes' : 'No', '</strong></span><br />'; echo '<label>Wordpress Super Admin</label><span class="metric">', is_super_admin() ? '<strong class="membGood">Yes' : '<strong class="membWarning">No', '</strong></span><br />'; echo '<label>WordPress Cron Jobs</label><span class="metric">', $vwpld78sfj, '</span><br />'; echo '<hr>'; echo '<label>SKU</label><span class="metric">', strtoupper(MEMBERIUM_SKU), '</span><br />'; echo '<label>WordPress Version</label><span class="metric">', get_bloginfo('version' ), '</span><br />'; echo '<label>Memory Used</label><span class="metric">', intval(memory_get_usage(true ) / (1024 * 1024 ) ), 'MB</span><br />'; echo '<label>WordPress Memory Limit</label><span class="metric">', intval(WP_MEMORY_LIMIT ), 'MB</span><br />'; echo '<label>Max Memory Limit</label><span class="metric">', intval(WP_MAX_MEMORY_LIMIT ), 'MB</span><br />'; echo '<label>PHP Memory Allocated</label><span class="metric">', ini_get('memory_limit' ), 'B</span><br />'; echo '<hr>'; $vwplvy1di7 = defined('I2SDK_VERSION') ? I2SDK_VERSION : '<strong class="membWarning">None</strong>'; $vwpl_7rpz = property_exists('PhpXmlRpc\PhpXmlRpc', 'xmlrpcVersion' ) ? PhpXmlRpc\PhpXmlRpc::$xmlrpcVersion : '<strong class="membWarning">Unknown</strong>'; echo '<label>i2SDK Version</label><span class="metric">', $vwplvy1di7, '</span><br />'; echo '<label>XML RPC Library Version</label><span class="metric">', $vwpl_7rpz, '</span><br />'; echo '<label>PHP Version</label><span class="metric">', phpversion(), '</span><br />'; echo '<label>Operating System</label><span class="metric">', php_uname('s' ), ' ', php_uname('m' ), '</span><br />'; echo '<label>Display Errors</label><span class="metric">', ini_get('display_errors' ) ? '<strong class="membWarning">Yes' : '<strong class="membGood">No', '</strong></span><br />'; if (function_exists('ioncube_loader_version' ) ) { echo '<label>IonCube Loader Version</label><span class="metric">', ioncube_loader_version(), '</span><br />'; } echo '<label>Load Balancer / Proxy</label><span class="metric">', $vwply0v3j ? '<strong class="membGood">Yes</strong>' : 'No' , '</span><br />'; echo '</form>';
