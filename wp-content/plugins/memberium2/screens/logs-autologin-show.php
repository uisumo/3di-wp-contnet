<?php
if (! defined('ABSPATH' ) ) { die(); } if (!current_user_can('manage_options' ) ) { wp_die(__('You do not have sufficient permissions to access this page.' ) ); } $vwplanieul = empty($_GET['limit'] ) ? 10 : (int) $_GET['limit']; $vwplx5d8 = empty($_GET['start'] ) ? 0 : (int) $_GET['start']; $vwplvakx = empty($_GET['search'] ) ? '' : trim($_GET['search'] ); $vwplnzlj0t = MEMBERIUM_DB_HTTPPOST; $vwplvtmqd = empty($_GET['contact_id'] ) ? 0 : (int) $_GET['contact_id']; $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwpljupbl4 = ''; $vwpljupbl4 .= empty($vwplvtmqd ) ? '' : " AND `contactid` = {$vwplvtmqd} "; $vwpljupbl4 .= empty($vwplvakx ) ? '' : " AND `log` LIKE '%" . $wpdb->esc_like($vwplvakx ) . "%' "; $vwplx1ap5_ = "SELECT `id`, UNIX_TIMESTAMP(`time`) AS `time`, `contactid`, `log` FROM `{$vwplnzlj0t}` WHERE `type` = 'autologin' AND `appname` = '{$vwplw5rgd3}' {$vwpljupbl4} ORDER BY `id` DESC LIMIT {$vwplanieul} ;"; $vwply4j8x = $wpdb->get_results($vwplx1ap5_, ARRAY_A ); if (! is_array($vwply4j8x ) || empty($vwply4j8x ) ) { echo '<p>The Autologin log is empty.</p>'; } else { $vwpli_ys = get_option('timezone_string'); $vwplvu0pn = date_default_timezone_get(); date_default_timezone_set($vwpli_ys ); echo '<table class="widefat" style="table-layout:fixed">'; echo '<tr>'; echo '<td width="150">Time</td>'; echo '<td width="100">Contact ID</td>'; echo '<td>Results</td>'; echo '</tr>'; foreach($vwply4j8x as $vwplheakg ) { echo '<tr>'; echo '<td>', date('Y-m-d H:i:s', $vwplheakg['time'] ), '</td>'; echo '<td>', $vwplheakg['contactid'], '</td>'; echo '<td style="word-wrap: break-word;">', nl2br($vwplheakg['log'] ), '</td>'; echo '</tr>'; } echo '</table>'; date_default_timezone_set($vwplvu0pn ); } echo '<form method="get" style="margin-top:12px;">'; echo '<input type="hidden" name="page" value="memberium-logs">'; echo '<input type="hidden" name="tab" value="autologin">'; echo "Contact ID: <input type='text' name='contact_id' value='{$vwplvtmqd}' placeholder='Contact ID'>"; echo "Search: <input type='text' name='search' value='{$vwplvakx}' placeholder='Search'>"; echo "Limit: <input type='text' name='limit' value='{$vwplanieul}' placeholder='# Results'>"; echo '<input type="submit" value="Search" class="button-primary" style="margin-left:15px;">'; echo '</form>'; echo '<form method="post">'; echo '<input type="hidden" name="page" value="memberium-logs">'; echo '<input type="hidden" name="tab" value="autologin">'; echo '<input type="submit" name="delete_autologin" value="Delete Log" class="button delete">'; echo '</form>';
