<?php
/**
 * Copyright (c) 2012-2020 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (!defined('ABSPATH' ) ) { die(); } global $wpdb; $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplelob86 = wplz8bid::wplvf1d('settings'); $vwplfqgl3j = stripslashes_deep(get_option('i2sdk') ); $vwplx1ap5_ = 'SELECT count(*) FROM ' . MEMBERIUM_DB_ACTIONSETS . ' WHERE `appname` = %s AND `name` > "" ORDER BY `name` ASC'; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $vwplw5rgd3 ); $vwpli86g = $wpdb->get_results($vwplx1ap5_, ARRAY_A ); $vwplx1ap5_ = 'SELECT concat(\'_\', name) as name FROM ' . MEMBERIUM_DB_DATAFORMFIELDS . ' WHERE `appname` = "' . $vwplw5rgd3 . '" AND datatype = 15 AND formid = -1 ORDER BY name ASC'; $vwplmu62n = $wpdb->get_results($vwplx1ap5_, ARRAY_A ); $vwplq6v9y2 = ''; $vwplf95rp = ''; $vwplkyvi = 1; $vwplgrky_4 = array( 'Email',   ); if ($vwplelob86['username_field'] <> 'Email') { $vwplgrky_4[] = $vwplelob86['username_field']; $vwplkyvi = 2; } foreach($vwplgrky_4 as $vwplcjpa ) { $vwplq6v9y2 .= "<option value='{$vwplcjpa}' " . ( ($vwplcjpa == $vwplelob86['username_field'] ) ? ' selected="selected" ' : '' ) . ">{$vwplcjpa}</option>"; } $vwplgrky_4 = array( 'Password', ); foreach($vwplgrky_4 as $vwplcjpa ) { $vwplf95rp .= "<option value='{$vwplcjpa}' " . ( ($vwplcjpa == $vwplelob86['password_field'] ) ? ' selected="selected" ' : '' ) . ">{$vwplcjpa}</option>"; } foreach ($vwplmu62n as $id => $vwplheakg ) {  $vwplf95rp.= '<option value="' . $vwplheakg['name'] . '" ' . ( ($vwplheakg['name'] == $vwplelob86['password_field'] ) ? ' selected="selected" ' : '' ) . '>' . $vwplheakg['name'] . '</option>'; } $vwplhe5jq = count($vwplmu62n ); unset($vwplmu62n, $vwplcjpa, $vwplheakg, $id); echo '<form method="POST" action="">'; wp_nonce_field(MEMBERIUM_LIB, 'memberium_options_nonce' ); echo '<h3>Login Fields</h3>'; echo '<ul>'; if ($vwplkyvi > 1) { echo '<li><label>Infusionsoft Username Field</label>'; echo '<select id="username_field" name="username_field" class="basic-single" style="width:250px;">'; echo $vwplq6v9y2; echo '</select>', wpljwbf2::wplypewkt(1169 ), '</li>'; } echo '<li><label>Infusionsoft Password Field</label>'; echo '<select id="password_field" name="password_field" class="basic-single" style="width:250px;">'; echo $vwplf95rp; echo '</select>', wpljwbf2::wplypewkt(1171 ), ' <strong style="color:red">IMPORTANT: Please Read</strong></li>'; if ($vwplelob86['password_field'] == 'Password' ) { echo '<li><label>Create New Password Field</label>'; echo '<input type="text" name="new_password_field" size="20" value="" />'; echo wpljwbf2::wplypewkt(5733 ), '</li>'; } echo '<hr>'; echo '<h3>Login Options</h3>'; wpljwbf2::wplsok6r('Known Logins Only', 'known_logins_only', 6773, $vwplelob86['known_logins_only'] ); wpljwbf2::wplsok6r('Allow Local Logins', 'allow_local_logins', 6367, $vwplelob86['allow_local_logins'] ); wpljwbf2::wplsok6r('Local Auth Only', 'local_auth_only', 6818, $vwplelob86['local_auth_only'] ); wpljwbf2::wplsok6r('Prevent Simultaneous Logins', 'simultaneous_logins', 1197, $vwplelob86['simultaneous_logins'] ); wpljwbf2::wplt5xt('Maximum Login IPs', 'maximum_login_ips', $vwplelob86['maximum_login_ips'], array('min' => 0, 'max' => 256 ) ); wpljwbf2::wplt5xt('Maximum Login Window (Hours)', 'maximum_login_timeframe', $vwplelob86['maximum_login_timeframe'], array('min' => 0, 'max' => 672 ) ); echo '<hr>'; echo '<h3>Login/Logout Actions</h3>'; wpljwbf2::wpln84ebf( 'Login Page <strong style="color:red;">(Caution)</strong>', 'login_url', (int) $vwplelob86['login_url'], 'pagelistdropdown', array('help_id' => 1208 ) ); if ($vwpli86g > 0) { if (true || ! empty($vwplelob86['login_actionset']) ) { wpljwbf2::wpln84ebf( 'Login Actionset', 'login_actionset', $vwplelob86['login_actionset'], 'actionsetdropdown', array('help_id' => 1175 ) ); } if (true || ! empty($vwplelob86['logout_actionset']) ) { wpljwbf2::wpln84ebf( 'Logout Actionset', 'logout_actionset', $vwplelob86['logout_actionset'], 'actionsetdropdown', array('help_id' => 1178 ) ); } } $vwplnzlj0t = i2sdk_class::DB_DATAFORMFIELDS; $vwplx1ap5_ = "SELECT concat('_', name) as name FROM `{$vwplnzlj0t}` WHERE `appname` = '{$vwplw5rgd3}' AND (datatype = 13 OR datatype = 14) ORDER BY name ASC"; $vwply4j8x = $wpdb->get_col($vwplx1ap5_ ); $vwplnkj9d_ = array(); $vwplnkj9d_[''] = '(None)'; foreach($vwply4j8x as $vwplheakg ) { $vwplnkj9d_[$vwplheakg] = $vwplheakg; } wpljwbf2::wplnclv('Last Login Field', 'last_login_field', $vwplelob86['last_login_field'], $vwplnkj9d_, array('help_id' => 1173 ) ); wpljwbf2::wpln84ebf('Autologin First Login Page', 'first_login_page', (int) $vwplelob86['first_login_page'], 'pagelistdropdown'); wpljwbf2::wplsok6r('Login Log', 'login_log', 1187, $vwplelob86['login_log'] ); wpljwbf2::wplsok6r('Disable Display Name Update', 'disable_displayname_update', 9634, $vwplelob86['disable_displayname_update'] ); wpljwbf2::wpls_l9('Nicename/Display Name Format', 'displayname_format', $vwplelob86['displayname_format'], array('help_id' => 5731 ) ); wpljwbf2::wplt5xt('Autologout/Inactivity Timer (Seconds)', 'autologout_time', $vwplelob86['autologout_time'],array('help_id' => 7688, 'min' => 0, 'max' => 86400, 'size' => 3, 'style' => 'text-align:right;width:80px;' ) ); echo '<hr>'; echo '<h3>Password Generation Settings</h3>'; wpljwbf2::wplt5xt('Minimum Password Length', 'min_password_length', $vwplelob86['min_password_length'], array('help_id' => 1185, 'min' => 0, 'max' => 64, 'size' => 5 ) ); $vwplnkj9d_ = array( 0 => 'Simple Lowercase (Level 0)', 1 => '+ Uppercase Consonants (Level 1)', 2 => '+ Uppercase Vowels (Level 2)', 3 => '+ Numbers (Level 3)', 4 => '+ Symbols (Level 4)', ); $vwplg6lz4 = array( 'style' => 'width:250px;', 'help_id' => 0 ); wpljwbf2::wplnclv('Password Strength', 'password_strength', $vwplelob86['password_strength'], $vwplnkj9d_, $vwplg6lz4); wpljwbf2::wpls_l9( 'HTTP POST Auth Keys', 'http_post_key', $vwplfqgl3j['http_post_key'], array('help_id' => 3699, 'disabled' => true, 'style' => 'text-align:left;width:350px;' ) ); wpljwbf2::wpln84ebf( 'Password Reset Tag', 'password_reset_tag', (int) $vwplelob86['password_reset_tag'], 'taglistdropdown', array('help_id' => 1183 ) ); wpljwbf2::wplsok6r('HTTP POST Log', 'httppost_log', 0000, $vwplelob86['httppost_log'] ); echo '<hr>'; echo '<h3>Auto-Login Settings</h3>'; wpljwbf2::wplsok6r('Allow Autologin', 'allow_autologin', 4398, $vwplelob86['allow_autologin'] ); if (! empty($vwplelob86['allow_autologin'] ) ) { wpljwbf2::wpls_l9( 'Autologin Auth Keys', 'autologin_authkeys', $vwplelob86['autologin_authkeys'], array('help_id' => 2571, 'style' => 'text-align:left;width:350px;' ) ); } echo '<hr>'; echo '</ul>'; echo '<p><input type="submit" value="Update" class="button-primary"></p>'; echo '</form>';
