<?php
/**
 * Copyright (c) 2012-2020 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (! defined('ABSPATH') ) { die(); } final class wple8cx { static function wplldr75($vwpllzc0 = false) { global $wpdb; self::wplbq5x9(); if (function_exists('is_multisite') && is_multisite() ) {  if ($vwpllzc0) { $vwpler1vp = $wpdb->blogid;  $vwpljonaxp = $wpdb->get_col("SELECT blog_id FROM $wpdb->blogs"); if (is_array($vwpljonaxp) ) { foreach ($vwpljonaxp as $vwpltycqk9) { switch_to_blog($vwpltycqk9); self::wplbq5x9(true); } switch_to_blog($vwpler1vp); return; } } } } static function wplbq5x9($vwplt3bf8k = false) { global $i2sdk, $wpdb; self::wpldfk9a(); self::wplddy3(); require_once ABSPATH . 'wp-admin/includes/upgrade.php';  $vwplnmgpy1 = self::wpl_gzcw(); $vwplfqgl3j = get_option('i2sdk'); self::wpltu6k();  self::wplqvrx8f();  self::wplrizyj(); if (! isset($vwplfqgl3j['server_verified']) || $vwplfqgl3j['server_verified'] <> 1) { return; }  wplneci::wplx4fq0i();   self::wpll76y();  self::wplak53_(); add_option('memberium/activation_timestamp', time() );  $vwplrd4c = get_option('memberium_extensions', array() ); $vwplz97jd = glob(MEMBERIUM_LIB . '/ext/*/init.php'); $expensive_extensions = array( 'page-tracking', ); if (! empty($vwplz97jd) ) { foreach ($vwplz97jd as $extension) { $vwplxmw46 = basename(dirname($extension) ); if (! isset($vwplz97jd[$vwplxmw46]) ) { if (in_array($vwplxmw46, $expensive_extensions) ) { $vwplrd4c[$vwplxmw46] = 0; } else { $vwplrd4c[$vwplxmw46] = 1; } } } } update_option('memberium_extensions', $vwplrd4c, true); if (! $vwplt3bf8k) {  self::wplekxip(); if (defined('MEMBERIUM_DEFER_ACTIVATION_SYNC') ) { return; }  if (! method_exists($i2sdk, 'isVerified') ) { return; } return; if (function_exists('wpal_i2sdk_activate') ) { wpal_i2sdk_activate(); } wpln9_s::wplzjhtq(true); global $i2sdk; set_time_limit(30); $i2sdk->syncCustomFields(); set_time_limit(30); memberium_app()->wplaw3p(); set_time_limit(30); wpllbej::wplwwbm9(); set_time_limit(30); wpllbej::wplctzj();   set_time_limit(30); memberium_app()->wplgfugwo(); } } static function wpln2ae() { $vwpljvhj = get_option('memberium_cron'); if ($vwpljvhj > 0) { wp_unschedule_event($vwpljvhj, 'memberium_scanmakepass', 0); wp_unschedule_event($vwpljvhj, 'memberium_maintenance', 0); wp_unschedule_event($vwpljvhj, 'memberium_licensecheck', 0); } delete_option('memberium_cron'); $vwplelob86 = get_option('memberium'); if (! empty($vwplelob86['delete_configuration']) ) { delete_option('memberium'); } } static function wplod95ok() { self::wplq85d(); self::wpldacm(); }    static private function wplyxp5($vwplogz_w = 'wplddjn3') { $vwplqzdlu3 = array('wplddjn3', 'LOGGED_IN', 'NONCE', 'SECRET', 'SECURE_AUTH'); $vwplexo_ = array('SALT', 'KEY'); $vwplogz_w = strtoupper($vwplogz_w); if (defined($vwplogz_w . '_SALT')) { return constant($vwplogz_w . '_SALT'); } foreach($vwplqzdlu3 as $vwply17edn) { foreach($vwplexo_ as $vwplgm_9s) { $vwply17edn = "{$vwplogz_w}_{$vwplgm_9s}"; if (defined($vwply17edn) ) { return constant($vwply17edn); } } } return self::wplinqpch(64); } static private function wpltu6k() { $vwplk8g1 = get_option('memberium_site_id', false); if (! $vwplk8g1) { $vwplk8g1 = hash_hmac('sha256', wp_basename('/'), self::wplyxp5('nonce') ); update_option('memberium_site_id', $vwplk8g1, 'yes'); } } static private function wplddy3() { if (! defined('MEMBERIUM_DEV') ) { $vwplg38x51 = dirname(MEMBERIUM_HOME) . '/lib/ext-dev/'; if (file_exists($vwplg38x51) ) { self::wplpw7bi($vwplg38x51); } $vwplg38x51 = dirname(MEMBERIUM_HOME) . '/lib7/ext-dev/'; if (file_exists($vwplg38x51) ) { self::wplpw7bi($vwplg38x51); } } } static private function wpldfk9a() { if (is_plugin_active('memberium2-installer/memberium2-installer.php') ) { deactivate_plugins('memberium2-installer/memberium2-installer.php'); } } static private function wplq85d() { $vwpl_ecm2 = get_role('administrator'); $vwpl_ecm2->remove_cap('memberium_view_user_info'); $vwpl_ecm2->remove_cap('memberium_edit_user_info'); $vwpl_ecm2->remove_cap('memberium_view_private_comments'); } static private function wpldacm() { $vwpljvhj = get_option('memberium_cron'); if ($vwpljvhj > 0) { $vwpld78sfj = array( 'memberium_license_check', 'memberium_maintenance', 'memberium_maintenance12', 'memberium_scanmakepass', ); foreach($vwpld78sfj as $vwplvp7j) { wp_clear_scheduled_hook($vwplvp7j); } } delete_option('memberium_cron'); } static private function wpl_gzcw() { $vwplnkj9d_ = wplz8bid::wplvf1d(); if (empty($vwplnkj9d_['settings']) || ! is_array($vwplnkj9d_['settings']) ) { $vwplnkj9d_['settings'] = array(); }    $vwplwt87ku = array( ); foreach ($vwplwt87ku as $vwply17edn) { unset($vwplnkj9d_['settings'][$vwply17edn]); } $vwplnkj9d_['settings']['autologin_authkeys'] = empty($vwplnkj9d_['settings']['autologin_authkeys']) ? self::wplinqpch(12) : $vwplnkj9d_['settings']['autologin_authkeys']; $vwplnkj9d_['settings']['random_seed'] = empty($vwplnkj9d_['settings']['random_seed']) ? self::wplinqpch(16) : $vwplnkj9d_['settings']['random_seed'];  $vwpltke6 = array(   'affiliate_detect' => 0, 'allow_autologin' => 1, 'allow_local_logins' => 0, 'allow_wpadmin_dashboard' => 'manage_options', 'allow_wpadmin_titlebar' => 'manage_options', 'allow_wpadmin' => 0, 'autogenerate_excerpts' => 0, 'autologout_time' => 0, 'autoupdate' => 1, 'beta_update_check' => 0, 'cache_bust' => 0, 'cache_flush' => 0, 'default_logout_page' => 0, 'default_page_redirect' => '', 'default_prohibited_action' => 'redirect', 'default_reglink_tag' => 0, 'disable_displayname_update' => 0, 'disable_lost_password' => 0, 'disable_password_reset' => 0, 'display_errors' => 0, 'displayname_format' => '', 'dynamic_menus' => 0, 'excerpt_length' => 55, 'extended_reg_fields' => 1, 'first_login_page' => 0, 'force_learndash_inheritance' => defined('LEARNDASH_VERSION') ? 1 : 0, 'global_excerpt' => '', 'hashing_mode' => 'plain', 'html_shortcode_embed' => 1, 'httppost_log' => 0, 'ignore_contact_fields' => 'ContactNotes', 'ignore_tag_categories' => '', 'known_logins_only' => 0, 'last_login_field' => '', 'local_auth_only' => 0, 'login_actionset' => 0, 'login_log' => 0, 'login_tag' => 0, 'login_url' => -1, 'logout_actionset' => 0, 'logout_tag' => 0, 'makepass_scan_size' => 10, 'makepass_scan_tag' => 0, 'makepass_success_actionset' => 0, 'makepass_success_tag' => 0, 'max_contact_age' => 0, 'maximum_login_ips' => 0, 'maximum_login_timeframe' => 0, 'merchant_account_id' => 0, 'microcache_compat_session' => 0, 'min_password_length' => 8, 'multi_language' => 0, 'new_user_registration_tag' => 0, 'page_inheritance' => 1, 'password_field' => 'Password', 'password_reset_tag' => 0, 'password_strength' => 0, 'paypal_api_password' => '', 'paypal_api_signature' => '', 'paypal_api_username' => '', 'paypal_api_verified' => 0, 'plaintext_db' => 0, 'preview_mode' => 0, 'protect_feeds' => 1, 'referral_partner_order' => 1,  'registration_url' => 0, 'require_membership' => 0, 'session_timeout' => 0, 'show_advanced_options' => 0, 'show_post_columns' => 0, 'simultaneous_logins' => 0, 'site_ban_tag' => 0, 'site_lock_enabled' => 0, 'stripe_live' => 0, 'stripe_public_key' => '', 'stripe_secret_key' => '', 'stripe_verified' => 0, 'sync_affiliate' => 0, 'sync_ecommerce' => 0, 'sync_meta_updates' => 0, 'sync_new_wp_users' => 0, 'sync_users' => 0, 'telemetry' => 1, 'thrivecart_secret' => '', 'two_pass_shortcode_filter' => 0, 'user_registration_tag' => 0, 'username_field' => 'Email', 'wplogin_redirect_to' => 0, ); foreach ($vwpltke6 as $vwply17edn => $vwplph268z) { if ( ! isset($vwplnkj9d_['settings'][$vwply17edn]) ) { $vwplnkj9d_['settings'][$vwply17edn] = $vwplph268z; } } if (empty($vwplnkj9d_['infusionsoft']) ) { $vwplnkj9d_['infusionsoft'] = array(); }  $vwplwt87ku = array(); foreach ($vwplwt87ku as $vwply17edn) { unset($vwplnkj9d_['infusionsoft'][$vwply17edn]); } $vwpltke6 = array( 'ignore_contact_fields' => 'ContactNotes', 'ignore_tag_categories' => '', 'max_record_age' => (60 * 60 * 12), 'password_field' => 'Password', 'sync_mode' => 'push', 'username_field' => 'Username', ); foreach ($vwpltke6 as $vwply17edn => $vwplph268z) { if (empty($vwplnkj9d_['infusionsoft'][$vwply17edn]) ) { $vwplnkj9d_['infusionsoft'][$vwply17edn] = $vwplph268z; } }  $vwplwt87ku = array(); foreach ($vwplwt87ku as $vwply17edn) { unset($vwplnkj9d_['sync'][$vwply17edn]); } $vwpltke6 = array( 'required_fields' => array('Contact' => 'Id,FirstName,LastName,Email,Groups,LastUpdated'), 'ignored_sync_fields' => array('Contact' => 'ContactNotes'), ); if (empty($vwplnkj9d_['sync']) ) { $vwplnkj9d_['sync'] = array(); } foreach ($vwpltke6 as $vwply17edn => $vwplph268z) { if (empty($vwplnkj9d_['sync'][$vwply17edn]) ) { $vwplnkj9d_['sync'][$vwply17edn] = $vwplph268z; } } unset($vwply17edn, $vwplph268z); if (is_array($vwplnkj9d_['memberships']) ) { foreach ($vwplnkj9d_['memberships'] as $vwply17edn => $vwplph268z) { if (! isset($vwplnkj9d_['memberships'][$vwply17edn]['main_id']) ) { $vwplnkj9d_['memberships'][$vwply17edn]['main_id'] = $vwply17edn; } $vwpltmtyd = 'Memberium ' . $vwplph268z['name']; $vwpla7qz = sanitize_key('memberium_' . $vwplph268z['name']); $vwpl_ecm2 = get_role($vwpla7qz); if (! $vwpl_ecm2) { $vwpl_ecm2 = add_role($vwpla7qz, $vwpltmtyd); } $vwpl_ecm2->add_cap('wplqsa2u'); } }  if (is_array($vwplnkj9d_['memberships']) ) { foreach ($vwplnkj9d_['memberships'] as $vwply17edn => $vwple0aphy) { $vwple0aphy['main_id'] = isset($vwple0aphy['main_id']) ? $vwple0aphy['main_id'] : $vwply17edn; $vwple0aphy['cancel_id'] = isset($vwple0aphy['cancel_id']) ? $vwple0aphy['cancel_id'] : 0; $vwple0aphy['level'] = isset($vwple0aphy['level']) ? $vwple0aphy['level'] : 0; $vwple0aphy['login_page'] = isset($vwple0aphy['login_page']) ? $vwple0aphy['login_page'] : 0; $vwple0aphy['first_login_page'] = isset($vwple0aphy['first_login_page']) ? $vwple0aphy['first_login_page'] : 0; $vwple0aphy['logout_page'] = isset($vwple0aphy['logout_page']) ? $vwple0aphy['logout_page'] : 0; $vwple0aphy['payf_id'] = isset($vwple0aphy['payf_id']) ? $vwple0aphy['payf_id'] : 0; $vwple0aphy['roles'] = is_array($vwple0aphy['roles']) ? $vwple0aphy['roles'] : array(); $vwple0aphy['suspend_id'] = isset($vwple0aphy['suspend_id']) ? $vwple0aphy['suspend_id'] : 0; $vwple0aphy['theme'] = isset($vwple0aphy['theme']) ? $vwple0aphy['theme'] : ''; $vwple0aphy['login_redirect_priority'] = isset($vwple0aphy['login_redirect_priority']) ? $vwple0aphy['login_redirect_priority'] : $vwple0aphy['level']; $vwple0aphy['payf_homepage'] = isset($vwple0aphy['payf_homepage']) ? $vwple0aphy['payf_homepage'] : 0; $vwple0aphy['susp_homepage'] = isset($vwple0aphy['susp_homepage']) ? $vwple0aphy['susp_homepage'] : 0; $vwple0aphy['canc_homepage'] = isset($vwple0aphy['canc_homepage']) ? $vwple0aphy['canc_homepage'] : 0; $vwple0aphy['dynamic_menus'] = isset($vwple0aphy['dynamic_menus']) ? $vwple0aphy['dynamic_menus'] : 0; $vwplnkj9d_['memberships'][$vwply17edn] = $vwple0aphy; } } $vwplnkj9d_['settings']['version'] = MEMBERIUM_VERSION; add_option('memberium', $vwplnkj9d_, '', 'yes'); update_option('memberium', $vwplnkj9d_, 'yes'); wplz8bid::wpln095z($vwplnkj9d_); return $vwplnkj9d_; } static private function wplpw7bi($vwplwweoq8) { if (is_dir($vwplwweoq8) ) { $vwplgfa0 = glob($vwplwweoq8 . '*', GLOB_MARK); foreach ($vwplgfa0 as $vwplf_3k79) { self::wplpw7bi($vwplf_3k79); } rmdir($vwplwweoq8); } elseif (is_file($vwplwweoq8) ) { unlink($vwplwweoq8); } } static private function wplekxip() { global $wpdb; require_once ABSPATH . 'wp-admin/includes/upgrade.php'; $vwpluo5gzf = array(); $vwplclau = 'utf8mb4_unicode_ci'; $vwpla54ov0 = MEMBERIUM_DB_ACTIONSETS; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(11) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "name varchar(64) COLLATE {$vwplclau} NOT NULL, \n" . "KEY appname (appname), \n" . "KEY id (id), \n" . "PRIMARY KEY  (appname,id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_AFFILIATES; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(20) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "fieldname varchar(64) COLLATE {$vwplclau} NOT NULL DEFAULT '', \n" . "value longtext COLLATE {$vwplclau}, \n" . "KEY id (id), \n" . "KEY fieldname (fieldname), \n" . "KEY appname (appname), \n" . "KEY value (value(64) ), \n" . "PRIMARY KEY  (id,appname,fieldname) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_CONTACTGROUPCATEGORIES; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(11) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "name varchar(64) COLLATE {$vwplclau} NOT NULL, \n" . "KEY id (id), \n" . "PRIMARY KEY  (appname,id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_CONTACTS; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(20) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "fieldname varchar(64) COLLATE {$vwplclau} NOT NULL DEFAULT '', \n" . "value longtext COLLATE {$vwplclau}, \n" . "KEY id (id), \n" . "KEY fieldname (fieldname), \n" . "KEY appname (appname), \n" . "KEY value (value(64) ), \n" . "PRIMARY KEY  (appname,id,fieldname) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_CONTACTTAGS; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(20) NOT NULL AUTO_INCREMENT, \n" . "appname varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "contactid int(20) NOT NULL, \n" . "tagid int(20) NOT NULL, \n" . "created timestamp, \n" . "KEY id (id), \n" . "KEY appname (appname), \n" . "KEY contactid (contactid), \n" . "KEY tagid (tagid), \n" . "PRIMARY KEY  (id,appname) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_HTTPPOST; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "time timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, \n" . "appname varchar(16) COLLATE {$vwplclau} NOT NULL, \n" . "contactid int(11) NOT NULL, \n" . "ipaddress varchar(20) COLLATE {$vwplclau} NOT NULL, \n" . "type varchar(16) COLLATE {$vwplclau} NOT NULL, \n" . "log longtext COLLATE {$vwplclau} NOT NULL, \n" . "KEY appname (appname), \n" . "KEY contactid (contactid), \n" . "KEY type (type), \n" . "KEY ipaddress (ipaddress), \n" . "PRIMARY KEY  (id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_INVOICES; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(11) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwplclau}, \n" . "affiliateid int(11) NOT NULL, \n" . "contactid int(11) NOT NULL, \n" . "creditstatus int(11) NOT NULL, \n" . "datecreated datetime NOT NULL, \n" . "description varchar(255) COLLATE {$vwplclau} NOT NULL, \n" . "invoicetotal double NOT NULL, \n" . "invoicetype varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "jobid int(11) NOT NULL, \n" . "lastupdated datetime NOT NULL, \n" . "leadaffiliateid int(11) NOT NULL, \n" . "payplanstatus int(11) NOT NULL, \n" . "paystatus int(11) NOT NULL, \n" . "productsold varchar(255) COLLATE {$vwplclau} NOT NULL, \n" . "promocode varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "refundstatus int(11) NOT NULL, \n" . "totaldue double NOT NULL, \n" . "totalpaid double NOT NULL, \n" . "KEY job_id (jobid), \n" . "KEY contactid (contactid), \n" . "KEY affiliateid (affiliateid), \n" . "KEY datecreated (datecreated), \n" . "PRIMARY KEY  (id,appname) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_LANG; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "language varchar(10) COLLATE {$vwplclau} NOT NULL, \n" . "context varchar(160) COLLATE {$vwplclau} NOT NULL, \n" . "name varchar(40) COLLATE {$vwplclau} NOT NULL, \n" . "origtext text COLLATE {$vwplclau} NOT NULL, \n" . "value text COLLATE {$vwplclau} NOT NULL, \n" . "KEY language (language), \n" . "KEY context (context), \n" . "KEY name (name), \n" . "KEY origtext (origtext(255) ), \n" . "PRIMARY KEY  (id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_LOGINLOG; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "appname varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "logintime int(11) NOT NULL, \n" . "ipaddress varchar(20) COLLATE {$vwplclau} NOT NULL, \n" . "username varchar(64) COLLATE {$vwplclau} NOT NULL, \n" . "KEY logintime (logintime), \n" . "KEY username (username), \n" . "PRIMARY KEY  (id) \n" . ") ENGINE=InnoDB default CHARSET=utf8 AUTO_INCREMENT=1;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_PAGETRACKING; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "starttime timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, \n" . "endtime timestamp, \n" . "session varchar(64) COLLATE {$vwplclau} NOT NULL, \n" . "userid int(11) NOT NULL, \n" . "pageid int(11) NOT NULL, \n" . "ipaddress varchar(20) COLLATE {$vwplclau} NOT NULL, \n" . "KEY starttime (starttime), \n" . "KEY pageid (pageid), \n" . "KEY session (session), \n" . "KEY userid (userid), \n" . "KEY ipaddress (ipaddress), \n" . "PRIMARY KEY  (id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_PRODUCTS; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(20) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "fieldname varchar(64) COLLATE {$vwplclau} NOT NULL default '', \n" . "value longtext COLLATE {$vwplclau}, \n" . "KEY id (id), \n" . "PRIMARY KEY  (id,appname,fieldname) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_QUEUE; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "pidlock int(11) NOT NULL default 0, \n" . "appname varchar(16) COLLATE {$vwplclau} NOT NULL, \n" . "actiontype varchar(20) COLLATE {$vwplclau} NOT NULL, \n" . "scheduled timestamp NOT NULL, \n" . "data text NOT NULL, \n" . "KEY scheduled (scheduled), \n" . "PRIMARY KEY  (id,appname) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = MEMBERIUM_DB_SESSIONS; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "session_key varchar(32) COLLATE {$vwplclau} NOT NULL default '', \n" . "email_key varchar(32) COLLATE {$vwplclau} NOT NULL default '', \n" . "expiration int(10) unsigned NOT NULL default '0', \n" . "value text COLLATE {$vwplclau} NOT NULL, \n" . "KEY email_key (email_key), \n" . "PRIMARY KEY  (session_key) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; $vwpla54ov0 = 'memberium_tables'; $vwplx1ap5_ = "DROP TABLE IF EXISTS `{$vwpla54ov0}`;"; $wpdb->query($vwplx1ap5_); $vwpla54ov0 = MEMBERIUM_DB_TAGS; $vwplx1ap5_ = "CREATE TABLE {$vwpla54ov0} (\n" . "id int(20) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwplclau} NOT NULL, \n" . "name varchar(255) COLLATE {$vwplclau} default NULL, \n" . "category int(20) default NULL, \n" . "KEY id (id), \n" . "PRIMARY KEY  (appname,id) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwplx1ap5_); $vwpluo5gzf[] = $vwpla54ov0; update_option('memberium_tables', $vwpluo5gzf, false); } static private function wplqvrx8f() { global $wpdb; $vwplx1ap5_ = "SELECT SUBSTRING(`option_name`, 12) as `transient` FROM `{$wpdb->options}` WHERE `option_name` like '%_transient_memberium%';"; $vwply4j8x = $wpdb->get_col($vwplx1ap5_); foreach($vwply4j8x as $vwplheakg) { delete_transient($vwplheakg); } } static private function wplrizyj() { global $wpdb; $vwplx1ap5_ = 'DELETE FROM `' . $wpdb->options . '` WHERE `option_name` LIKE "%telemetry%" '; $wpdb->query($vwplx1ap5_); }  static private function wpll76y() { } static private function wplak53_() { $vwpl_ecm2 = get_role('administrator'); if ($vwpl_ecm2) { $vwpl_ecm2->add_cap('memberium_view_user_info'); $vwpl_ecm2->add_cap('memberium_edit_user_info'); $vwpl_ecm2->add_cap('memberium_view_private_comments'); } } private static function wplinqpch($length = 8) { if ( function_exists('wp_generate_password') ) { return wp_generate_password($length, false, false); } else { return substr(md5(AUTH_SALT . LOGGED_IN_SALT . SECURE_AUTH_SALT . microtime() . mt_rand(0, 999999999) ), 0, $length); } } }
