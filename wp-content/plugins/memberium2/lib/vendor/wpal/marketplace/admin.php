<?php
if ( ! defined( 'ABSPATH' ) ) { die(); } final class wplo03zfk { private $marketplace_version = '1.0.0'; protected $marketplace_feed_url = 'https://licenseserver.webpowerandlight.com/memberium-is/marketplace.php'; private $marketplace_admin_slug = 'memberium-marketplace'; private $marketplace_opt_key = 'memberium/marketplace'; private $marketplace_cached_time = 60 * 5; function __construct() {  add_action('admin_menu', array($this, 'wple4kb'), PHP_INT_MAX); add_action('admin_enqueue_scripts', array($this, 'wplkc0x')); } function wple4kb(){ $vwplf51r = 'manage_options'; if (! current_user_can($vwplf51r) ) { return; } $vwplmml58c = 'memberium'; $vwploc9adn = $vwplf51r; add_submenu_page($vwplmml58c, 'Marketplace', 'Marketplace', $vwploc9adn, $this->marketplace_admin_slug, array($this, 'wplset0wq') ); } function wplkc0x($hook) { if ( 'memberium_page_memberium-marketplace' != $hook ) { return; } wp_register_style('m4is-marketplace-css', plugin_dir_url(__FILE__).'assets/css/styles.css', array(), $this->marketplace_version, 'all' ); wp_enqueue_style('m4is-marketplace-css'); } function wplset0wq() { $vwplg_jop = $this->wplhhlsg0(); if( ! $vwplg_jop ){ echo __('No Listings Found'); } else{ $vwplwzk9 = ($vwplg_jop) ? count($vwplg_jop) : 0; $vwplwp1bjq = admin_url( "admin.php?page=" . $this->marketplace_admin_slug ); $vwplb63a = ( isset($_GET['tab']) ) ? $_GET['tab'] : false; if( ! $vwplb63a ){ $vwplxmw46 = array_column($vwplg_jop['content'],'slug'); $vwplb63a = $vwplxmw46[0]; } $vwpljeic = ( isset($vwplg_jop['style']) ) ? $vwplg_jop['style'] : false; $vwpljeic = ( $vwpljeic > '' ) ? $vwpljeic : false; $vwplr3gz9h = ( isset($vwplg_jop['header']) ) ? $vwplg_jop['header'] : false; $vwplvpt5_ = ( isset($vwplg_jop['content']) ) ? $vwplg_jop['content'] : false; $vwpllgtp = ( isset($vwplg_jop['footer']) ) ? $vwplg_jop['footer'] : false; include_once __DIR__ . '/marketplace.php'; } } function wplhhlsg0(){ $vwplz4g7n = get_option($this->marketplace_opt_key, false); $vwpln_eu = ( $vwplz4g7n ) ? false : true; if( $vwplz4g7n ){ if ( ( time() - $vwplz4g7n['timestamp'] ) > $this->marketplace_cached_time ) { $vwpln_eu = true; } } if( $vwpln_eu ){ $vwplz4g7n = $this->wplfg9c(); } return ( $vwplz4g7n ) ? $vwplz4g7n['data'] : false; } function wplfg9c() { $vwplgitq = array( 'user-agent' => 'm4is', ); $vwplu_gxri = wp_remote_get( $this->marketplace_feed_url, $vwplgitq ); if( ! is_wp_error($vwplu_gxri) ){ $vwplz4g7n = json_decode( wp_remote_retrieve_body( $vwplu_gxri ), true ); $vwplz4g7n = is_array($vwplz4g7n) ? $vwplz4g7n : false; if( $vwplz4g7n ){ $vwplsd1i = [ 'timestamp' => time(), 'data' => $vwplz4g7n ]; update_option($this->marketplace_opt_key, $vwplsd1i); return $vwplsd1i; } else { return false; } } else { return false; } } }
