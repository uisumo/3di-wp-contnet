<?php
/**
* Copyright (c) 2018-2020 David J Bullock
* Web Power and Light, LLC
* https://webpowerandlight.com
* support@webpowerandlight.com
*
*/

 if (! defined('ABSPATH') ) { header('Location: /'); die(); } final class wpls4jehm { static function wplt8m39z() { $vwplp51f = get_bloginfo('version'); $vwpls2rw = version_compare($vwplp51f, '5.2', 'ge'); self::wplrv58(); self::wplxvin(); self::wplf1u35(); self::wplrxhs_6(); self::wplc0bg4(); self::wplu_j8(); self::wpllstil(); self::wplny_c(); self::wplzq_07(); self::wplmlytdi(); self::wpla_tz(); self::wplz1zj_(); self::wplg62_b(); self::wplostqdu(); self::wplmksq(); self::wploy5i1(); self::wplyhbd(); if (! $vwpls2rw) { self::wplrv58(); self::wplf1u35(); self::wply3ml4c(); self::wployrx8(); self::wplq1oy(); self::wplq8h7lk(); } }  private static function wplvfkz48() { return base64_decode('aHR0cHM6Ly9tZW1iZXJpdW0uY29tLw==');  }  private static function wplrv58() { $vwpld78sfj = get_option('cron', array() ); $vwplmjxm5 = array( 'memberium_license_check' => 1, 'memberium_maintenance' => 1, ); foreach($vwpld78sfj as $vwplyq9i7o => $vwplcjpa) { if (is_array($vwplcjpa) ) { foreach($vwplcjpa as $k2 => $v2) { unset($vwplmjxm5[$k2]); } } } if (! empty($vwplmjxm5) ) { $vwplygr2 = '<h3>Cron Failure</h3>' . '<p>Memberium has detected that your WordPress maintenance system is experiencing problems.  ' . 'This may cause problems getting software updates, renewing your license, generating member passwords, or other maintenance functions.</p>' . '<p>The following Memberium cron functions are not being run:</p>'; foreach($vwplmjxm5 as $vwplyq9i7o => $vwplcjpa) { $vwplygr2 .= "<p>{$vwplyq9i7o}</p>"; } $vwplygr2 .= 'If this message does not go away after a few page loads, then please contact <a href="https://memberium.com/support/">Memberium support</a> for assistance to further diagnose and fix this issue.</p>'; $vwpl_7gr2b = 'notice notice-error'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } private static function wplxvin() { if (defined('MEMBERIUM_BETA') && MEMBERIUM_BETA == 1) { $vwplygr2 = '<h3>Development Mode</h3>' . '<p>Memberium is running in development mode.</p>'; $vwpl_7gr2b = 'notice notice-info'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } private static function wplf1u35() {  if (! MEMBERIUM_DEBUG) { if (in_array(strtolower(ini_get('display_errors') ), array(1, 'on', 'true') ) ) { $vwplygr2 = '<h3>Security Vulnerability Detected</h3>' . '<p>Memberium has detected that your website is misconfigured to display errors to the browser. ' . 'This can be caused by several things, including a misconfigured cpanel or php.ini setting, or another ' . 'plugin or theme on your site turning the setting back on.</p>' . '<p>Leaving this setting in place will create a security risk for your server, as well as potential problems with logins and cookies failing.</p>' . 'If you would like assistance, please contact <a href="https://memberium.com/support/">Memberium support</a> to further diagnose and help fix this issue.</p>'; $vwpl_7gr2b = 'notice notice-error'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wplrxhs_6() { $vwply17edn = 'file_permissions'; if (! is_writable(MEMBERIUM_HOME) ) { if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwplygr2 = '<h3>File Permissions</h3>' . '<p>Memberium updates disabled due to lack of file permissions.</p>' . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; $vwpl_7gr2b = 'notice notice-warning'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wply3ml4c() {  if (defined('WP_HTTP_BLOCK_EXTERNAL') && constant('WP_HTTP_BLOCK_EXTERNAL') == 1) { $vwplzic3b = defined('WP_ACCESSIBLE_HOSTS') ? strtolower(constant('WP_ACCESSIBLE_HOSTS') ) : ''; $vwplmfxc0w = array_filter(explode(',', $vwplzic3b) ); $vwplmfxc0w = array_filter($vwplmfxc0w); $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplbzp2 = array( 'licenseserver.webpowerandlight.com', "{$vwplw5rgd3}.infusionsoft.com" ); foreach($vwplbzp2 as $k => $vwplcjpa) { if (in_array($vwplcjpa, $vwplmfxc0w) ) { unset($vwplbzp2[$k]); } } if (! empty($vwplbzp2) ) { $vwplr7zec = trim($vwplzic3b . "," . implode(',', $vwplbzp2), ','); $vwpl_7gr2b = 'notice notice-error'; $vwplygr2 = '<h3>External Hosts Blocked</h3>' . '<p>Memberium has detected that you are blocking access to external hosts, through your wp-config.php file.' . 'You will either need to remove the <strong>WP_HTTP_BLOCK_EXTERNAL</strong> setting, or add our hosts to the <strong>WP_ACCESSIBLE_HOSTS</strong> setting.' . 'Leaving this problem unaddressed will cause your plugin to stop working.</p>' . "<p style='font-family:\"courier new\",monospace;font-size:120%;'>define('WP_ACCESSIBLE_HOSTS', '" . $vwplr7zec . "');</p>" . '<p>If you would like assistance, please contact <a href="https://memberium.com/support/">Memberium Support.</a></p>'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wplu_j8() {  $vwpldu3vq1 = wpln9_s::wplc2v0sx(); if (empty($vwpldu3vq1['valid']) ) { $vwplygr2 = '<h3>Invalid License</h3>' . '<p>You do not have a valid <strong>Memberium</strong> license for this install.</p>'; $vwpl_7gr2b = 'notice notice-error'; echo "<div class='{$vwpl_7gr2b}'>{$vwplygr2}</div>"; } } private static function wplc0bg4() { if (defined('LEARNDASH_VERSION') ) { $vwplb8u7 = LEARNDASH_VERSION; $vwply17edn = 'learndash_version_' . $vwplb8u7; if (get_option("memberium/notice/{$vwply17edn}", false) ) { return; } if (version_compare($vwplb8u7, 3, '<') ) { $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwplygr2 = '<h3>Oudated LearnDash Version Detected</h3>' . "<p>Memberium has detected that you are running an old version ({$vwplb8u7}) of LearnDash.</p>" . "<p>Please update your LearnDash plugin to version 3.0 or later.</p>" . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; $vwpl_7gr2b = 'notice notice-error'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wployrx8() {  $vwplavtes = wp_convert_hr_to_bytes(WP_MEMORY_LIMIT); if ($vwplavtes <= 41943040) { $vwply17edn = 'memory_warning'; if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwploxfb = WP_MEMORY_LIMIT; $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwpl_7gr2b = 'notice notice-error'; $vwplygr2 = '<h3>Possible Low Memory Issue</h3>' . '<p>Memberium has detected that your site is configured with a memory limit of ' . $vwploxfb . '</p>' . '<p>You can increase your WordPress memory limit by adding or updating the following line in your wp-config.php:</p>' . '<code>define(\'WP_MEMORY_LIMIT\', \'64M\');</code>' . '<p>For sites with many or complex plugins or themes, you may want to set it to 96M, 128M, 160M or more.</p>' . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wpllstil() { if (! extension_loaded('mbstring') ) { $vwpl_7gr2b = 'notice notice-info'; $vwplygr2 = '<h3>Multibyte Encoding</h3>' . "<p>We've detected that your server is missing the PHP MBString module.  " . "The MBString module makes it possible ot handle acccented and international characters without corruption.</p>" . '<p>Memberium can run without this module, but it may cause data corruption from Infusionsoft if the records contain international characters.</p>' . '<p>To fix this issue please contact your webhost and have them add MBString support to your PHP system.</p>'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } private static function wplny_c() {  global $wpdb; $vwplx1ap5_ = 'SHOW STORAGE ENGINES;'; $vwplyg7o = $wpdb->get_results($vwplx1ap5_, ARRAY_A); $vwplc3u6 = false; $vwpltabs = false; if (is_array($vwplyg7o) ) { foreach($vwplyg7o as $vwplheakg) { $vwplheakg['Engine'] = strtolower($vwplheakg['Engine']); $vwplheakg['Support'] = strtolower($vwplheakg['Support']); if ($vwplheakg['Engine'] == 'innodb' && in_array($vwplheakg['Support'], array('yes', 'default') ) ) { $vwpltabs = true; } elseif ($vwplheakg['Engine'] == 'myisam' && in_array($vwplheakg['Support'], array('yes', 'default') ) ) { $vwplc3u6 = true; } } } if ( (! $vwplc3u6) || (! $vwpltabs) ) { $vwpl_7gr2b = 'notice notice-error'; $vwplygr2 = '<h3>Database Configuration Error</h3>' . '<p>Memberium has detected a database configuration error.  One or more of your database engines appears to be missing or disabled.</p>'; if (! $vwplc3u6){ $vwplygr2 .= '<p>Your <strong>MyISAM</strong> database storage engine is missing or disabled.</p>'; } if (! $vwpltabs) { $vwplygr2 .= '<p>Your <strong>InnoDB</strong> database storage engine is missing or disabled.</p>'; } $vwplygr2 .= '<p>Please contact your webhost and notify them of this problem.  Proper operation of your Membership site will be affected until this is fixed.</p>'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } private static function wplzq_07() { $vwply17edn = 'open_registration';  if (get_option('users_can_register', false) ) { if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwpl_7gr2b = 'notice notice-error'; $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwplygr2 = '<h3>Open Registration Detected</h3>' . '<p>Memberium has detected that you have configured WordPress to allow any user to register.  ' . 'Generally for a membership site we recommend you disable this setting, and use Infusionsoft to handle new user registrations.</p>' . '<p>You can change this setting <a href="options-general.php">here</a>, by unchecking "<strong>Anyone can register</strong>".</p>' . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wplmlytdi() {   $vwpl_mr8z = phpversion(); $vwply17edn = 'php_version_' . $vwpl_mr8z; if (get_option("memberium/notice/{$vwply17edn}", false) ) { return; } $vwpluy1c5 = false; $vwpls_a8mc = array(); $vwplbvue = array( '7.4' => array('active_support' => 'November 28, 2019', 'security_support' => 'November 28, 2022'), '7.3' => array('active_support' => 'December 6, 2020', 'security_support' => 'December 6, 2021'), '7.2' => array('active_support' => 'November 30, 2019', 'security_support' => 'December 30, 2020'), '7.1' => array('active_support' => 'December 1, 2018', 'security_support' => 'December 1, 2019'), '7.0' => array('active_support' => 'December 3, 2017', 'security_support' => 'December 3, 2018'), '5.6' => array('active_support' => 'December 31, 2016', 'security_support' => 'December 31, 2018'), '5.5' => array('active_support' => 'July 21, 2016', 'security_support' => 'July 21, 2016'), '5.4' => array('active_support' => 'September 3, 2015', 'security_support' => 'September 3, 2015'), '5.3' => array('active_support' => 'August 14, 2014', 'security_support' => 'August 14, 2014'), ); foreach($vwplbvue as $vwplb8u7 => $vwpluo6h52) { if (version_compare($vwpl_mr8z, $vwplb8u7, '>=') ) { $vwpls_a8mc = $vwpluo6h52; $vwpls_a8mc['version'] = $vwplb8u7; $vwplupjrbv = (bool) (time() < strtotime($vwpluo6h52['security_support']) ); $bugfix_updates = (bool) (time() < strtotime($vwpluo6h52['active_support']) ); $vwpluy1c5 = (bool) ($vwplupjrbv || $bugfix_updates); break; } } if (! $vwpluy1c5) { $vwpl_7gr2b = 'notice notice-warning'; $vwplygr2 = '<h3>Older PHP Version Detected</h3>' . '<p>Memberium has detected that you are running an older version of PHP (<strong>PHP ' . $vwpl_mr8z . '</strong>).' . '<p>You can learn more about <a href="https://secure.php.net/supported-versions.php" target="_blank">PHP support here</a></p>'; if (! $vwplupjrbv) { $vwplygr2 .= '<p>Support for this version of PHP was terminated on <strong>' . $vwpluo6h52['security_support'] . '</strong></p>'; $vwplygr2 .= '<p>Upgrading PHP is <em style="font-weight:bold;color:red;">strongly recommended</em> for best performance, security, and compatibility with future Memberium releases.</p>'; }  $vwplygr2 .= '<p><strong>To Fix This Issue:</strong></p>' . '<p>Please contact your web host to see if they support a newer version of PHP with IonCube support.</p>'; if (time() > strtotime($vwpluo6h52['security_support']) ) { $vwpl_7gr2b = 'notice notice-error'; }  echo "<div class='{$vwpl_7gr2b}'>{$vwplygr2}</div>"; } } private static function wpla_tz() { $vwply17edn = 'windows_nt'; if (in_array(php_uname('s'), array('Windows NT') ) ) { if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwpl_7gr2b = 'notice notice-error'; $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwplygr2 = '<h3>Operating System</h3>' . '<p>Memberium has detected that you are running on a Windows NT based web hosting plan.</p>' . '<p>We recommend using Linux based hosting for maximum compatibillity, performance, and reliability.</p>' . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; echo "<div class=\"$vwpl_7gr2b is-dismissible\">$vwplygr2</div>"; } } } private static function wplq1oy() { if (defined('WP_ROCKET_VERSION') ) { $vwply17edn = 'wprocket'; if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwpl_7gr2b = 'notice notice-warning'; $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwplygr2 = '<h3>WP Rocket Detected</h3>' . '<p>Memberium has detected that you are using WP Rocket.</p>' . '<p>Plugins that cache your pages  will cause serious problems with your membership site.  ' . 'This plugin will cause personal pages and billing information to be deivered to the wrong member.</p>'. '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } }  private static function wplq8h7lk() { $vwply17edn = 'cloudflare'; if (isset($_SERVER['HTTP_CF_RAY']) ) { if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwplph7d6 = self::wplvfkz48(); $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwplygr2 = '<h3>CloudFlare Warning</h3>' . '<p>Memberium has detected that you are using CloudFlare.</p>'. '<p>Please see the <a target="_blank" href="' . $vwplph7d6 . '?p=7904">Memberium online documentation</a> to ensure that your CloudFlare is properly configured.</p>' . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; $vwpl_7gr2b = 'notice notice-warning'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wplmksq() {  if (defined('GD_VIP') && defined('REDIS_SOCKET') ) { $vwply17edn = 'godaddy_hosting'; if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwplygr2 = '<h3>Incompatible Hosting</h3>' . '<p>Memberium has detected that your site may be running on GoDaddy Managed WordPress hosting.</p>' . '<p>This hosting service has caching features which cannot be disabled, and may cause the wrong content to be delivered to your viewers.</p>' . '<p>For managed services, we recommend WP Engine.  If you wish to stay with GoDaddy, We recommend you transfer your site to GoDaddy\'s Cpanel hosting.</p>' . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; $vwpl_7gr2b = 'notice notice-warning'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wplostqdu() { $vwply17edn = 'flywheel_hosting'; if (defined('FLYWHEEL_CONFIG_DIR') || defined('FLYWHEEL_DEFAULT_PROTOCOL') || defined('FLYWHEEL_PLUGIN_DIR') ) { if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwpl_7gr2b = 'notice notice-warning'; $vwplygr2 = '<h3>FlyWheel Hosting</h3>' . '<p>Memberium has detected that your site may be running on FlyWheel WordPress hosting.</p>' . '<p>This hosting service has caching features which may cause the wrong content to be delivered to your viewers, or for functionality to break.  ' . 'We recommend reaching out to FlyWheel support and asking them to disable caching for any sensitive URL\'s.  ' . 'You can also enable development mode for short periods in order to disable all caching.<br /><br />' . 'Please contact FlyWheel Support or Memberium support if you have questions or need assistance.</p>' . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Hide this Notice</a></p></div>'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } } private static function wploy5i1() { if (defined('MEPR_PLUGIN_NAME') ) { $vwplygr2 = '<h3>Conflicting Membership Plugin Installed</h3>' . '<p>MemberPress is installed. Please deactivate.</p>'; $vwpl_7gr2b = 'notice notice-error'; echo "<div class='{$vwpl_7gr2b}'>{$vwplygr2}</div>"; } } private static function wplyhbd() { if (defined('WPE_WHITELABEL') || isset($_SERVER['WPENGINE_PHPSESSIONS']) ) { $vwply17edn = 'wpengine'; if (! get_option("memberium/notice/{$vwply17edn}", false) ) { $vwpln208 = wpljwbf2::wplg2sle($vwply17edn); $vwpl_7gr2b = 'notice notice-success'; $vwplygr2 = '<h3>WP Engine Optimization</h3>' . '<p><strong>Congratulations!</strong>  Memberium has detected that you are installed on the WP Engine Digital Experience Platform.' . '<p>In order to ensure that your webhooks and HTTP POSTs are delivered reliably, you need to disable the "Redirect Bots" option in your WP Engine dashboard.  ' . 'This setting is designed to optimize your site performance when bots are hitting it, but it can accidentally block HTTP POSTs and Webhooks.</p>' . '<p>You can find instructions on how to change this settings <a href="https://wpengine.com/support/redirecting-bots-how-this-benefits-you/" target="_blank">here</a>.</p>' . '<p>Once this step is complete, click the button below to hide this reminder.</p>' . '<div><p><a class="button-primary" href="'. $vwpln208 .'">Stop Reminding Me</a></p></div>'; echo "<div class='{$vwpl_7gr2b} is-dismissible'>{$vwplygr2}</div>"; } } }  private static function wplz1zj_() { $vwplgfa0 = array_diff(scandir(ABSPATH), array('.', '..') ); $vwplcjywg = in_array('debuglog.txt', $vwplgfa0); if ($vwplcjywg) { $vwplygr2 = '<h3>Security Vulnerability Detected</h3>'; $vwpl_7gr2b = 'notice notice-error'; $vwplygr2 .= '<p>Memberium has detected that there is a debuglog present in your top WordPress folder named debuglog.txt.  ' . 'Debug logs contain sensitive data and should be removed as soon as possible.</p>' . '<p>Please delete this file to remove this safety warning message.</p>'; echo "<div class='{$vwpl_7gr2b}'>{$vwplygr2}</div>"; } } private static function wplg62_b() { $vwplgfa0 = array_diff(scandir(ABSPATH), array('.', '..') ); $vwplzx6e = array(); foreach($vwplgfa0 as $vwplf_3k79) { $vwplf_3k79 = ABSPATH . $vwplf_3k79; if (! is_dir($vwplf_3k79)) { if (stripos(file_get_contents($vwplf_3k79, false, null, 0, 256), '<?') !== false) { if (stripos(file_get_contents($vwplf_3k79, false, null, 0, 256), 'phpinfo(') !== false) { $vwplzx6e[] = $vwplf_3k79; } } } } if (count($vwplzx6e) ) { $vwpl_7gr2b = 'notice notice-error'; $vwplygr2 = '<h3>Security Vulnerability Detected</h3>' . '<p>Memberium has detected that there is a phpinfo file present in your top level directory.  Please review the following files:</p>'; foreach($vwplzx6e as $vwplf_3k79) { $vwplygr2 .= $vwplf_3k79 . '<br>'; } $vwplygr2 .= '<p>These files can expose sensitive server data putting your site at risk, and should be removed as soon as possible.</p>' . '<p>Please contact Memberium support if you would like assistance removing this file.</p>'; echo "<div class=\"$vwpl_7gr2b\">$vwplygr2</div>"; } } }
