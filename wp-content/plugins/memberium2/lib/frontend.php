<?php
/**
 * Copyright (c) 2012-2019 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (! defined('ABSPATH') ) { die(); }  final class wpls3of8 {    function wplyhl4i() { $vwpls0hwb5 = $GLOBALS['allowedposttags']; $vwpls0hwb5['a']['href'] = 1; $vwpls0hwb5['iframe']['src'] = 1; $vwpls0hwb5['iframe']['srcdoc'] = 1; $vwpls0hwb5['input']['name'] = 1; $vwpls0hwb5['input']['placeholder'] = 1; $vwpls0hwb5['input']['value'] = 1; $vwpls0hwb5['option']['value'] = 1; $vwpls0hwb5['progress']['max'] = 1; $vwpls0hwb5['progress']['value'] = 1; $vwpls0hwb5['source']['src'] = 1; $vwpls0hwb5['textarea']['placeholder'] = 1; $vwpls0hwb5['textarea']['value'] = 1; $GLOBALS['allowedposttags'] = $vwpls0hwb5; } function wplmbme4($vwply17edn, $vwplph268z = false) { if ($vwplph268z) { $this->footer_json[$vwply17edn] = $vwplph268z; } else { unset($this->footer_json[$vwply17edn]); } } function wplf6yid($vwply17edn = false) { if ($vwply17edn) { return (isset($this->footer_json[$vwply17edn]) ) ? $this->footer_json[$vwply17edn] : NULL; } else { return $this->footer_json; } } function wplhyibo() {  add_filter('op_check_page_availability', array($this, 'wplzdtph4') );  if (class_exists('Yoast_GA_Options') ) { add_filter('yoast-ga-custom-vars', array($this, 'wploz6jp4'), 10, 2); }  if (class_exists('WooCommerce') ) { add_action('woocommerce_customer_save_address', array($this, 'wpl_egq'), 10, 2); add_action('woocommerce_register_form_start', array($this, 'wplmb2sju') ); add_action('woocommerce_register_post', array($this, 'wplgsryeb'), 10, 3); add_action('woocommerce_created_customer', array($this, 'wpl_ref7t'), 999999, 3); }   add_filter('ninja_forms_field', array($this, 'wploprv2'), 10, 2); if (defined('WPCW_PLUGIN_ID') ) { add_action('wpcw_user_completed_unit', array($this, 'wplb5az'), 10, 3); add_action('wpcw_user_completed_module', array($this, 'wplgshx0'), 10, 3); add_action('wpcw_user_completed_course', array($this, 'wplf04t8'), 10, 3); } } function wplobs0co() { return; if (! isset($_SERVER['PHP_AUTH_USER']) ) { header('WWW-Authenticate: Basic realm="RSS Feeds"'); header('HTTP/1.0 401 Unauthorized'); echo 'Feeds from this site are private'; exit; } else { if (is_wp_error(wp_authenticate($_SERVER['PHP_AUTH_USER'], $_SERVER['PHP_AUTH_PW']) ) ) { header('WWW-Authenticate: Basic realm="RSS Feeds"'); header('HTTP/1.0 401 Unauthorized'); echo 'Username and password were not correct'; exit; } } }  function wpla1zc($vwplyd39) { $vwplyd39[] = 'memb_php'; $vwplyd39[] = 'memb_raw'; return $vwplyd39; }  function wplr0rwu($vwplmx5ew) { $vwplmx5ew[] = 'memb_'; $vwplmx5ew[] = 'membc_'; return $vwplmx5ew; } function wplal6qwa($vwplob9i24, $vwplv80sz) { global $wpdb; $vwplx1ap5_ = explode('LIMIT', $vwplv80sz->request, -1); if (empty($vwplx1ap5_) ) { $vwplx1ap5_ = $vwplv80sz->request; } else { $vwplx1ap5_ = $vwplx1ap5_[0]; } $vwplp4pw = $wpdb->get_col($vwplx1ap5_); if (is_array($vwplp4pw) && (count($vwplp4pw) < ($vwplv80sz->posts_per_page * 10) ) ) { foreach($vwplp4pw as $vwplyq9i7o => $vwplcjpa) { if (! $this->wpls9nje($vwplcjpa) ) { unset($vwplp4pw[$vwplyq9i7o]); } } } $vwplv80sz->found_posts = count($vwplp4pw); return $vwplob9i24; } function wplzzfb8($vwpllte68, $vwplv80sz) { if ($this->found_posts !== null) { $vwplv80sz->found_posts = $this->found_posts; $this->found_posts = null; return $vwplv80sz->found_posts; } return $vwpllte68; } function wplcaq67y($vwplupjq0, $vwplv80sz) { if (false) { echo '<p>', $vwplupjq0, '</p>'; } return $vwplupjq0; } function wpltq6_o4($vwplztb4, $vwplv80sz) { foreach($vwplztb4 as $vwply17edn => $vwplzzlf5b) { if (! $this->wpls9nje($vwplzzlf5b->post_id) ) { unset($vwplztb4[$vwply17edn]); } }   return $vwplztb4; }  function wplvak2() { $vwplso1pw = trim($_GET['memb_setcookie']); $vwplxp50 = isset($_GET['expiration']) ? strtotime($_GET['expiration']) : time() + YEAR_IN_SECONDS; $vwplph268z = isset($_GET['value']) ? $_GET['value'] : ''; $vwplsfdb_t = isset($_GET['mode']) ? strtolower($_GET['mode']) : 'replace'; $vwpltancmh = isset($_GET['redir']) ? strtolower($_GET['redir']) : '/'; $vwplg38x51 = isset($_GET['path']) ? strtolower($_GET['path']) : '/'; $vwplmy6d = isset($_GET['domain']) ? strtolower($_GET['domain']) : $_SERVER['HTTP_HOST'];  if ($vwplsfdb_t == 'append') { $vwplph268z = implode(',', array_unique(explode(',', $_COOKIE[$vwplso1pw] . ',' . trim($vwplph268z) ) ) ); } $vwplyio4f = setcookie($vwplso1pw, $vwplph268z, $vwplxp50, $vwplg38x51, $vwplmy6d); wp_redirect($vwpltancmh); exit; } function wplevrzp($vwplwpg_6, $vwplyhcr_j, $vwplgogvie) { if (! empty($this->login_redirect_url) ) { return $this->login_redirect_url; }  if (! empty($vwplyhcr_j) ) { return $vwplyhcr_j; } return $vwplwpg_6; } function wplqaem($vwplwpg_6, $vwplgogvie) { if (! empty($_GET['redirect_to']) ) { return $_GET['redirect_to']; } if (is_super_admin() ) { return get_dashboard_url(); } if (! empty($this->login_redirect_url) ) { return $this->login_redirect_url; } return $vwplwpg_6; } function wplbunm() { if ($_SERVER['REQUEST_METHOD'] !== 'POST') { return; } if (isset($_GET['i4w_genpass']) && $_GET['i4w_genpass'] == substr($this->i2sdk_options, 0, 6) ) { $_GET['operation'] = 'makepass'; $_GET['adduser'] = isset($_GET['autoreg']) && $_GET['autoreg'] == 'n' ? 'no' : ''; $_GET['tagids'] = isset($_GET['tagid']) ? $_GET['tagid'] : ''; $_GET['goal'] = isset($_GET['goal']) ? $_GET['goal'] : ''; $_GET['default_pass'] = isset($_GET['password']) ? $_GET['password'] : ''; $this->i2sdk->normalizePOSTFields(); } if (isset($_GET['i4w_sync_user']) && $_GET['i4w_sync_user'] == substr($this->i2sdk_options, 0, 6) ) { $_GET['operation'] = 'update-contact'; $this->i2sdk->normalizePOSTFields(); } if (! isset($_GET['operation']) ) { return; } $vwple_u5 = array( 'add-contact' => 'wplccaeqx', 'add-event' => 'wpllacq', 'add-issue' => 'wplxse7d', 'add-tags' => 'wplqt4om', 'add-user' => 'post_add_user', 'contact-update' => 'wple6xzqe', 'copy-fields' => 'wplcg2kob', 'copy-fields' => 'wplcg2kob', 'copy-next-billing' => 'wplvigd', 'delete-contact' => 'wplrgr47', 'expire-subs' => 'wplkx7fnl', 'gdpr-erase' => 'httppost_gdpr_erase', 'gdpr-export' => 'httppost_gdpr_export', 'get-post' => 'wplsa_l', 'makepass' => 'wpllgi3', 'math' => 'wplmpwxad', 'optin' => 'wplkgqn', 'optout' => 'wplj9wb7t', 'prettify-contact' => 'wplozkywh', 'scan-subscriptions' => 'wplxmgfi0', 'set-date' => 'wplt1f9', 'update-contact' => 'wple6xzqe', 'foo' => 'wpll682', ); $vwplunkr = strtolower($_GET['operation']); if (array_key_exists($vwplunkr, $vwple_u5) ) { add_action('i2sdk_http_post', array($this, $vwple_u5[$vwplunkr]) ); memberium_app()->wplbluoxq(true); } } function wplf5yc6() {  if (empty($_SESSION['memb_user']) && is_user_logged_in() ) { $_SESSION = memberium_app()->wplyte2(); } if (class_exists('WooCommerce') ) { $this->wplcytk(); } if ($this->options['settings']['cache_flush']) { flush_rewrite_rules(); } $this->is_administrator = current_user_can('manage_options'); add_action('template_redirect', array($this, 'wplrbon') ); add_action('wp_login_failed', array($this, 'wpld1u_') );   $vwplshogq = array_filter(explode(',', $this->options['settings']['allow_wpadmin_titlebar']) ); $vwplu6eg = true; if (! empty($vwplshogq) ) { $vwpllzly5b = get_current_user_id(); foreach($vwplshogq as $vwpl__qx) { if (user_can($vwpllzly5b, $vwpl__qx) ) { $vwplu6eg = false; } } } $vwplu6eg = apply_filters('memberium/hide_titlebar', $vwplu6eg); if ($vwplu6eg) { add_filter('show_admin_bar', '__return_false', 999999); } $this->wplbunm(); } function wplv2hd68($vwplu6eg) { if ($vwplu6eg) {  $vwplidfhi7 = array( 'wordpress_user_sw_olduser_', 'wordpress_user_sw_secure_', 'impersonated_by_', ); foreach($vwplidfhi7 as $vwplyct0) { if (! empty($_COOKIE[$vwplyct0 . COOKIEHASH]) ) { return false; } } } return $vwplu6eg; } function wpltckpl5() { if ($this->url_id == 0) { $this->url_id = (int) url_to_postid($_SERVER['REQUEST_URI']); } return (int) $this->url_id; } function wplmhf761() { $this->wpltckpl5(); do_action('memb_init'); } function wpld0l4e() { $this->url_id = (int) url_to_postid($_SERVER['REQUEST_URI']); if ($this->url_id == 0) { $vwplhy0p2 = get_option('page_on_front'); $vwplz1vt = parse_url(site_url(), PHP_URL_PATH) . '/'; $vwplineb = substr($_SERVER['REQUEST_URI'], 0, strlen($vwplz1vt) + 1); if ($_SERVER['REQUEST_URI'] == $vwplz1vt || $vwplineb == $vwplz1vt . '#' || $vwplineb == ($vwplz1vt . '?') ) { $this->url_id = $vwplhy0p2; } } return $this->url_id; } function wpllerm() { if (empty($this->options['settings']['site_lock_enabled']) ) { return; } if (! empty($_SESSION['memb_user']) ) { return; } if (is_user_logged_in() ) { return; } $vwplzw_4 = (int) $this->options['settings']['login_url']; if ($this->url_id) { if ($this->url_id == $vwplzw_4) { return; }  $vwplw1cav = get_post_meta ($this->url_id, '_is4wp_force_public', true); if (! empty($vwplw1cav) ) { return; } } if ($vwplzw_4) { $vwplimo5 = get_permalink($vwplzw_4); $vwplimo5 = add_query_arg('redirect_to', $_SERVER['REQUEST_URI'], $vwplimo5); } else { $vwplimo5 = wp_login_url($_SERVER['REQUEST_URI']); } wplpwn3::wplbryv(); wp_redirect($vwplimo5); exit; } function wplrbon() {  if (memberium_app()->wply9rhd4() ) { wplpwn3::wplcgt1lo(); return; } if (isset($_GET['action']) && $_GET['action'] == 'confirmregistration') { wplpwn3::wplcgt1lo(); wpls_mw::wpls2cn0w();  } $_GET['viewable'] = isset($_GET['viewable']) ? $_GET['viewable'] : '';  if (! empty($_GET['filebox_id']) && $_GET['filebox_id'] > 0) { wplpwn3::wplcgt1lo(); wpllbej::wplitel9( (int) $_GET['filebox_id'], $_GET['filename'], (bool) $_GET['viewable']); exit; } if (! empty($this->options['settings']['cache_bust']) ) { wplpwn3::wplcgt1lo(); }  if (! empty($GLOBALS['bp']) ) { if (! empty($GLOBALS['bp']->groups->current_group->id) ) { return; } } $this->wpld0l4e(); if (is_404() && substr($_SERVER['REQUEST_URI'], 0, 7) == '/prtctd') { $redirect = str_ireplace($this->options['settings']['default_page_redirect'], '{{current.url}}', get_site_url() ); wplpwn3::wplbryv(); wp_redirect($redirect); exit; } if ($this->url_id > 0 && ! $this->wpls9nje($this->url_id) ) { $vwplww_i2o = $this->wplyne0cg($this->url_id, FALSE); if ($vwplww_i2o == 'redirect') { wplpwn3::wplcgt1lo(); $this->wpli7nqcf($this->url_id); } } $this->post_type = get_post_type($this->url_id); if (get_post_meta($this->url_id, '_is4wp_discourage_cache', true) ) { wplpwn3::wplcgt1lo(); } }    function wplkptly9() { if ($this->options['settings']['two_pass_shortcode_filter']) { if (defined('OP_VERSION') ) { $this->optimizepress_page = (get_post_meta($this->url_id, '_optimizepress_pagebuilder', true) == 'Y'); } if ($this->optimizepress_page) { add_filter('comment_text', array($this, 'wplr_qoi0'), 1, 1); $this->wplovnmyj(); } else { add_filter('the_content', array($this, 'wplewvgr'), 1, 1); } } add_filter('no_texturize_shortcodes', array($this, 'wpla1zc') ); } function wplr_qoi0($vwplckl3) { $vwplckl3 = preg_replace('/\[(\w.*)\]/', '[[$1]]', $vwplckl3); return $vwplckl3; } function wplzdtph4($vwplf_3k79) { $this->wpllhjalp(); $GLOBALS['op_content_layout'] = do_shortcode($GLOBALS['op_content_layout']); return $vwplf_3k79; }    function wpld1u_($vwplc_uoh4) {  global $user; if (is_a($user, 'WP_Error') ) { $vwplcq9y = empty($user->errors['authentication_failed'][0]) ? '' : $user->errors['authentication_failed'][0]; setcookie ('login_error', $vwplcq9y, (time() + 60) ); }   if (isset($_POST['woocommerce-login-nonce']) ) { return; } $vwplw43j = isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : '';  if (empty($refererer) ) { $vwplzw_4 = isset($this->options['settings']['login_url']) ? $this->options['settings']['login_url'] : 0; $vwplw43j = get_permalink($vwplzw_4); }  if (! empty($vwplw43j) && ! strstr($vwplw43j, 'wp-login') && ! strstr($vwplw43j, 'wp-admin') ) { $vwplw43j = add_query_arg('login', 'failed', $vwplw43j); wplpwn3::wplbryv(); wp_redirect($vwplw43j);  exit; } }    function wplxpex() { $this->login_redirect_enabled = false; } function wplvzi01n() { $this->login_redirect_enabled = true; } function wpljmvd7($sso_mode = true) { memberium_app()->wpljmvd7($sso_mode); } function wpllpld() { return (bool) memberium_app()->wpllpld(); } function wplcixv($caching) { $this->can_cache = (boolean) $caching; } function wplgi7dw() { return $this->can_cache; }    function wply4hd() { return wpln9_s::wplio5sck(); }     function wpl_ref7t($vwplas89b5, $vwpllcu6, $vwplvpm15) { if (empty($this->options['settings']['sync_new_wp_users']) ) { return; } if (empty($vwpllcu6['user_pass']) ) { return; } $vwplmu62n = wplj_l2t::wplm_vec(); $vwplrp9u24 = array(); $vwplct26 = get_user_meta($vwplas89b5); foreach($vwplmu62n as $meta_name => $crm_name) { if (isset($vwplct26[$meta_name][0]) ) { $vwplrp9u24[$crm_name] = trim($vwplct26[$meta_name][0]); } } $vwplup7mi = $this->options['settings']['password_field']; if ($vwplvpm15) { $vwplrp9u24[$vwplup7mi] = $vwpllcu6['user_pass']; } else { $vwplrp9u24[$vwplup7mi] = 'PASSWORD_PLACEHOLDER'; } $vwplrp9u24['Email'] = $vwpllcu6['user_email']; $vwplvtmqd = (int) $this->isdk->addWithDupCheck($vwplrp9u24, 'Email'); }  function wplzfn8() { }  function wpldplb() { ?>
		<script type="text/javascript" src="<?php echo site_url('/wp-includes/js/jquery/jquery.js'); ?>"></script>
		<script>
		jQuery('#user_login').parent().remove();
		jQuery('#user_email').attr('type', 'email');
		jQuery('#user_email').blur(function() {
			jQuery("#user_login2").val(jQuery("#user_email").val() );
		});
		</script>
		<input type="hidden" id="user_login2" name="user_login" value="">
		<p>
		<label>
		First Name<br/>
		<input id="firstname" type="text" tabindex="30" size="25" value="" name="firstname" />
		</label>
		</p>
		<p>
		<label>
		Last Name<br/>
		<input id="lastname" type="text" tabindex="30" size="25" value="" name="lastname" />
		</label>
		</p>
		<?php
 }  function wpl_3k7zy($vwplxo3wtv) { if ($vwplxo3wtv == 'Lost your password?') { $vwplxo3wtv = ''; } return $vwplxo3wtv; }  function wplrqi5() { return FALSE; }     function wplhert_j($vwplqvwk) { if (empty($_SESSION['memb_user']['theme']) ) { return $vwplqvwk; } $vwplvk9zsx = $_SESSION['memb_user']['theme']; $vwpljrgp = wp_get_themes(); $vwplgjao = current_filter(); if (! isset($vwpljrgp[$vwplvk9zsx]) ) { return $vwplqvwk; } if ($vwplgjao == 'option_template' || $vwplgjao == 'template') { return $vwpljrgp[$vwplvk9zsx]->Template; } else { return $vwplvk9zsx; } }    function wploiyv($vwplbcu8 = true) { if (! empty($_GET['action']) && $_GET['action'] == 'logout') { $vwplbcu8 = true; }  $vwplvtmqd = wplsbzgvp::wplfhxj9(); if (! empty($vwplvtmqd) ) { $vwplmgprn = (int) wplz8bid::wplvf1d('settings', 'logout_actionset', 0); $vwplj35u = (int) wplz8bid::wplvf1d('settings', 'logout_tag', 0); memberium_app()->wplmupt($vwplmgprn, $vwplvtmqd); memberium_app()->wplt263_($vwplj35u, $vwplvtmqd); } if (empty($_GET['redirect_to']) ) { $url = memberium_app()->wplenfoxj(); } else { $url = $_GET['redirect_to']; } setcookie('nextend_uniqid', NULL, -1, '/'); memberium_app()->wplwxbl(0); if (session_id() > '') { unset($_SESSION['memb_user'], $_SESSION['memb_db_fields']); if (empty($_SESSION) ) { session_destroy();  } } if ($vwplbcu8) { wplpwn3::wplbryv(); wp_redirect($url); exit; } }  function wplh3645($vwplcqlhk = false) { global $wpdb; if (memberium_app()->wplubo6() > 0 && ! defined('DOING_AJAX') && ! is_admin() && ! is_super_admin() ) { $vwplh6zjmd = (int) wplz8bid::wplvf1d('settings', 'simultaneous_logins', 0); if (! empty($vwplh6zjmd) ) { memberium_app()->wplgei5(get_current_user_id() ); } } memberium_app()->wplnpey(); if (! $vwplcqlhk) { $vwplcqlhk = wp_get_current_user(); }    if (isset($_SESSION['memb_user']['Id']) ) { if ($vwplcqlhk->ID == 0 || $vwplcqlhk->ID != $_SESSION['memb_user']['Id']) { unset($_SESSION['memb_db_fields'], $_SESSION['memb_user']); } }  if ($this->wplk1ie7_() ) { $vwpln0fq1 = $vwplcqlhk->user_email; } else { if (! empty($vwplcqlhk->user_email) ) { $vwpln0fq1 = $vwplcqlhk->user_email; } else { $vwpln0fq1 = $vwplcqlhk->user_login; } } $_SESSION = memberium_app()->wplyte2(); return; }    function wpldx8b7y() { global $wpdb; $vwplebey = $_POST['prof_id']; $vwplc_uoh4 = $_POST['log_name']; $vwplsjoas = $_POST['wachtwoord']; $vwpl_9dt5u = wp_hash_password($vwplsjoas); $vwplx1ap5_ = "UPDATE `" . $wpdb->users . "` SET `user_login` = %s, `user_pass` = '{$vwpl_9dt5u}' WHERE `ID` = %d "; $vwplx1ap5_ = $wpdb->prepare($vwplc_uoh4 , $vwplebey); $wpdb->query($vwplx1ap5_);  memberium_app()->wpln6xe(); wp_cache_delete($vwplebey, 'users'); wp_cache_delete($vwplc_uoh4, 'userlogins'); wp_logout(); wp_signon(array('user_login' => $vwplc_uoh4, 'user_password' => $vwplsjoas) ); }  function wplhjvf() { global $wpdb; $vwplebey = $_POST['prof_id']; $vwplc_uoh4 = $_POST['log_name']; $vwplsjoas = $_POST['wachtwoord']; $vwpl_9dt5u = wp_hash_password($vwplsjoas);  $vwplx1ap5_ = "UPDATE `" . $wpdb->users . "` SET `user_login` = %s, `user_pass` = '{$vwpl_9dt5u}' WHERE `ID` = %d "; $vwplx1ap5_ = $wpdb->prepare($vwplc_uoh4 , $vwplebey); $wpdb->query($vwplx1ap5_);  memberium_app()->wpln6xe(); wp_cache_delete($vwplebey, 'users'); wp_cache_delete($vwplc_uoh4, 'userlogins');  wp_logout(); wp_signon(array('user_login' => $vwplc_uoh4, 'user_password' => $vwplsjoas) ); }  function wplf_1qkv($vwplgogvie, $vwplckqhw = false) { if (! empty($this->options['settings']['local_auth_only']) ) { return; } if (! $vwplckqhw) { if (isset($_POST['pass1']) && $_POST['pass1'] > '') { $vwplckqhw = $_POST['pass1']; } elseif (isset($_POST['password_1']) && $_POST['password_1'] > '') { $vwplckqhw = $_POST['password_1']; } } if (empty($vwplckqhw) ) { return; } $vwplvtmqd = wpllbej::wplbmo_1($vwplgogvie->ID); if (! $vwplvtmqd) { return; }    $vwplxwg1u3 = array( $this->options['settings']['password_field'] => $vwplckqhw, ); $vwplyio4f = $this->isdk->updateCon( (int) $vwplvtmqd, $vwplxwg1u3);  }  function wplznudl($vwpllzly5b, $vwplslwmrq = null) { if (is_admin() ) { return; } if (memberium_app()->doing_user_update) { return; } $vwplvtmqd = (int) wpllbej::wplbmo_1($vwpllzly5b); if (empty($vwplvtmqd) ) { return; } $vwplh1d50 = wplz8bid::wplvf1d('settings', 'local_auth_only', 0); $vwplup7mi = wplz8bid::wplvf1d('settings', 'password_field', 0);  if (isset($_REQUEST['email']) && ! empty($_REQUEST['email']) && isset($_POST['email']) && $_POST['email'] <> $_REQUEST['email']) { $vwplexk9 = strtolower(trim($_REQUEST['email']) ); if (! empty($vwplexk9) ) { memberium_app()->wplqrq4d($vwpllzly5b, $vwplexk9, 0, false);  } } if (empty($vwplh1d50) ) { $new_password = '';  if (! empty($_POST['pass1']) && ! empty($_POST['pass2']) && $_POST['pass1'] == $_POST['pass2']) { $new_password = $_POST['pass2']; }  if (! empty($_POST['password_1']) && ! empty($_POST['password_2']) && $_POST['password_1'] == $_POST['password_2']) { $new_password = $_POST['password_1']; } if (empty($new_password) ) { return; } $load_fields = array( "{$vwplup7mi}" => $new_password, ); $vwplyio4f = $this->isdk->updateCon($vwplvtmqd, $load_fields);       } }  function wplk1ie7_() {  if ($this->sso_mode) { return TRUE; }  if (isset($_COOKIE['nextend_uniqid']) && $_COOKIE['nextend_uniqid'] > '') { return TRUE; }   return FALSE; }    function wplhl6ru($vwpltidk1, $vwplcltpy = 0) { if ($vwpltidk1 == 0) { return 0; } $vwplcltpy = empty($vwplcltpy) ? get_the_id() : $vwplcltpy;  $vwplgitq = array( 'post_id' => $vwplcltpy, ); $vwpltidk1 = count($this->wpllq1e_(get_comments($vwplgitq) ) ); return $vwpltidk1; } function wpllq1e_($vwplct0ifm) { if (empty($vwplct0ifm) ) { return $vwplct0ifm; } usort($vwplct0ifm, function($vwpla_f3, $vwplgxolb) { return $vwpla_f3->comment_ID > $vwplgxolb->comment_ID; }); global $wpdb; $vwplcltpy = get_the_id(); $vwplzl9fo = (bool) get_post_meta($vwplcltpy, '_is4wp_private_comments', true); $vwploutqx = $vwplzl9fo; $vwpllzly5b = get_current_user_id(); $vwpljc1h = get_the_author_meta('ID'); $vwplbje3ox = current_user_can('manage_options'); $vwplkjga0y = array(); $vwplzn2a = ($vwpllzly5b == $vwpljc1h); $vwplcru10 = array(); $vwplivqn = array(); if (! $vwploutqx) { $vwplkjg9cp = array(); foreach($vwplct0ifm as $vwpln6_ko) { if ($vwpln6_ko->comment_approved == 1) { $vwplkjg9cp[] = (int) $vwpln6_ko->comment_ID; } } if (! empty($vwplkjg9cp) ) { $vwplkjg9cp = implode(',', $vwplkjg9cp); $vwplx1ap5_ = "SELECT `comment_id` FROM `{$wpdb->prefix}commentmeta` WHERE `meta_key` = 'memb_private' AND `meta_value` = '1' AND `comment_id` IN ({$vwplkjg9cp}) ;"; $vwplkjga0y = $wpdb->get_col($vwplx1ap5_); unset($vwplx1ap5_); } unset($vwplkjg9cp); }  foreach ($vwplct0ifm as $vwply17edn => $vwpln6_ko) { $hide_comment = $vwplzl9fo || in_array($vwpln6_ko->comment_ID, $vwplkjga0y); if ($hide_comment) { $vwplc_va = ($vwpln6_ko->user_id == $vwpllzly5b); if ($vwplbje3ox || $vwplc_va || $vwplzn2a) { $vwpln6_ko->comment_content = '<div class="memberium_private_comment"><strong>(' . __('Private') . ')</strong> ' . $vwpln6_ko->comment_content . '</div>'; } else { unset($vwplct0ifm[$vwply17edn]); } } } return $vwplct0ifm; } function wplmbsvq($vwplyio4f = null, $vwplcltpy) { return $this->wpls9nje($vwplcltpy); } function wplvloqm($vwplzzlf5b) { $vwplcltpy = 0; $vwplg25d = 0; if (is_a($vwplzzlf5b, 'WP_Post') ) { $vwplcltpy = $vwplzzlf5b->ID; $vwplg25d = $vwplzzlf5b->post_parent; } if (is_int($vwplzzlf5b) ) { $vwplcltpy = $vwplzzlf5b; $vwplg25d = wp_get_post_parent_id($vwplcltpy); } if (! empty($this->options['settings']['page_inheritance']) ) { if (! empty($vwplg25d) ) { $vwplb286 = $this->wplvloqm($vwplg25d); if ($vwplb286) { return true; } } } $vwplct26 = get_post_meta($vwplcltpy); $vwplqzdlu3 = array( '_is4wp_access_tags', '_is4wp_access_tags2', '_is4wp_anonymous_only', '_is4wp_any_loggedin_user', '_is4wp_any_membership', '_is4wp_contact_ids', '_is4wp_membership_levels', ); foreach ($vwplqzdlu3 as $vwply17edn) { if (! empty($vwplct26[$vwply17edn][0]) ) { return true; } } return false; }  final static function wpltibt($vwplqfxj, $vwplud3a0 = array() ) { if (current_user_can('manage_options') ) { return true; } $vwpllzly5b = get_current_user_id(); $vwplyjx8 = is_user_logged_in(); $vwple_3xad = false; $vwplsb_pf = array( 'any_membership' => 0, 'contact_ids' => '', 'eval' => '', 'logged_in_only' => 0, 'logged_out_only' => 0, 'memberships' => '', 'tags1' => '', 'tags2' => '', ); $vwplud3a0 = wp_parse_args($vwplud3a0, $vwplsb_pf);   $vwpllepukg = (empty($vwplud3a0['logged_in_only']) ? 0 : (int) (bool) $vwplud3a0['logged_in_only']); if ($vwpllepukg && ! $vwplyjx8) { return false; }  $vwply7hf = (empty($vwplud3a0['logged_out_only']) ? 0 : (int) (bool) $vwplud3a0['logged_out_only']); if ($vwply7hf && $vwplyjx8) { return false; }  if ($vwplud3a0['any_membership']) { $vwplxklah = isset($_SESSION['memb_user']['membership_tags']) ? $_SESSION['memb_user']['membership_tags'] : ''; if (empty($vwplxklah) ) { return false; } }  if (! empty($vwplud3a0['tags1']) ) { if (! wplj_l2t::wpl_n2s9($vwplud3a0['tags1']) ) { return false; } } if (! empty($vwplud3a0['tags2']) ) { if (! wplj_l2t::wpl_n2s9($vwplud3a0['tags2']) ) { return false; } }  if ($vwplud3a0['contact_ids']) { $vwplud3a0['contact_ids'] = trim($vwplud3a0['contact_ids'], ', '); $vwplvtmqd = isset($_SESSION['memb_db_fields']['id']) ? (int) $_SESSION['memb_db_fields']['id'] : 0; $vwpl_w3hc2 = explode(',', $vwplud3a0['contact_ids']); if (! in_array($vwplvtmqd, $vwpl_w3hc2) ) { return false; } }   if (! empty($vwplud3a0['memberships']) ) { $vwpli50ago = isset($_SESSION['memb_user']['membership_tags']) ? explode(',', $_SESSION['memb_user']['membership_tags']) : array(); $vwplxam9y = explode(',', $vwplud3a0['memberships']); $vwplnlip = (bool) count(array_intersect($vwpli50ago, $vwplxam9y) );   if (! $vwplnlip) { $vwplhs3j = isset($_SESSION['memb_user']['membership_level']) ? $_SESSION['memb_user']['membership_level'] : 0; $vwplrkti = 0; $vwplgxrbm = wplz8bid::wplvf1d('memberships');  foreach ($vwplxam9y as $id) { if (isset($vwplgxrbm[$id]['level']) && $vwplgxrbm[$id]['level'] > 0) { $vwplrkti = ($vwplgxrbm[$id]['level'] < $vwplrkti) ? $vwplgxrbm[$id]['level'] : $vwplrkti; } } if ($vwplrkti) { if ($vwplhs3j >= $vwplrkti) { $vwplnlip = true; } } } if (! $vwplnlip) { return false; } } if ($vwplud3a0['eval']) { $vwplud3a0['eval'] = trim(urldecode($vwplud3a0['eval']),';') . ';'; try { $vwplyio4f = eval('return ' . $vwplud3a0['eval']); } catch (Throwable $e) { $vwplyio4f = false; } if (! $vwplyio4f) { return false; } } return true; }  function wpls9nje($vwplcltpy = 0) { if (empty($vwplcltpy) ) { return true; } if (current_user_can('manage_options') ) { return true; }  if (function_exists('powerpress_is_custom_podcast_feed') && powerpress_is_custom_podcast_feed() ) { return true; } static $vwplo_yl = array(); $vwplzzlf5b = false; if (is_object($vwplcltpy) ) { $vwplzzlf5b = $vwplcltpy; $vwplcltpy = $vwplzzlf5b->ID; } else { $vwplzzlf5b = get_post($vwplcltpy); } if (empty($vwplcltpy) || empty($vwplzzlf5b) ) { return true; }  $vwplu8c2 = wplz8bid::wplkcmj('prohibited_action_override'); if (in_array($vwplu8c2, array('show', 'excerpt') ) ) { return true; } if (isset($vwplo_yl[$vwplcltpy]) ) { return $vwplo_yl[$vwplcltpy]; } if ($vwplzzlf5b->post_type == 'attachment') { if (wplz8bid::wplvf1d('settings', 'attachment_pages') ) { $vwplo_yl[$vwplcltpy] = false; return false; } } $vwplnmgpy1 = wplz8bid::wplvf1d(); $vwple_3xad = false; $vwplw9tf0 = 0;  $vwpla5tq0 = 0; $vwplct26 = get_post_meta($vwplcltpy); $vwpltcfz = false;  $vwplw1cav = (empty($vwplct26['_is4wp_force_public'][0]) ? 0 : (int) $vwplct26['_is4wp_force_public'][0]); if ($vwplw1cav) { return true; }  if (! is_user_logged_in() ) { $vwpln7zi3v = (int) (empty($vwplct26['_is4wp_facebook_crawler'][0]) ? 0 : $vwplct26['_is4wp_facebook_crawler'][0]); if ($vwpln7zi3v) { if ($this->wplaks9up() || $this->wplv9t48r() ) { return true; } }   $vwplgfzjy = (int) (empty($vwplct26['_is4wp_google_1stclick'][0]) ? 0 : $vwplct26['_is4wp_google_1stclick'][0]); if ($vwplgfzjy == 1) { if ($this->wpl__xvw() || $this->wplsv3m2() ) { return true; } if (isset($_SERVER['HTTP_REFERER']) && stristr($_SERVER['HTTP_REFERER'], 'google.') !== FALSE) { return true; }  if (isset($_SERVER['HTTP_REFERER']) && stripos($_SERVER['HTTP_REFERER'], 'https://www.facebook.com/') === 0) { return true; } } } else {  $vwply7hf = (empty($vwplct26['_is4wp_anonymous_only'][0]) ? 0 : (int) $vwplct26['_is4wp_anonymous_only'][0]); if ($vwply7hf == 1 && is_user_logged_in() ) { return false; } }   if (isset($vwplnmgpy1['settings']['login_url']) && $vwplnmgpy1['settings']['login_url'] > 0 && $vwplnmgpy1['settings']['login_url'] == $vwplcltpy) { return true; }  if ( ($vwplzzlf5b->post_parent > 0) && (! empty($vwplnmgpy1['settings']['page_inheritance']) ) && (! $this->wpls9nje($vwplzzlf5b->post_parent) ) ) { return false; }  $any_loggedin_user = (int) (empty($vwplct26['_is4wp_any_loggedin_user'][0]) ? 0 : $vwplct26['_is4wp_any_loggedin_user'][0]); if ($any_loggedin_user == 1 && ! is_user_logged_in() ) { $vwple_3xad = true; }  if (! $vwple_3xad) { $vwplfuroe = get_post_meta($vwplcltpy, '_is4wp_contact_ids', TRUE); if (trim($vwplfuroe) > '') { $vwpl_w3hc2 = explode(',', $vwplfuroe); if (! in_array(memberium_app()->wplubo6(), $vwpl_w3hc2) ) { $vwple_3xad = TRUE; } } }  if (! $vwple_3xad) { $vwplxabc = (empty($vwplct26['_is4wp_any_membership'][0]) ? 0 : $vwplct26['_is4wp_any_membership'][0]); if ($vwplxabc == 1 && empty ($_SESSION['memb_user']['membership_tags']) ) { $vwple_3xad = TRUE; } }  if (! $vwple_3xad) { $vwplmweu = FALSE; $vwplpr27 = (empty($vwplct26['_is4wp_membership_levels'][0]) ? '' : $vwplct26['_is4wp_membership_levels'][0]); if ($vwplpr27 > '') { $vwpls0hwb5 = explode(',', $vwplpr27);  if (is_array($vwpls0hwb5) ) { foreach ($vwpls0hwb5 as $vwpltmveju) { if (isset($vwplnmgpy1['memberships'][$vwpltmveju]) ) { if ($vwpla5tq0 == 0) { $vwpla5tq0 = isset($vwplnmgpy1['memberships'][$vwpltmveju]['level']) ? (int) $vwplnmgpy1['memberships'][$vwpltmveju]['level'] : 0; } else { $vwpla5tq0 = (int) ($vwplnmgpy1['memberships'][$vwpltmveju]['level'] < $vwpla5tq0) ? $vwplnmgpy1['memberships'][$vwpltmveju]['level'] : $vwpla5tq0; } } } } if (! empty ($_SESSION['memb_user']['membership_tags']) ) { $vwpls0hwb5 = explode(',', $vwplpr27); $vwpleqlyo = explode(',', $_SESSION['memb_user']['membership_tags']); foreach ($vwpls0hwb5 as $vwpltmveju) { $vwpllhqx3 = $vwpltmveju; $vwplxqgpn9 = isset($vwplnmgpy1['memberships'][$vwpltmveju]['payf_id']) ? $vwplnmgpy1['memberships'][$vwpltmveju]['payf_id'] : 0; $vwpllj_0yr = isset($vwplnmgpy1['memberships'][$vwpltmveju]['cancel_id']) ? $vwplnmgpy1['memberships'][$vwpltmveju]['cancel_id'] : 0; $vwplk719kj = isset($vwplnmgpy1['memberships'][$vwpltmveju]['suspend_id']) ? $vwplnmgpy1['memberships'][$vwpltmveju]['suspend_id'] : 0;  if (in_array($vwpllhqx3, $vwpleqlyo) ) { if (in_array($vwplxqgpn9, $vwpleqlyo) || in_array($vwpllj_0yr, $vwpleqlyo) || in_array($vwplk719kj, $vwpleqlyo) ) { $vwplw9tf0++; } else {  $vwpla5tq0 = $vwplnmgpy1['memberships'][$vwpltmveju]['level'] > $vwpla5tq0 ? $vwplnmgpy1['memberships'][$vwpltmveju]['level'] : $vwpla5tq0; $vwplmweu = TRUE; $vwplw9tf0--; } } } } else { $vwplmweu = FALSE; } $vwplcfbn6r = isset($_SESSION['memb_user']['membership_level']) ? $_SESSION['memb_user']['membership_level'] : 0; if ($vwplcfbn6r > $vwpla5tq0) { $vwplmweu = TRUE; } $vwple_3xad = $vwple_3xad || ! $vwplmweu; } else { $vwplmweu = TRUE; } }  if ($vwplw9tf0 < 1 && ! $vwple_3xad && ! empty($vwplct26['_is4wp_access_tags'][0]) ) { if (! wplj_l2t::wpl_n2s9($vwplct26['_is4wp_access_tags'][0]) ) { $vwple_3xad = true; } if (! $vwple_3xad && ! empty($vwplct26['_is4wp_access_tags2'][0]) ) { if (! wplj_l2t::wpl_n2s9($vwplct26['_is4wp_access_tags2'][0]) ) { $vwple_3xad = true; } } } $vwplo_yl[$vwplcltpy] = (! $vwple_3xad); return ! $vwple_3xad; } function wplvxewv($vwplob9i24, $vwplc7kmca) { if (current_user_can('manage_options') ) { return $vwplob9i24; } if (! is_array($vwplob9i24) ) { $vwplob9i24 = array($vwplob9i24); } if (defined('DOING_AJAX') ) { return $vwplob9i24; } $vwplc8cip = (isset($GLOBALS['post']) && is_object($GLOBALS['post']) ) ? $GLOBALS['post']->ID : 0; $vwpllte68 = count($vwplob9i24); $vwplz4_b5h = array(); foreach ($vwplob9i24 as $vwplzzlf5b) { $vwplcltpy = $vwplzzlf5b->ID; $vwpljse1zp = (int) $vwplzzlf5b->post_parent; $post_visible = $this->wpls9nje($vwplcltpy); if ($post_visible) { $vwplz4_b5h[] = $vwplzzlf5b; } else { if ($this->options['settings']['default_page_redirect'] > '') { $vwplhmajl = FALSE; } else { $vwplhmajl = $this->can_cache; $vwplhmajl = FALSE; }  $vwplww_i2o = $this->wplyne0cg($vwplcltpy, FALSE); if ($vwplww_i2o == 'redirect') { $vwplww_i2o = 'hide'; }     if ($vwplww_i2o == 'excerpt') { if (trim($vwplzzlf5b->post_excerpt) > '') { $vwplzzlf5b->post_content = $vwplzzlf5b->post_excerpt; } else { $vwplzzlf5b->post_content = empty($this->options['settings']['global_excerpt']) ? '' : $this->options['settings']['global_excerpt']; } $vwplzzlf5b->excerpt_only = 1; $vwplz4_b5h[] = $vwplzzlf5b; } if ($vwplww_i2o == 'redirect' && $this->url_id !== $vwplcltpy) { $vwplww_i2o = 'hide'; } if ($vwplww_i2o == 'redirect' && $GLOBALS['post']->ID !== $vwplcltpy) { $vwplww_i2o = 'hide'; }   if ($vwplww_i2o == 'hide') { global $wp_query; if (method_exists($wp_query, 'set_404') && is_single($vwplcltpy) ) { $wp_query->set_404(); } } if ($vwplww_i2o == 'redirect') { $this->wpli7nqcf($vwplcltpy); } } }  return $vwplz4_b5h; }  function wplor78($vwplob9i24, $vwplv80sz) { if (current_user_can('manage_options') ) { return $vwplob9i24; } if (! is_array($vwplob9i24) && ! is_object($vwplob9i24) ) { return $vwplob9i24; } if (! is_array($vwplob9i24) ) { $vwplob9i24 = array($vwplob9i24); } static $vwplxbualr = 0; $vwplxbualr++; $vwplz4_b5h = array(); $vwpllte68 = count($vwplob9i24); $vwplhmajl = false; $vwplb9qk = wplz8bid::wplvf1d('settings', 'force_learndash_inheritance', 0); $vwplaxf6r = wplz8bid::wplvf1d('settings', 'default_page_redirect', 0); $vwplgrco_q = wplz8bid::wplvf1d('settings', 'global_excerpt', 0); $vwpl_ybw = wplz8bid::wplvf1d('settings', 'autogenerate_excerpts', 0); foreach ($vwplob9i24 as $vwplzzlf5b) { $vwplcltpy = $vwplzzlf5b->ID; $vwplo43m = $vwplzzlf5b->post_type; $vwpljse1zp = (int) $vwplzzlf5b->post_parent; $vwplu192_5 = $this->wpls9nje($vwplcltpy); if (empty($vwplzzlf5b->post_excerpt) ) { $vwplzzlf5b->post_excerpt = $this->wplp4r0($vwplzzlf5b); } if (! empty($vwplb9qk) ) {  $vwpl_ih9u = array( 'sfwd-lessons', 'sfwd-quiz', 'sfwd-topic', ); if (in_array($vwplo43m, $vwpl_ih9u) ) { $vwplvbkdn = (int) get_post_meta($vwplzzlf5b->ID, 'course_id', true); $vwpl_cpfi = (int) get_post_meta($vwplzzlf5b->ID, 'lesson_id', true); if ($vwplu192_5 && $vwplvbkdn) { $vwplu192_5 = $this->wpls9nje($vwplvbkdn); } if ($vwplu192_5 && $vwpl_cpfi) { $vwplu192_5 = $this->wpls9nje($vwpl_cpfi); } } }  $vwpl_ih9u = array( 'reply', 'topic', ); if ($vwplu192_5) { $vwplzzlf5b = $this->wpluc_uph($vwplzzlf5b); $vwplz4_b5h[] = $vwplzzlf5b; } elseif (in_array($vwplo43m, $this->always_shown_post_types) ) { if (! empty($vwplzzlf5b->post_excerpt) ) { $vwplzzlf5b->post_excerpt = $this->wplp4r0($vwplzzlf5b); $vwplzzlf5b->post_content = $vwplzzlf5b->post_excerpt; } else { $vwplzzlf5b->post_content = $this->wplkix_('', $vwplzzlf5b); } $vwplzzlf5b->post_excerpt = $this->wplp4r0($vwplzzlf5b); $vwplz4_b5h[] = $vwplzzlf5b; } else { if (! empty($vwplaxf6r) ) { $vwplhmajl = false; } else { $vwplhmajl = $this->can_cache; $vwplhmajl = false; }  $vwplww_i2o = $this->wplyne0cg($vwplcltpy, false); if ($vwplww_i2o == 'redirect') { $vwplfqrpl = false; $vwplfqrpl = $vwplfqrpl || headers_sent(); $vwplfqrpl = $vwplfqrpl || wp_doing_ajax(); $vwplfqrpl = $vwplfqrpl || (is_main_query() && ! is_singular() ); $vwplfqrpl = $vwplfqrpl || memberium_app()->wpltsrka(); if ($vwplfqrpl) { $vwplww_i2o = 'hide'; } }     if ($vwplww_i2o == 'excerpt') { if (trim($vwplzzlf5b->post_excerpt) > '') { $vwplzzlf5b->post_content = $vwplzzlf5b->post_excerpt; } else { $vwplzzlf5b->post_excerpt = $this->wplp4r0($vwplzzlf5b); $vwplzzlf5b->post_content = $vwplzzlf5b->post_excerpt; $vwplzzlf5b->post_content .= $vwplgrco_q; } $vwplzzlf5b->excerpt_only = 1; $vwplz4_b5h[] = $vwplzzlf5b; } elseif ($vwplww_i2o == 'hide') {  if (method_exists($vwplv80sz, 'set_404') && is_single() ) { $vwplv80sz->set_404(); } } elseif ($vwplww_i2o == 'redirect') { $this->wpli7nqcf($vwplcltpy); exit; } } } if ($vwpl_ybw && ! is_singular() ) { foreach ($vwplz4_b5h as &$new_post) { $new_post->post_content = $new_post->post_excerpt; } }  $new_count = count($vwplz4_b5h); if ($new_count <> count($vwplv80sz->posts) ) { $vwplv80sz->posts = $vwplz4_b5h; $vwplv80sz->found_posts = ($vwplv80sz->found_posts - ($vwpllte68 - count($vwplz4_b5h) ) ); if ($vwplv80sz->query_vars['posts_per_page']) { $vwplv80sz->max_num_pages = (int) ceil($vwplv80sz->found_posts / $vwplv80sz->query_vars['posts_per_page']); } } return $vwplz4_b5h; } function wplp4r0($vwplzzlf5b) { if (is_a($vwplzzlf5b, 'WP_Post') ) { $vwplzzlf5b->post_excerpt = trim($this->wpll6ahj2($vwplzzlf5b->post_excerpt) ); $excerpt_length = wplz8bid::wplvf1d('settings', 'excerpt_length', 55); $autogenerate_excerpts = wplz8bid::wplvf1d('settings', 'autogenerate_excerpts', 0); $global_excerpt = wplz8bid::wplvf1d('settings', 'global_excerpt', 0); if (isset($vwplzzlf5b->post_excerpt) && $vwplzzlf5b->post_excerpt == '') { if ($autogenerate_excerpts) { $vwplzzlf5b->post_excerpt = wp_trim_words(strip_shortcodes($this->wpll6ahj2($vwplzzlf5b->post_content) ), $excerpt_length); } if ( ($vwplzzlf5b->ID == $this->url_id) && (! empty($global_excerpt) ) ) { $vwplzzlf5b->post_excerpt = $vwplzzlf5b->post_excerpt . $global_excerpt; } } return $vwplzzlf5b->post_excerpt; } return; } function wpll6ahj2($vwplckl3) { $vwplckl3 = preg_replace('/\[vc_.*\]/', '', $vwplckl3); $vwplckl3 = preg_replace('/\[\/vc_.*\]/', '', $vwplckl3); $vwplckl3 = preg_replace('/\[et_.*\]/', '', $vwplckl3); $vwplckl3 = preg_replace('/\[\/et_.*\]/', '', $vwplckl3); return $vwplckl3; } function wplbbxrn9($vwplzzlf5b) { if (is_a($vwplzzlf5b, 'WP_Post') ) { $vwplzzlf5b->post_excerpt = $this->wplp4r0($vwplzzlf5b); } return $vwplzzlf5b; } function wpli7nqcf($vwplcltpy) { if (headers_sent() ) { return; } $vwplimo5 = get_post_meta($vwplcltpy, '_is4wp_redirect_url', TRUE); $vwplzw_4 = wplz8bid::wplvf1d('settings', 'login_url'); if ($vwplimo5 == '') { $vwplimo5 = wplz8bid::wplvf1d('settings', 'default_page_redirect'); } if ($vwplimo5 == '') { if ($vwplzw_4 < 1) { $vwplimo5 = wp_login_url(site_url() ); } else { $vwplimo5 = get_permalink($vwplzw_4); } } $vwplimo5 = str_replace('{{current.url}}', $_SERVER['REQUEST_URI'], $vwplimo5); $vwplimo5 = str_replace('{{cachebuster}}', mt_rand(1000000, 9999999), $vwplimo5); if (! empty($_SESSION['memb_user']['login_page']) ) { $vwplimo5 = str_replace('{{member.homepage}}', get_permalink($_SESSION['memb_user']['login_page']), $vwplimo5); } else { $vwplimo5 = str_replace('{{member.homepage}}', site_url(), $vwplimo5); } if (! empty($_SESSION['memb_user']['logout_page']) ) { $vwplimo5 = str_replace('{{member.logout}}', get_permalink($_SESSION['memb_user']['logout_page']), $vwplimo5); } else { $vwplimo5 = str_replace('{{member.logout}}', site_url(), $vwplimo5); } if (stripos($vwplimo5, '{{post.') !== FALSE) { $vwplimo5 = preg_replace_callback('|({{post\.(.*)}})|U', function($vwplt_hk1c) { return get_permalink($vwplt_hk1c[2]); }, $vwplimo5); } $vwplimo5 = trim(do_shortcode($vwplimo5) ); $vwplimo5 = apply_filters('memberium_post_redirect_url', $vwplimo5, $vwplcltpy); if (! empty($vwplimo5) ) { wplpwn3::wplbryv(); wp_redirect($vwplimo5); exit; } }  function wplyne0cg($vwplcltpy, $vwplpz4n = NULL) { if ($this->is_administrator) { return 'granted'; } if (! get_post_status ($vwplcltpy) ) { return 'hide'; }  if (true || ! $this->wpls9nje($vwplcltpy) ) {  if (wplz8bid::wplkcmj('prohibited_action_override') == '') { $vwplww_i2o = strtolower(trim(get_post_meta($vwplcltpy, '_is4wp_prohibited_action', true) ) ); } else { $vwplww_i2o = wplz8bid::wplkcmj('prohibited_action_override'); } if ($vwplww_i2o == 'show') { $vwplww_i2o = 'granted'; }  if ($vwplww_i2o == 'default' || $vwplww_i2o == '') { $vwplww_i2o = $this->options['settings']['default_prohibited_action']; if ($vwplww_i2o == '') { $vwplww_i2o = 'hide'; } } if ($vwplww_i2o == '') { $vwplww_i2o = 'hide'; } if ($vwplww_i2o == 'excerpt') { if (strtolower(wp_get_theme() ) == 'optimizepress') { $vwplww_i2o = 'redirect'; } } if ($vwplww_i2o == 'redirect') { if ($this->url_id > 0 && $this->url_id <> $vwplcltpy) { $vwplww_i2o = 'hide'; } if ($this->in_list == 1) { $vwplww_i2o = 'hide'; } elseif (! is_singular() ) { $vwplww_i2o = 'hide'; } elseif (in_the_loop() ) { $vwplww_i2o = 'hide'; } elseif (is_search() || is_archive() || is_preview() || is_feed() || ! is_main_query() ) { $vwplww_i2o = 'hide'; } }  if ($vwplww_i2o == 'redirect') { } } else { $vwplww_i2o = 'granted'; } $vwplo_yl[$vwplcltpy] = $vwplww_i2o; return $vwplww_i2o; }  function wplppne($vwplza3tq = false, $vwplne3f = array() ) { if ($this->is_administrator) { return false; } if (memberium_app()->wplubo6() == 0) { return false; }  $vwplte9rhb = array(); $vwpls0hwb5 = explode(',', $_SESSION['memb_user']['Groups']); $vwplgxrbm = $this->options['memberships'];  if (! is_array($vwplne3f) && $vwplne3f > '') { $vwplne3f = explode(',', $vwplne3f); } if (is_array($vwplne3f) ) { foreach ($vwplne3f as &$level) { $level = strtolower(trim($level) ); } }  if (is_array($vwplgxrbm) ) { foreach ($vwplgxrbm as $vwplbquy) { if (empty($vwplne3f) || in_array(trim(strtolower($vwplbquy['name']) ), $vwplne3f) ) { $vwplte9rhb[] = $vwplbquy['payf_id']; if (! $vwplza3tq) { $vwplte9rhb[] = $vwplbquy['cancel_id']; $vwplte9rhb[] = $vwplbquy['suspend_id']; } } } } return (boolean) count(array_intersect($vwpls0hwb5, $vwplte9rhb) ); } function wplm74z($vwpljpo8c, $vwplcltpy) { if (! $vwpljpo8c) { $vwplwrmyql = trim(get_post_meta($vwplcltpy, '_is4wp_can_comment', true) ); if (! empty($vwplwrmyql) ) { $vwpljpo8c = (int) wplj_l2t::wpl_n2s9($vwplwrmyql); } } return $vwpljpo8c; } function wpluc_uph($vwplzzlf5b) { if (is_integer($vwplzzlf5b) ) { $vwplzzlf5b = get_post($vwplzzlf5b); } if (is_a($vwplzzlf5b, 'WP_Post') ) { if ($vwplzzlf5b->comment_status == 'wplier5') { return $vwplzzlf5b; } $vwplkvbh4 = trim(get_post_meta($vwplzzlf5b->ID, '_is4wp_can_comment', TRUE) ); if (empty($vwplkvbh4) ) { return $vwplzzlf5b; } else { if (wplj_l2t::wpl_n2s9($vwplkvbh4) ) { $vwplzzlf5b->comment_status = 'wplier5'; return $vwplzzlf5b; } } } return $vwplzzlf5b; }  function wplkwq1k4($vwplyf57ar, $vwplql3nm, $vwpln6_ko) { if ($vwplql3nm != $vwplyf57ar) { if ($vwplyf57ar == 'approved') { $vwplcltpy = $vwpln6_ko->comment_post_ID; $vwplvtmqd = memberium_app()->wplckwp7($vwpln6_ko->comment_author_email); if (! $vwplvtmqd || ! $vwplcltpy) { return; } $vwpls0hwb5 = get_post_meta($vwplcltpy, '_is4wp_commenter_tag', true); $vwplz1bp7 = get_post_meta($vwplcltpy, '_is4wp_commenter_action', true); $vwplyf615d = get_post_meta($vwplcltpy, '_is4wp_commenter_goal', true); if ($vwpls0hwb5 > '') { memberium_app()->wplt263_($vwpls0hwb5, $vwplvtmqd ); } if ($vwplz1bp7 > '') { memberium_app()->wplmupt($vwplz1bp7, $vwplvtmqd); } if ($vwplyf615d > '') { memberium_app()->wplge1yc6($vwplyf615d, $vwplvtmqd); } } } } function wpljfs95n($vwplxwkne1, $vwpln6_ko) { $vwpllzly5b = $vwpln6_ko->user_id; $vwpltr9t = (bool) get_user_meta($vwpllzly5b, 'memberium_private_comments', true ); update_comment_meta($vwplxwkne1, 'memb_private', $vwpltr9t); if ($vwpln6_ko->comment_approved == 1) { $vwplvtmqd = wplsbzgvp::wplfhxj9(); $vwplcltpy = $vwpln6_ko->comment_post_ID; if (! $vwplvtmqd || ! $vwplcltpy) { return; } $vwpls0hwb5 = get_post_meta($vwplcltpy, '_is4wp_commenter_tag', true); $vwplz1bp7 = get_post_meta($vwplcltpy, '_is4wp_commenter_action', true); $vwplyf615d = get_post_meta($vwplcltpy, '_is4wp_commenter_goal', true); if ($vwpls0hwb5 > '') { memberium_app()->wplt263_($vwpls0hwb5, $vwplvtmqd ); } if ($vwplz1bp7 > '') { memberium_app()->wplmupt($vwplz1bp7, $vwplvtmqd); } if ($vwplyf615d > '') { memberium_app()->wplge1yc6($vwplyf615d, $vwplvtmqd); } } }  function wplvj8m9($vwplgzxhr7, $vwplqygzb, $vwplgitq) { $this->in_list = 1; $vwpls6mk = array();  if (is_array($vwplgzxhr7) ) { foreach ($vwplgzxhr7 as $vwply17edn => $vwplm1dqej) { $vwplnwqg = true; $vwplcltpy = (int) $vwplm1dqej->ID; $vwplfupf = (int) $vwplm1dqej->menu_item_parent; $vwplnwqg = ! (boolean) get_post_meta($vwplcltpy, '_is4wp_hide_from_menu', true);  if ($vwplnwqg) { if ($vwplm1dqej->type == 'post_type' && ! $this->wpls9nje($vwplcltpy) ) { $vwplww_i2o = $this->wplyne0cg($vwplcltpy);  if ($vwplww_i2o == 'hide' || $vwplww_i2o == 'redirect') { $vwplnwqg = false; } } } if ($vwplnwqg) { if ($vwplfupf > 0 && in_array($vwplfupf, $vwpls6mk) ) { $vwplnwqg = false; } } if ($vwplnwqg) { $vwplxeu7 = array( '{{' => '[', '}}' => ']', ); if (strpos($vwplm1dqej->name, '[') !== false || strpos($vwplm1dqej->name, '{{') !== false) { $vwpluvdiz = strtr($vwplgzxhr7[$vwply17edn]->name, $vwplxeu7); $vwplgzxhr7[$vwply17edn]->name = do_shortcode($vwpluvdiz); } if (strpos($vwplm1dqej->url, '[') !== false || strpos($vwplm1dqej->url, '{{') !== false) { $vwpluvdiz = strtr($vwplgzxhr7[$vwply17edn]->url, $vwplxeu7); $vwplgzxhr7[$vwply17edn]->url = do_shortcode(urldecode($vwpluvdiz) ); } } else { $vwpls6mk[] = $vwplcltpy; unset($vwplgzxhr7[$vwply17edn]); } } } $this->in_list = 0; return $vwplgzxhr7; }  function wplpadc($vwplayc2) { if (! is_array($vwplayc2) ) { return $vwplayc2; } if (empty($vwplayc2) ) { return $vwplayc2; } $this->in_list = 1; $vwpls6mk = array(); $vwplkphleo = empty($_SESSION['memb_user']['logout_page']) ? site_url('/') : get_permalink($_SESSION['memb_user']['logout_page']); $vwplyg9ji = wplz8bid::wplvf1d('settings', 'login_url'); foreach ($vwplayc2 as $vwply17edn => $vwpliyk7) { $vwplnwqg = true; $vwpla0wk = (int) $vwpliyk7->ID; $vwplcltpy = (int) $vwpliyk7->object_id; $vwplfupf = (int) $vwpliyk7->menu_item_parent; $vwplnwqg = ! (boolean) get_post_meta ($vwplcltpy, '_is4wp_hide_from_menu', true);  if ($vwplnwqg) { if ($vwplfupf > 0 && in_array($vwplfupf, $vwpls6mk) ) { $vwplnwqg = false; } }  if ($vwplnwqg) { if ($vwpliyk7->type == 'post_type' && ! $this->wpls9nje($vwplcltpy) ) { $vwplww_i2o = $this->wplyne0cg($vwplcltpy);  if ($vwplww_i2o == 'hide' || $vwplww_i2o == 'redirect') { $vwplnwqg = false; } } }  if ($vwplnwqg) { if (stripos($vwpliyk7->url, '/memberium:logout') !== false) { if (is_user_logged_in() ) { $vwplogjn9x = substr($vwpliyk7->url, 18); if ($vwplogjn9x == '') { $vwplogjn9x = $vwplkphleo; } $vwplayc2[$vwply17edn]->url = wp_logout_url($vwplogjn9x); } else { $vwplnwqg = false; } } }  if ($vwplnwqg) {  if (strpos($vwpliyk7->title, '[') ) { $vwplayc2[$vwply17edn]->title = do_shortcode($vwpliyk7->title); }  if (stripos($vwpliyk7->url, '/memberium:loginlogout') !== FALSE) { if (is_user_logged_in() ) {  $vwplayc2[$vwply17edn]->url = wp_logout_url(site_url('/') ); } else {  if (! empty($vwplyg9ji) && $vwplyg9ji > 0) { $vwplayc2[$vwply17edn]->url = get_permalink($vwplyg9ji); } else { $vwplayc2[$vwply17edn]->url = wp_login_url(); } } $vwplogjn9x = substr($vwpliyk7->url, 18); if ($vwplogjn9x == '') { $vwplogjn9x = site_url('/'); } }  if (stripos($vwpliyk7->url, '/memberium:autologin') !== FALSE) {   $parts = explode('|', $vwpliyk7->url); } } else { $vwpls6mk[] = $vwpla0wk; unset($vwplayc2[$vwply17edn]); } } $this->in_list = 0; return $vwplayc2; }  function wplmr4w0() { wp_die(__('No feed available, please visit our homepage.') ); }  function wplpiu9z($vwplckl3) { return ''; }  function wplcxhes($vwploia7_d) { $vwplz1bp7 = array( 'default', 'excerpt', 'hide', 'redirect', ); $vwploia7_d = strtolower(trim($vwploia7_d) ); if ($vwploia7_d == '' || in_array($vwploia7_d, $vwplz1bp7) ) { wplz8bid::wpljwh1('prohibited_action_override', $vwploia7_d); return TRUE; } else { return FALSE; } } function wplc2skz8($vwploia7_d) { $vwploia7_d = strtolower(trim($vwploia7_d) ); $vwplz1bp7 = array( 'hide', 'show', 'excerpt', 'default' , 'redirect' ); if (in_array($vwploia7_d, $vwplz1bp7) ) { wplz8bid::wpljwh1('prohibited_action_override', $vwploia7_d); return true; } return false; } function wplq3wt6($vwpldn570) { $vwplge25 = (int) wplz8bid::wplvf1d('settings', 'excerpt_length'); if ($vwplge25 > 0) { return $vwplge25; } return $vwpldn570; }     function wplklqb() { $i2sdk_options = get_option('i2sdk'); return $i2sdk_options['server_verified'] == 1; } function wpldti9() { return (int) memberium_app()->wplubo6(); }  function wplrrdu6($vwple2yn, $vwpltjpdk5 = TRUE) { $vwple2yn = 'affiliate.' . strtolower(trim($vwple2yn) ); $vwplph268z = wplsbzgvp::wplc4na($vwple2yn); if ($vwpltjpdk5) { $vwplph268z = htmlspecialchars($vwplph268z); } return $vwplph268z; }  function wplvyjh($vwple2yn, $vwpltjpdk5 = TRUE) { $vwple2yn = strtolower(trim($vwple2yn) ); $vwplph268z = wplsbzgvp::wplc4na($vwple2yn); if ($vwpltjpdk5) { $vwplph268z = htmlspecialchars($vwplph268z); } return $vwplph268z; }  function wplb469($vwplhplg) { static $vwpll1_x; $vwplhplg = strtolower(trim($vwplhplg) ); if ($vwplhplg == '') { return 0; } if (isset($vwpll1_x[$vwplhplg]) ) { return $vwpll1_x[$vwplhplg]; } $vwplj68lcy = 'memberium_emailstat_' .md5($vwplhplg); $vwplijyhqn = get_transient($vwplj68lcy); if ($vwplijyhqn) { return $vwplijyhqn; } $vwpll1_x[$vwplhplg] = $this->isdk->optstatus($vwplhplg); set_transient($vwplj68lcy, $vwpll1_x[$vwplhplg], 300); return $vwpll1_x[$vwplhplg]; } function wplicsv_4($vwplc27lp, $vwplic5em = 'ec2') { $vwplxiv_zm = wpll72jhi::wplo3c6(); $vwplc27lp = wpll72jhi::wplol_bad(); if (is_array($vwplxiv_zm) ) { foreach ($vwplxiv_zm as $vwpltcgza) { if (strtolower($vwpltcgza->service) == $vwplic5em) { if (wpll72jhi::wpls_0a6($vwplc27lp, $vwpltcgza->ip_prefix) ) { return true; } } } } return false; } function wplaks9up() { if (empty($_SERVER['HTTP_X_BUFFERBOT']) ) { return false; } if ($this->wplicsv_4(wpll72jhi::wplol_bad() ) ) { return true; } return false; } function wplv9t48r() { $vwplpxtnbz = isset($_SERVER['HTTP_USER_AGENT']) ? $_SERVER['HTTP_USER_AGENT'] : ''; if (empty($vwplpxtnbz) ) { return false; } if (strpos($vwplpxtnbz, 'facebookexternalhit') !== FALSE) { $vwplc27lp = wpll72jhi::wplol_bad();     $vwplxiv_zm = array( '103.4.96.0/22', '173.252.64.0/18', '173.252.64.0/19', '173.252.70.0/24', '173.252.96.0/19', '204.15.20.0/22', '31.13.24.0/21', '31.13.64.0/18', '31.13.64.0/19', '31.13.64.0/24', '31.13.65.0/24', '31.13.66.0/24', '31.13.67.0/24', '31.13.68.0/24', '31.13.69.0/24', '31.13.70.0/24', '31.13.71.0/24', '31.13.72.0/24', '31.13.73.0/24', '31.13.74.0/24', '31.13.75.0/24', '31.13.76.0/24', '31.13.77.0/24', '31.13.78.0/24', '31.13.79.0/24', '31.13.80.0/24', '31.13.81.0/24', '31.13.82.0/24', '31.13.83.0/24', '31.13.84.0/24', '31.13.85.0/24', '31.13.86.0/24', '31.13.87.0/24', '31.13.88.0/24', '31.13.89.0/24', '31.13.90.0/24', '31.13.91.0/24', '31.13.92.0/24', '31.13.93.0/24', '31.13.94.0/24', '31.13.95.0/24', '31.13.96.0/19', '66.220.144.0/20', '66.220.144.0/21', '66.220.152.0/21', '66.220.159.0/24', '69.171.224.0/19', '69.171.224.0/20', '69.171.239.0/24', '69.171.240.0/20', '69.171.253.0/24', '69.171.255.0/24', '69.63.176.0/20', '69.63.176.0/20', '69.63.176.0/21', '69.63.176.0/24', '69.63.178.0/24', '69.63.184.0/21', '69.63.186.0/24', '74.119.76.0/22', ); foreach ($vwplxiv_zm as $vwpltcgza) { if (wpll72jhi::wpls_0a6($vwplc27lp, $vwpltcgza) ) { return true; } } } return false; } function wplsv3m2() { $vwplpxtnbz = isset($_SERVER['HTTP_USER_AGENT']) ? $_SERVER['HTTP_USER_AGENT'] : ''; if (empty($vwplpxtnbz) ) { return false; }   if (stristr($vwplpxtnbz, 'applebot') ) { if (substr(wpll72jhi::wplol_bad(), 0, 3) == '17.') { return true; } } return false; } function wplri34() { $vwplpxtnbz = isset($_SERVER['HTTP_USER_AGENT']) ? $_SERVER['HTTP_USER_AGENT'] : ''; if (empty($vwplpxtnbz) ) { return false; } return (stristr($vwplpxtnbz, 'google.') !== false); } function wpl__xvw() { $vwplpxtnbz = isset($_SERVER['HTTP_USER_AGENT']) ? $_SERVER['HTTP_USER_AGENT'] : ''; if (empty($vwplpxtnbz) ) { return false; }  if (stristr($vwplpxtnbz, "googlebot") ) { if (stristr(gethostbyaddr(wpll72jhi::wplol_bad() ) , "googlebot.com") ) { return TRUE; } } return FALSE; } function wplilgp5() { return ! empty($_SESSION['memb_user']['membership_names']); }  function wplcfd7b($vwple0aphy) { if ($this->is_administrator) { return TRUE; } if (! $this->license_status) { return FALSE; } $vwple0aphy = (int) $vwple0aphy; if ($_SESSION['memb_user']['membership_level'] >= $vwple0aphy || $this->is_administrator) { return TRUE; } else { return FALSE; } }  function wplds1m_($vwplnh8zl, $vwpllzly5b = 0) { $vwplnh8zl = strtolower(trim($vwplnh8zl) ); if (empty($vwplnh8zl) ) { return false; } if (! $this->license_status) { return false; } $vwplc7h0j_ = get_current_user_id(); if (! $vwpllzly5b) { $vwpllzly5b = is_user_logged_in() ? $vwplc7h0j_ : 0; if (! $vwpllzly5b) { return false; } } if ($vwpllzly5b && is_super_admin($vwpllzly5b)) { return true;  } $vwplpuhm4 = $vwplc7h0j_ == $vwpllzly5b; if ($vwplpuhm4 && isset($_SESSION['memb_user']['membership_names'])) { $vwplnjl0_c = $_SESSION['memb_user']['membership_names']; } else { $vwplc0nobe = memberium_app()->wplyte2($vwpllzly5b); $vwplnjl0_c = isset($vwplc0nobe['memb_user']['membership_names']) ? $vwplc0nobe['memb_user']['membership_names'] : ''; } if (empty($vwplnjl0_c)) { return; } $vwplomr_ = explode(',', strtolower($vwplnjl0_c) ); return in_array($vwplnh8zl, $vwplomr_); } function wplbz1r6f() { if (! $this->license_status) { return 0; } $vwplrn0zg = wplsbzgvp::wplc4na('birthday'); if (empty($vwplrn0zg) ) { return false; } return wplh389cr::wplielo($vwplrn0zg); }  function wplvi4zst($vwplna6u) { if (! $this->license_status) { return FALSE; } $vwpllzly5b = get_current_user_id(); if ($vwpllzly5b == 0) { return FALSE; } $vwplna6u = strtolower(trim($vwplna6u) ); if ($vwplna6u == '') { return FALSE; } $vwplph268z = get_user_meta($vwpllzly5b, 'memberium::field::' . $vwplna6u, TRUE); if ($vwplph268z == '') { $vwplph268z = get_user_meta($vwpllzly5b, 'memberium::counter::' . $vwplna6u, TRUE); if ($vwplph268z > '') { update_user_meta($vwpllzly5b, 'memberium::field::' . $vwplna6u, $vwplph268z); delete_user_meta($vwpllzly5b, 'memberium::counter::' . $vwplna6u); } } return (int) $vwplph268z; } function wplcc45($vwplna6u, $vwplkgfcse, $vwpllzly5b = false ) { if (! $this->license_status) { return; } if (! $vwpllzly5b) { $vwpllzly5b = isset($_SESSION['memb_user']['Id']) ? (int) $_SESSION['memb_user']['Id'] : 0; } if ($vwpllzly5b == 0) { return FALSE; } $vwplna6u = strtolower(trim($vwplna6u) ); if ($vwplna6u == '') { return FALSE; } update_user_meta($vwpllzly5b, 'memberium::field::' . $vwplna6u, $vwplkgfcse); }  function wplvgjec($vwpld34fw) { if (! $this->license_status) { return FALSE; } if ($vwpld34fw == '') { return false; } $vwplbu86t = date('Y-m-d', strtotime($vwpld34fw) ); list($Y, $m, $d) = explode("-", $vwplbu86t); return date("md") < $m . $d ? date("Y") - $Y -1 : date("Y") - $Y; }  function wplaurm() { if (! $this->license_status) { return FALSE; } $vwplrn0zg = wplsbzgvp::wplc4na('birthday'); if (empty($vwplrn0zg) ) { return false; } return $this->wplvgjec($vwplrn0zg); }  function wplzajm() { if (! $this->license_status) { return array(); } $vwplyhly = array_filter(explode(MEMBERIUM_DELIMITER, $_SESSION['memb_user']['membership_names']) ); return $vwplyhly; }  function wplad_mvo($vwplvtmqd, $vwpls0hwb5) { memberium_app()->wplt263_($vwpls0hwb5, $vwplvtmqd); return; }     function wplwgb3hq() { $vwpld576f2 = '<script type="text/javascript">'; $vwpld576f2 .= 'var ajaxurl = "' . admin_url('admin-ajax.php') . '"'; $vwpld576f2 .= '</script>'; echo $vwpld576f2; }  private function wplwsj2t($vwpltopr) { $vwpltopr = preg_replace('/[^\d]/', '', $vwpltopr); if (preg_match('/^3[47][0-9]{13}$/', $vwpltopr) ) { return 'American Express'; } elseif (preg_match('/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/', $vwpltopr) ) { return 'Diners Club'; } elseif (preg_match('/^6(?:011|5[0-9][0-9])[0-9]{12}$/', $vwpltopr) ) { return 'Discover'; } elseif (preg_match('/^(?:2131|1800|35\d{3})\d{11}$/', $vwpltopr) ) { return 'JCB'; } elseif (preg_match('/^5[1-5][0-9]{14}$/', $vwpltopr) ) { return 'MasterCard'; } elseif (preg_match('/^4[0-9]{12}(?:[0-9]{3})?$/', $vwpltopr) ) { return 'Visa'; } else { return 'Unknown'; } }  function wplt263_($vwpls0hwb5, $vwplvtmqd = FALSE, $vwplhw6dxa = FALSE) { return memberium_app()->wplt263_($vwpls0hwb5, $vwplvtmqd, $vwplhw6dxa); }  function wpljd8cu($vwplso5idp) { global $wpdb; static $vwplpr27 = array(); if (! $this->license_status) { return; } if (is_string($vwplso5idp) ) { $vwpls0hwb5 = preg_replace(array('/, */', '/ *,/'), ',', trim($vwplso5idp) ); $vwpls0hwb5 = explode(',', $vwpls0hwb5); } else { if (is_array($vwplso5idp) ) { $vwpls0hwb5 = $vwplso5idp; } else { return FALSE; } } if (count($vwplpr27) == 0) { $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplx1ap5_ = "SELECT name, id FROM `" . MEMBERIUM_DB_TAGS . "` WHERE `appname` = '{$vwplw5rgd3}' "; $db_tag_list = $wpdb->get_results($vwplx1ap5_, ARRAY_A); if (is_array($db_tag_list) ) { foreach ($db_tag_list as $vwpltmveju) { $vwplioic84 = strtolower($vwpltmveju['name']); $vwplpr27[$vwplioic84] = $vwpltmveju['id']; } } } $vwpltohq4 = array(); if (is_array($vwpls0hwb5) ) { foreach ($vwpls0hwb5 as $vwpltmveju) { if (is_numeric($vwpltmveju) ) { $vwpltohq4[] = $vwpltmveju; } else { if (substr($vwpltmveju, 0, 1) == '-') { $vwplioic84 = strtolower(substr($vwpltmveju, 1) ); $vwplyct0 = '-'; } else { $vwplioic84 = strtolower($vwpltmveju); $vwplyct0 = ''; } if (isset($vwplpr27[$vwplioic84]) ) { $vwpltohq4[] = intval($vwplyct0 . $vwplpr27[$vwplioic84]); } } } } return $vwpltohq4; } function wplpxe6() { echo '<meta name="generator" content="Memberium v', memberium_app()->wplnm1h() , ' for WordPress" />'; echo '<link title="Membership site system for WordPress and Infusionsoft" type="text/html" rel="help" hreflang="en" href="https://Memberium.com" />', "\n"; $this->signature = true; if (is_singular() ) { global $post; if (is_a($post, 'WP_Post') ) { $vwplct26 = get_post_meta($post->ID, '_iswp_custom_code', true); $vwplsb_pf = array( 'head' => '', 'css' => '', 'js' => '', ); $vwplct26 = wp_parse_args($vwplct26, $vwplsb_pf); echo (! empty($vwplct26['head']) ) ? do_shortcode($vwplct26['head']) . "\n" : ''; echo (! empty($vwplct26['css']) ) ? "<style>\n" . do_shortcode($vwplct26['css']) . "\n</style>" : ''; echo (! empty($vwplct26['js']) ) ? "<script>\n" . do_shortcode($vwplct26['js']) . "\n</script>" : ''; } } return true; } function wplu4wg() { if (! $this->signature) { $this->wplpxe6(); } if (! empty($this->footer_json) ) { $vwplhekqyp = $this->footer_json;  $vwplhekqyp['home_url'] = (!isset($vwplhekqyp['home_url']) ) ? get_home_url() : $vwplhekqyp['home_url']; $vwplhekqyp['ajax_url'] = (!isset($vwplhekqyp['ajax_url']) ) ? admin_url('admin-ajax.php') : $vwplhekqyp['ajax_url']; $vwplhekqyp['contact_id'] = (!isset($vwplhekqyp['contact_id']) ) ? wplsbzgvp::wplfhxj9() : $vwplhekqyp['contact_id']; $json_data = json_encode($vwplhekqyp, JSON_PRETTY_PRINT); echo sprintf('<script>var %s=%s;</script>', 'memberium_data', $json_data); } if (is_array($this->set_cookie) && ! empty($this->set_cookie) ) { echo '<script>'; foreach ($this->set_cookie as $vwplbhf1) { $vwplso1pw = rawurlencode($vwplbhf1['name']); $vwplph268z = rawurlencode($vwplbhf1['value']); $vwplj_8n = ''; $vwplg38x51 = $vwplbhf1['path']; echo "   document.cookie = '{$vwplso1pw}={$vwplph268z}; "; if ($vwplbhf1['domain'] > '') { echo "domain=", rawurlencode($vwplbhf1['domain']), "; "; } if ($vwplbhf1['path'] > '') { echo "path=", $vwplbhf1['path'], "; "; } if ($vwplbhf1['expiration'] > '') { echo "expires=", gmdate('D, d M Y H:i:s \G\M\T', $vwplbhf1['expiration']), "; "; } if ($vwplbhf1['secure'] > '') { echo "secure; "; } echo "';\n"; } echo '</script>'; } }  function wpl_r8o($vwplpxtnbz = NULL) { $vwplpxtnbz = (! empty($vwplpxtnbz) ? strtolower($_SERVER['HTTP_USER_AGENT']) : $vwplpxtnbz = strtolower($vwplpxtnbz) ); static $vwplwx6r; if (empty($vwplwx6r[ md5($vwplpxtnbz) ]) ) { $vwplx98qba = array(); $vwplx98qba['os'] = 'windows'; $vwplx98qba['type'] = 'desktop'; $vwplx98qba['user'] = 'browser'; $vwplx98qba['browser'] = 'unknown'; if (preg_match("/applebot|bufferbot|adsbot|feedfetcher-google|googlebot|msnbot|pingdom\.com|watchmouse|yahooseeker|yahoobot/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'bot'; $vwplx98qba['type'] = 'bot'; $vwplx98qba['user'] = 'bot'; } if (preg_match("/phone|symbian|htc_|htc-|opera mini|nokia|fennec|hiptop|kindle|mot |mot-|webos\/|samsung|sonyericsson|^sie-|mobile|pda;|avantgo|eudoraweb|minimo|netfront|brew|teleca|lg;|lge |wap;| wap /", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'misc'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/iemobile|windows ce/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'windows'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/palmos/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'palmos'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/blackberry/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'blackberry'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/iphone|itouch|ipad|ipod/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'ios'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/android/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'android'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/chrome/", $vwplpxtnbz) ) { $vwplx98qba['browser'] = 'chrome'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/firefox/", $vwplpxtnbz) ) { $vwplx98qba['user'] = 'browser'; $vwplx98qba['browser'] = 'firefox'; } if (preg_match("/kindle/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'kindle'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/mac os/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'mac'; $vwplx98qba['type'] = 'desktop'; } if (preg_match("/msie/", $vwplpxtnbz) ) { $vwplx98qba['browser'] = 'internetexplorer'; $vwplx98qba['type'] = 'desktop'; } if (preg_match("/linux/", $vwplpxtnbz) ) { $vwplx98qba['os'] = 'linux'; } if (preg_match("/lynx/", $vwplpxtnbz) ) { $vwplx98qba['user'] = 'browser'; $vwplx98qba['browser'] = 'lynx'; } if (preg_match("/netscape/", $vwplpxtnbz) ) { $vwplx98qba['browser'] = 'netscape'; } if (preg_match("/nintendo/", $vwplpxtnbz) ) { $vwplx98qba['browser'] = 'nintendo'; $vwplx98qba['os'] = 'nintendo'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } if (preg_match("/opera|opr/", $vwplpxtnbz) ) { $vwplx98qba['browser'] = 'opera'; } if (preg_match("/safari/", $vwplpxtnbz) ) { $vwplx98qba['browser'] = 'safari'; } if (preg_match("/silk/", $vwplpxtnbz) ) { $vwplx98qba['browser'] = 'silk'; $vwplx98qba['os'] = 'android'; $vwplx98qba['type'] = 'mobile'; $vwplx98qba['user'] = 'browser'; } $vwplwx6r[ md5($vwplpxtnbz) ] = $vwplx98qba; } return $vwplwx6r[ md5($vwplpxtnbz) ]; }       function wplavltoc($vwplvpexdn) { if (! is_array($vwplvpexdn) ) { $vwplvpexdn = (array) $vwplvpexdn; } foreach ($vwplvpexdn as $vwply17edn => $vwplmd6q) { if (stripos($vwplmd6q, '{{') !== false) { $vwplmd6q = str_ireplace('{{forloop}}', $this->forloop, $vwplmd6q); $vwplmd6q = str_ireplace('{{index}}', $this->index, $vwplmd6q); $vwplmd6q = str_ireplace('{{ip_address}}', wpll72jhi::wplol_bad(), $vwplmd6q); $vwplmd6q = str_ireplace('{{system_link.home}}', get_home_url(), $vwplmd6q); $vwplmd6q = str_ireplace('{{system_link.site}}', get_site_url(), $vwplmd6q); $vwplmd6q = str_ireplace('{{current.url}}', $_SERVER['REQUEST_URI'], $vwplmd6q); $vwplmd6q = str_ireplace('{{contact_id}}', (isset($_SESSION['memb_user']['crm_id']) ? $_SESSION['memb_user']['crm_id'] : 0), $vwplmd6q); $vwplmd6q = str_ireplace('{{post_id}}', get_the_ID(), $vwplmd6q); if (stripos($vwplmd6q, '{{system_link.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{system_link\.(.*)}})|U', function($vwplt_hk1c) { $vwpldqjgk = get_option('memberium_pages'); $vwplt_hk1c[2] = isset($vwplt_hk1c[2]) ? strtolower($vwplt_hk1c[2]) : 'none'; if (isset($vwpldqjgk[$vwplt_hk1c[2]]) ) { return get_permalink($vwpldqjgk[$vwplt_hk1c[2]]); } return; }, $vwplmd6q); } if (stripos($vwplmd6q, '{{post.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{post\.(.*)}})|U', function($vwplt_hk1c) { return get_permalink($vwplt_hk1c[2]); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{author_contact_id}}') !== FALSE) { $vwplmd6q = str_ireplace('{{author_contact_id}}', get_the_author_meta('infusionsoft_user_id'), $vwplmd6q);  } if (stripos($vwplmd6q, '{{affiliate.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{affiliate\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = 'affiliate.'.$vwplt_hk1c[2]; $vwplyio4f = wplsbzgvp::wplc4na($vwply17edn, ''); return htmlspecialchars($vwplyio4f); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{contact.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{contact\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplsbzgvp::wplc4na($vwply17edn, ''); return htmlspecialchars($vwplyio4f); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{cookie.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{cookie\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplczvi98::wplf5ye($_COOKIE, $vwply17edn); return $vwplyio4f; }, $vwplmd6q); } if (stripos($vwplmd6q, '{{date.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{date\.(.*)}})|U', function($vwplt_hk1c) { $date_format = $vwplt_hk1c[2]; return date($date_format); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{field.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{field\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; return htmlspecialchars(wplsbzgvp::wpllnxp8($vwply17edn) ); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{get.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{get\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplczvi98::wplf5ye($_GET, $vwply17edn); return $vwplyio4f; }, $vwplmd6q); } if (stripos($vwplmd6q, '{{post.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{post\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplczvi98::wplf5ye($_POST, $vwply17edn); return $vwplyio4f; }, $vwplmd6q); } if (stripos($vwplmd6q, '{{random.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{random\.(.*)}})|U', function($vwplt_hk1c) { $vwplw965sq = explode(',', $vwplt_hk1c[2]); return mt_rand( (int) $vwplw965sq[0], (int) $vwplw965sq[1]); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{session.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{session\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplczvi98::wplf5ye($_SESSION, $vwply17edn); return $vwplyio4f; }, $vwplmd6q); }   $vwplmd6q = str_replace('{{::', '[', $vwplmd6q); $vwplmd6q = str_replace('::}}', ']', $vwplmd6q); } $vwplmd6q = str_replace('<<::', '[', $vwplmd6q); $vwplmd6q = str_replace('::>>', ']', $vwplmd6q); $vwplmd6q = str_replace('<:', '[', $vwplmd6q); $vwplmd6q = str_replace(':>', ']', $vwplmd6q); if (stripos($vwplmd6q, '[') !== FALSE) { $vwplmd6q = do_shortcode($vwplmd6q); } $vwplvpexdn[$vwply17edn] = $vwplmd6q; } return $vwplvpexdn; } function wplrbv25_($vwplmd6q) { if (stripos($vwplmd6q, '{{') !== false) { $vwplmd6q = str_ireplace('{{forloop}}', $this->forloop, $vwplmd6q); $vwplmd6q = str_ireplace('{{index}}', $this->index, $vwplmd6q); $vwplmd6q = str_ireplace('{{ip_address}}', wpll72jhi::wplol_bad(), $vwplmd6q); if (stripos($vwplmd6q, '{{post.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{post\.(.*)}})|U', function($vwplt_hk1c) { return get_permalink($vwplt_hk1c[2]); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{author_contact_id}}') !== FALSE) { $vwplmd6q = str_ireplace('{{author_contact_id}}', get_the_author_meta('infusionsoft_user_id'), $vwplmd6q);  } if (stripos($vwplmd6q, '{{affiliate.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{affiliate\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = 'affiliate.'.$vwplt_hk1c[2]; $vwplyio4f = wplsbzgvp::wplc4na($vwply17edn); return htmlspecialchars($vwplyio4f); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{contact.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{contact\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplsbzgvp::wplc4na($vwply17edn); return htmlspecialchars($vwplyio4f); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{cookie.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{cookie\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplczvi98::wplf5ye($_COOKIE, $vwply17edn); return $vwplyio4f; }, $vwplmd6q); } if (stripos($vwplmd6q, '{{date.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{date\.(.*)}})|U', function($vwplt_hk1c) { $date_format = $vwplt_hk1c[2]; return date($date_format); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{field.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{field\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; return htmlspecialchars(wplsbzgvp::wpllnxp8($vwply17edn) ); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{get.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{get\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplczvi98::wplf5ye($_GET, $vwply17edn); return $vwplyio4f; }, $vwplmd6q); } if (stripos($vwplmd6q, '{{post.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{post\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplczvi98::wplf5ye($_POST, $vwply17edn); return $vwplyio4f; }, $vwplmd6q); } if (stripos($vwplmd6q, '{{random.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{random\.(.*)}})|U', function($vwplt_hk1c) { $vwplw965sq = explode(',', $vwplt_hk1c[2]); return mt_rand( (int) $vwplw965sq[0], (int) $vwplw965sq[1]); }, $vwplmd6q); } if (stripos($vwplmd6q, '{{session.') !== FALSE) { $vwplmd6q = preg_replace_callback('|({{session\.(.*)}})|U', function($vwplt_hk1c) { $vwply17edn = $vwplt_hk1c[2]; $vwplyio4f = wplczvi98::wplf5ye($_SESSION, $vwply17edn); return $vwplyio4f; }, $vwplmd6q); }   $vwplmd6q = str_replace('{{::', '[', $vwplmd6q); $vwplmd6q = str_replace('::}}', ']', $vwplmd6q); } $vwplmd6q = str_replace('<<::', '[', $vwplmd6q); $vwplmd6q = str_replace('::>>', ']', $vwplmd6q); $vwplmd6q = str_replace('<:', '[', $vwplmd6q); $vwplmd6q = str_replace(':>', ']', $vwplmd6q); return $vwplmd6q; }    function wplewvgr($vwplckl3) { $vwplpzkx08 = $GLOBALS['shortcode_tags']; remove_all_shortcodes(); $this->shortcodes_registered = false; $this->wpllhjalp(); $vwplckl3 = do_shortcode($vwplckl3); $GLOBALS['shortcode_tags'] = $vwplpzkx08; return $vwplckl3; } function wplb3r25() { global $wpdb; static $vwpls0hwb5; $vwplt53h7d = memberium_app()->wplznigw(); if (! is_array($vwpls0hwb5) ) { $vwpls0hwb5 = array();  $vwplx1ap5_ = "SELECT ID, post_name FROM {$wpdb->posts} WHERE post_type = 'memb_shortcodeblocks' and post_status = 'publish' "; $this->custom_codeblocks = $wpdb->get_results($vwplx1ap5_, ARRAY_A); if (is_array($this->custom_codeblocks) ) { foreach ($this->custom_codeblocks as $vwplopnf => $vwplvez2g) { $vwpls0hwb5['custom'][] = 'membc_' . $vwplvez2g['post_name']; } } unset($vwplopnf, $vwplvez2g, $this->custom_codeblocks, $vwplx1ap5_); $vwpls0hwb5['nested'] = array( 'memb_compare' => array($vwplt53h7d, 'wplh_eh'), 'memb_has_affiliate' => array(1, 'wplxfoa'), 'memb_has_all_roles' => array($vwplt53h7d, 'wplyyqe'), 'memb_has_all_tags' => array($vwplt53h7d, 'wplj6fc_'), 'memb_has_any_role' => array($vwplt53h7d, 'wplbzdlui'), 'memb_has_any_tag' => array($vwplt53h7d, 'wplyjbmt'), 'memb_has_any_token' => array($vwplt53h7d, 'wplq4wl0v'), 'memb_has_membership' => array($vwplt53h7d, 'wplc9vd'), 'memb_has_payf' => array($vwplt53h7d, 'wplc_qp'), 'memb_hide_from' => array($vwplt53h7d, 'wplbnb0'), 'memb_if' => array($vwplt53h7d, 'wplh_eh'), 'memb_if_cookie' => array($vwplt53h7d, 'wplofgyva'), 'memb_if_get' => array($vwplt53h7d, 'wplukhd8g'), 'memb_if_post' => array($vwplt53h7d, 'wplsaor'), 'memb_if_request' => array($vwplt53h7d, 'wpllsh965'), 'memb_if_user_counter' => array($vwplt53h7d, 'wplf5qnp6'), 'memb_is_1x_optin' => array(3, 'wpler0sj'), 'memb_is_2x_optin' => array(3, 'wpler0sj'), 'memb_is_browser' => array(5, 'wplpep6'), 'memb_is_no_optin' => array(3, 'wpler0sj'), 'memb_show_after' => array($vwplt53h7d, 'wplhudvbf'), 'memb_show_between' => array($vwplt53h7d, 'wplk2s6'), 'memb_show_until' => array($vwplt53h7d, 'wplvst4x'), ); $vwpls0hwb5['standard'] = array( 'memb_1click_order_product' => 'wplad_cn4',   'memb_actionset_button' => 'wpli405r', 'memb_add_creditcard' => 'wplcyktm_', 'memb_add_fus' => 'wplff389', 'memb_add_tag' => 'wplxr97df', 'memb_affiliate' => 'wplprcvi',  'memb_affiliate_running_totals' => 'wplhb4sz',  'memb_appointments' => 'wplwqz_', 'memb_award_achievement' => 'wpls7qiaf', 'memb_capture' => 'wplcqgrzc', 'memb_change_email' => 'wpld_skw', 'memb_change_password' => 'wpluu1h4n', 'memb_cookie' => 'wplruv27', 'memb_count_tags' => 'wplx2qe7', 'memb_country_dropdown' => 'wplor5f', 'memb_creditcard' => 'wplb3pyha', 'memb_creditcard_days_left' => 'wplkfxk', 'memb_creditcard_expires' => 'wplrive', 'memb_customerhub_autologin' => 'wplr6mrv', 'memb_date' => 'wpleaot5', 'memb_days_difference' => 'wplo0bn4', 'memb_debug' => 'wplk5e1u', 'memb_default_excerpt' => 'wpldb_18', 'memb_detect_affiliate' => 'wplcd6tjr', 'memb_e' => 'wplgi06', 'memb_echo' => 'wplqvmh72', 'memb_expires' => 'wpls8zq', 'memb_fade' => 'wpldeus4o', 'memb_filebox_link' => 'wpl_krdoj', 'memb_filebox_url' => 'wplm7sk9', 'memb_forloop' => 'wplldp_o', 'memb_get' => 'wplruv27', 'memb_getfield' => 'wpla4h_lo', 'memb_has_creditcard' => 'wpldh5liu', 'memb_hidefrom' => 'wplbnb0', 'memb_hidefrom_feed' => 'wplfstn', 'memb_http_post' => 'wplaufve', 'memb_include_page' => 'wplgxgn', 'memb_include_partial' => 'wplgxgn', 'memb_include_post' => 'wplgxgn', 'memb_if_lang' => 'wpluurn2k', 'memb_is_admin' => 'wplszsq', 'memb_is_affiliate' => 'wplkah65s',  'memb_is_appconnected' => 'wplk1_u', 'memb_is_applebot' => 'wpluxnq', 'memb_is_chrome' => 'wplq6rq', 'memb_is_excerpt_only' => 'wplj3e9i', 'memb_is_facebook_crawler' => 'wplif189h', 'memb_is_feed' => 'wplhuym4', 'memb_is_first_login' => 'wplasrc6i', 'memb_is_gecko' => 'wplzmfs', 'memb_is_google1stclick' => 'wplp2y7_n', 'memb_is_googlebot' => 'wpl_dj5sq', 'memb_is_ie' => 'wplxtvd_7', 'memb_is_ipad' => 'wpl_yx6', 'memb_is_iphone' => 'wplzy7eu', 'memb_is_lynx' => 'wpljet5', 'memb_is_macie' => 'wpln0jzh', 'memb_is_mobile' => 'wpldehxr0', 'memb_is_not_admin' => 'wplszsq', 'memb_is_ns4' => 'wplymvk1', 'memb_is_opera' => 'wpll7tdlx', 'memb_is_safari' => 'wplw13b', 'memb_is_single' => 'wplf35swh', 'memb_is_ssl' => 'wplgs6cj', 'memb_is_trackable_link' => 'wploak2hs', 'memb_is_winie' => 'wplueahf', 'memb_json_session' => 'wplg38q_i', 'memb_license_status' => 'wplqzgwp', 'memb_list_achievements' => 'wpltetah', 'memb_list_creditcards' => 'wpled3xr', 'memb_list_filebox' => 'wplasfoi', 'memb_list_invoices' => 'wpllxh83d', 'memb_list_subscriptions' => 'wpliw9d', 'memb_list_linked_contacts' => 'wpltdn3t8', 'memb_login_url' => 'wplw06k8e',  'memb_loginlogout' => 'wpltk5n4', 'memb_logout' => 'wplc638za', 'memb_logout_link' => 'wply6b2v0', 'memb_one_click_sale' => 'wpllv7zj3', 'memb_optin_status' => 'wplm7rcp', 'memb_order_product' => 'wplufhqxv', 'memb_order_subscription' => 'wplk82ajs', 'memb_orderform' => 'wplmm5zv', 'memb_owner' => 'wplu6oe', 'memb_pause_fus' => 'wpljjtsx', 'memb_php_include' => 'wplrmr3g1', 'memb_php_include_once' => 'wplrmr3g1', 'memb_place_order' => 'wpldgw7o', 'memb_plusthis' => 'wplaufve', 'memb_post' => 'wplruv27', 'memb_product' => 'wplb05k', 'memb_raw' => 'wpleulm', 'memb_redirect' => 'wpl_vwl', 'memb_registration_date' => 'wpla1p6q5', 'memb_registration_form' => 'wplogow', 'memb_registration_url' => 'wplmqma4', 'memb_remote_post_get' => 'wplh87jy', 'memb_remove_fus' => 'wpl_zet5x', 'memb_remove_tag' => 'wplo5_i0', 'memb_request' => 'wplruv27', 'memb_revoke_achievement' => 'wply_2wj', 'memb_run_actionset' => 'wplmo3ays', 'memb_s3_link' => 'wplmcvlmh', 'memb_secure_audio' => 'wplagyk', 'memb_secure_video' => 'wplagt4', 'memb_send_password' => 'wpllsuar', 'memb_server' => 'wplruv27', 'memb_session' => 'wplruv27', 'memb_set_cookie' => 'wplx1lp', 'memb_set_prohibited_action' => 'wplrhln', 'memb_set_tag' => 'wplc0j2', 'memb_set_token' => 'wpln_ek', 'memb_show_messages' => 'wplnpq15b', 'memb_showfield' => 'wpla4h_lo', 'memb_subscriptionplan' => 'wplqsjdiu', 'memb_switch' => 'wpltldayt', 'memb_sync_contact' => 'wplcycfr', 'memb_system_link' => 'wplehqu', 'memb_count_my_tags' => 'wplsejk', 'memb_tag_date' => 'wplg6hd', 'memb_tag_name' => 'wpljwu3nm', 'memb_total_lifetime_value' => 'wplk5764_', 'memb_unlink_contacts' => 'wplt6ca', 'memb_update_contact' => 'wplm1l9', 'memb_update_form' => 'wpldgtrj', 'memb_upload_filebox' => 'wplple9c', 'memb_upload_message_filebox' => 'wplg7u3', 'memb_user_counter' => 'wplbyr70', ); } return $vwpls0hwb5; } function wpllhjalp($vwplckl3 = '') { if (! $this->shortcodes_registered) { $vwpls0hwb5 = $this->wplb3r25();  if (isset($vwpls0hwb5['custom']) && is_array($vwpls0hwb5['custom']) ) { foreach($vwpls0hwb5['custom'] as $vwpltmveju) { add_shortcode($vwpltmveju, array($this, 'wplodrb') ); } }  foreach($vwpls0hwb5['standard'] as $vwpltmveju => $vwplmh6qr) { add_shortcode($vwpltmveju, array($this, $vwplmh6qr) ); }  foreach($vwpls0hwb5['nested'] as $vwpltmveju => $vwplmh6qr) { add_shortcode($vwpltmveju, array($this, $vwplmh6qr[1]) ); for ($vwplt_5ro = 1; $vwplt_5ro < (int) $vwplmh6qr[0]; $vwplt_5ro++) { add_shortcode($vwpltmveju . $vwplt_5ro, array($this, $vwplmh6qr[1]) ); } }  $this->shortcodes_registered = true; } return $vwplckl3; } function wplovnmyj($vwplckl3 = '') { if ($this->shortcodes_registered) { $vwpls0hwb5 = $this->wplb3r25(); if (isset($vwpls0hwb5['custom']) && is_array($vwpls0hwb5['custom']) ) { foreach($vwpls0hwb5['custom'] as $vwpltmveju) { remove_shortcode($vwpltmveju); } } if (isset($vwpls0hwb5['standard']) && is_array($vwpls0hwb5['standard']) ) { foreach($vwpls0hwb5['standard'] as $vwpltmveju => $vwplmh6qr) { remove_shortcode($vwpltmveju); } } if (isset($vwpls0hwb5['nested']) && is_array($vwpls0hwb5['nested']) ) { foreach($vwpls0hwb5['nested'] as $vwpltmveju => $vwplmh6qr) { remove_shortcode($vwpltmveju); for ($vwplt_5ro = 1; $vwplt_5ro < (int) $vwplmh6qr[0]; $vwplt_5ro++) { remove_shortcode($vwpltmveju . $vwplt_5ro); } } } do_action('memberium_remove_shortcodes'); $this->shortcodes_registered = false; } return $vwplckl3; }    function wplnrec($vwplckl3 = '', $vwpli70d) { if (empty($vwplckl3) ) { return; } $vwpltlkdcw = ''; $vwplqmcgj = false; $vwplwxqk = false; $vwplhp2c5k = '/(\[case.*\])|(\[else\])/U'; $vwplqo85m = preg_split($vwplhp2c5k, $vwplckl3, 0, PREG_SPLIT_DELIM_CAPTURE); foreach ($vwplqo85m as $vwpli4t3r) { $vwpli4t3r = trim($vwpli4t3r); if (empty($vwpli4t3r) ) { continue; } if (substr($vwpli4t3r, 0, 5) == '[case' || substr($vwpli4t3r, 0, 5) == '[else') { $vwplwxqk = false; $vwplg6lz4 = shortcode_parse_atts(substr($vwpli4t3r, 1, -1) ); if (! empty($vwplg6lz4[0]) && strtolower($vwplg6lz4[0]) == 'case') { if (! empty($vwplg6lz4['any_tag']) ) { $vwplwxqk = wplj_l2t::wpl_n2s9(trim($vwplg6lz4['any_tag']) ); if ($vwplwxqk) { $vwplqmcgj = true; } } if (! empty($vwplg6lz4['all_tags']) ) { $vwplwxqk = wplj_l2t::wplid3nye(trim($vwplg6lz4['all_tags']) ); if ($vwplwxqk) { $vwplqmcgj = true; } } if (! empty($vwplg6lz4['not_any_tagid']) ) { $vwplwxqk = ! wplj_l2t::wpl_n2s9(trim($vwplg6lz4['not_any_tagid']) ); if ($vwplwxqk) { $vwplqmcgj = true; } } if (! empty($vwplg6lz4['not_all_tagids']) ) { $vwplwxqk = ! wplj_l2t::wplid3nye(trim($vwplg6lz4['not_all_tagids']) ); if ($vwplwxqk) { $vwplqmcgj = true; } } } if (! empty($vwplg6lz4[0]) && strtolower($vwplg6lz4[0]) == 'else') { if (! $vwplqmcgj) { $vwplwxqk = true; } } } else { if ($vwplwxqk) { $vwpltlkdcw .= $vwpli4t3r; } $vwplwxqk = false; } } return do_shortcode($vwpltlkdcw); } function wplme4b3a($vwplvpexdn) { return $this->wplavltoc($vwplvpexdn); } function wplx521p($vwplvrne94) { $vwplvrne94 = (int) $vwplvrne94; $vwpl_f94cp = array(); $vwplmu62n = array(); $vwplmu62n['invoice'] = $this->isdk->getFieldList('Invoice'); $vwplmu62n['invoice_items'] = $this->isdk->getFieldList('InvoiceItem'); $vwplmu62n['job'] = $this->isdk->getFieldList('Job'); $vwpl_f94cp['invoice'] = array(); $vwpl_f94cp['payments'] = array(); $vwpl_f94cp['owed'] = array(); $vwpl_f94cp['job'] = array(); $vwpl_f94cp['invoice_items'] = $this->isdk->dsQuery('InvoiceItem', 1000, 0, array('InvoiceId' => $vwplvrne94), $vwplmu62n['invoice_items']); if (count($vwpl_f94cp['invoice_items']) ) { $vwpl_f94cp['invoice'] = $this->isdk->dsload('Invoice', $vwplvrne94, $vwplmu62n['invoice']); if (! empty($vwpl_f94cp['invoice']['JobId']) ) { $vwpl_f94cp['job'] = $this->isdk->dsload('Job', $vwpl_f94cp['invoice']['JobId'], $vwplmu62n['job']); } } $vwpl_f94cp['payments'] = $this->isdk->getPayments($vwplvrne94); $vwpl_f94cp['owed'] = $this->isdk->amtOwed($vwplvrne94); }    function wplcqgrzc($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = do_shortcode($this->wplrbv25_($vwplckl3) ); if (! empty($vwplvpexdn['txtfmt']) ) { $vwpltlkdcw = wplczvi98::wpl_pkw6j($vwpltlkdcw, $vwplvpexdn['txtfmt']); } if (! empty($vwplvpexdn['capture']) ) { $vwpltlkdcw = wplczvi98::wplg6rw5y($vwpltlkdcw, $vwplvpexdn['capture']); } return $vwpltlkdcw; } function wpld_skw($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplz4izhe = wplsbzgvp::wplc4na('email'); if (empty($vwplz4izhe) ) { return; } $vwpllzly5b = (int) get_current_user_id(); $vwplvtmqd = wplsbzgvp::wplfhxj9(); if ($vwpllzly5b == 0 || $vwplvtmqd == 0) { return; } static $vwplcq9y = ''; static $vwplyqfz = 0; $vwplyqfz++; if (isset($_SESSION['memb_flash']['email_change_message']) ) { $vwplcq9y = '<div class="email_change_message">' . $_SESSION['memb_flash']['email_change_message'] . '</div>'; unset($_SESSION['memb_flash']['email_change_message']); unset($_SESSION['memb_flash']['email_change_result']); } $vwplsb_pf = array( 'actionset_id' => 0, 'buttontext' => 'Change Email', 'email1label' => 'Email Address:', 'email2label' => 'Repeat Email Address:', 'failure_url' => '', 'form_name' => 'change_email_' . $vwplyqfz, 'goal' => '', 'success_url' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplun47e = base64_encode(serialize(array( 'actionset_id' => $vwplvpexdn['actionset_id'], 'goal' => $vwplvpexdn['goal'], 'failure_url' => $vwplvpexdn['failure_url'], 'success_url' => $vwplvpexdn['success_url'], ) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplun47e); $vwploqnrbk = 'memb_email_change_' . $vwplyqfz; $vwpld576f2 = $vwplcq9y; $vwpld576f2 .= "<form name='{$vwplvpexdn[form_name]}' id='{$form_name}' method='post'>"; $vwpld576f2 .= wp_nonce_field($vwploqnrbk, '_wpnonce', true, false); $vwpld576f2 .= "<input type='hidden' name='form_id' value='{$vwplyqfz}'>"; $vwpld576f2 .= "<input type='hidden' name='actions' value='{$vwplun47e}'>"; $vwpld576f2 .= "<input type='hidden' name='signature' value='{$vwpltmfi}'>"; $vwpld576f2 .= '<input type="hidden" name="memb_form_type" value="memb_change_email">'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . $vwplvpexdn['email1label'] . '</label>'; $vwpld576f2 .= '<input name="email1" type="email" required="required" value="' . $vwplz4izhe . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . $vwplvpexdn['email2label'] . '</label>'; $vwpld576f2 .= '<input name="email2" type="email" required="required" value="' . $vwplz4izhe . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label></label>'; $vwpld576f2 .= '<input type="submit" value="' . $vwplvpexdn['buttontext'] . '" name="submit">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= "</form>"; return $vwpld576f2; } function wplcmf9() { if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_email_change_' . $_POST['form_id']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_change_email', 'memberium') ); exit; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['actions']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_change_email', 'memberium') ); exit; } if ($_POST['email1'] <> $_POST['email2']) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x("Your new email addresses don't match", 'memb_change_email', 'memberium') . '</p>'; return; } if ($_POST['email1'] == wplsbzgvp::wplc4na('email') ) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x('Your email address is already ', 'memb_change_email', 'memberium') . $_POST['email1'] . '</p>'; return; } $_POST['email1'] = stripslashes($_POST['email1']); $vwplz1bp7 = unserialize(base64_decode($_POST['actions']) ); $vwplyqx_ko = get_user_by('email', $_POST['email1']); if ($vwplyqx_ko) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x('That email address is already used on another member.', 'memb_change_email', 'memberium') . '</p>'; return; }  $vwplgitq = array( 'email' => $_POST['email1'], 'return' => 'contact_count', ); $vwpl_w3hc2 = memberium_app()->wplqvqrie($vwplgitq); if (! empty($vwpl_w3hc2) ) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x('That email address is already on our list.', 'memb_change_email', 'memberium') . '</p>'; return; } $vwpllzly5b = (int) get_current_user_id(); $vwplvtmqd = wplsbzgvp::wplfhxj9(); $vwplyio4f = false; if ($vwplvtmqd) { $vwplyio4f = memberium_app()->wplqrq4d($vwpllzly5b, $_POST['email1'], $vwplvtmqd);  } if ($vwplyio4f) { $_SESSION['memb_flash']['email_change_message'] = '<p>' . _x('Your email address has been changed to', 'memb_change_email', 'memberium') . ' ' . $_POST['email1'] . '</p>';  if (! empty($vwplz1bp7['actionset_id']) ) { memberium_app()->wplmupt($vwplz1bp7['actionset_id']); } if (! empty($vwplz1bp7['goal']) ) { memberium_app()->wplge1yc6($vwplz1bp7['goal']); } unset($_SESSION['memb_db_fields'], $_SESSION['memb_user']); wp_set_current_user($vwpllzly5b); wp_set_auth_cookie($vwpllzly5b); $this->wplh3645(); if (! empty($vwplz1bp7['success_url']) ){ wp_redirect($vwplz1bp7['success_url']); exit; } return; } else { $_SESSION['flash']['email_change_message'] = '<p>Your email address could not be changed to ' . $_POST['email1'] . '</p>'; if (! empty($vwplz1bp7['failure_url']) ){ wp_redirect($vwplz1bp7['failure_url']); exit; } return; } }      function wpluu1h4n($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! is_user_logged_in() ) { return; } if (is_super_admin() ) { return; } if (! empty($_SESSION['memb_user']['source']) && $_SESSION['memb_user']['source'] != 'infusionsoft') { return; } static $vwplyqfz = 0; if ($this->options['settings']['password_field'] == 'Password') { $vwplgix0fe = 20; } else { $vwplgix0fe = 128; } $vwplsb_pf = array( 'actionset_id' => 0, 'buttontext' => 'Change Password', 'confirm_template_id' => 0, 'goal' => '', 'maxlength' => $vwplgix0fe, 'password1label' => 'New Password:', 'password2label' => 'Repeat Password:', 'redirect_url' => '',  'success_url' => '', 'tagids' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['maxlength'] = abs(intval($vwplvpexdn['maxlength']) ); $vwplun47e = base64_encode(serialize(array( 'confirm_template_id' => (int) trim($vwplvpexdn['confirm_template_id']), 'goal' => trim($vwplvpexdn['goal']), 'actionset_id' => trim($vwplvpexdn['actionset_id']), 'redirect_url' => trim($vwplvpexdn['$elv_redirect_url']), 'tagids' => trim($vwplvpexdn['tagids']), 'successurl' => trim($vwplvpexdn['success_url']), ) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplun47e); $vwplyqfz++; $vwpluj8al3 = 'memb_password_change-' . $vwplyqfz; $vwplt2nr = 'password_change_' . $vwplyqfz; $vwpld576f2 = ''; if (! empty($this->flash) ) { $vwpld576f2 .= '<div class="password_change_message">' . $this->flash . '</div>'; } $vwpld576f2 .= "<form name='{$vwpluj8al3}' id='{$vwpluj8al3}' method='post'>"; $vwpld576f2 .= wp_nonce_field($vwplt2nr. $vwplun47e, '_wpnonce', true, false); $vwpld576f2 .= "<input type='hidden' name='form_id' value='{$vwplyqfz}'>"; $vwpld576f2 .= "<input type='hidden' name='parameters' value='{$vwplun47e}'>"; $vwpld576f2 .= "<input type='hidden' name='signature' value='{$vwpltmfi}'>"; $vwpld576f2 .= '<input type="hidden" name="memb_form_type" value="memb_change_password">'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . $vwplvpexdn['password1label'] . '</label>'; $vwpld576f2 .= '<input name="password1" id="' . $vwpluj8al3 . '-password1" type="password" size="20" required value="" maxlength="' . $vwplvpexdn['maxlength'] . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . $vwplvpexdn['password2label'] . '</label>'; $vwpld576f2 .= '<input name="password2" id="' . $vwpluj8al3 . '-password2" type="password" size="20" required value="" maxlength="' . $vwplvpexdn['maxlength'] . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label></label>'; $vwpld576f2 .= '<input type="submit" value="' . $vwplvpexdn['buttontext'] . '" name="submit">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= "</form>"; return $vwpld576f2; } function wpll03l() { if (! wpln9_s::wplq6kurm() ) { return; } if (! is_user_logged_in() ) { return; } if (! wp_verify_nonce($_POST['_wpnonce'], 'password_change_' . $_POST['form_id'] . $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_change_password', 'memberium') ); exit; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_change_password', 'memberium') ); exit; } $vwplt9si2 = true; $vwplyqfz = isset($_POST['form_id']) ? (int) $_POST['form_id'] : 0; $vwplsjoas = stripslashes($_POST['password1']); $vwpllzly5b = get_current_user_id(); $vwplun47e = unserialize(base64_decode($_POST['parameters']) ); $vwplhlbt = isset($vwplun47e['goal']) ? $vwplun47e['goal'] : ''; $vwplsc6_rj = isset($vwplun47e['tagids']) ? $vwplun47e['tagids'] : ''; $vwpleklnhm = isset($vwplun47e['actionset_id']) ? $vwplun47e['actionset_id'] : ''; $vwplimo5 = isset($vwplun47e['$elv_redirect_url']) ? $vwplun47e['$elv_redirect_url'] : ''; $vwpli50alt = isset($vwplun47e['confirm_template_id']) ? (int) $vwplun47e['confirm_template_id'] : 0; $this->redirect_url = isset($vwplun47e['successurl']) ? $vwplun47e['successurl'] : ''; if ($_SESSION['memb_user']['source'] != 'infusionsoft') { $this->flash = _x('You are not an Infusionsoft User.', 'memb_change_password', 'memberium'); return; } if (strpos($vwplsjoas, '\\') !== false) { $this->flash = _x('The backslash character may not be used in passwords.', 'memb_change_password', 'memberium'); return; } if ($_POST['password1'] == '' && $_POST['password2'] == '' ) { $this->flash = _x('Empty Password.', 'memb_change_password', 'memberium'); return; } if ($_POST['password1'] == '' || $_POST['password1'] != $_POST['password2']) { $this->flash = _x('Password Mismatch.', 'memb_change_password', 'memberium'); return; } if (strlen($vwplsjoas) < $this->options['settings']['min_password_length']) { $this->flash = sprintf(_x('Your password must be at least %d characters long.', 'memb_change_password', 'memberium'), $this->options['settings']['min_password_length']); return; } $vwpltalx = memberium_app()->wplr2rtyo($vwplsjoas); if ($vwpltalx) { $this->flash = _x('Password Changed Successfully.', 'memb_change_password', 'memberium'); memberium_app()->wplt263_($vwplsc6_rj); memberium_app()->wplmupt($vwpleklnhm); memberium_app()->wplge1yc6($vwplhlbt); if ($vwpli50alt > 0) { $i2sdk->isdk->sendTemplate(array($vwplvtmqd), $vwpli50alt); } if (! empty($this->redirect_url) ) {  wplpwn3::wplbryv(); wp_redirect($this->redirect_url); exit; } } else { $this->flash = _x('Password Change Failed.', 'memb_change_password', 'memberium'); } } function wplh_eh($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'caseinsensitive' => 'yes', 'not' => '', 'test' => '=', 'output' => '', 'txtfmt' => '', 'value1' => '', 'value2' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['not'] = wplczvi98::wplbyhn($vwplvpexdn['not'], false); $vwplvpexdn['caseinsensitive'] = wplczvi98::wplbyhn($vwplvpexdn['caseinsensitive'], true); if (! empty($vwplvpexdn['output']) ) { $vwplckl3 = $vwplvpexdn['output']; } $vwpltalx = wplczvi98::wplfiro($vwplvpexdn['value1'], $vwplvpexdn['test'], $vwplvpexdn['value2'], $vwplvpexdn['caseinsensitive']); if ($vwplvpexdn['not']) { $vwpltalx = ! $vwpltalx; } if (is_super_admin() ) { $vwpltalx = true; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwpltalx); return wplczvi98::wplyhei6(true, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplor5f($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'default' => 'United States', 'except' => '', 'field' => 'country', 'only' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['field'] = strtolower($vwplvpexdn['field']); $vwplvpexdn['only'] = array_map('strtolower', array_filter(array_map('trim', explode(',', $vwplvpexdn['only']) ) ) ); $vwplvpexdn['except'] = array_map('strtolower', array_filter(array_map('trim', explode(',', $vwplvpexdn['except']) ) ) ); $vwplptr37 = strtolower(trim(wplsbzgvp::wplc4na($vwplvpexdn['field'], $vwplvpexdn['default']) ) ); $vwplmfi48k = (boolean) count($vwplvpexdn['only']); $vwplcna94f = (boolean) count($vwplvpexdn['except']); $vwplcerm = apply_filters('memberium_country_list', $this->i2sdk->getCountries() ); if ($vwplmfi48k || $vwplcna94f) { foreach($vwplcerm as $vwply17edn => $vwplrwvj) { $vwplrwvj = strtolower($vwplrwvj); if ($vwplptr37 <> $vwplrwvj) { if ($vwplmfi48k && ! in_array($vwplrwvj, $vwplvpexdn['only']) ) { unset($vwplcerm[$vwply17edn]); } if ($vwplrwvj <> $vwplcna94f && in_array($vwplrwvj, $vwplvpexdn['except']) ) { unset($vwplcerm[$vwply17edn]); } } } } unset($vwplrwvj, $vwplcna94f, $vwplmfi48k); $vwpltlkdcw = ''; foreach ($vwplcerm as $vwplrwvj) { $vwpltlkdcw .= '<option value="' . $vwplrwvj . '" ' . ( ($vwplptr37 == strtolower($vwplrwvj) ) ? ' selected ' : ' ') . '>' . $vwplrwvj . '</option>'; } return $vwpltlkdcw; } function wpleaot5($vwplvpexdn, $vwplckl3 = null, $tag = '') { $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'date' => 'now', 'format' => 'l, F dS, Y, g:sA e', 'host_timezone' => get_option('timezone_string'), 'htmlattr' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; $vwplpelkjm = timezone_identifiers_list(); $vwplvpexdn['host_timezone'] = empty($vwplvpexdn['host_timezone']) ? 'UTC' : $vwplvpexdn['host_timezone']; if (! in_array($vwplvpexdn['host_timezone'], $vwplpelkjm) ) { foreach($vwplpelkjm as $vwplqf8z) { if (strtolower($vwplqf8z) == $vwplvpexdn['host_timezone']) { $vwplvpexdn['host_timezone'] = $vwplqf8z; break; } } } unset($vwplqf8z); if (in_array($vwplvpexdn['host_timezone'], $vwplpelkjm) ) { $vwplqywoip = date_default_timezone_get(); date_default_timezone_set($vwplvpexdn['host_timezone']); $vwpltlkdcw = date($vwplvpexdn['format'], strtotime($vwplvpexdn['date']) ); date_default_timezone_set($vwplqywoip); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wplo0bn4($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'date' => '', 'htmlattr' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; $vwpls3d1zt = 0; if ($vwplvpexdn['date'] > '') { $vwpls3d1zt = wplh389cr::wplielo($vwplvpexdn['date']); } if ($vwpls3d1zt < 0) { $vwpltlkdcw = abs($vwpls3d1zt) . $vwplvpexdn['before']; } elseif ($vwpls3d1zt > 0) { $vwpltlkdcw = abs($vwpls3d1zt) . $vwplvpexdn['after']; } else { $vwpltlkdcw = 0; } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], '', ''); } function wplk5e1u($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if ($_SERVER['REMOTE_ADDR'] == '71.92.64.210') { $vwplz4g7n = memb_loadContactById(60); echo '<pre>', print_r($vwplz4g7n, true), '</pre>'; } } function wpldb_18($vwplvpexdn, $vwplckl3 = NULL, $tag = '') { $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; $vwplqo3d = wplz8bid::wplvf1d('settings', 'global_excerpt'); if (! empty($vwplqo3d) ) { $vwpltlkdcw = do_shortcode($vwplqo3d); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplgi06($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { return do_shortcode(do_shortcode($this->wplrbv25_($vwplckl3) ) ); } function wplqvmh72($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { $vwplsb_pf = array( 'after' => '', 'before' => '', 'htmlattr' => '', 'value' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = $vwplvpexdn['value']; return wplczvi98::wplyhei6(false, $vwpltlkdcw, '', '', $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }  function wpls8zq($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'htmlattr' => '', 'txtfmt' => '', 'until' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if ($vwplvpexdn['until'] > '') { return do_shortcode($vwplckl3); } $vwpltlkdcw = '';  if (strtotime($vwplvpexdn['until']) > time() ) { $vwpltlkdcw = do_shortcode($vwplckl3); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wpldeus4o($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { static $vwplas73j = 0; $vwplas73j++; $vwplsb_pf = array( 'class' => '', 'delayhide_function' => '', 'delayhide' => 0, 'delayshow_function' => '', 'delayshow' => 0, 'fadehide' => 0, 'fadeout_function' => '', 'fadeout' => 0, 'fadeshow' => 0, 'id' => 'memberium_fader_' . $vwplas73j, 'style' => '', 'target_class' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpld576f2 = ''; $vwplfzivxc = ''; $vwplvpexdn['delayshow'] = (int) ($vwplvpexdn['delayshow'] * 1000); $vwplvpexdn['delayhide'] = (int) ($vwplvpexdn['delayhide'] * 1000); $vwplvpexdn['fadeout'] = (int) ($vwplvpexdn['fadeout'] * 1000); $vwplvpexdn['fadeshow'] = (int) ($vwplvpexdn['fadeshow'] * 1000); $vwplvpexdn['fadehide'] = (int) ($vwplvpexdn['fadehide'] * 1000); $vwplvpexdn['delayhide_function'] = ! empty($vwplvpexdn['delayhide_function']) ? ', ' . $vwplvpexdn['delayhide_function'] : ''; $vwplvpexdn['delayshow_function'] = ! empty($vwplvpexdn['delayshow_function']) ? ', ' . $vwplvpexdn['delayshow_function'] : ''; $vwplvpexdn['fadeout_function'] = ! empty($vwplvpexdn['fadeout_function']) ? ', ' . $vwplvpexdn['fadeout_function'] : ''; $vwplzofga1 = ''; if ($vwplvpexdn['fadeout'] < 1) { $vwplzofga1 = 'display:none;'; } if ($vwplvpexdn['style'] > '') { $vwplzofga1 .= $vwplvpexdn['style']; } $vwplwweoq8 = '#' . $vwplvpexdn['id']; if ($vwplvpexdn['target_class'] > '') { $vwplwweoq8 = $vwplvpexdn['target_class']; } if (trim($vwplckl3) > '') { $vwpld576f2 .= '<div id="' . $vwplvpexdn['id'] . '" class="' . $vwplvpexdn['class'] . '" style="' . $vwplzofga1 . '">' . do_shortcode($vwplckl3) . '</div>'; } $vwplfzivxc .= '<script type="text/javascript">'; $vwplfzivxc .= 'jQuery(document).ready(function() { '; $vwplfzivxc .= '   jQuery("' . $vwplwweoq8 . '")'; if ($vwplvpexdn['fadeout'] > 0) { $vwplfzivxc .= '.delay(' . $vwplvpexdn['fadeout'] .')'; $vwplfzivxc .= '.fadeOut(' . $vwplvpexdn['fadehide'] . $vwplvpexdn['fadeout_function'] . ')'; } if ($vwplvpexdn['delayshow'] > 0) { $vwplfzivxc .= '.delay(' . $vwplvpexdn['delayshow'] . ')'; $vwplfzivxc .= '.fadeIn(' . $vwplvpexdn['fadeshow'] . $vwplvpexdn['delayshow_function'] . ')' ; } if ($vwplvpexdn['delayhide'] > 0) { $vwplfzivxc .= '.delay(' . $vwplvpexdn['delayhide'] . ')'; $vwplfzivxc .= '.fadeOut(' . $vwplvpexdn['fadehide'] . $vwplvpexdn['delayhide_function'] . ')' ; } $vwplfzivxc .= ";\n"; $vwplfzivxc .= '});'; $vwplfzivxc .= '</script>'; echo $vwplfzivxc; return $vwpld576f2; } function wplldp_o($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplmkypa = array( 'end' => 1, 'start' => 0, 'step' => 1, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; for ($vwplt_5ro = $vwplvpexdn['start']; $vwplt_5ro <= $vwplvpexdn['end']; $vwplt_5ro += $vwplvpexdn['step']) { $this->forloop = $vwplt_5ro; $vwpltlkdcw .= str_ireplace('{{forloop}}', $vwplt_5ro, $vwplckl3); } $this->forloop = 0; return $vwpltlkdcw; } function wpla4h_lo($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'fields' => '', 'htmlattr' => '', 'separator' => ' ', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if ($vwplvpexdn['fields'] == '') { return; } $vwplfu1sbe = explode(',', $vwplvpexdn['fields']); $vwpltlkdcw = ''; foreach ($vwplfu1sbe as $vwple2yn) { $vwple2yn = strtolower(trim($vwple2yn) ); $vwpltlkdcw .= htmlspecialchars(wplsbzgvp::wpllnxp8($vwple2yn) ); if (count($vwplfu1sbe) > 1) { $vwpltlkdcw .= $vwplvpexdn['separator']; } } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }  function wplyyqe($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'roles' => '', 'not' => '', 'except_roles' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); if (stripos($vwpluvdiz, '_not_') ) { $vwplvpexdn['not'] = true; } $vwplvpexdn['except_roles'] = explode(',', strtolower(trim($vwplvpexdn['except_roles']) ) ); $vwplvpexdn['roles'] = explode(',', strtolower(trim($vwplvpexdn['roles']) ) ); $vwplgogvie = get_userdata(get_current_user_id() ); $vwpluu_o = (is_a($vwplgogvie, 'WP_User') ) ? $vwplgogvie->roles : array(); $vwplcjywg = false; if (empty($vwplvpexdn['roles']) && empty($vwplvpexdn['except_roles']) ) { return; } if (is_user_logged_in() ) { if ($this->is_administrator) { $vwplcjywg = true; } else { $vwplcjywg = (boolean) (count(array_intersect($vwplvpexdn['roles'], $vwpluu_o) ) == count($vwplvpexdn['roles']) ); if ($vwplcjywg) { $vwplcjywg = ! (boolean) (count(array_intersect($vwplvpexdn['except_roles'], $vwpluu_o) ) > 0); } if ($vwplvpexdn['not']) { $vwplcjywg = ! $vwplcjywg; } } } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplbzdlui($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'except_roles' => '', 'not' => '', 'roles' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); if (stripos($vwpluvdiz, '_not_') ) { $vwplvpexdn['not'] = true; } $vwplvpexdn['except_roles'] = explode(',', strtolower(trim($vwplvpexdn['except_roles']) ) ); $vwplvpexdn['roles'] = explode(',', strtolower(trim($vwplvpexdn['roles']) ) ); $vwplgogvie = get_userdata(get_current_user_id() ); $vwpluu_o = (is_a($vwplgogvie, 'WP_User') ) ? $vwplgogvie->roles : array(); $vwplcjywg = false; if (empty($vwplvpexdn['roles']) && empty($vwplvpexdn['except_roles']) ) { return; } if (is_user_logged_in() ) { if ($this->is_administrator) { $vwplcjywg = true; } else { $vwplcjywg = (boolean) (count(array_intersect($vwplvpexdn['roles'], $vwpluu_o) ) > 0); if ($vwplcjywg) { $vwplcjywg = ! (boolean) (count(array_intersect($vwplvpexdn['except_roles'], $vwpluu_o) ) > 0); } if ($vwplvpexdn['not']) { $vwplcjywg = ! $vwplcjywg; } } } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplq4wl0v($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'not' => '', 'output' => '', 'tokens' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium');; $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); $vwplvpexdn['tokens'] = trim($vwplvpexdn['tokens'], ', '); $vwpllzly5b = get_current_user_id(); if (stripos($vwpluvdiz, '_not_') ) { $vwplvpexdn['not'] = true; } $vwplcjywg = false; if ($this->is_administrator) { $vwplcjywg = true; } elseif ($vwpllzly5b < 1) { $vwplcjywg = false; } elseif (empty($vwplvpexdn['tokens']) ) { $vwplcjywg = false; } else { $vwplcjywg = memberium_app()->wplcw8ap($vwplvpexdn['tokens'], $vwpllzly5b); if ($vwplvpexdn['not']) { $vwplcjywg = ! $vwplcjywg; } } if (! empty($vwpltlkdcw) ) { $vwplckl3 = $vwpltlkdcw; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplc9vd($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'except_memberships' => '', 'not' => '', 'output' => '', 'memberships' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium');; $vwpltalx = false; $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); if (stripos($vwpluvdiz, '_not_') ) { $vwplvpexdn['not'] = true; } $vwplvpexdn['except_memberships'] = array_filter(explode(',', strtolower(trim($vwplvpexdn['except_memberships']) ) ) ); $vwplvpexdn['memberships'] = array_filter( explode(',', strtolower(trim($vwplvpexdn['memberships']) ) ) ); $vwpldwe0 = isset($_SESSION['memb_user']['membership_names']) ? array_filter(explode(',', strtolower($_SESSION['memb_user']['membership_names']) ) ) : array(); if (empty($vwplvpexdn['memberships']) && empty($vwplvpexdn['except_memberships']) ) { $vwpltalx = false; } elseif (! is_user_logged_in() ) { $vwpltalx = false; } elseif (is_super_admin() ) { $vwpltalx = true; } else { $vwpltalx = (bool) count(array_intersect($vwpldwe0, $vwplvpexdn['memberships']) ); } if ($vwplvpexdn['not']) { $vwpltalx = ! $vwpltalx; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplc_qp($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'levels' => '', 'strict' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium');; $vwplvpexdn['strict'] = ($vwplvpexdn['strict'] > '') ? true : false; $vwplcjywg = false; if (memberium_app()->wplubo6() > 0) { $vwplcjywg = $this->wplppne($vwplvpexdn['strict'], $vwplvpexdn['levels']); } if (is_super_admin() ) { $vwplcjywg = true; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplbnb0($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'except_contact_ids' => '', 'except_contactid' => '', 'except_tag_ids' => '', 'except_tagid' => '', 'tagid' => '', 'tag_ids' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['except_tagid'] = trim($vwplrtps . ',' . $vwplvpexdn['except_tag_ids'], ', '); $vwplvpexdn['except_contactid'] = trim($vwpls7sd . ',' . $vwplvpexdn['except_contact_ids'], ', '); $vwplvpexdn['tagid'] = trim($vwplvpexdn['tagid'] . ',' . $vwplvpexdn['tag_ids'], ', '); if (empty($vwplvpexdn['tagid']) ) { return; } if (memberium_app()->wplubo6() ) { $vwplcjywg = wplj_l2t::wpl_n2s9($vwplvpexdn['tagid']); } else { $vwplcjywg = false; } if ($vwplcjywg) { $vwplvpexdn['except_contactids'] = explode(',', $vwpls7sd); if (count($vwplvpexdn['except_contactids']) && in_array(memberium_app()->wplubo6(), $vwplvpexdn['except_contactids']) ) { $vwplcjywg = false; } } if ($vwplcjywg) { if ($vwplrtps > '' && wplj_l2t::wpl_n2s9($vwplrtps) ) { $vwplcjywg = false; } } if ($this->is_administrator) { $vwplcjywg = true; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, ! $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplfstn($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplv_qo = ! is_feed(); return wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplv_qo); } function wplofgyva($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'caseinsensitive' => 1, 'key' => '', 'test' => '=', 'txtfmt' => '', 'value' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (empty($vwplvpexdn['key']) ) { return; } if (empty($vwplvpexdn['value']) && $vwplvpexdn['test'] == '=') { $vwpltalx = isset($_COOKIE[$vwplvpexdn['key']]); } else { $vwplfa0m = (isset($_COOKIE[$vwplvpexdn['key']]) ) ? $_COOKIE[$vwplvpexdn['key']] : NULL; $vwpltalx = wplczvi98::wplfiro($vwplfa0m, $vwplvpexdn['test'], $vwplvpexdn['value'], $vwplvpexdn['caseinsensitive']); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplukhd8g($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'caseinsensitive' => 1, 'key' => '', 'test' => '=', 'txtfmt' => '', 'value' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (empty($vwplvpexdn['key']) ) { return; } if ($vwplvpexdn['value'] == '' && $vwplvpexdn['test'] == '=') { $vwpltalx = isset($_GET[$vwplvpexdn['key']]); } else { $vwplfa0m = (isset($_GET[$vwplvpexdn['key']]) ) ? $_GET[$vwplvpexdn['key']] : NULL; $vwpltalx = wplczvi98::wplfiro($vwplfa0m, $vwplvpexdn['test'], $vwplvpexdn['value'], $elvs_atts['caseinsensitive']); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplsaor($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', 'key' => '', 'test' => '=', 'value' => '', 'caseinsensitive' => 1, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (empty($vwplvpexdn['key']) ) { return; } if (empty($vwplvpexdn['value']) && $vwplvpexdn['test'] == '=') { $vwpltalx = isset($_POST[$vwplvpexdn['key']]); } else { $keyvalue = (isset($_POST[$vwplvpexdn['key']]) ) ? $_POST[$vwplvpexdn['key']] : NULL; $vwpltalx = wplczvi98::wplfiro($keyvalue, $vwplvpexdn['test'], $vwplvpexdn['value'], $vwplvpexdn['caseinsensitive']); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpllsh965($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'key' => '', 'txtfmt' => '', 'test' => '=', 'value' => '', 'caseinsensitive' => 1, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (empty($vwplvpexdn['key']) ) { return; } if (empty($vwplvpexdn['value']) && $vwplvpexdn['test'] == '=') { $vwpltalx = isset($_REQUEST[$vwplvpexdn['key']]); } else { $vwplfa0m = (isset($_REQUEST[$vwplvpexdn['key']]) ) ? $_REQUEST[$vwplvpexdn['key']] : NULL; $vwpltalx = wplczvi98::wplfiro($vwplfa0m, $vwplvpexdn['test'], $vwplvpexdn['value'], $vwplvpexdn['caseinsensitive']); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplf5qnp6($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwpllzly5b = get_current_user_id(); if (empty($user_id) ) { return; } $vwplsb_pf = array( 'capture' => '', 'name' => '', 'test' => 'show', 'txtfmt' => '', 'val' => 0, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['name'] = strtolower(trim($vwplvpexdn['name']) ); $vwplvpexdn['test'] = strtolower(trim($vwplvpexdn['test']) ); $vwpltalx = FALSE; $vwplgyte5 = (float) $this->wplvi4zst($vwplvpexdn['name']); $vwplph268z = (float) $vwplvpexdn['val']; if (in_array($vwplvpexdn['test'], array('eq', '=', '==', '===') ) ) { $vwpltalx = ($vwplgyte5 === $vwplph268z); } elseif ($vwplvpexdn['test'] == 'gt') { $vwpltalx = ($vwplgyte5 > $vwplph268z); } elseif ($vwplvpexdn['test'] == 'lt') { $vwpltalx = ($vwplgyte5 < $vwplph268z); } elseif ($vwplvpexdn['test'] == 'le') { $vwpltalx = ($vwplgyte5 <= $vwplph268z); } elseif ($vwplvpexdn['test'] == 'ge') { $vwpltalx = ($vwplgyte5 >= $vwplph268z); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplgxgn($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'bypass_permissions' => 0, 'capture' => '', 'field' => 'post_content', 'id' => 0, 'length' => 0, 'tagid' => '', 'txtfmt' => '', 'type' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (! empty($vwplvpexdn['tagid']) ) { if (! wplj_l2t::wpl_n2s9($tagids) ) { return; } } if (empty($vwplvpexdn['type']) ) { switch ($vwpluvdiz) { case 'memb_include_partial': $vwplo43m = 'partials'; break; case 'memb_include_page': $vwplo43m = 'page'; break; default: $vwplo43m = 'post'; break; } } else { $vwplo43m = strtolower($vwplvpexdn['type']); } $post_id = 0; if (empty($vwplvpexdn['field']) ) { $vwple2yn = 'post_content'; } else { $vwple2yn = ($vwplvpexdn['field']); } if ( (int) $vwplvpexdn['id'] > 0) { $vwplcltpy = (int) $vwplvpexdn['id']; } else { $vwplcltpy = $vwplvpexdn['id']; }  if (intval($vwplcltpy) > 0) { $vwplw2hs7 = get_post($vwplcltpy, ARRAY_A); $vwplcltpy = $vwplw2hs7['ID']; } elseif ($vwplcltpy == 0) { $vwplw2hs7 = get_page_by_path($vwplcltpy, ARRAY_A, $vwplo43m); $vwplcltpy = $vwplw2hs7['ID']; } elseif ($vwplcltpy == 0) { $vwplw2hs7 = get_page_by_title($vwplcltpy, ARRAY_A, $vwplo43m); }  if ($this->wpls9nje($vwplw2hs7['ID']) ) { $vwpltlkdcw = do_shortcode($vwplw2hs7[$vwple2yn]); } else { $vwpltlkdcw = do_shortcode($vwplw2hs7['post_excerpt']); } if ($vwplvpexdn['length'] > 0) { $vwpltlkdcw = substr($vwpltlkdcw, 0, $vwplvpexdn['length']); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplszsq($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { $vwplsb_pf = array( 'capture' => '', 'not' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); if ($vwpluvdiz == 'memb_is_not_admin') { $vwplvpexdn['not'] = true; } $vwplbje3ox = is_super_admin(); if ($vwplvpexdn['not']) { $vwplbje3ox = ! $vwplbje3ox; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwplbje3ox); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpluxnq($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $success = $this->wplsv3m2(); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $success); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplpep6($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'browser' => '', 'capture' => '', 'os' => '', 'txtfmt' => '', 'type' => '', 'user' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['browser'] = strtolower(trim($vwplvpexdn['browser']) ); $vwplvpexdn['os'] = strtolower(trim($vwplvpexdn['os']) ); $vwplvpexdn['type'] = strtolower(trim($vwplvpexdn['type']) ); $vwplvpexdn['user'] = strtolower(trim($vwplvpexdn['user']) ); $vwplx98qba = $this->wpl_r8o($_SERVER['HTTP_USER_AGENT']); $vwplv_qo = TRUE; if (! empty($vwplvpexdn['browser']) && $vwplvpexdn['browser'] != $vwplx98qba['browser']) { $vwplv_qo = FALSE; } if (! empty($vwplvpexdn['os']) && $vwplvpexdn['os'] != $vwplx98qba['os']) { $vwplv_qo = FALSE; } if (! empty($vwplvpexdn['type']) && $vwplvpexdn['type'] != $vwplx98qba['type']) { $vwplv_qo = FALSE; } if (! empty($vwplvpexdn['user']) && $vwplvpexdn['user'] != $vwplx98qba['user']) { $vwplv_qo = FALSE; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwplv_qo); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplq6rq($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplv_qo = $GLOBALS['is_chrome']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwplv_qo); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplj3e9i($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); global $post; $vwploia7_d = ($post->excerpt_only == 1); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwploia7_d); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplif189h($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltalx = $this->wplv9t48r(); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplhuym4($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['match'] = is_feed(); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwplvpexdn['match']); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplasrc6i($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! get_current_user_id() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); $vwply6sl = (boolean) (1 == get_user_meta(get_current_user_id(), 'login_count', true) ); if ($vwplvpexdn['not']) { $vwply6sl = ! $vwply6sl; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwply6sl); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplzmfs($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '' ) { $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['match'] = $GLOBALS['is_gecko']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplvpexdn['match']); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpl_dj5sq($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltalx = $this->wpl__xvw(); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplp2y7_n($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltalx = $this->wplri34(); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplxtvd_7($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = $GLOBALS['is_IE']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpl_yx6($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $match = (bool) strpos($_SERVER['HTTP_USER_AGENT'], 'iPad'); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $match); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplzy7eu($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = $GLOBALS['is_iphone']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpljet5($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = $GLOBALS['is_lynx']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpln0jzh($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = $GLOBALS['is_macIE']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpldehxr0($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = wp_is_mobile(); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplymvk1($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = $GLOBALS['is_NS4']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpll7tdlx($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = $GLOBALS['is_opera']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplw13b($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = $GLOBALS['is_safari']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplf35swh($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltalx = is_single(); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplgs6cj($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, is_ssl() ); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplueahf($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpln1aqch = $GLOBALS['is_winIE']; $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpln1aqch); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wploak2hs($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'fields' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if ($vwplvpexdn['fields'] == '') { return false; } $vwpltalx = false; $vwplvpexdn['fields'] = explode(',', $vwplvpexdn['fields']); foreach ($vwplvpexdn['fields'] as $vwpl_s6l) { if (isset($_GET[$vwpl_s6l]) ) { $vwpltalx = TRUE; } } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplg38q_i($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'includepassword' => '', 'name' => 'membsession', 'omit' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplrbh71u = explode(',', $vwplvpexdn['omit']); $session = $_SESSION; if (strtolower(trim($vwplvpexdn['includepassword']) ) != 'yes') { unset($session['memb_db_fields'][strtolower($this->options['settings']['password_field'])]); } foreach ($vwplrbh71u as $vwplchm4g) { unset($session['memb_user'][$vwplchm4g], $session['memb_db_fields'][$vwplchm4g]); } $vwpltlkdcw = '<script type="text/javascript">' . "\n"; $vwpltlkdcw .= 'var ' . $vwplvpexdn['name'] . ' = ' . json_encode($session, JSON_PRETTY_PRINT) . ";\n"; $vwpltlkdcw .= '</script>' . "\n"; return $vwpltlkdcw; } function wplqzgwp($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if ( wpln9_s::wplq6kurm() ) { $vwpltlkdcw = _x('Valid', 'memb_license_status', 'memberium'); } else { $vwpltlkdcw = _x('Invalid', 'memb_license_status', 'memberium'); } $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'htmlattr' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }  function wplw06k8e($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { $vwplsb_pf = array( 'after' => '', 'before' => '', 'htmlattr' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplu32sji = wplz8bid::wplvf1d('settings', 'login_url'); $vwpltlkdcw = ($vwplu32sji < 1) ? wp_login_url() : get_permalink($vwplu32sji); return wplczvi98::wplyhei6(false, $vwpltlkdcw, '', '', $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wpltk5n4($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'logintext' => 'Login', 'logouttext' => 'Logout', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (is_user_logged_in() ) { return $vwplvpexdn['logouttext']; } else { return $vwplvpexdn['logintext']; } } function wplc638za($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $_SESSION = NULL;  wp_destroy_current_session(); wp_clear_auth_cookie(); wp_logout(); } function wply6b2v0($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'htmlattr' => '', 'linktext' => 'Logout', 'url' => NULL ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['url'] = trim($vwplvpexdn['url']); if (empty($vwplvpexdn['url']) ) { $vwplvpexdn['url'] = memberium_app()->wplenfoxj(); } if (empty($vwplvpexdn['htmlattr']) ) { $vwpltlkdcw = '<a href="' . wp_logout_url($vwplvpexdn['url']) . '" title="' . _x('Logout', 'memb_logout_link', 'memberium') . '" class="memb_logout_link">' . $vwplvpexdn['linktext']. '</a>'; } else { $vwpltlkdcw = wp_logout_url($vwplvpexdn['url']); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, '', $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wpllbgft($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'date_format' => '', 'default' => '', 'fields' => '', 'htmlattr' => '', 'post_id' => get_the_ID(), 'separator' => ' ', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium');  if ($vwplvpexdn['post_id'] < 1) { return; } if ($vwplvpexdn['fields'] = '') { return; } $vwplfu1sbe = explode(',', $vwplvpexdn['fields']); $vwplx6yba = count($vwplfu1sbe); $vwple2rb_ = 0;  $vwpltlkdcw = ''; foreach ($vwplfu1sbe as $vwple2yn) { $vwplhlyd1 = get_post_meta($vwplvpexdn['post_id'], $vwple2yn, TRUE); if (isset($vwplhlyd1) ) { $vwplpg5x = strtotime($vwplhlyd1); if ($vwplvpexdn['date_format'] == '' || $vwplpg5x == 0) { $vwplnghzs1 = $vwplhlyd1; } else { $vwplnghzs1 = date($vwplvpexdn['date_format'], strtotime($vwplhlyd1) ); } } else { $vwplnghzs1 = $vwplvpexdn['default']; } $vwpltlkdcw .= $vwplnghzs1; if ($vwplx6yba > 1) { $vwpltlkdcw .= $vwplvpexdn['separator']; } } if ($vwplx6yba > 1 && strlen($vwplvpexdn['separator']) > 0) { $vwpltlkdcw = substr($vwpltlkdcw, 0, -strlen($vwplvpexdn['separator']) ); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wplrmr3g1($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', 'filename' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (substr($vwplvpexdn['filename'], 0, 1) !== '/' && substr($vwplvpexdn['filename'], 0, 1) !== '\\') { $vwplvpexdn['filename'] = ABSPATH . '/' . $vwplvpexdn['filename']; } $vwplvpexdn['filename'] = $vwplvpexdn['filename'] . '.php'; if (! file_exists($vwplvpexdn['filename']) ) { if (is_super_admin() ) { return _x('Not Found.', 'memb_php_include', 'memberium'); } else { return; } } ob_start(); switch (strtolower($vwpluvdiz) ) { case 'memb_phpinclude_once': include_once $vwplvpexdn['filename']; break; default: include $vwplvpexdn['filename']; break; } $vwpltlkdcw = ob_get_contents(); ob_end_clean(); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplaufve($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') {  if (! wpln9_s::wplq6kurm() ) { return; }  $vwplvtmqd = wplsbzgvp::wplfhxj9(); if (! $vwplvtmqd) { return; } $vwplsb_pf = array( 'url' => '', 'background' => 0, 'resync' => 0, 'display' => false, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (! empty($vwplvpexdn['url']) ) { $vwplun47e = array( 'contactId' => $vwplvtmqd, 'Email' => wplsbzgvp::wplc4na('email'), ); $vwplyio4f = wp_remote_post($vwplvpexdn['url'], array('body' => $vwplun47e) ); } if ($vwplvpexdn['display']) { return isset($vwplyio4f['body']) ? $vwplyio4f['body'] : ''; } } function wpleulm($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'shortcodes' => false, 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplckl3 = preg_replace('#</p>\s*<p>#', '', $vwplckl3); $vwplvpexdn['shortcodes'] = wplczvi98::wplbyhn($vwplvpexdn['shortcodes'], false); if ($vwplvpexdn['shortcodes']) { $vwplckl3 = do_shortcode($vwplckl3); } return wplczvi98::wplyhei6(false, $vwplckl3, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wpl_vwl($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') {       if (is_super_admin() ) { return; } if (is_feed() ) { return; } if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'automatic' => 1, 'delay' => 0, 'forcejs' => 1, 'target' => '_self', 'url' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['delay'] = (int) $vwplvpexdn['delay']; if ($vwplvpexdn['delay']) { $vwplvpexdn['delay'] = intval($vwplvpexdn['delay'] * 1000); } $vwplcltpy = get_the_id(); $vwplor_y7 = ! headers_sent(); $vwplor_y7 = $vwplor_y7 && (is_single($vwplcltpy) || is_page($vwplcltpy) ); $vwplor_y7 = $vwplor_y7 && ($vwplvpexdn['delay'] == 0); $vwplor_y7 = $vwplor_y7 && ($vwplvpexdn['automatic'] == 1); $vwplor_y7 = $vwplor_y7 && (! $vwplvpexdn['forcejs']); if ($vwplor_y7) { wp_redirect(html_entity_decode($vwplvpexdn['url']) ); exit; } if ($vwplvpexdn['target'] == '_self' || empty($vwplvpexdn['target']) ) { $vwplkd6iz = 'window.location  = ("' . $vwplvpexdn['url'] . '");'; } else { $vwplkd6iz = 'window.open("' . $vwplvpexdn['url'] . '", "' . $vwplvpexdn['target'] . '");'; } if ($vwplvpexdn['delay']) { $vwpl_w3z01 = '<script>
			jQuery(document).ready(function() {
				setTimeout(function() {
					' . $vwplkd6iz . '
				}, ' . $vwplvpexdn['delay'] . ');
			});
			</script>'; } else { $vwpl_w3z01 = '<script> ' . $vwplkd6iz . '</script>'; } return html_entity_decode($vwpl_w3z01); } function wpla1p6q5($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! is_user_logged_in() ) { return; } $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'date_format' => 'F jS, Y', 'htmlattr' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = date($vwplvpexdn['date_format'], strtotime(get_userdata(get_current_user_id() )->user_registered) ); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }     function wplxr97df($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (memberium_app()->wplubo6() < 1) { return; } if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } $vwplsb_pf = array( 'contact_id' => memberium_app()->wplubo6(), 'debug' => 'no', 'force' => 'no', 'tag_id' => '', 'tag_ids' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['debug'] = wplczvi98::wplbyhn($vwplvpexdn['debug'], false); $vwplvpexdn['force'] = wplczvi98::wplbyhn($vwplvpexdn['force'], false); $vwplvpexdn['tag_id'] = trim($vwplvpexdn['tag_id'] . ',' . $vwplvpexdn['tag_ids'], ','); memberium_app()->wplt263_($vwplvpexdn['tag_id'], $vwplvpexdn['contact_id'], (boolean) $vwplvpexdn['force'], $vwplvpexdn['debug']); }  function wplprcvi($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (memberium_app()->wplubo6() < 1) { return; } if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'fields' => '', 'htmlattr' => '', 'separator' => ' ', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (empty($vwplvpexdn['fields']) ) { return; } $vwplfu1sbe = explode(',', $vwplvpexdn['fields']); $vwpltlkdcw = ''; foreach ($vwplfu1sbe as $vwple2yn) { $vwple2yn = strtolower(trim($vwple2yn) ); $vwplnghzs1 = wplsbzgvp::wplc4na('affiliate.' . $vwple2yn); $vwpltlkdcw .= $vwplnghzs1; if (count($vwplfu1sbe) > 1) { $vwpltlkdcw .= $vwplvpexdn['separator']; } } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }  function wplwqz_($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (memberium_app()->wplubo6() < 1) { return; } $vwplsb_pf = array( 'date_format' => 'F j, Y g:i a', 'limit' => 1, 'upcomingonly' => 'yes', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['upcomingonly'] = wplczvi98::wplbyhn($vwplvpexdn['upcomingonly'], true); $vwplvpexdn['limit'] = (int) $vwplvpexdn['limit']; if ($vwplvpexdn['limit'] < 0) { $vwplvpexdn['limit'] = 1; } if ($vwplvpexdn['limit'] > 1000) { $vwplvpexdn['limit'] = 1000; }  $vwplv80sz = array( 'IsAppointment' => 1, 'ContactId' => (int) memberium_app()->wplubo6(), ); if ($vwplvpexdn['upcomingonly']) {  $vwplv80sz['ActionDate'] = '~>~' . date('Y-m-d'); } $vwplmu62n = $this->i2sdk->getInfusionsoftFieldsByTable('ContactAction'); $vwplxx23 = $this->isdk->dsQuery('ContactAction', $vwplvpexdn['limit'], 0, $vwplv80sz, $vwplmu62n); $vwplemvr = 0; $vwpltlkdcw = ''; $vwplaegnu = 0; $vwplm_bmqo = array( 'ActionDate', 'CompletionDate', 'CreationDate', 'EndDate', 'LastUpdated', 'PopupDate', ); if (is_array($vwplxx23) ) { if (! empty($vwplxx23) ) { $vwplemvr = count($vwplxx23); foreach($vwplxx23 as $vwplplyj) { $vwplzxhjbg = $vwplckl3; $vwplaegnu++; if ($vwplaegnu % 2) { $vwplyv8z = 'odd'; } else { $vwplyv8z = 'even'; } $vwplzxhjbg = str_ireplace('%%cycler%%', $vwplyv8z, $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%line%%', $vwplaegnu, $vwplzxhjbg); foreach($vwplm_bmqo as $vwplxb4o) { $vwplhp2c5k = '/(%%'.strtolower($vwplxb4o) . '(\|?)(.*)%%)/U'; if (stripos($vwplzxhjbg, '%%' . $vwplxb4o) !== false) { $vwplzxhjbg = preg_replace_callback($vwplhp2c5k, function($vwplt_hk1c) use ($vwplplyj, $vwplxb4o, $vwplvpexdn) { $vwplt_hk1c[3] = substr($vwplt_hk1c[3], 1); if ($vwplt_hk1c[3] > '') { $vwply9silk = $vwplt_hk1c[3]; } else { $vwply9silk = $vwplvpexdn['date_format']; } return date($vwply9silk, strtotime($vwplplyj[$vwplxb4o]) ); }, $vwplzxhjbg); } } foreach($vwplmu62n as $vwpl_s6l) { if (! in_array($vwpl_s6l, $vwplm_bmqo) ) { if (! isset($vwplplyj[$vwpl_s6l]) ) { $vwplplyj[$vwpl_s6l ] = ''; } $vwplzxhjbg = str_ireplace('%%' . $vwpl_s6l . '%%', $vwplplyj[$vwpl_s6l], $vwplzxhjbg); } } $vwpltlkdcw .= $vwplzxhjbg; } } } $vwpltlkdcw = str_ireplace('%%appt.count%%', $vwplemvr, $vwplzxhjbg); return do_shortcode($vwpltlkdcw); } function wplsejk($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'format' => '', 'htmlattr' => '', 'tags' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['tags'] = explode(',', $vwplvpexdn['tags']); $vwplrudn1 = wplsbzgvp::wplc4na('groups'); $vwplfrdm6 = empty($vwplrudn1) ? array() : explode(',', $vwplrudn1); $vwplymh8 = count($vwplvpexdn['tags']); $vwply15hx0 = 0; foreach($vwplfrdm6 as $vwplsd8f) { if (in_array($vwplsd8f, $vwplvpexdn['tags']) ) { $vwply15hx0++; } } $vwpltlkdcw = ''; if ($vwplvpexdn['format'] == '%') { $vwpltlkdcw = ( ($vwply15hx0 / $vwplymh8) * 100); } else { $vwpltlkdcw = $vwply15hx0; } return wplczvi98::wplyhei6(true, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr']); } function wplx2qe7($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'cachetime' => 900, 'capture' => '', 'tag_id' => 0, 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['tag_id'] = (int) memberium_app()->wpljfe4jd($vwplvpexdn['tag_id']); $vwplvpexdn['cachetime'] = $vwplvpexdn['cachetime'] < 450 ? $vwplvpexdn['cachetime'] = 450 : (int) $vwplvpexdn['cachetime']; if ($vwplvpexdn['tag_id'] < 1) { return; } $vwplsekv = 'memberium::tag_count::' . $vwplvpexdn['tag_id']; $vwpltidk1 = get_transient($vwplsekv); if ($vwpltidk1 === false) { if (method_exists($this->isdk, 'dscount') ) { $vwpltidk1 = $this->isdk->dscount('ContactGroupAssign', array('GroupId' => $vwplvpexdn['tag_id']) ); set_transient($vwplsekv, $vwpltidk1, $vwplvpexdn['cachetime']); } else { $vwpltidk1 = 'Count Unavailable'; } } return wplczvi98::wplyhei6(true, $vwpltidk1, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], ''); }  function wplr6mrv($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } static $vwplihrt = 0; $vwplihrt++; $vwplsb_pf = array( 'style' => 'link', 'appname' => wplz8bid::wplm3z9k('appname'), 'url' => '/', 'css_id' => $vwplihrt, 'button_text' => 'Login', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; $username = wplsbzgvp::wplc4na('email'); $password = wplsbzgvp::wplc4na('password'); if ($vwplvpexdn['style'] == 'button') { $vwpltlkdcw .= "<form method='GET' action='https://{$vwplvpexdn['appname']}.customerhub.net/web_services/auto_login'>"; $vwpltlkdcw .= "<input type='hidden' name='email' value='{$username}'>"; $vwpltlkdcw .= '<input type="hidden" name="password" value='. $password . '>'; $vwpltlkdcw .= '<input type="hidden" name="to" value="' . $link . '"">'; $vwpltlkdcw .= '<input type="submit" name="to" value="' . $vwplvpexdn['button_text'] . '" id="' . $vwplvpexdn['css_id'] . '">'; $vwpltlkdcw .= '</form>'; } else { $vwpltlkdcw = 'https://' . $vwplvpexdn['appname'] . '.customerhub.net/web_services/auto_login?email='. urlencode($username) . '&password='. urlencode($password) . '&to=' . urlencode($vwplvpexdn['url']); } return $vwpltlkdcw; }  function wplcd6tjr($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } if (! isset($_SESSION['infusionsoft_affiliate']) ) { memberium_app()->wplew0p1(); } } function wpl_krdoj($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } if (memberium_app()->wplubo6() < 1) { return; } $vwplsb_pf = array( 'capture' => '', 'file_id' => 0, 'text' => 'Click here to Download', 'missing_text' => 'No such file.' ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium');    $vwpltlkdcw = ''; if ($vwplvpexdn['file_id'] > 0) { $vwplucr9e = $this->isdk->getDownloadUrl( (int) $vwplvpexdn['file_id']); } if ($vwplucr9e > '' && strpos($vwplucr9e, 'http') !== false) { $vwpltlkdcw = '<a href="' . $vwplucr9e . '">' . htmlspecialchars($vwplvpexdn['text']) . '</a>'; } else { $vwpltlkdcw = $vwplvpexdn['missing_text']; } if ($vwplvpexdn['capture'] > '') { $vwpltlkdcw = wplczvi98::wplg6rw5y($vwpltlkdcw, $vwplvpexdn['capture']); } return $vwpltlkdcw; } function wplm7sk9($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'htmlattr' => '', 'file_id' => 0, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if ($vwplvpexdn['file_id'] > 0) { $vwplucr9e = $this->isdk->getDownloadUrl( (int) $vwplvpexdn['file_id']); } if ($vwplucr9e > '' && strpos($vwplucr9e, 'http') !== FALSE) { $vwpltlkdcw = $vwplucr9e; } else { $vwpltlkdcw = ''; } return wplczvi98::wplyhei6(false, $vwpltlkdcw, '', $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], '', ''); }   function wplple9c($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { static $vwplgyte5 = 1; if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } $vwplsb_pf = array( 'button_text' => 'Upload', 'contact_id' => memberium_app()->wplubo6(), 'error_msg' => 'Your file upload failed.', 'failure_actionsets' => '', 'failure_goals' => '', 'failure_tags' => '', 'failure_url' => '', 'maxsize' => 10000000, 'multiple' => false, 'no_errors' => false, 'rename' => '', 'success_actionsets' => '', 'success_goals' => '', 'success_msg' => 'Your file upload completed.', 'success_tags' => '', 'success_url' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['multiple'] = wplczvi98::wplbyhn($vwplvpexdn['multiple'], false); $vwplvpexdn['no_errors'] = wplczvi98::wplbyhn($vwplvpexdn['no_errors'], false); $vwplvpexdn['maxsize'] = (int) wp_convert_hr_to_bytes($vwplvpexdn['maxsize']); if ($vwplvpexdn['contact_id'] < 1) { return; } if ($vwplvpexdn['maxsize'] > 10000000 || $vwplvpexdn['maxsize'] < 1) { $vwplvpexdn['maxsize'] = 10000000; } $vwplzxutw = ''; if ($vwplvpexdn['multiple']) { $vwplzxutw = ' multiple="multiple" '; } $vwpllwhf_ = base64_encode(serialize(array( 'contact_id' => $vwplvpexdn['contact_id'], 'error_msg' => $vwplvpexdn['error_msg'], 'failure_actionsets' => $vwplvpexdn['failure_actionsets'], 'failure_goals' => $vwplvpexdn['failure_goals'], 'failure_tags' => $vwplvpexdn['failure_tags'], 'failure_url' => $vwplvpexdn['failure_url'], 'maxsize' => $vwplvpexdn['maxsize'], 'no_errors' => $vwplvpexdn['no_errors'], 'rename' => $vwplvpexdn['rename'], 'success_actionsets' => $vwplvpexdn['success_actionsets'], 'success_goals' => $vwplvpexdn['success_goals'], 'success_msg' => $vwplvpexdn['success_msg'], 'success_tags' => $vwplvpexdn['success_tags'], 'success_url' => $vwplvpexdn['success_url'], ) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwpllwhf_); $vwpltlkdcw = '<form id="upload_' . $vwplgyte5 . '" action="" method="POST" enctype="multipart/form-data">' . '<input type="hidden" name="memb_form_type" value="memb_filebox_upload">' . '<input type="hidden" name="params" value="' . $vwpllwhf_ . '">' . '<input type="hidden" name="signature" value="' . $vwpltmfi . '">' . '<fieldset>' . '<input type="hidden" id="MAX_FILE_SIZE" name="MAX_FILE_SIZE" value="' . $vwplvpexdn['maxsize'] . '" />' . '<div>' . '<label for="fileselect">Files to upload:</label>' . '<input type="file" id="fileselect_' . $vwplgyte5 . '" name="uploadedfiles[]" ' . $vwplzxutw . ' required="required"/>' . '</div>' . '<div id="submitbutton_' . $vwplgyte5 . '">' . '<button type="submit">' . $vwplvpexdn['button_text'] . '</button>' . '</div>' . '</fieldset>'. '</form>'; $vwplgyte5++; return $vwpltlkdcw; } function wplsdtsj9() { if (empty($_FILES['uploadedfiles']) ) { return; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['params']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_filebox_upload', 'memberium') ); exit; } $vwplg6lz4 = unserialize(base64_decode($_POST['params']) ); $vwplvtmqd = (int) $vwplg6lz4['contact_id']; $vwplh4r2 = $vwplg6lz4['rename']; $vwplxv9k3f = count($_FILES['uploadedfiles']['name']); $vwpl_95w = 0; $vwplidk1 = ''; $vwplgfa0 = array(); for ($vwplt_5ro = 0; $vwplt_5ro < $vwplxv9k3f; $vwplt_5ro++) { $vwplso1pw = $_FILES['uploadedfiles']['name'][$vwplt_5ro]; $vwplgm_9s = $_FILES['uploadedfiles']['type'][$vwplt_5ro]; $vwplbiqzp = $_FILES['uploadedfiles']['tmp_name'][$vwplt_5ro]; $vwplnrd9 = $_FILES['uploadedfiles']['error'][$vwplt_5ro]; $vwplfo82zr = $_FILES['uploadedfiles']['size'][$vwplt_5ro]; if ($vwplfo82zr > $vwplg6lz4['maxsize'] || $vwplnrd9 == 2) { $vwpl_95w++; $vwplidk1 .= '<p class="filebox_upload_error">' . 'File size of "' . $vwplso1pw . '" exceeded the ' . size_format($vwplg6lz4['maxsize']) . ' limit.</p>'; continue; } if (! empty($vwplnrd9) ) { $vwpl_95w++; $vwplidk1 .= '<p class="filebox_upload_error">Upload of ' . $vwplso1pw . ' failed (' . $vwplnrd9 .').</p>'; continue; } $vwplgfa0[] = array( 'name' => $vwplso1pw, 'type' => $vwplgm_9s, 'size' => $vwplfo82zr, 'error' => $vwplnrd9, 'tmp_name' => $vwplbiqzp, ); } if ($vwplg6lz4['no_errors'] && $vwpl_95w) { $vwplidk1 .= '<p class="filebox_upload_error">Some uploads failed.  No files saved.</p>'; $vwpl_95w++; } else { foreach($vwplgfa0 as $vwplf_3k79) {  if (! empty($vwplh4r2) ) { $vwplf_3k79['name'] = $vwplh4r2 . '.' . pathinfo($vwplf_3k79['name'], PATHINFO_EXTENSION); }  set_time_limit(30); $vwpljdrf = base64_encode(file_get_contents($vwplf_3k79['tmp_name']) ); $vwplyio4f = $this->isdk->uploadFile($vwplf_3k79['name'], $vwpljdrf, $vwplvtmqd); if ($vwplyio4f < 1) { $vwplidk1 .= substr($vwplyio4f, strpos($vwplyio4f, ']') + 1, -1) . ' for ' . $vwplf_3k79['name']; } unset($vwpljdrf); unlink($vwplf_3k79['tmp_name']); if (! (int) $vwplyio4f) { $vwpl_95w++; } } $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplsekv = 'Memberium::Filebox::' . $vwplw5rgd3 . '::' . $vwplvtmqd; delete_transient($vwplsekv); } $vwply17edn = 'memberium::file_upload_msg::' . get_current_user_id(); if ($vwpl_95w) {  $vwplyio4f = set_transient($vwply17edn, $vwplidk1, 3600); $this->error_message = $vwplidk1;  memberium_app()->wplge1yc6($vwplg6lz4['failure_goals'], $vwplvtmqd); memberium_app()->wplmupt($vwplg6lz4['failure_actionsets'], $vwplvtmqd); memberium_app()->wplt263_($vwplg6lz4['failure_tags'], $vwplvtmqd); if (! empty($vwplg6lz4['failure_url']) ) { wp_redirect($vwplg6lz4['failure_url']); die(); } } else {  $vwplyio4f = set_transient($vwply17edn, $vwplg6lz4['success_msg'], 3600); $this->error_message = $vwplg6lz4['success_msg'];  memberium_app()->wplge1yc6($vwplg6lz4['success_goals'], $vwplvtmqd); memberium_app()->wplmupt($vwplg6lz4['success_actionsets'], $vwplvtmqd); memberium_app()->wplt263_($vwplg6lz4['success_tags'], $vwplvtmqd); if (! empty($vwplg6lz4['success_url']) ) { wp_redirect($vwplg6lz4['success_url']); die(); } } } function wplg7u3($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (is_feed() ) { return; } $vwplygr2 = ''; if (is_user_logged_in() ) { $vwply17edn = 'memberium::file_upload_msg::' . get_current_user_id(); $vwplygr2 = trim(get_transient($vwply17edn) ); delete_transient($vwply17edn); } if (empty($vwplygr2) ) { $vwplygr2 = $this->error_message; } return $vwplygr2; } function wplxfoa($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'affiliate_id' => false, 'not' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); $vwplnufe = isset($_SESSION['infusionsoft_affiliate']) ? $_SESSION['infusionsoft_affiliate'] : 0; if ($this->is_administrator) { $vwplcjywg = true; } else { if (stripos($vwpluvdiz, '_not_') ) { $vwplvpexdn['not'] = true; } if ($vwplvpexdn['affiliate_id'] && $vwplvpexdn['affiliate_id'] == $vwplnufe) { $vwplcjywg = true; } else { $vwplcjywg = false; } } if ($vwplvpexdn['not']) { $vwplcjywg = ! $vwplcjywg; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplyjbmt($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'category_id' => '', 'contact_id' => 0, 'except_contact_ids' => '', 'except_contactid' => '', 'except_tag_ids' => '', 'except_tagid' => '', 'min' => 1, 'not' => '', 'output' => '', 'tag_id' => '', 'tag_ids' => '', 'tagid' => '', 'tagids' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); if (stripos($vwpluvdiz, '_not_') ) { $vwplvpexdn['not'] = true; } $vwplvpexdn['tagid'] = trim($vwplvpexdn['tag_id'] . ',' . $vwplvpexdn['tag_ids'] . ',' . $vwplvpexdn['tagid'] . ',' . $vwplvpexdn['tagids'], ', '); $vwplvpexdn['except_tagid'] = trim($vwplvpexdn['except_tagid'] . ', ' . $vwplvpexdn['except_tag_ids'], ', '); $vwplvpexdn['except_contactid'] = trim($vwplvpexdn['except_contactid'] . ',' . $vwplvpexdn['except_contact_ids'], ', '); if ($vwplvpexdn['contact_id']) { $vwplc0nobe = memberium_app()->wplyte2(false, $vwplvpexdn['contact_id']); } else { $vwplc0nobe = isset($_SESSION) ? $_SESSION : array(); $vwplvpexdn['contact_id'] = memberium_app()->wplubo6(); } if ($this->is_administrator) { $vwplcjywg = true; } else { $vwplkx_7zd = true; if ($vwplvpexdn['tagid'] > '') { $vwplkx_7zd = wplj_l2t::wpl_n2s9($vwplvpexdn['tagid'], $vwplc0nobe); } $vwplxamfit = true; if ($vwplvpexdn['except_tagid'] > '') { $vwplxamfit = ! wplj_l2t::wpl_n2s9($vwplvpexdn['except_tagid'], $vwplc0nobe); } $vwplvrgy0 = true; if ($vwplvpexdn['except_contactid'] > '') { $vwplvpexdn['except_contactids'] = explode(',', $vwplvpexdn['except_contactid']); if (count($vwplvpexdn['except_contactids']) && in_array($vwplvpexdn['contact_id'], $vwplvpexdn['except_contactids']) ) { $vwplvrgy0 = false; } } $vwplbzjs = true; if (! empty($vwplvpexdn['category_id']) ) { $vwplbzjs = memberium_app()->wplhg0eyq($vwplvpexdn['category_id'], $vwplc0nobe); } $vwplcjywg = ($vwplkx_7zd === true) && ($vwplxamfit === true) && ($vwplvrgy0 === true) && ($vwplbzjs === true); if ($vwplcjywg && $vwplvpexdn['min'] > 1) { $vwplpr27 = explode(',', $vwplvpexdn['tagid']); $vwplrudn1 = explode(',', wplsbzgvp::wplc4na('groups') ); $vwplfrdm6 = array_filter($vwplrudn1); $vwply15hx0 = 0; foreach($vwplfrdm6 as $vwplsd8f) { if (in_array($vwplsd8f, $vwplpr27) ) { $vwply15hx0++; } } if ($vwply15hx0 < $vwplvpexdn['min']) { $vwplcjywg = false; } } if ($vwplvpexdn['not']) { $vwplcjywg = ! $vwplcjywg; } } if (! empty($vwplvpexdn['output']) ) { $vwplckl3 = $vwplvpexdn['output']; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplj6fc_($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'contact_id' => memberium_app()->wplubo6(), 'except_contact_ids' => '', 'not' => '', 'output' => '', 'tagid' => '', 'tagids' => '', 'tag_ids' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpls0hwb5 = explode(',', trim($vwplvpexdn['tagid'] . ',' . $vwplvpexdn['tagids'] . ',' . $vwplvpexdn['tag_ids'], ', ') ); if (! count($vwpls0hwb5) ) { return; } $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); if (stripos($vwpluvdiz, '_not_') ) { $vwplvpexdn['not'] = TRUE; } if ($vwplvpexdn['contact_id'] > 0) { $vwplcjywg = wplj_l2t::wplid3nye($vwpls0hwb5, $vwplvpexdn['contact_id']); } else { $vwplcjywg = false; } if ($vwplcjywg) { $vwplvpexdn['except_contact_ids'] = explode(',', $vwplvpexdn['except_contact_ids']); if (count($vwplvpexdn['except_contact_ids']) && in_array($vwplvpexdn['contact_id'], $vwplvpexdn['except_contact_ids']) ) { $vwplcjywg = FALSE; } } if ($vwplvpexdn['not']) { $vwplcjywg = ! $vwplcjywg; } if ($this->is_administrator) { $vwplcjywg = TRUE; } if (! empty($vwplvpexdn['output']) ) { $vwplckl3 = $vwplvpexdn['output']; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wpldh5liu($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', 'not' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplcjywg = false; $vwplvpexdn['not'] = ! empty($vwplvpexdn['not']); if (stripos($vwpluvdiz, '_no_') ) { $vwplvpexdn['not'] = true; } if (! isset($_SESSION['memb_user']['has_credit_card']) || (isset($_SESSION['memb_user']['has_credit_card']) && $_SESSION['memb_user']['has_credit_card'] == 0) ) { wpllbej::wpllrqb(memberium_app()->wplubo6() ); } if (isset($_SESSION['memb_user']['has_credit_card']) && $_SESSION['memb_user']['has_credit_card'] == 1) { $vwplcjywg = true; } if ($vwplvpexdn['not']) { $vwplcjywg = ! $vwplcjywg; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcjywg); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplkah65s($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplkafd = wplsbzgvp::wplc4na('affiliate.status'); if (! empty($vwplkafd) ) { $vwplyio4f = (boolean) $vwplkafd || $this->is_administrator; } else { $vwplyio4f = 0; } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwplyio4f); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplk1_u($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplyio4f = wpllbej::wplgyias(); $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplyio4f); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wpler0sj($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = NULL) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'exact' => false, 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltalx = false; $vwplz58xgr = 0; $vwplj_cn9 = 0; $vwplhplg = ! empty($_SESSION['memb_user']['Email']) ? $_SESSION['memb_user']['Email'] : ''; switch ($vwpluvdiz) { case 'memb_is_no_optin': $vwplz58xgr = 0; break; case 'memb_is_1x_optin': $vwplz58xgr = 1; break; case 'memb_is_2x_optin': $vwplz58xgr = 2; break; } $vwplj_cn9 = $this->wplb469($vwplhplg); if ($vwplvpexdn['exact'] || $vwplz58xgr == 0) { $vwpltalx = ($this->is_administrator || $vwplj_cn9 == $vwplz58xgr); } else { $vwpltalx = ($this->is_administrator || $vwplj_cn9 >= $vwplz58xgr); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplasfoi($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'contact_id' => memberium_app()->wplubo6(), 'filter' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['contact_id'] = (int) $vwplvpexdn['contact_id']; if (empty($vwplvpexdn['contact_id']) ) { return; } $vwpltlkdcw = ''; $vwplgfa0 = memberium_app()->wplnrutgy($vwplvpexdn['contact_id'], true); if (! empty($vwplvpexdn['filter']) ) { if (is_array($vwplgfa0) && ! empty($vwplgfa0) ) { foreach ($vwplgfa0 as $vwply17edn => $vwplf_3k79) { if (stripos($vwplf_3k79['filename'], $vwplvpexdn['filter']) === false) { unset($vwplgfa0[$vwply17edn]); } } } } unset($vwplf_3k79); $vwpl_oilx = count($vwplgfa0) > 0; if ($vwpl_oilx && empty($vwplckl3) ) { $vwplckl3 = '<p>
			%%line%% - %%cycler%%<br />
			filesize: %%filebox.filesize%%<br />
			filebytes: %%filebox.filebytes%%<br />
			extension: %%filebox.extension%%<br />
			filename: %%filebox.filename%%<br />
			id: %%filebox.id%%<br/>
			public: %%filebox.public%%<br/>
			<a href="%%filebox.openlink%%">Open</a><br/>
			<a href="%%filebox.downloadlink%%">Download</a><br/>
			</p>'; } $vwplckl3 = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwpl_oilx); $vwplaegnu = 0; if ($vwpl_oilx) { foreach ($vwplgfa0 as $vwply17edn => $vwplf_3k79) { $vwplaegnu++; $vwplhi0uw = $vwplckl3; if ($vwplaegnu % 2) { $vwplyv8z = 'odd'; } else { $vwplyv8z = 'even'; } $vwplsilde = wp_nonce_url('?filebox_id=' . urlencode($vwplf_3k79['id']) . '&filename=' . urlencode($vwplf_3k79['filename']), 'filebox_download::' . $vwplf_3k79['id'], 'signature'); $vwplnw420 = wp_nonce_url('?filebox_id=' . urlencode($vwplf_3k79['id']) . '&filename=' . urlencode($vwplf_3k79['filename']) . '&viewable=1', 'filebox_download::' . $vwplf_3k79['id'], 'signature'); $vwplhi0uw = str_ireplace('%%line%%', $vwplaegnu, $vwplhi0uw); $vwplhi0uw = str_ireplace('%%cycler%%', $vwplyv8z, $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.filesize%%', memberium_app()->wplm2h6($vwplf_3k79['filesize'], 0), $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.filebytes%%', $vwplf_3k79['filesize'], $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.extension%%', $vwplf_3k79['extension'], $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.filename%%', $vwplf_3k79['filename'], $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.id%%', $vwplf_3k79['id'], $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.public%%', $vwplf_3k79['public'], $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.link%%', '?filebox_id=' . urlencode($vwplf_3k79['id']) . '&filename=' . urlencode($vwplf_3k79['filename']), $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.openlink%%', $vwplnw420, $vwplhi0uw); $vwplhi0uw = str_ireplace('%%filebox.downloadlink%%', $vwplsilde, $vwplhi0uw); $vwpltlkdcw .= do_shortcode($vwplhi0uw); } } else { $vwpltlkdcw .= do_shortcode($vwplckl3); } return $vwpltlkdcw; }  function wplm7rcp($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'after' => '', 'before' => '', 'cache' => HOUR_IN_SECONDS, 'capture' => '', 'mode' => 'text', 'htmlattr' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; if (isset($_SESSION['memb_user']['Email']) ) { $vwpll1_x = $this->wplb469($_SESSION['memb_user']['Email']); if ($vwplvpexdn['mode'] == 'text') { switch ($vwpll1_x) { case 1: $vwpltlkdcw = _x('Single Opted In', 'memb_optin_status', 'memberium'); break; case 2: $vwpltlkdcw = _x('Double Opted In', 'memb_optin_status', 'memberium'); break; default: $vwpltlkdcw = _x('Not Opted In', 'memb_optin_status', 'memberium'); break; } } else { $vwpltlkdcw = $vwpll1_x; } } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wplu6oe($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'contact_id' => memberium_app()->wplubo6(), 'date_format' => '', 'default' => '', 'fields' => '', 'htmlattr' => '', 'owner_id' => 0, 'separator' => ' ', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['fields'] = trim($vwplvpexdn['fields']); if (empty($vwplvpexdn['fields']) ) { return; } $vwplvpexdn['contact_id'] = (int) $vwplvpexdn['contact_id'];  if ($vwplvpexdn['owner_id'] > 0) { $vwplvpexdn['owner_id'] = (int) $vwplvpexdn['owner_id']; } else { if ($vwplvpexdn['contact_id'] <> memberium_app()->wplubo6() ) { $vwplj4rq_ = wpllbej::wplrande($vwplvpexdn['contact_id'], true); $vwplvpexdn['owner_id'] = (int) $vwplj4rq_['ownerid']; unset($vwplj4rq_); } else { $vwplvpexdn['owner_id'] = (int) wplsbzgvp::wplc4na('ownerid', 0); } } $vwplz260go = wpllbej::wplcj7f($vwplvpexdn['owner_id'], true); $vwplfu1sbe = explode(',', $vwplvpexdn['fields']); $vwplx6yba = count($vwplfu1sbe); $vwple2rb_ = 0; $vwpltlkdcw = ''; $vwplgyte5 = 0; $vwplvpexdn['fields'] = explode(',', $vwplvpexdn['fields']); foreach($vwplvpexdn['fields'] as $vwple2yn) { $vwplgyte5++; $vwple2yn = strtolower(trim($vwple2yn) ); if (isset($vwplz260go[$vwple2yn]) ) { $vwplpg5x = strtotime($vwplz260go[$vwple2yn]); if ($vwplvpexdn['date_format'] == '' || $vwplpg5x == 0) { $vwplnghzs1 = $vwplz260go[$vwple2yn]; } else { $vwplnghzs1 = date($vwplvpexdn['date_format'], strtotime($vwplz260go[$vwple2yn]) ); } } else { $vwplnghzs1 = $vwplvpexdn['default']; } $vwpltlkdcw .= $vwplnghzs1; if ($vwplgyte5 < $vwplx6yba) { $vwpltlkdcw .= $vwplvpexdn['separator']; } } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr']); }  function wpljjtsx($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'fus_id' => 0, 'fus_ids' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['fus_ids'] = trim($vwplvpexdn['fus_id'] . ',' . $vwplvpexdn['fus_ids'], ','); memberium_app()->wpli5nd($vwplvpexdn['fus_ids'], memberium_app()->wplubo6() ); } function wplb05k($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'default' => '', 'fields' => '', 'htmlattr' => '', 'id' => 0, 'separator' => ' ', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['id'] = (int) $vwplvpexdn['id']; if (empty($vwplvpexdn['fields']) || $vwplvpexdn['id'] < 1) { return; } $vwplfu1sbe = explode(',', strtolower($vwplvpexdn['fields']) ); $vwplx6yba = count($vwplfu1sbe); $vwplb3hm = memberium_app()->wplpg5eox($vwplvpexdn['id'], true); $vwpltlkdcw = ''; foreach ($vwplfu1sbe as $vwple2yn) { $vwple2yn = trim($vwple2yn); $fieldvalue = isset($vwplb3hm[$vwple2yn]) ? $vwplb3hm[$vwple2yn] : $vwplvpexdn['default']; if ($vwple2yn == 'productprice') { $fieldvalue = number_format( (double) $fieldvalue, 2); } elseif ($vwple2yn == 'image.url') { $fieldvalue = 'https://' . wplz8bid::wplm3z9k('appname') . '.infusionsoft.com/cart/pimg.jsp?i=5&t=p&s=x&date=' . time(); } $vwpltlkdcw .= $fieldvalue; if ($vwplx6yba > 1) { $vwpltlkdcw .= $vwplvpexdn['separator']; } } if ($vwplx6yba > 1 && $vwplvpexdn['separator']) { $vwpltlkdcw = substr($vwpltlkdcw, 0, -strlen($vwplvpexdn['separator']) ); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }  function wplogow($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } if (is_user_logged_in() ) { return; }     static $vwplihrt = 0; $vwplihrt++; $vwplsb_pf = array( 'action_id' => '', 'autologin' => false, 'date_fields' => '', 'encoded' => true, 'failure_url' => '', 'form_id' => '', 'goal' => '', 'inf_fields' => false, 'membership_tags' => '',  'pass_fields' => false, 'pass_password' => false, 'remove_accents' => 'n', 'required_fields' => 'FirstName,Email', 'success_url' => '', 'tagids' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['pass_fields'] = wplczvi98::wplbyhn($vwplvpexdn['pass_fields'], false); $vwplvpexdn['pass_password'] = wplczvi98::wplbyhn($vwplvpexdn['pass_password'], false); $vwplvpexdn['inf_fields'] = wplczvi98::wplbyhn($vwplvpexdn['inf_fields'], false); $vwplvpexdn['autologin'] = wplczvi98::wplbyhn($vwplvpexdn['autologin'], false); $vwplvpexdn['encoded'] = wplczvi98::wplbyhn($vwplvpexdn['encoded'], false); if (trim($vwplvpexdn['form_id']) === '') { $vwplvpexdn['form_id'] = 'registration_form_' . $vwplihrt; } $vwplsh985b = base64_encode(serialize(array( 'action_id' => $vwplvpexdn['action_id'], 'autologin' => $vwplvpexdn['autologin'], 'date_fields' => $vwplvpexdn['date_fields'], 'failure_url' => $vwplvpexdn['failure_url'], 'form_id' => $vwplvpexdn['form_id'], 'goal' => $vwplvpexdn['goal'], 'membership_tags' => $vwplvpexdn['membership_tags'], 'pass_fields' => $vwplvpexdn['pass_fields'], 'pass_password' => $vwplvpexdn['pass_password'], 'remove_accents' => $vwplvpexdn['remove_accents'], 'required_fields' => $vwplvpexdn['required_fields'], 'success_url' => $vwplvpexdn['success_url'], 'tagids' => $vwplvpexdn['tagids'], ) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplsh985b); $vwpld576f2 = ''; if (! empty($_SESSION['error_message']) ) { foreach ($_SESSION['error_message'] as $vwplcq9y) { $vwpld576f2 .= '<p class="memb_registration_error"> ' . $vwplcq9y . '</p>'; } } $_SESSION['error_message'] = null; $vwpld576f2 .= '<form method="post" action="" id="' . $vwplvpexdn['form_id'] . '" name="">' . "\n"; $vwpld576f2 .= "<input type=\"hidden\" name=\"memb_form_type\" value=\"memb_registration\">" . "\n"; $vwpld576f2 .= wp_nonce_field($vwplsh985b, '_wpnonce', true, false) . "\n"; $vwpld576f2 .= '<input type="hidden" name="params" value="' . $vwplsh985b . '">' . "\n"; $vwpld576f2 .= '<input type="hidden" name="signature" value="' . $vwpltmfi . '">' . "\n"; $vwpld576f2 .= do_shortcode($vwplckl3) . "\n"; $vwpld576f2 .= '</form>' . "\n\n"; if ($vwplvpexdn['encoded']) { $vwpltlkdcw = '<script type="text/javascript"> document.write(atob("' . substr(base64_encode($vwpld576f2), 0, -2) . '" + "==") ); </script>'; $vwpld576f2 = $vwpltlkdcw; } return $vwpld576f2; }  function wpltn5t() { global $wpdb; if (! wp_verify_nonce($_POST['_wpnonce'], $_POST['params']) ) { wp_die(_x('Invalid Registration Submission', 'memb_registration_form', 'memberium') ); exit; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['params']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_registration_form', 'memberium') ); exit; }  $vwplzzlf5b = apply_filters('memberium_registration_form_pre', $_POST); $vwplrbh71u = array('memb_form_type', '_wpnonce', '_wp_http_referer', 'params', 'signature'); $vwplg6lz4 = unserialize(base64_decode($vwplzzlf5b['params']) ); $vwplm_bmqo = explode(',', $vwplg6lz4['date_fields']); $vwplnrd9 = false; $vwplcq9y = array(); $vwplxsdxcp = false; $vwplonvfma = true; $vwplup7mi = $this->options['settings']['password_field']; $vwpltalx = false; $vwpl_2cd9 = $this->options['settings']['username_field']; $vwplxh7sa0 = array();  if ($vwplg6lz4['remove_accents']) { foreach($vwplzzlf5b as $vwplyq9i7o=>$vwplcjpa) { $vwplzzlf5b[$vwplyq9i7o] = remove_accents($vwplcjpa); } } if (! isset($_POST[$vwplup7mi]) && ! isset($_POST["{$vwplup7mi}_confirmation"]) ) { $_POST["{$vwplup7mi}_confirmation"] = $_POST["{$vwplup7mi}"] = memberium_app()->wpleh1zcw(); }  $vwplkwc4l3 = explode(',', $vwplg6lz4['required_fields']); if (is_array($vwplkwc4l3) ) { foreach ($vwplkwc4l3 as $vwplgzv5p) { if (! isset($_POST[$vwplgzv5p]) ) { $vwplonvfma = false; $vwplnrd9 = true; $vwplcq9y[] = _x('You are missing required fields.', 'memb_registration_form', 'memberium'); } } }  if (! empty($vwplzzlf5b[$vwplup7mi]) && strlen($vwplzzlf5b[$vwplup7mi]) < $this->options['settings']['min_password_length']) { $vwplnrd9 = true; $vwplcq9y[] = sprintf(_x('Your password must be at least %d characters long.', 'memb_registration_form', 'memberium'), $this->options['settings']['min_password_length']); } if (strpos($vwplzzlf5b[$vwplup7mi], '\\') !== false) { $vwplnrd9 = true; $vwplcq9y[] = _x('You may not use the backslash (\\) character in passwords.', 'memb_registration_form', 'memberium'); }  if (is_array($vwplzzlf5b) ) { foreach ($vwplzzlf5b as $vwply17edn => $vwplph268z) { if (isset($vwplzzlf5b[$vwply17edn . '_confirmation']) && $vwplzzlf5b[$vwply17edn] <> $vwplzzlf5b[$vwply17edn . '_confirmation']) { $vwplnrd9 = true; $vwplcq9y[] = _x('Your confirmed fields do not match.', 'memb_registration_form', 'memberium'); } } } $vwplzzlf5b[$vwpl_2cd9] = stripslashes($vwplzzlf5b[$vwpl_2cd9]);  $vwplx1ap5_ = "SELECT COUNT(*) FROM `{$wpdb->users}` WHERE `user_login` = %s OR `user_email` = %s;"; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $vwplzzlf5b[$vwpl_2cd9], $vwplzzlf5b[$vwpl_2cd9]); $vwpltidk1 = $wpdb->get_col($vwplx1ap5_, 0); $vwplxsdxcp = (boolean) array_shift($vwpltidk1);  if (! $vwplxsdxcp) { $vwplc0g3p = array($vwplup7mi, 'Groups'); $vwplv80sz = array($vwpl_2cd9 => $vwplzzlf5b[$vwpl_2cd9]); $vwplqmbq = $this->isdk->dsQuery('Contact', 1000, 0, $vwplv80sz, $vwplc0g3p); if (is_array($vwplqmbq) ) { foreach ($vwplqmbq as $vwplrp9u24) { if ($vwplrp9u24[$vwplup7mi] > '') { $vwplxsdxcp = true; } }  } }  if (! $vwplxsdxcp && $vwpl_2cd9 <> 'Email' && isset($vwplzzlf5b['Email']) ) { $vwplc0g3p = array($vwplup7mi, 'Groups', 'Id', 'Email'); $vwplv80sz = array('Email' => $vwplzzlf5b[$vwpl_2cd9]);  $vwplqmbq = $this->isdk->dsQuery('Contact', 1000, 0, $vwplv80sz, $vwplc0g3p); if (is_array($vwplqmbq) ) { foreach ($vwplqmbq as $vwplrp9u24) { if ($vwplrp9u24[$vwplup7mi] > '') { $vwplxsdxcp = true; } }  } } if ($vwplxsdxcp) { $vwplcq9y[] = _x('That username is not available.', 'memb_registration_form', 'memberium'); }  if (! $vwplnrd9 && ! $vwplxsdxcp) { if (empty($_POST[$vwplup7mi]) ) { $_POST[$vwplup7mi] = memberium_app()->wpleh1zcw(); } $vwplpv8rgm = wpllbej::wplntnyv('Contact', true); $vwplrp9u24 = array(); foreach ($_POST as $vwply17edn => $vwplph268z) { if (in_array($vwply17edn, $vwplm_bmqo) ) { $vwplph268z = date('Ymd\Th:i:s', strtotime($vwplph268z) ); } if (in_array($vwply17edn, $vwplpv8rgm) ) { $vwplrp9u24[$vwply17edn] = $vwplph268z; } }  if (! empty($this->options['settings']['local_auth_only']) ) { unset($vwplrp9u24[$vwplup7mi]); } if ($vwplg6lz4['pass_password'] == 0) { $vwplrbh71u[] = $vwplup7mi; $vwplrbh71u[] = $vwplup7mi . '_confirmation'; }  if (is_array($vwplrp9u24) && ! empty($vwplrp9u24) && $vwplg6lz4['pass_fields']) { foreach($vwplrp9u24 as $vwply17edn => $vwplph268z) { if (! in_array($vwply17edn, $vwplrbh71u) ) { $vwplyct0 = ''; if ($vwplg6lz4['inf_fields']) { $vwply17edn = (substr($vwply17edn, 0, 1) == '_') ? 'inf_custom' . $vwply17edn : 'inf_field_' . $vwply17edn; } $vwplxh7sa0[$vwply17edn] = urlencode($vwplph268z); } } foreach ($_POST as $vwply17edn => $vwplph268z) { if (! isset($vwplrp9u24[$vwply17edn]) ) { if (! in_array($vwply17edn, $vwplrbh71u) ) { $vwplxh7sa0[$vwply17edn] = urlencode($vwplph268z); } } } }  if (!empty($vwplrp9u24) ) {  $vwplvtmqd = $this->isdk->addWithDupCheck($vwplrp9u24, 'Email'); $this->isdk->updateCon($vwplvtmqd, $vwplrp9u24); $this->isdk->optin($vwplrp9u24['Email'], _x('Membership Signup New User', 'memb_registration_form', 'memberium') ); if (! empty($vwplrp9u24['EmailAddress2']) ) { $this->isdk->optin($vwplrp9u24['EmailAddress2'], _x('Membership Signup New User', 'memb_registration_form', 'memberium') ); } if (! empty($vwplrp9u24['EmailAddress3']) ) { $this->isdk->optin($vwplrp9u24['EmailAddress3'], _x('Membership Signup New User', 'memb_registration_form', 'memberium') ); } if ($vwplvtmqd) { memberium_app()->wplge1yc6($vwplg6lz4['goal'], $vwplvtmqd); memberium_app()->wplt263_($vwplg6lz4['tagids'], $vwplvtmqd); memberium_app()->wplmupt($vwplg6lz4['action_id'], $vwplvtmqd); $rows = memberium_app()->wplj9ye($vwplvtmqd);  $user_id = memberium_app()->wplqd_lae($vwplvtmqd, $_POST[$vwplup7mi]);  if ($vwplg6lz4['autologin']) { $vwplgogvie = get_user_by('email', $vwplrp9u24['Email']); $vwpln1la_j = $vwplrp9u24[$this->options['settings']['username_field']]; if (! empty($vwplg6lz4['success_url']) ) { $this->redirect_url = add_query_arg($vwplxh7sa0, $vwplg6lz4['success_url']); } wp_set_auth_cookie($user_id); wp_set_current_user($user_id); $this->wplmmu74($vwpln1la_j); do_action('wp_login', $vwpln1la_j, $vwplgogvie); $this->wplo4tqd($vwplrp9u24, $user_id); $this->wplh3645(); } } else { $vwplnrd9 = true; } } }  if ($vwplnrd9 || $vwplxsdxcp) { $vwplimo5 = $vwplg6lz4['failure_url']; } else { $vwplimo5 = $vwplg6lz4['success_url']; }  if (! empty($vwplcq9y) ) { $_SESSION['error_message'] = $vwplcq9y; }  if (! empty($vwplimo5) ) { wplpwn3::wplbryv(); $vwplimo5 = add_query_arg($vwplxh7sa0, $vwplimo5) ; wp_redirect($vwplimo5); exit; } } function wplmqma4($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return wp_login_url(); } $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'htmlattr' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplcltpy = $this->options['settings']['registration_url']; if (! $vwplcltpy && $this->options['settings']['login_url'] > 0) { $vwplcltpy = $this->options['settings']['login_url']; } if ($vwplcltpy) { $vwpltlkdcw = get_permalink($vwplcltpy); } else { $vwpltlkdcw = get_site_url(); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wplh87jy($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'authkey' => '', 'cachetime' => 3600, 'capture' => '', 'field' => 'post_content', 'id' => 0, 'txtfmt' => '', 'url' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (empty($vwplvpexdn['id']) || empty($vwplvpexdn['url']) || empty($vwplvpexdn['authkey']) || empty($vwplvpexdn['field']) ) {  } $vwplxoxi1e = array( 'user-agent' => 'Memberium', 'body' => array('contactId' => memberium_app()->wplubo6() ), ); $vwplbybpl8 = $vwplvpexdn['url'] . '?operation=get-post&auth_key=' . urlencode(trim($vwplvpexdn['authkey']) ) . '&post_id=' . $vwplvpexdn['id'] . '&field=' . urlencode(trim($vwplvpexdn['field']) ); $response = wp_remote_post($vwplbybpl8, $vwplxoxi1e); $vwpltlkdcw = do_shortcode($response['body']); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wpl_zet5x($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; } if (is_feed() ) { return; } $vwplsb_pf = array( 'fus_id' => 0, 'fus_ids' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['fus_ids'] = trim($vwplvpexdn['fus_id'] . ',' . $vwplvpexdn['fus_ids'], ', '); memberium_app()->wplkm9bv($vwplvpexdn['fus_ids'], memberium_app()->wplubo6() ); }  function wplo5_i0($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } $vwplsb_pf = array( 'tag_id' => 0, 'contact_id' => memberium_app()->wplubo6(), ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if ($vwplvpexdn['tag_id'] > '') { memberium_app()->wplt263_($vwplvpexdn['tag_id'], $vwplvpexdn['contact_id']); } } function wplmo3ays($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } $vwplsb_pf = array( 'action_id' => 0, 'force_sync' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); memberium_app()->wplmupt($vwplvpexdn['action_id'], memberium_app()->wplubo6()); }  function wplmcvlmh($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'action_ids' => '',  'after' => '', 'before' => '', 'bucket' => '', 'debug' => 0, 'direct_link' => 'no',  'expiring' => '', 'fus_ids' => '',  'goals' => '', 'htmlattr' => '', 'object' => '', 'profile' => '', 'protocol' => 'https', 'require_login' => 'no',  'tag_ids' => '', 'tokens' => '',  'class' => '', 'download' => '', 'id' => '', 'rel' => '', 'style' => '', 'target' => '', 'type' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; $vwplvpexdn['profile'] = strtolower(trim($vwplvpexdn['profile']) ); if (isset($this->options['remote_files'][$vwplvpexdn['profile']]) ) { $vwplvpexdn['expiring'] = empty($vwplvpexdn['expiring']) ? $this->options['remote_files'][$vwplvpexdn['profile']]['expiration'] : (int) $vwplvpexdn['expiring']; $vwplvpexdn['bucket'] = empty($vwplvpexdn['bucket']) ? $this->options['remote_files'][$vwplvpexdn['profile']]['bucket'] : $vwplvpexdn['bucket']; $vwplff5g = empty($vwplff5g) ? $this->options['remote_files'][$vwplvpexdn['profile']]['host'] : $vwplff5g; $vwplbu4on = empty($vwplbu4on) ? $this->options['remote_files'][$vwplvpexdn['profile']]['access_key'] : $vwplbu4on; $vwplbu82r = empty($vwplbu82r) ? $this->options['remote_files'][$vwplvpexdn['profile']]['secret_key'] : $vwplbu82r; } if (strtolower(trim($vwplvpexdn['direct_link']) ) == 'no') { $vwploia7_d = array(); $vwploia7_d['actionset'] = $vwplvpexdn['action_ids']; $vwploia7_d['debug'] = $vwplvpexdn['debug']; $vwploia7_d['expiring'] = $vwplvpexdn['expiring']; $vwploia7_d['fus'] = $vwplvpexdn['fus_ids']; $vwploia7_d['goals'] = $vwplvpexdn['goals']; $vwploia7_d['object'] = $vwplvpexdn['object']; $vwploia7_d['profile'] = $vwplvpexdn['profile']; $vwploia7_d['protocol'] = $vwplvpexdn['protocol']; $vwploia7_d['require_login'] = $vwplvpexdn['require_login']; $vwploia7_d['tags'] = $vwplvpexdn['tag_ids']; $vwploia7_d['tokens'] = $vwplvpexdn['tokens']; $vwplexgq1 = empty($_SERVER['REQUEST_URI']) ? '' : $_SERVER['REQUEST_URI']; if (strpos($vwplexgq1, '?') === false) { $vwplexgq1 .= '?'; } else { $vwplexgq1 .= '&'; } $vwplun47e = base64_encode(serialize($vwploia7_d) ); $vwplfkojlf = 'memb_s3link=' . $vwplun47e;  $vwplso1pw = 'verification'; $vwploia7_d = $vwplun47e; $action_url = wp_nonce_url($vwplfkojlf, $vwploia7_d, $vwplso1pw);   $vwpln208 = $vwplexgq1 . $action_url; } else { $vwpln208 = memberium_app()->wpls6uf1($vwplbu4on, $vwplbu82r, $vwplvpexdn['protocol'], $vwplff5g, $vwplvpexdn['bucket'], $vwplvpexdn['object'], $vwplvpexdn['expiring']); } if (strtolower($vwplvpexdn['htmlattr']) == 'all') { $vwpllkg9a6 = array( 'action_ids', 'after', 'before', 'bucket', 'debug', 'direct_link', 'expiring', 'fus_ids', 'goals', 'htmlattr', 'object', 'profile', 'protocol', 'require_login', 'tag_ids', 'tokens', ); $vwpltlkdcw = '<a href="' . $vwpln208 . '"'; foreach($vwplvpexdn as $vwplyq9i7o => $vwplcjpa) { if (! empty($vwplvpexdn[$vwplyq9i7o]) && ! in_array($vwplyq9i7o, $vwpllkg9a6) ) { $vwpltlkdcw .= ' ' . $vwplyq9i7o . '="' . $vwplcjpa . '" '; } } $vwpltlkdcw .= '>' . $vwplckl3 . '</a>'; $vwplvpexdn['htmlattr'] = ''; } else { $vwpltlkdcw = $vwpln208; } return wplczvi98::wplyhei6(false, $vwpltlkdcw, '', '', $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wplagyk($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } static $vwplas73j = 0; $vwplas73j++; $vwplsb_pf = array( 'autoplay' => '', 'bucket' => '', 'controls' => '', 'direct_link' => 'no',  'download' => 0, 'expiring' => '', 'height' => 0, 'loop' => 'off', 'muted' => '', 'object' => '', 'poster' => '', 'preload' => '', 'profile' => '', 'protocol' => 'https', 'require_login' => 'no',  'src' => '', 'width' => 0, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplbcf9ny = ''; $vwpld576f2 = ''; $vwplvpexdn['profile'] = strtolower(trim($vwplvpexdn['profile']) ); if (isset($this->options['remote_files'][$vwplvpexdn['profile']]) ) { $vwplvpexdn['expiring'] = empty($vwplvpexdn['expiring']) ? $this->options['remote_files'][$vwplvpexdn['profile']]['expiration'] : (int) $vwplvpexdn['expiring']; $vwplvpexdn['bucket'] = empty($vwplvpexdn['bucket']) ? $this->options['remote_files'][$vwplvpexdn['profile']]['bucket'] : $vwplvpexdn['bucket']; $vwplff5g = empty($vwplff5g) ? $this->options['remote_files'][$vwplvpexdn['profile']]['host'] : $vwplff5g; $vwplbu4on = empty($vwplbu4on) ? $this->options['remote_files'][$vwplvpexdn['profile']]['access_key'] : $vwplbu4on; $vwplbu82r = empty($vwplbu82r) ? $this->options['remote_files'][$vwplvpexdn['profile']]['secret_key'] : $vwplbu82r; } if (false && strtolower(trim($vwplvpexdn['direct_link']) ) == 'no') { $vwploia7_d['expiring'] = $vwplvpexdn['expiring']; $vwploia7_d['object'] = $vwplvpexdn['object']; $vwploia7_d['profile'] = $vwplvpexdn['profile']; $vwploia7_d['require_login'] = $vwplvpexdn['require_login']; $vwploia7_d['protocol'] = $vwplvpexdn['protocol']; $vwplun47e = base64_encode(serialize($vwploia7_d) ); $vwplfkojlf = '?memb_s3link=' . $vwplun47e; $vwplso1pw = 'verification'; $vwploia7_d = $vwplun47e; $vwplcv1j = wp_nonce_url($vwplfkojlf, $vwploia7_d, $vwplso1pw); $vwplfkojlf = site_url() . $vwplcv1j; } else { $vwplfkojlf = memberium_app()->wpls6uf1($vwplbu4on, $vwplbu82r, $vwplvpexdn['protocol'], $vwplff5g, $vwplvpexdn['bucket'], $vwplvpexdn['object'], $vwplvpexdn['expiring']); } if ($vwplvpexdn['width'] > 0) { $vwplpf76hx = ' style="width:' . $vwplvpexdn['width'] . 'px;" '; } $vwpld576f2 .= '<div '. $vwplpf76hx .' class="wp-video">'; $vwpld576f2 .= '<audio class="wp-audio-shortcode" id="secureaudio-' . $vwplas73j . '" '; if ($vwplvpexdn['width'] > 0) { $vwpld576f2 .= ' width="' . $vwplvpexdn['width'] . '" '; } if ($vwplvpexdn['height'] > 0) { $vwpld576f2 .= ' height="' . $vwplvpexdn['height'] . '" '; } if ($vwplvpexdn['preload'] > '') { $vwpld576f2 .= ' autobuffer="autobuffer" preload="' . $vwplvpexdn['preload'] . '" '; } if ($vwplvpexdn['controls'] > '') { $vwpld576f2 .= ' controls="controls" '; } if ($vwplvpexdn['autoplay'] > '') { $vwpld576f2 .= ' autoplay="autoplay" '; } if ($vwplvpexdn['muted'] > '') { $vwpld576f2 .= ' muted="muted" '; } if ($vwplvpexdn['poster'] > '') { $vwpld576f2 .= ' poster="' . $vwplvpexdn['poster'] . '" '; } if ($vwplvpexdn['loop'] > '') { $vwpld576f2 .= ' loop="' . $vwplvpexdn['loop'] . '" '; } if (! $vwplvpexdn['download']) { $vwpld576f2 .= ' controlsList="nodownload" '; } $vwpld576f2 .= '>'; $vwpld576f2 .= '<source src="' . $vwplfkojlf .'" />'; $vwpld576f2 .= '</audio></div>'; return $vwpld576f2; } function wplagt4($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } static $vwplas73j = 0; $vwplas73j++; $vwplsb_pf = array( 'autoplay' => '', 'bucket' => '', 'controls' => '', 'direct_link' => 'no',  'expiring' => '', 'height' => 0, 'loop' => 'off', 'muted' => '', 'object' => '', 'poster' => '', 'preload' => '', 'profile' => '', 'protocol' => 'https', 'require_login' => 'no',  'src' => '', 'width' => 0, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplbcf9ny = ''; $vwpld576f2 = ''; $vwplvpexdn['profile'] = strtolower(trim($vwplvpexdn['profile']) ); if (isset($this->options['remote_files'][$vwplvpexdn['profile']]) ) { $vwplvpexdn['expiring'] = empty($vwplvpexdn['expiring']) ? $this->options['remote_files'][$vwplvpexdn['profile']]['expiration'] : (int) $vwplvpexdn['expiring']; $vwplvpexdn['bucket'] = empty($vwplvpexdn['bucket']) ? $this->options['remote_files'][$vwplvpexdn['profile']]['bucket'] : $vwplvpexdn['bucket']; $vwplff5g = empty($vwplff5g) ? $this->options['remote_files'][$vwplvpexdn['profile']]['host'] : $vwplff5g; $vwplbu4on = empty($vwplbu4on) ? $this->options['remote_files'][$vwplvpexdn['profile']]['access_key'] : $vwplbu4on; $vwplbu82r = empty($vwplbu82r) ? $this->options['remote_files'][$vwplvpexdn['profile']]['secret_key'] : $vwplbu82r; } if (false && strtolower(trim($vwplvpexdn['direct_link']) ) == 'no') { $vwploia7_d['expiring'] = $vwplvpexdn['expiring']; $vwploia7_d['object'] = $vwplvpexdn['object']; $vwploia7_d['profile'] = $vwplvpexdn['profile']; $vwploia7_d['require_login'] = $vwplvpexdn['require_login']; $vwploia7_d['protocol'] = $vwplvpexdn['protocol']; $vwplun47e = base64_encode(serialize($vwploia7_d) ); $vwplfkojlf = '?memb_s3link=' . $vwplun47e; $vwplso1pw = 'verification'; $vwploia7_d = $vwplun47e; $vwplcv1j = wp_nonce_url($vwplfkojlf, $vwploia7_d, $vwplso1pw); $vwplfkojlf = site_url() . $vwplcv1j; } else { $vwplfkojlf = memberium_app()->wpls6uf1($vwplbu4on, $vwplbu82r, $vwplvpexdn['protocol'], $vwplff5g, $vwplvpexdn['bucket'], $vwplvpexdn['object'], $vwplvpexdn['expiring']); } if ($vwplvpexdn['width'] > 0) { $vwplpf76hx = ' style="width:' . $vwplvpexdn['width'] . 'px;" '; } $vwpld576f2 .= '<div '. $vwplpf76hx .' class="wp-video">'; $vwpld576f2 .= '<video class="wp-video-shortcode" id="securevideo-' . $vwplas73j . '" '; if ($vwplvpexdn['width'] > 0) { $vwpld576f2 .= ' width="' . $vwplvpexdn['width'] . '" '; } if ($vwplvpexdn['height'] > 0) { $vwpld576f2 .= ' height="' . $vwplvpexdn['height'] . '" '; } if ($vwplvpexdn['preload'] > '') { $vwpld576f2 .= ' autobuffer="autobuffer" preload="' . $vwplvpexdn['preload'] . '" '; } if ($vwplvpexdn['controls'] > '') { $vwpld576f2 .= ' controls="controls" '; } if ($vwplvpexdn['autoplay'] > '') { $vwpld576f2 .= ' autoplay="autoplay" '; } if ($vwplvpexdn['muted'] > '') { $vwpld576f2 .= ' muted="muted" '; } if ($vwplvpexdn['poster'] > '') { $vwpld576f2 .= ' poster="' . $vwplvpexdn['poster'] . '" '; } if ($vwplvpexdn['loop'] > '') { $vwpld576f2 .= ' loop="' . $vwplvpexdn['loop'] . '" '; } $vwpld576f2 .= '>'; $vwpld576f2 .= '<source src="' . $vwplfkojlf .'" />'; $vwpld576f2 .= '</video></div>'; return $vwpld576f2; } function wpllsuar($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! empty($this->options['settings']['local_auth_only']) ) { return; } if (is_feed() ) { return; } static $vwplyqfz = 0; $vwplyqfz++; $vwplsb_pf = array( 'buttontext' => 'Send Password', 'emailtext' => 'Email Address', 'successurl' => '',  'failureurl' => '',  'template_id' => 0, 'tag_id' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpluj8al3 = 'memb_password_send-' . $vwplyqfz; $vwpld576f2 = ''; $vwplvpexdn['template_id'] = (int) $vwplvpexdn['template_id']; $vwpltmfi = memberium_app()->wpln4nyq2($vwplvpexdn['template_id']); if (! empty($this->flash) ) { $vwpld576f2 .= '<div class="password_send_message">' . $this->flash . '</div>'; } $vwpld576f2 .= "<form name=\"{$vwpluj8al3}\" id=\"{$vwpluj8al3}\" method=\"post\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"form_id\" value=\"{$vwplyqfz}\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"template_id\" value=\"{$vwplvpexdn['template_id']}\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"signature\" value=\"{$vwpltmfi}\">"; $vwpld576f2 .= '<input type="hidden" name="successurl" value="' . base64_encode($vwplvpexdn['successurl']) . '">'; $vwpld576f2 .= '<input type="hidden" name="failureurl" value="' . base64_encode($vwplvpexdn['failureurl']) . '">'; $vwpld576f2 .= '<input type="hidden" name="memb_form_type" value="memb_send_password">'; $vwpld576f2 .= '<div id="' . $vwpluj8al3 . '-block1">'; $vwpld576f2 .= '<label id="' . $vwpluj8al3 . '-email-label">' . $vwplvpexdn['emailtext'] . ':</label>'; $vwpld576f2 .= '<input id="' . $vwpluj8al3 . '-email-input" name="email" type="email" required value="">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div id="' . $vwpluj8al3 . '-block2">'; $vwpld576f2 .= '<input type="submit" value="' . $vwplvpexdn['buttontext'] . '" name="submit">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= "</form>"; $this->flash = ''; return $vwpld576f2; } function wpli3e6_() { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['template_id']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_send_password', 'memberium') ); exit; } global $i2sdk; $this->flash = 'There was an error Looking up that account.'; $vwplt9si2 = true; $vwplyqfz = (int) $_POST['form_id']; $vwplmwynkc = (int) $_POST['template_id']; $vwplz4izhe = strtolower(trim($_POST['email']) ); $vwpl_gmn = base64_decode($_POST['successurl']); $vwplxjnz = base64_decode($_POST['failureurl']); $vwpltalx = false; $vwplup7mi = $this->options['settings']['password_field']; if (trim($_POST['email']) == '') { $this->flash = 'You must submit an email address.'; return; } $vwplgogvie = get_user_by('email', $vwplz4izhe); if ($vwplgogvie) { $vwplvtmqd = wpllbej::wplbmo_1($vwplgogvie->ID); if (! $vwplvtmqd) { memberium_app()->wplqvqrie($vwplz4izhe); $vwplvtmqd = wpllbej::wplbmo_1($vwplgogvie->ID); } if ($vwplvtmqd) { $vwplrp9u24 = wpllbej::wplrande($vwplvtmqd); } } if (empty($vwplrp9u24) ) { memberium_app()->wplqvqrie($vwplz4izhe); $vwplj9dl = wpllbej::wplnu4bn($vwplz4izhe); if (is_array($vwplj9dl) ) { $vwplvtmqd = $vwplj9dl[0]; } } if (empty($this->options['settings']['local_auth_only']) ) { if ($vwplvtmqd > 0) { if (isset($vwplrp9u24[$vwplup7mi]) && $vwplrp9u24[$vwplup7mi] == 'PASSWORD_PLACEHOLDER') { $vwplckqhw = memberium_app()->wpleh1zcw(); $vwplrp9u24[$vwplup7mi] = $vwplckqhw; memberium_app()->wplto2h4($vwplrp9u24); $this->isdk->updateCon($vwplvtmqd, array($vwplup7mi => $vwplckqhw) ); memberium_app()->wplqd_lae($vwplvtmqd); } } } if ($vwplmwynkc) { if ($vwplvtmqd > 0) { $vwpldkr03x = array($vwplvtmqd); } if (! empty ($vwpldkr03x) ) { $vwpll1_x = $this->isdk->sendTemplate($vwpldkr03x, $vwplmwynkc); $vwpltalx = true; } } else { if (! empty($vwplrp9u24) ) { $password = empty($vwplrp9u24[$vwplup7mi]) ? '' : $vwplrp9u24[$vwplup7mi]; $first_name = empty($vwplrp9u24['FirstName']) ? '' : $vwplrp9u24['FirstName']; $from = get_bloginfo('admin_email'); $to = $vwplz4izhe; $subject = sprintf(_x('Your Password for %s', 'memb_send_password', 'memberium'), get_bloginfo('name') ); $message = sprintf(_x("Dear %s\n\nYour password is: %s\n\n- %s\n", 'memb_send_password', 'memberium'), $first_name, $password, get_bloginfo('name') ); wp_mail($to, $subject, $message); $vwpltalx = true; } else { $this->flash = 'Account not found.'; } } if ($vwpltalx) { $this->flash = _x('Your password has been emailed to you.  Please be sure to check your spam folder.', 'memb_send_password', 'memberium'); if (! empty($vwpl_gmn) ) { wplpwn3::wplbryv(); wp_redirect($vwpl_gmn); exit; } } if (! $vwpltalx) { if (! empty($vwplxjnz) ) { wplpwn3::wplbryv(); wp_redirect($vwplxjnz); exit; } } memberium_app()->wpln6xe(); } function wplx1lp($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } $vwplsb_pf = array( 'domain' => $_SERVER['HTTP_HOST'], 'expiration' => 'forever', 'httponly' => 0, 'name' => '', 'path' => '/', 'secure' => 0, 'value' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvyz9nr = array ( '__utma', '__utmc', '__utmz', 'NREUM', 'PHPSESSID', 'wordpress_test_cookie', 'wp-settings-1', 'wp-settings-time-1', ); if (in_array($vwplvpexdn['name'], $vwplvyz9nr) ) { return; } $vwplvpexdn['secure'] = (boolean) $vwplvpexdn['secure']; $vwplvpexdn['httponly'] = (boolean) $vwplvpexdn['httponly'];  $vwplvpexdn['expiration'] = strtolower(trim($vwplvpexdn['expiration']) ); if ($vwplvpexdn['expiration'] === 'forever') { $vwplvpexdn['expiration'] = '2038-01-19 00:00:00'; } if ($vwplvpexdn['expiration'] == '' || $vwplvpexdn['expiration'] == 'session') { $vwplvpexdn['expiration'] = 0; } else { if ($vwplvpexdn['expiration'] === (int) $vwplvpexdn['expiration']) { $vwplvpexdn['expiration'] = $vwplvpexdn['expiration'] + time(); } else { $vwplvpexdn['expiration'] = strtotime($vwplvpexdn['expiration']); } } $_COOKIE[$vwplvpexdn['name']] = $vwplvpexdn['value']; $this->set_cookie[$vwplvpexdn['name']] = array( 'name' => $vwplvpexdn['name'], 'value' => $vwplvpexdn['value'], 'expiration' => $vwplvpexdn['expiration'], 'path' => $vwplvpexdn['path'], 'domain' => $vwplvpexdn['domain'], 'secure' => $vwplvpexdn['secure'], 'httponly' => $vwplvpexdn['httponly'], ); } function wplrhln($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'action' => 'default', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['action'] = strtolower(trim($vwplvpexdn['action']) ); if (! in_array($vwplvpexdn['action'], array('default', 'show', 'hide', 'redirect', 'excerpt') ) ) { $vwplvpexdn['action'] = 'default'; } $this->wplc2skz8($vwplvpexdn['action']); } function wplc0j2($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } if (! memberium_app()->wplubo6()) { return; } $vwplsb_pf = array( 'tag_id' => 0, 'contact_id' => memberium_app()->wplubo6(), ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); memberium_app()->wplt263_($vwplvpexdn['tag_id'], $vwplvpexdn['contact_id']); } function wpln_ek($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } $user_id = get_current_user_id(); if (! $user_id) { return; } $vwplsb_pf = array( 'tokens' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); memberium_app()->wplwuo3z8($vwplvpexdn['tokens']); }  function wplhudvbf($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'date_format' => 'F jS, Y', 'date' => '', 'days' => 0, 'months' => 0, 'tagids' => '', 'txtfmt' => '', 'weeks' => 0, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltalx = false; $vwplvpexdn['days'] = (int) $vwplvpexdn['days'] + ( (int) $vwplvpexdn['weeks'] * 7) + ( (int) $vwplvpexdn['months'] * 31); if ($vwplvpexdn['days'] < 1 && $vwplvpexdn['date'] == '') { return; } $vwpls0hwb5 = array_map(explode(',', trim($vwplvpexdn['tagids']) ) ); if ($this->is_administrator) { $vwpltalx = true; } else { if ($vwplvpexdn['date'] == '') { $vwplvpexdn['date'] = get_userdata(get_current_user_id() )->user_registered; } if ($vwplvpexdn['days'] > 0) { $vwplehmpno = strtotime($vwplvpexdn['date'] . ' + ' . $vwplvpexdn['days'] . ' days'); } else { $vwplehmpno = strtotime($vwplvpexdn['date']); } if ($vwplehmpno < time() ) { $vwpltalx = true; if (! empty($vwpls0hwb5) ) { if (! wplj_l2t::wpl_n2s9($vwpls0hwb5) ) { $vwpltalx = false; } } } else { $vwpltalx = false; } } if ($vwpltalx) { $vwplckl3 = str_ireplace('{{:date:}}', date($vwplvpexdn['date_format'], $vwplehmpno), $vwplckl3); $vwplrobk = (int) ( ($vwplehmpno - time() ) / 86400); $vwplrobk .= $vwplrobk > 1 ? ' days' : ' day'; $vwplckl3 = str_ireplace('{{:days:}}', $vwplrobk, $vwplckl3); $vwplk4xac = (int) ( ($vwplehmpno - time() ) / (7 * 86400) ); $vwplk4xac .= $vwplk4xac > 1 ? ' weeks' : ' week'; $vwplckl3 = str_ireplace('{{:weeks:}}', $vwplk4xac, $vwplckl3); $vwpln5u8zi = (int) ( ($vwplehmpno - time() ) / (30 * 86400) ); $vwpln5u8zi .= $vwpln5u8zi > 1 ? ' months' : ' month'; $vwplckl3 = str_ireplace('{{:months:}}', $vwpln5u8zi, $vwplckl3); $vwplrobk = intval( ($vwplehmpno - time() - (7 * 86400 * $vwplk4xac) ) / 86400); $vwplrobk .= $vwplrobk > 1 ? ' days' : ' day'; $vwplckl3 = str_ireplace('{{:compoundtime:}}', $vwplk4xac . ' and ' . $vwplrobk, $vwplckl3); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplk2s6($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'date_format' => 'F jS, Y', 'end' => '', 'start' => '', 'tagids' => '', 'txtfmt' => '', 'tz' => get_option('timezone_string'), ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (! in_array($vwplvpexdn['tz'], timezone_identifiers_list() ) ) { $vwplvpexdn['tz'] = get_option('timezone_string'); } $vwplf_ito = date_default_timezone_get(); if ($vwplvpexdn['tz'] > '') { date_default_timezone_set($vwplvpexdn['tz']); } $vwplchls = (int) strtotime($vwplvpexdn['start']); $vwplyq_l = strtotime($vwplvpexdn['end']) ? (int) strtotime($vwplvpexdn['end']) : time() + 1; $vwplpg5x = time(); date_default_timezone_set($vwplf_ito); $vwpltalx = false; $vwpls0hwb5 = explode(',', trim($vwplvpexdn['tagids']) );  if ($vwplpg5x > $vwplchls && $vwplpg5x < $vwplyq_l) { $vwpltalx = true; }  if (! empty($vwplvpexdn['tagids']) ) { if (! wplj_l2t::wpl_n2s9($vwplvpexdn['tagids']) ) { $vwpltalx = false; } } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, TRUE, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }  function wplvst4x($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'date_format' => 'F jS, Y', 'date' => '', 'days' => 0, 'months' => 0, 'tagids' => '', 'txtfmt' => '', 'weeks' => 0, 'years' => 0, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['days'] = (int) $vwplvpexdn['days'] + ( (int) $vwplvpexdn['weeks'] * 7) + ( (int) $vwplvpexdn['months'] * 30) + ( (int) $vwplvpexdn['years'] * 365); $vwpls0hwb5 = array_filter(explode(',', trim($vwplvpexdn['tagids']) ) ); $vwpltalx = false; if (empty($vwplvpexdn['date']) ) { $vwplvpexdn['date'] = get_userdata(get_current_user_id() )->user_registered; $vwplehmpno = strtotime($vwplvpexdn['date'] . ' + ' . $vwplvpexdn['days'] . ' days'); } else { $vwplehmpno = strtotime($vwplvpexdn['date']); } $vwpltalx = (bool) ($vwplehmpno > time() ); if (! empty($vwpls0hwb5) ) { if (! wplj_l2t::wpl_n2s9($vwpls0hwb5) ) { $vwpltalx = false; } } if ($vwpltalx) { $vwplckl3 = str_ireplace('{{:date:}}', date($vwplvpexdn['date_format'], $vwplehmpno), $vwplckl3); $vwplrobk = (int) ( ($vwplehmpno - time() ) / 86400); $vwplrobk .= $vwplrobk > 1 ? ' days' : ' day'; $vwplckl3 = str_ireplace('{{:days:}}', $vwplrobk, $vwplckl3); $vwplk4xac = (int) ( ($vwplehmpno - time() ) / (7 * 86400) ); $vwplk4xac .= $vwplk4xac > 1 ? ' weeks' : ' week'; $vwplckl3 = str_ireplace('{{:weeks:}}', $vwplk4xac, $vwplckl3); $vwpln5u8zi = (int) ( ($vwplehmpno - time() ) / (30 * 86400) ); $vwpln5u8zi .= $vwpln5u8zi > 1 ? ' months' : ' month'; $vwplckl3 = str_ireplace('{{:months:}}', $vwpln5u8zi, $vwplckl3); $vwplk4xac = intval( ($vwplehmpno - time() - (7 * 86400 * $vwplk4xac) ) / 86400); $vwplk4xac .= $vwplk4xac > 1 ? ' days' : ' day'; $vwplckl3 = str_ireplace('{{:compoundtime:}}', $vwplk4xac . ' and ' . $vwplrobk, $vwplckl3); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwpltalx); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplnpq15b($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } static $vwplas73j = 0; $vwplas73j++; $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'class' => 'memberium_message', 'names' => '', 'style' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['names'] = array_filter(array_map('trim', explode(',', $vwplvpexdn['names']) ) ); $vwplg3b8w = array(); if (! empty($_SESSION['flash']) ) { if (empty($vwplvpexdn['names']) ) { foreach($_SESSION['flash'] as $vwply17edn => $vwplygr2) { $vwplg3b8w[] = $vwplygr2; unset($_SESSION['flash'][$vwply17edn]); } } else { foreach($vwplvpexdn['names'] as $name) { if (! empty($_SESSION['flash'][$name]) ) { $vwplg3b8w[] = $name; unset($_SESSION['flash'][$name]); } } } } $vwpltlkdcw = ''; foreach($vwplg3b8w as $vwplygr2) { if (empty($vwplvpexdn['before']) && empty($vwplvpexdn['after']) ) { $vwpltlkdcw .= '<div class="' . $vwplvpexdn['class'] . '" style="' . $vwplvpexdn['style'] . '">' . $vwplygr2 . '</div>'; } else { $vwpltlkdcw .= $vwplvpexdn['before'] . $vwplygr2 . $vwplvpexdn['after']; } } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplqsjdiu($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'default' => '', 'fields' => '', 'id' => 0, 'separator' => ' ', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['id'] = (int) $vwplvpexdn['id']; if ($vwplvpexdn['fields'] = '' || $vwplvpexdn['id'] < 1) { return; } $vwplfu1sbe = explode(',', $vwplvpexdn['fields']); $vwplx6yba = count($vwplfu1sbe); $subscriptionplan = memberium_app()->wplvkevh($vwplvpexdn['id'], TRUE); $vwpltlkdcw = ''; foreach ($vwplfu1sbe as $vwple2yn) { $vwple2yn = strtolower(trim($vwple2yn) ); $fieldvalue = isset($subscriptionplan[$vwple2yn]) ? $subscriptionplan[$vwple2yn] : $vwplvpexdn['default']; if (in_array($vwple2yn, array('planprice', 'preauthorizeamount') ) ) { $fieldvalue = number_format( (double) $fieldvalue, 2); } $vwpltlkdcw .= $fieldvalue; if ($vwplx6yba > 1) { $vwpltlkdcw .= $vwplvpexdn['separator']; } } $vwpltlkdcw = substr($vwpltlkdcw, 0, -strlen($vwplvpexdn['separator']) ); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); }    function wplruv27($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplj_wrxn = false; switch (strtolower(trim($vwpluvdiz) ) ) { case 'memb_cookie': $vwplj_wrxn = $_COOKIE; break; case 'memb_get': $vwplj_wrxn = $_GET; break; case 'memb_post': $vwplj_wrxn = $_POST; break; case 'memb_request': $vwplj_wrxn = $_REQUEST; break; case 'memb_server': $vwplj_wrxn = $_SERVER; break; case 'memb_session': $vwplj_wrxn = isset($_SESSION) ? $_SESSION : array(); break; } if (! $vwplj_wrxn) { return; } $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'default' => '', 'htmlattr' => '', 'name' => false, 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium');  if ($vwplvpexdn['name'] > '') { $vwpl_3h16 = explode(',', $vwplvpexdn['name']); foreach ($vwpl_3h16 as $vwple2rb_) { if (! empty($vwplj_wrxn[$vwple2rb_]) ) { $vwplj_wrxn = $vwplj_wrxn[$vwple2rb_]; } else { $vwplj_wrxn = $vwplvpexdn['default']; break; } } }  if (is_array($vwplj_wrxn) ) { $vwpltlkdcw = htmlspecialchars(print_r($vwplj_wrxn, TRUE) ); } else { $vwpltlkdcw = htmlspecialchars($vwplj_wrxn); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wpltldayt($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplckl3 = $this->wplnrec($vwplckl3, $vwpluvdiz); return wplczvi98::wplyhei6(false, $vwplckl3, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplcycfr($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_super_admin() ) { return; } if (is_feed() ) { return; } static $vwplhc0div = false; if ($vwplhc0div) { return; } $vwplhc0div = true; $vwplvtmqd = wplsbzgvp::wplfhxj9(); if (! empty($vwplvtmqd) ) { memberium_app()->wplj9ye($vwplvtmqd); } else { $vwplgogvie = wp_get_current_user(); memberium_app()->wplqvqrie($vwplgogvie->user_email); } $this->wplh3645(); } function wplehqu($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'type' => 'lostpassword', 'htmlattr' => '', 'redirect' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['type'] = strtolower(trim($vwplvpexdn['type']) ); if ($vwplvpexdn['type'] == 'lostpassword') { $vwpltlkdcw = wp_lostpassword_url($vwplvpexdn['redirect']); } $vwpldqjgk = get_option('memberium_pages'); if (isset($vwpldqjgk[$vwplvpexdn['type']]) ) { $vwpltlkdcw = get_permalink($vwpldqjgk[$vwplvpexdn['type']]); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, '', '', $vwplvpexdn['htmlattr']); } function wpljwu3nm($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'delimiter' => ',', 'htmlattr' => '', 'separator' => MEMBERIUM_DELIMITER, 'tag_ids' => '', 'tagids' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; $vwplvpexdn['tagids'] = trim($vwplvpexdn['tagids'] . ',' . $vwplvpexdn['tag_ids'], ', '); if ($vwplvpexdn['tagids'] > '') { $vwplpr27 = wplj_l2t::wplaajf(); $vwpls0hwb5 = explode($vwplvpexdn['delimiter'], $vwplvpexdn['tagids']); foreach ($vwpls0hwb5 as $vwpltmveju) { if (isset($vwplpr27['mc'][$vwpltmveju]) ) { $vwpltlkdcw .= htmlspecialchars($vwplpr27['mc'][$vwpltmveju]) . $vwplvpexdn['separator']; } } $vwpltlkdcw = substr($vwpltlkdcw, 0, strlen($vwpltlkdcw) - strlen($vwplvpexdn['separator']) ); } unset($vwpls0hwb5, $vwpltmveju, $vwplpr27); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wplg6hd($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (memberium_app()->wplubo6() == 0 || is_super_admin() ) { return; } global $wpdb; $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'date_format' => 'l, F dS, Y, g:sA', 'default' => '', 'htmlattr' => '', 'mode' => 'newest',  'tag_ids' => '', 'tagids' => '', 'txtfmt' => '', 'tz' => 'America/New_York', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['tagids'] = trim($vwplvpexdn['tagids'] . ',' . $vwplvpexdn['tag_ids'], ', '); $vwplvpexdn['mode'] = strtolower(trim($vwplvpexdn['mode']) ); $vwplqywoip = date_default_timezone_get(); date_default_timezone_set($vwplvpexdn['tz']); $vwpltlkdcw = $vwplvpexdn['default']; if ($vwplvpexdn['tagids'] > '') { $vwpls0hwb5 = $this->wpljd8cu($vwplvpexdn['tagids']); $vwpljejx = implode(',', $vwpls0hwb5); if (! empty($vwpls0hwb5) ) { if ($vwplvpexdn['mode'] == 'newest') { $vwplawvl_ = 'DESC'; } else { $vwplawvl_ = 'ASC'; } if (wplj_l2t::wpl_n2s9($vwpls0hwb5) ) { if ($_SESSION['memb_user']['tag_detail_count'] == 0 && $this->options['settings']['sync_tag_details'] == 0) { memberium_app()->wplt52wpo(memberium_app()->wplubo6()); } $vwplx1ap5_ = 'SELECT `created` FROM `' . MEMBERIUM_DB_CONTACTTAGS . '` WHERE `contactid` = %d AND `tagid` IN (' . $vwpljejx . ') AND `appname` = %s ORDER BY `created` ' . $vwplawvl_ . ' LIMIT 1'; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, array(memberium_app()->wplubo6(), wplz8bid::wplm3z9k('appname') ) ); $vwpli6vzy = $wpdb->get_var($vwplx1ap5_); $vwpltlkdcw = date($vwplvpexdn['date_format'], strtotime($vwpli6vzy) ); } } } date_default_timezone_set($vwplqywoip); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); } function wplm1l9($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } $vwplsb_pf = array( 'actionset_id' => '', 'contact_id' => memberium_app()->wplubo6(), 'date_format' => '', 'fields' => '', 'goal' => '', 'tag_id' => '', 'txtfmt' => '', 'value' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['contact_id'] = (int) $vwplvpexdn['contact_id']; if ($vwplvpexdn['contact_id'] < 1) { return; } $vwplvpexdn['fields'] = explode(',', $vwplvpexdn['fields']); if (empty($vwplvpexdn['fields']) ) { return; } $vwplvpexdn['value'] = wplczvi98::wpl_pkw6j($vwplvpexdn['value'], $vwplvpexdn['txtfmt']); if ($vwplvpexdn['date_format'] > '') { if (strcasecmp($vwplvpexdn['date_format'] , 'infusionsoft') == 0) { $vwplvpexdn['date_format'] = 'Ymd\Th:i:s'; } $vwplvpexdn['value'] = date($vwplvpexdn['date_format'], strtotime($vwplvpexdn['value']) ); } $vwplpv8rgm = $this->i2sdk->getInfusionsoftFieldsByTable('Contact'); $vwplt9mos2 = array( 'CreatedBy', 'DateCreated', 'Groups', 'Id', 'LastUpdated', 'LastUpdatedBy', 'Validated', ); array_walk($vwplvpexdn['fields'], function(&$vwplvpexdn) { $vwplvpexdn['value'] = trim($vwplvpexdn['value']); }); if (is_array($vwplpv8rgm) ) { foreach ($vwplpv8rgm as $valid_field) { $vwplvpexdn['fields'] = str_ireplace($valid_field, $valid_field, $vwplvpexdn['fields']); } } foreach ($vwplvpexdn['fields'] as $vwply17edn => $vwpl_s6l) { if (! in_array($vwpl_s6l, $vwplpv8rgm) || in_array($vwpl_s6l, $vwplt9mos2) ) { unset($vwplvpexdn['fields'][$vwply17edn]); } else { memberium_app()->wplox2qcd($vwpl_s6l, $vwplvpexdn['value'], $vwplvpexdn['contact_id']); } } if ($vwplvpexdn['contact_id'] == memberium_app()->wplubo6() ) { $_SESSION = memberium_app()->wplyte2(); } return; } function wplbyr70($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'htmlattr' => '', 'name' => false, 'op' => 'show', 'txtfmt' => '', 'val' => 0, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['name'] = strtolower(trim($vwplvpexdn['name']) ); if (empty($vwplvpexdn['name']) ) { return; } $vwpllzly5b = get_current_user_id();; if (! $vwpllzly5b) { return; }  $vwpltlkdcw = ''; $vwplgyte5 = (int) $this->wplvi4zst($vwplvpexdn['name']); switch (strtolower($vwplvpexdn['op']) ) { case 'decr': if ( (int) $vwplvpexdn['val'] == 0) { $vwplvpexdn['val'] = 1; } $vwplgyte5 = $vwplgyte5 - (int) $vwplvpexdn['val']; break; case 'incr': if ( (int) $vwplvpexdn['val'] == 0) { $vwplvpexdn['val'] = 1; } $vwplgyte5 = $vwplgyte5 + (int) $vwplvpexdn['val']; break; case 'set': $vwplgyte5 = (int) $vwplvpexdn['val']; break; case 'show': case 'get': $vwpltlkdcw = $vwplgyte5; break; } $this->wplcc45($vwplvpexdn['name'], $vwplgyte5); return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }     function wplodrb($vwplvpexdn, $vwplckl3 = null, $tag = '') { if (! wpln9_s::wplq6kurm() ) { return; } static $vwpluvdiz = array(); static $vwplmkte81 = array(); $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'htmlattr' => '', 'txtfmt' => '', ); if (is_array($vwplvpexdn) ) { foreach($vwplvpexdn as $vwplyq9i7o => $vwplcjpa) { if (! isset($vwplsb_pf[$vwplyq9i7o]) ) { $vwplsb_pf[$vwplyq9i7o] = $vwplcjpa; } } } $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium');  $vwpltm40r8 = substr($tag, 6);  if (! isset($vwplmkte81[$vwpltm40r8]) ) { $vwplmkte81[$vwpltm40r8] = 0; } $vwplmkte81[$vwpltm40r8]++; if ($vwplmkte81[$vwpltm40r8] > 10) { wp_die('Custom Shortcode Recursion Limit Exceeded.'); } if (! isset($vwpluvdiz[$vwpltm40r8]) ) { $vwplob9i24 = get_posts(array('name' => $vwpltm40r8, 'post_type' => 'memb_shortcodeblocks') ); $vwpluvdiz[$vwpltm40r8] = $vwplob9i24[0]->post_content; } $vwpltlkdcw = $vwpluvdiz[$vwpltm40r8]; $vwplvpexdn = $this->wplavltoc($vwplvpexdn);  if (is_array($vwplvpexdn) ) { foreach ($vwplvpexdn as $vwply17edn=>$vwplph268z) { $vwply17edn = strtolower($vwply17edn); $vwpli70d = '{{atts:' . $vwply17edn . '}}'; $vwpltlkdcw = str_replace($vwpli70d, $vwplph268z, $vwpltlkdcw); } } while (stripos($vwpltlkdcw, '{{atts:') !== false) { $vwpltlkdcw = preg_replace_callback('|({{atts\:(.*)}})|U', function($vwplt_hk1c) { return ''; }, $vwpltlkdcw); } $vwplckl3 = $vwpltlkdcw; unset($vwpltlkdcw);  $vwplckl3 = do_shortcode($vwplckl3); if (! empty($vwplvpexdn['txtfmt']) ) { $vwplckl3 = wplczvi98::wpl_pkw6j($vwplckl3, $vwplvpexdn['txtfmt']); } $vwplckl3 = $vwplvpexdn['before'] . $vwplckl3 . $vwplvpexdn['after']; if (! empty($vwplvpexdn['capture']) ) { $vwplckl3 = wplczvi98::wplg6rw5y($vwplckl3, $vwplvpexdn['capture']); } if (! empty($vwplvpexdn['htmlattr']) ) { $vwplckl3 = $vwplvpexdn['htmlattr'] . '="' . $vwplckl3 . '"'; } $vwplmkte81[$vwpltm40r8]--; return $vwplckl3; }     function wplm36eu() { if (! wp_verify_nonce($_GET['verification'], $_GET['memb_s3link']) ) { return; } if (is_feed() ) { return; } $vwplyjx8 = is_user_logged_in(); $vwploia7_d = unserialize(base64_decode($_GET['memb_s3link']) ); $vwplwwytci = (boolean) $vwploia7_d['debug'] == 1; if ($vwplwwytci) { echo __LINE__, ' - Protocol: ', $vwploia7_d['protocol'], '<br />'; echo __LINE__, ' - Require Login?: ', $vwploia7_d['require_login'], '<br />'; echo __LINE__, ' - Set Actionset: ', $vwploia7_d['actionset'], '<br />'; echo __LINE__, ' - Set Cache Bust: ', $vwploia7_d['cachebust'], '<br />'; echo __LINE__, ' - Set Debug: ', $vwploia7_d['debug'], '<br />'; echo __LINE__, ' - Set Expiration: ', $vwploia7_d['expiring'], ' seconds<br />'; echo __LINE__, ' - Set Follow Up Sequence: ', $vwploia7_d['fus'], '<br />'; echo __LINE__, ' - Set Goals: ', $vwploia7_d['goals'], '<br />'; echo __LINE__, ' - Set Object: ', $vwploia7_d['object'], '<br />'; echo __LINE__, ' - Set Profile: ', $vwploia7_d['profile'], '<br />'; echo __LINE__, ' - Set Tags: ', $vwploia7_d['tags'], '<br />'; echo __LINE__, ' - Tokens: ', $vwploia7_d['tokens'], '<br />'; } if ($vwploia7_d['require_login'] == 'yes' && ! $vwplyjx8) { if ($vwplwwytci) { echo __LINE__, " - Login Required, returning to referring page"; echo '<a href="', $_SERVER['HTTP_REFERER'], '">Continue</a>'; exit; } wplpwn3::wplbryv(); wp_redirect($_SERVER['HTTP_REFERER']); exit; } if (memberium_app()->wplubo6() > 0) { if (! empty($vwploia7_d['actionset']) ) { memberium_app()->wplmupt($vwploia7_d['actionset'], memberium_app()->wplubo6() ); } if (! empty($vwploia7_d['fus']) ) { memberium_app()->wplz3_a($vwploia7_d['fus'], memberium_app()->wplubo6() ); } if (! empty($vwploia7_d['goals']) ) { memberium_app()->wplge1yc6($vwploia7_d['goals'], memberium_app()->wplubo6() ); } if (! empty($vwploia7_d['tags']) ) { memberium_app()->wplt263_($vwploia7_d['tags'], memberium_app()->wplubo6() ); } if (! empty($vwploia7_d['tokens']) ) { memberium_app()->wplwuo3z8($vwploia7_d['tokens']); } } $vwplvkv3 = strtolower(trim($vwploia7_d['profile']) ); if (isset($this->options['remote_files'][$vwplvkv3]) ) { $vwplkaroyi = $this->options['remote_files'][$vwplvkv3]['bucket']; $vwplff5g = $this->options['remote_files'][$vwplvkv3]['host']; $vwplbu4on = $this->options['remote_files'][$vwplvkv3]['access_key']; $vwplbu82r = $this->options['remote_files'][$vwplvkv3]['secret_key']; if ($vwplwwytci) { echo __LINE__, ' - Host: ', $vwplff5g, '<br />'; echo __LINE__, ' - Bucket: ', $vwplkaroyi, '<br />'; } } $vwpldj83n = $vwploia7_d['expiring']; $vwplx9rsp = $vwploia7_d['protocol']; $vwplmos5h3 = $vwploia7_d['object']; $vwplfkojlf = memberium_app()->wpls6uf1($vwplbu4on, $vwplbu82r, $vwplx9rsp, $vwplff5g, $vwplkaroyi, $vwplmos5h3, $vwpldj83n); if ($vwplwwytci) { echo __LINE__, ' - URL: <a href="', $vwplfkojlf, '">', $vwplfkojlf, '</a><br />'; exit; } else { wplpwn3::wplbryv(); wp_redirect($vwplfkojlf); exit; } }     function wplt314() { if (empty($_POST['memb_form_type']) ) { return; } switch (strtolower($_POST['memb_form_type']) ) { case 'memb_resetfeedurl_button': $this->wplgwxt(); break; case 'memb_registration': $this->wpltn5t(); break; case 'memb_filebox_upload': $this->wplsdtsj9(); break; case 'memb_actionset_button': $this->wplfpbou(); break; case 'memb_add_creditcard_button': $this->wplywai(); break; case 'memb_change_email': $this->wplcmf9(); break; case 'memb_change_password': $this->wpll03l(); break; case 'memb_pay_invoice': $this->wplq53du(); break; case 'memb_cancel_subscription': $this->wplt1khy(); break; case 'memb_placeorder_button': $this->wplqvqbum(); break; case 'memb_send_password': $this->wpli3e6_(); break; case 'memb_update_contact_form': $this->wpldkhl(); break; } }    function wplgwxt() {  if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_resetfeedurl_' . $_POST['form_id']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_resetfeedurl_button', 'memberium') ); exit; } wplutf3y::wplci0l(); return; } function wpllacq() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; if ($vwplnbzsux) echo __LINE__, " - POST: ", print_r($_POST, true) , "\n"; $vwplso1pw = empty($_GET['name']) ? '' : trim($_GET['name']); $vwplin_i8 = time(); memberium_app()->wplas0qx($vwplso1pw); echo 'Operation Completed'; return; }  function wplxse7d() { global $wpdb; $vwplbgavbj = array(); $vwplqs9ey5 = array(); $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplpg5x = date('Y-m-d h:i:s'); $vwplvtmqd = (int) $_POST['Id']; $vwplnbzsux = isset($_GET['debug']) ? true : false; $vwplljlq = empty($_GET['channel']) ? 'm' : preg_replace("/[^[:alnum:][:space:]]/u", '', $_GET['channel']);; $vwplk_sn = isset($_GET['cat_id']) && (int) $_GET['cat_id'] > 0 ? (int) $_GET['cat_id'] : 0; $vwpliilvm = isset($_GET['tagcount']) && (int) $_GET['tagcount'] > 0 ? (int) $_GET['tagcount'] : 6; $vwplo3na = isset($_GET['date_format']) && $_GET['date_format'] > '' ? $_GET['date_format'] : 'Ym'; $vwplhhyscj = empty($_GET['interval']) ? '' : strtolower(trim($_GET['interval']) ); if ($vwplhhyscj == '') { if ($vwplo3na == 'Yz') { $vwplhhyscj = 'days'; } elseif ($vwplo3na == 'YW') { $vwplhhyscj = 'weeks'; } elseif (in_array($vwplo3na, array('YM', 'Ym', 'M', 'm', 'F', 'n') ) ) { $vwplhhyscj = 'months'; } elseif ($vwplo3na == 'Y') { $vwplhhyscj = 'years'; } } if (empty($vwplhhyscj) ) { if ($vwplnbzsux) echo __LINE__, "Premature End - Empty Interval\n"; exit; } wplsbzgvp::wplx9wl8g('id', $vwplvtmqd); wplsbzgvp::wplx9wl8g('groups', $_POST['Groups']); if ($vwplnbzsux) { echo __LINE__, " - Channel: ", print_r($vwplljlq, true) , "\n"; echo __LINE__, " - Category ID: ", print_r($vwplk_sn, true) , "\n"; echo __LINE__, " - Tag Count: ", print_r($vwpliilvm, true) , "\n"; echo __LINE__, " - Date Format: ", print_r($vwplo3na, true) , "\n"; echo __LINE__, " - Interval: ", print_r($vwplhhyscj, true) , "\n"; }  for ($vwplt_5ro = 0; $vwplt_5ro < $vwpliilvm; $vwplt_5ro++) { $vwplbgavbj[$vwplt_5ro] = $vwplljlq . date($vwplo3na, strtotime('now + ' . $vwplt_5ro . ' ' . $vwplhhyscj) ); $vwplqxosl = memberium_app()->wpljfe4jd($vwplbgavbj[$vwplt_5ro]); if (! $vwplqxosl) { if ($vwplnbzsux) echo __LINE__, " - Missing Tag: ", $vwplbgavbj[$vwplt_5ro], "\n"; $vwplqs9ey5[$vwplt_5ro] = $vwplt_5ro; } else { if ($vwplnbzsux) echo __LINE__, " - Found Existing Tag: ", $vwplbgavbj[$vwplt_5ro], "\n"; } } if (is_array($vwplqs9ey5) && ! empty($vwplqs9ey5) ) { wpllbej::wplwwbm9(); foreach ($vwplqs9ey5 as $vwplt_5ro) { $vwplbgavbj[$vwplt_5ro] = $vwplljlq . date($vwplo3na, strtotime('now + ' . $vwplt_5ro . ' ' . $vwplhhyscj) ); $vwplqxosl = memberium_app()->wpljfe4jd($vwplbgavbj[$vwplt_5ro]); if ($vwplnbzsux) echo __LINE__, " - Found Tag: ", $vwplbgavbj[$vwplt_5ro], "\n"; if ($vwplqxosl) { if ($vwplnbzsux) echo __LINE__, " - Found Missing Tag: ", $vwplbgavbj[$vwplt_5ro], "\n"; unset($vwplqs9ey5[$vwplt_5ro]); } } if ($vwplnbzsux) echo __LINE__, " - Still Missing Tags: ", print_r($vwplqs9ey5, true), "\n"; foreach ($vwplqs9ey5 as $vwplt_5ro) { $vwplqxosl = memberium_app()->wplstw20($vwplbgavbj[$vwplt_5ro], (int) $vwplk_sn, 'Magazine Issue Tag Auto-created by Memberium on ' . $vwplpg5x); if ($vwplnbzsux) echo __LINE__, " - Created Tag : ", $vwplbgavbj[$vwplt_5ro], "\n"; } } if ($vwplnbzsux) echo __LINE__, " - Setting Tag: ", $vwplbgavbj[0] , "\n"; $vwplqxosl = memberium_app()->wpljfe4jd($vwplbgavbj[0]); $this->wplt263_($vwplqxosl, $vwplvtmqd); memberium_app()->wpllfqh_('send_http_post'); exit; } function wplccaeqx() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; if ($vwplnbzsux) echo __LINE__, " - POST: ", print_r($_POST, true) , "\n"; memberium_app()->wplto2h4($_POST); memberium_app()->wpllfqh_('send_http_post'); echo __LINE__, " - Saved Contact Record To Local Cache\n"; echo 'Operation Completed'; return; } function wplqt4om() { if (! empty($_POST['Id']) ) { $vwplvtmqd = (int) $_POST['Id']; } if (! empty($_POST['contactId']) ) { $vwplvtmqd = (int) $_POST['contactId']; } $vwplnbzsux = isset($_GET['debug']) ? true : false; $vwplsc6_rj = isset($_GET['tagids']) && $_GET['tagids'] > '' ? array_unique(explode(',', $_GET['tagids']) ) : array(); $vwplglvdw = (boolean) strtolower($_GET['sync']) <> 'no'; if ($vwplnbzsux) { echo __LINE__, " - Debug Mode Enabled\n"; echo __LINE__, " - _POST = ", print_r($_POST, true),"\n"; echo __LINE__, " - Tag ID's = ", print_r($vwplsc6_rj, true),"\n"; echo __LINE__, " - Contact Id = ", $vwplvtmqd, "\n"; } if ($vwplvtmqd > 0) { $vwplrp9u24 = wpllbej::wplrande($vwplvtmqd, false); if ($vwplnbzsux) echo __LINE__, " - Contact Tags = ", $vwplrp9u24['Groups'], "\n"; if (is_array($vwplrp9u24) && (isset($vwplrp9u24['Groups']) ) ) { $vwplrudn1 = array_unique(explode(',', $vwplrp9u24['Groups']) ); if (is_array($vwplsc6_rj) && ! empty($vwplsc6_rj) ) { foreach($vwplsc6_rj as $vwplxmeo) { $vwplxmeo = (int) $vwplxmeo; if ($vwplxmeo > 0) { $vwplrudn1[] = $vwplxmeo; } if ($vwplxmeo < 0) { $vwplxmeo = abs($vwplxmeo); if ( ($vwply17edn = array_search($vwplxmeo, $vwplrudn1) ) !== false) { unset($vwplrudn1[$vwply17edn]); } } } $vwplrudn1 = array_unique($vwplrudn1); sort($vwplrudn1); $vwplrp9u24['Groups'] = implode(',', $vwplrudn1); $vwplrp9u24['!LastUpdated'] = time(); if ($vwplnbzsux) { echo __LINE__, " - Final Groups = ", implode(',', $vwplrudn1), "\n"; echo __LINE__, " - Final Contact = ", print_r($vwplrp9u24, true), "\n"; } memberium_app()->wplto2h4($vwplrp9u24); } else { if ($vwplnbzsux) echo __LINE__, " - No Tag ID's passed\n"; } } else { if ($vwplnbzsux) echo __LINE__, " - Contact ID ", $vwplvtmqd, " not found.\n"; } } }   function wplcg2kob() { global $wpdb; $vwplnbzsux = isset($_GET['debug']) ? true : false; if ($vwplnbzsux) { echo __LINE__, " - Debug Mode Enabled\n"; echo __LINE__, " - GET: ", print_r($_GET, true) , "\n"; echo __LINE__, " - POST: ", print_r($_POST, true) , "\n"; } $vwplvtmqd = isset($_POST['Id']) && (int) $_POST['Id'] > 0 ? $_POST['Id'] : 0; $vwplfyuqzi = trim($_GET['source']); $vwpltco2 = explode(',', $_GET['target']); $vwpldtnh = isset($_GET['overwrite']) ? strtolower($_GET['overwrite']) == 'yes' : FALSE; if ($vwplnbzsux) { echo __LINE__, " - Set Contact ID: ", $vwplvtmqd, "\n"; echo __LINE__, " - Set Source Field: ", $vwplfyuqzi, "\n"; echo __LINE__, " - Set Target Fields: ", print_r($vwpltco2, TRUE), "\n"; echo __LINE__, " - Set Overwrite: ", (int) $vwpldtnh, "\n"; } if (empty($vwplvtmqd) ) { if ($vwplnbzsux) echo __LINE__, " - Invalid Contact ID, Ending.\n"; return; } if ($vwplfyuqzi == '' || $vwpltco2 == array() ) { if ($vwplnbzsux) echo __LINE__, " - Source or Target Empty :: Ending.\n"; return; } $vwplkgfcse = $_POST[$vwplfyuqzi]; $vwplv09c = array(); if ($vwplnbzsux) echo __LINE__, " - New Value: {$vwplkgfcse}\n"; foreach ($vwpltco2 as $vwple2yn) { if ( (isset($_POST[$vwple2yn]) && $vwpldtnh) || (! isset($_POST[$vwple2yn]) ) || (trim($_POST[$vwple2yn]) == '') ) { $vwplv09c[$vwple2yn] = $vwplkgfcse; if ($vwplnbzsux) echo __LINE__, " - Setting {$vwple2yn} to: {$vwplkgfcse}\n"; } else { if ($vwplnbzsux) echo __LINE__, " - {$vwple2yn} is not empty\n"; } } if (count($vwplv09c) > 0) { $this->isdk->updateCon($vwplvtmqd, $vwplv09c);  if ($vwplnbzsux) { echo __LINE__, " - Updated Infusionsoft\n"; echo __LINE__, " - Updating Local Cache\n"; } foreach ($vwplv09c as $vwple2yn => $vwplph268z) { $vwplx1ap5_ = "UPDATE `" . MEMBERIUM_DB_CONTACTS . "` SET `value` = %s WHERE `fieldname` = %s AND `id` = %d AND `appname` = %s "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $vwplph268z, $vwple2yn, $vwplvtmqd, $this->i2sdk_options['app_name']); $wpdb->query($vwplx1ap5_); } }  memberium_app()->wpllfqh_('send_http_post'); if ($vwplnbzsux) echo __LINE__, " - Operation Completed\n"; echo 'Operation Completed'; }    function wplrgr47() { echo 'Unimplemented Function, '; memberium_app()->wpllfqh_('send_http_post'); return; }     function wplt1f9() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) { echo __LINE__, " - Debug Mode Enabled\n"; echo __LINE__, " - POST: ", print_r($_POST, true), "\n"; } $vwplvtmqd = (int) $_POST['Id']; if (empty($vwplvtmqd) ) { return; } $vwplwweoq8 = (isset($_GET['target']) && $_GET['target'] > '') ?$_GET['target'] : $vwpl_q3rku; if (! isset($_GET['target']) ) { if ($vwplnbzsux) echo __LINE__, " - Target Parameter Required: {$vwplwweoq8}\n"; return; } $vwpl_q3rku = (isset($_GET['source']) && $_POST[$_GET['source']] > '') ? $_POST[$_GET['source']] : 'now '; $vwpltgsaw = (isset($_GET['function']) && $_GET['function'] > '') ? $_GET['function'] : ''; $vwply9silk = (isset($_GET['format']) && $_GET['format'] > '') ? $_GET['format'] : 'Y-m-d\TH:i:s'; $vwpltgsaw = str_replace('plus', '+', $vwpltgsaw); $vwpll1udp0 = date($vwply9silk, strtotime($vwpl_q3rku . $vwpltgsaw) ); if ($vwplnbzsux) { echo __LINE__, " - Contact Id: {$vwplvtmqd}\n"; echo __LINE__, " - Source: {$vwpl_q3rku}\n"; echo __LINE__, " - Target: {$vwplwweoq8}\n"; echo __LINE__, " - Function/Operation: {$vwpltgsaw}\n"; echo __LINE__, " - Format: {$vwply9silk}\n"; echo __LINE__, " - Calculated Date: {$vwpl_q3rku} {$vwpltgsaw} using {$vwply9silk} = {$vwpll1udp0}\n"; } $updated_fields = array( $vwplwweoq8 => $vwpll1udp0, ); $this->isdk->updateCon($vwplvtmqd, $updated_fields);  memberium_app()->wplj9ye($vwplvtmqd); if ($vwplnbzsux) { echo __LINE__, " - Updated Infusionsoft\n"; echo __LINE__, " - Resync Contact\n"; echo __LINE__, " - Operation Complete\n"; } memberium_app()->wpllfqh_('send_http_post'); echo 'Operation Completed'; }   function wplmpwxad() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwplvtmqd = (int) $_POST['Id']; if (empty($vwplvtmqd) ) { return; } $vwplfos5_ = isset($_GET['value1']) ? $_GET['value1'] : 0; $vwpltgsaw = isset($_GET['function']) ? $_GET['function'] : ''; $vwplx8t75 = isset($_GET['value2']) ? $_GET['value2'] : 0; $vwplj2jid = isset($_GET['destination']) ? $_GET['destination'] : ''; $vwplcx3m = isset($_GET['round']) ? (int) $_GET['round'] : 0; $vwply9silk = isset($_GET['format']) ? trim($_GET['format']) : ''; $vwplsc6_rj = isset($_GET['tagids']) && $_GET['tagids'] > '' ? explode(',', $_GET['tagids']) : false; $vwplkjx4fs = wplycjh::wplwlamwg($_POST['Id'], 'httppost', 'Math'); wplycjh::wplxc5ht_($vwplkjx4fs, "Value1 = {$vwplfos5_}"); wplycjh::wplxc5ht_($vwplkjx4fs, "Value2 = {$vwplx8t75}"); wplycjh::wplxc5ht_($vwplkjx4fs, "Test = {$vwpltgsaw}"); if ($vwplnbzsux) { echo __LINE__, " - Contact Id: {$vwplvtmqd}\n"; echo __LINE__, " - Value 1: {$vwplfos5_}\n"; echo __LINE__, " - Function: {$vwpltgsaw}\n"; echo __LINE__, " - Value 2: {$vwplx8t75}\n"; echo __LINE__, " - Destination: {$vwplj2jid}\n"; echo __LINE__, " - Precision: {$vwplcx3m}\n"; echo __LINE__, " - sprintf Formatting: {$vwply9silk}\n"; }  if (array_key_exists($vwplfos5_, $_POST) ) { if ($vwplnbzsux) echo __LINE__, " - Value1 = {$vwplfos5_}, which matches POST key value of {$_POST[$vwplfos5_]}\n"; $vwplfos5_ = (float) $_POST[$vwplfos5_]; } else { $vwplfos5_ = (float) $vwplfos5_; } if (array_key_exists($vwplx8t75, $_POST) ) { if ($vwplnbzsux) echo __LINE__, " - Value2 = {$vwplx8t75}, which matches POST key value of {$_POST[$vwplx8t75]}\n"; $vwplx8t75 = (float) $_POST[$vwplx8t75]; } else { $vwplx8t75 = (float) $vwplx8t75; } if ($vwplnbzsux) { echo __LINE__, " - Value 1 Resolved to: {$vwplfos5_}\n"; echo __LINE__, " - Value 2 Resolved to: {$vwplx8t75}\n"; }  switch (strtolower($vwpltgsaw) ) { case 'subtract': $vwplyio4f = $vwplfos5_ - $vwplx8t75; break; case 'add': $vwplyio4f = $vwplfos5_ + $vwplx8t75; break; case 'max': $vwplyio4f = max($vwplfos5_, $vwplx8t75); break; case 'min': $vwplyio4f = min($vwplfos5_, $vwplx8t75); break; case 'multiply': $vwplyio4f = $vwplfos5_ * $vwplx8t75; break; case 'divide': $vwplyio4f = $vwplfos5_ / $vwplx8t75; break; case 'random': $vwplyio4f = mt_rand($vwplfos5_, $vwplx8t75); break; } if ($vwplnbzsux) echo __LINE__, " - Calculating: {$vwplfos5_} {$vwpltgsaw} {$vwplx8t75} = {$vwplyio4f}\n"; if (isset($_GET['round']) ) { $vwplyio4f = round($vwplyio4f, $vwplcx3m); if ($vwplnbzsux) echo __LINE__, " - Rounded Result to {$vwplyio4f}\n"; } if ($vwplyio4f == (int) $vwplyio4f) { $vwplyio4f = (int) $vwplyio4f; } if ($vwply9silk > '') { $vwplyio4f = sprintf($vwply9silk, $vwplyio4f); if ($vwplnbzsux) echo __LINE__, " - Formatted Result to {$vwplyio4f}\n"; } if ($vwplj2jid > '') {  $vwplv09c = array($vwplj2jid => $vwplyio4f); $this->isdk->updateCon($vwplvtmqd, $vwplv09c);  memberium_app()->wplj9ye($vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Updated Contact\n"; sleep(1);   } if ($vwplsc6_rj) { memberium_app()->wplt263_($vwplsc6_rj, $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Added Tags: ", implode(',', $vwplsc6_rj), "\n"; } wplycjh::wplxc5ht_($vwplkjx4fs, "Result = {$vwplyio4f}"); memberium_app()->wpllfqh_('send_http_post'); echo 'Operation Completed'; }  function wpllgi3() { global $wpdb; $vwplnbzsux = isset($_GET['debug']) ? true : false; if ($vwplnbzsux) { echo __LINE__, " - Begin MakePass at ", microtime(true) ,"\n"; echo __LINE__, " - Debug Mode Enabled\n"; } $_POST['Id'] = isset($_POST['Id']) ? (int) $_POST['Id'] : 0; $_GET['overwrite'] = isset($_GET['overwrite']) ? $_GET['overwrite'] : 'no'; $_GET['adduser'] = isset($_GET['adduser']) ? $_GET['adduser'] : 'yes'; $vwpll5uo = false; $vwplsjoas = ''; $vwplbk4y2 = false; $vwplvtmqd = (int) $_POST['Id']; $vwplup7mi = $this->options['settings']['password_field']; $vwpl_2cd9 = $this->options['settings']['username_field']; $vwplc_uoh4 = isset($_POST[$vwpl_2cd9]) ? $_POST[$vwpl_2cd9] : ''; $vwpldtnh = (strtolower($_GET['overwrite']) == 'yes'); $vwplbhzfr = (bool) (strtolower($_GET['adduser']) <> 'no'); $vwplw9mr = isset($_GET['delay']) ? (int) $_GET['delay'] : 0; $vwplsc6_rj = isset($_GET['tagids']) && $_GET['tagids'] > '' ? explode(',', $_GET['tagids']) : false; $vwplhlbt = isset($_GET['goal']) && $_GET['goal'] > '' ? $_GET['goal'] : false; $vwplkjx4fs = wplycjh::wplwlamwg($_POST['Id'], 'httppost', 'MakePass'); wplycjh::wplxc5ht_($vwplkjx4fs, "Contact ID = {$_POST['Id']}"); wplycjh::wplxc5ht_($vwplkjx4fs, "Username = {$vwplc_uoh4}"); if (MEMBERIUM_ERRORLOG) error_log('MakePass HTTP POST ContactID:' . $_POST['Id'], 0); if ($vwplnbzsux) { echo __LINE__, " - POST: ", print_r($_POST, true) , "\n"; echo __LINE__, " - Set Contact ID: {$vwplvtmqd}\n"; echo __LINE__, " - Set Password Field: {$vwplup7mi}\n"; echo __LINE__, " - Set Username Field: {$vwpl_2cd9}\n"; echo __LINE__, " - Set Overwrite: ", (int) $vwpldtnh, "\n"; echo __LINE__, " - Set Add User: ", (int) $vwplbhzfr, "\n"; echo __LINE__, " - Set Delay: {$vwplw9mr}\n"; echo __LINE__, " - Set Tag ID's: ", print_r($vwplsc6_rj, true), "\n"; echo __LINE__, " - Set Goal: {$vwplhlbt}\n"; } if (intval($vwplvtmqd) < 1) { wplycjh::wplxc5ht_($vwplkjx4fs, 'No valid contact ID'); if ($vwplnbzsux) echo __LINE__, " - Finish MakePass at ", microtime(true) ,"\n"; if ($vwplnbzsux) echo __LINE__, " - Early Termination - No valid Contact ID Passed\n"; exit; } if (empty($vwplc_uoh4) ) { wplycjh::wplxc5ht_($vwplkjx4fs, 'No valid Username'); if ($vwplnbzsux) echo __LINE__, " - Finish MakePass at ", microtime(true) ,"\n"; if ($vwplnbzsux) echo __LINE__, " - Early Termination - No valid Username Passed\n"; exit; }   if (! isset($_POST['Password']) && $vwplup7mi == 'Password') { $vwplmu62n = array('Password'); $vwplrp9u24 = $this->isdk->loadCon($vwplvtmqd, $vwplmu62n); if (! empty($vwplrp9u24['Password']) ) { $_POST['Password'] = $vwplsjoas = $vwplrp9u24['Password']; }  if ($vwplnbzsux) echo __LINE__, " - Retrieved Password from API: ", $_POST[$vwplup7mi], "\n"; } if (MEMBERIUM_ERRORLOG) error_log('MakePass HTTP POST ContactID:' . $_POST['Id'], 0); if ($vwplnbzsux) echo __LINE__, " - Saving Contact at ", microtime(true) ,"\n"; memberium_app()->wplto2h4($_POST); if (username_exists($vwplc_uoh4) || email_exists($vwplc_uoh4) ) { $vwplbk4y2 = true; if ($vwplnbzsux) echo __LINE__, " - User {$vwplc_uoh4} found in WordPress database.\n"; wplycjh::wplxc5ht_($vwplkjx4fs, "Username found in WordPress database"); } if ( ($vwpldtnh == false) && (! empty($_POST['password_field']) ) ) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Infusionsoft Password Field Populated'); $vwpll5uo = true; } if ($vwplbk4y2 == true && $vwpldtnh == false) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Password Exists, Overwrite Off'); if ($vwplnbzsux) { echo __LINE__, " - Early Termination - Overwrite set to No and WP User Exists\n"; echo __LINE__, " - Finish MakePass at ", microtime(true) ,"\n"; } exit; }  if (isset($_POST[$vwplup7mi]) && trim($_POST[$vwplup7mi]) > '') { $vwpll5uo = true; $vwplsjoas = isset($_POST[$vwplup7mi]) ? $_POST[$vwplup7mi] : ''; if ($vwplnbzsux) echo __LINE__, " - Password Already Exists: {$vwplsjoas}\n"; wplycjh::wplxc5ht_($vwplkjx4fs, 'Password Exists'); } if (! empty($_POST[$vwplup7mi]) && $_POST[$vwplup7mi] == 'PASSWORD_PLACEHOLDER') { $vwpll5uo = false; $vwpldtnh = true; } if ($vwpll5uo && ! $vwpldtnh) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Password Update Disabled'); $vwplzoen7q = false; } else { $vwplzoen7q = true; } if ($vwplnbzsux) { echo __LINE__, " - Password Exists    = ", (int) $vwpll5uo, "\n"; echo __LINE__, " - Password Overwrite = ", (int) $vwpldtnh, "\n"; echo __LINE__, " - Update Password = ", (int) $vwplzoen7q, "\n"; }  if ($vwplzoen7q) { $vwplsjoas = memberium_app()->wpleh1zcw(); if ($vwplnbzsux) echo __LINE__, " - Password Generated: {$vwplsjoas}\n"; wplycjh::wplxc5ht_($vwplkjx4fs, 'Password Generated'); $_POST[$vwplup7mi] = $vwplsjoas; $vwplrp9u24[$vwplup7mi] = $vwplsjoas; $updated_fields = array( $vwplup7mi => $vwplsjoas, ); $vwplyio4f = $this->isdk->updateCon($vwplvtmqd, $updated_fields);  memberium_app()->wplun7pt5($vwplvtmqd, $vwplrp9u24); if ($vwplnbzsux) { echo __LINE__, " - password_field = ", $vwplup7mi, "\n"; echo __LINE__, " - password = ", $vwplsjoas, "\n"; echo __LINE__, " - updated_fields = ", print_r($updated_fields, true), "\n"; echo __LINE__, " - result = ", print_r($vwplyio4f, true), "\n"; echo __LINE__, " - Updated Password to {$vwplsjoas} \n"; } wplycjh::wplxc5ht_($vwplkjx4fs, 'Contact Updated'); if ($vwplsc6_rj) { memberium_app()->wplt263_($vwplsc6_rj, $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Added Tags: ", implode(',', $vwplsc6_rj), "\n"; wplycjh::wplxc5ht_($vwplkjx4fs, 'Added Tags', implode(',', $vwplsc6_rj) ); } memberium_app()->wpln6xe(); if ($vwplnbzsux) { echo __LINE__, " - Updated Contact\n"; echo __LINE__, " - Sleeping: {$vwplw9mr} seconds\n"; } sleep($vwplw9mr); }  $vwplx1ap5_ = "UPDATE `{$wpdb->users}` SET `user_email` = LOWER(`user_email`) WHERE `user_email` = %s; "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, strtolower($_POST['Email']) ); $wpdb->query($vwplx1ap5_); if ( (! $vwpldtnh) && $vwplbk4y2) { $vwplbhzfr = false; if ($vwplnbzsux) echo __LINE__, " - WordPress username already exists.  Remote password reset, local password retained.\n"; wplycjh::wplxc5ht_($vwplkjx4fs, 'WordPress Username aready exists'); } add_filter('send_password_change_email', array(memberium_app(), 'wplj4_rn8'), PHP_INT_MAX, 3);   if ($vwplbhzfr) { if (! $vwplbk4y2) { $vwpldj4of = array(); $vwpldj4of['user_login'] = isset($_POST[$vwpl_2cd9]) ? $_POST[$vwpl_2cd9] : ''; $vwpldj4of['user_pass'] = $vwplsjoas; $vwpldj4of['first_name'] = isset($_POST['FirstName']) ? trim($_POST['FirstName']) : ''; $vwpldj4of['last_name'] = isset($_POST['LastName']) ? trim($_POST['LastName']) : ''; $vwpldj4of['user_nicename'] = apply_filters('memberium/wpuser/nicename', trim($vwpldj4of['first_name'] . ' ' . $vwpldj4of['last_name']), $vwplrp9u24); $vwpldj4of['display_name'] = apply_filters('memberium/wpuser/display_name', $vwpldj4of['user_nicename'], $vwplrp9u24); $vwpldj4of['nickname'] = apply_filters('memberium/wpuser/nickname', $vwpldj4of['user_nicename'], $vwplrp9u24); $vwpldj4of['user_url'] = isset($_POST['Website']) ? substr(trim($_POST['Website']), 0, 88) : ''; $vwpldj4of['user_email'] = isset($_POST['Email']) ? strtolower(trim($_POST['Email']) ) : ''; $vwpl_ma6z = wp_insert_user($vwpldj4of); if ($vwplnbzsux) echo __LINE__, " - Inserted WP User - Local User Id: ", print_r($vwpl_ma6z, true), "\n"; if (MEMBERIUM_ERRORLOG) error_log('MakePass HTTP POST UserId:' . $vwpl_ma6z, 0); if (is_int($vwpl_ma6z) && $vwpl_ma6z > 0) { memberium_app()->wplaig81($vwplvtmqd, $vwpl_ma6z); if ($vwplnbzsux) { echo __LINE__, " - Added Infusionsoft ID {$vwplvtmqd} to User {$vwpl_ma6z} Meta\n"; echo __LINE__, " - Doing user_register Action\n"; }  do_action('user_register', $vwpl_ma6z); if (function_exists('WPCW_actions_users_newUserCreated') ) { WPCW_actions_users_newUserCreated($vwpl_ma6z); } } $vwplbk4y2 = true; if ($vwplnbzsux) echo __LINE__, " - User Creation Completed\n"; } } if ($vwplsc6_rj > '') { memberium_app()->wplt263_($vwplsc6_rj, $vwplvtmqd); wplycjh::wplxc5ht_($vwplkjx4fs, "Applying Tags {$vwplsc6_rj}"); if ($vwplnbzsux) echo __LINE__, " - Applying Tags {$vwplsc6_rj}\n"; } if ($vwplhlbt > '') { memberium_app()->wplge1yc6($vwplhlbt, $vwplvtmqd); wplycjh::wplxc5ht_($vwplkjx4fs, "Achieving Goal {$vwplhlbt}"); if ($vwplnbzsux) echo __LINE__, " - Achieving Goal {$vwplhlbt}\n"; }  if ($vwplbk4y2) { $vwplvezkp1 = get_userdatabylogin($_POST[$vwpl_2cd9]); add_filter('send_password_change_email', array(memberium_app(), 'wplj4_rn8'), 999999, 3); wp_update_user(array ('ID' => $vwplvezkp1->ID, 'user_pass' => $vwplsjoas) );  remove_filter('wplj4_rn8', array(memberium_app(), 'wplj4_rn8'), 999999); if ($vwplnbzsux) echo __LINE__, " - Updating WordPress User {$vwplvezkp1->ID} Password to {$vwplsjoas}\n"; } if (is_multisite() && ! is_user_member_of_blog($vwpl_ma6z) ) { $vwpltycqk9 = get_current_blog_id(); $vwplwpqkj8 = get_blog_option($vwpltycqk9, 'default_role', 'subscriber'); add_user_to_blog($vwpltycqk9, $vwpl_ma6z, $vwplwpqkj8); } memberium_app()->wpllfqh_('send_http_post'); remove_filter('send_password_change_email', array(memberium_app(), 'wplj4_rn8'), 999999); echo 'Operation Completed'; wplycjh::wplxc5ht_($vwplkjx4fs, "Makepass completed"); if ($vwplnbzsux) echo __LINE__, " - Finish MakePass at ", microtime(true) ,"\n"; return false; } function wplkgqn() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwpllzly5b = wplvnitod($_REQUEST['Email']); if ($vwpllzly5b > 0) { update_user_meta($vwpllzly5b, 'memberium_optout', 0); if ($vwplnbzsux) echo __LINE__, " - User ID ", $vwpllzly5b, " opted in\n"; } else { if ($vwplnbzsux) echo __LINE__, " - User ID ", $vwpllzly5b, " not found\n"; } } function wplj9wb7t() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwpllzly5b = wplvnitod($_REQUEST['Email']); if ($vwpllzly5b > 0) { update_user_meta($vwpllzly5b, 'memberium_optout', 1); if ($vwplnbzsux) echo __LINE__, " - User ID ", $vwpllzly5b, " opted out\n"; } else { if ($vwplnbzsux) echo __LINE__, " - User ID ", $vwpllzly5b, " not found\n"; } } function wplsa_l() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwplcltpy = trim($_GET['post_id']); $vwple2yn = trim($_GET['field']); if (empty($vwplcltpy) || empty($vwple2yn) ) { return; } if ( (int) $vwplcltpy > 0) { $vwplzzlf5b = get_post($vwplcltpy, ARRAY_A); } elseif ($vwplcltpy > '') { $vwplzzlf5b = get_page_by_path($vwplcltpy, ARRAY_A, 'post'); } memberium_app()->wpllfqh_('send_http_post'); echo $vwplzzlf5b[$vwple2yn]; exit; }  function wplg74c() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwplvtmqd = isset($_POST['Id']) ? (int) $_POST['Id'] : 0; if (! $vwplvtmqd) { return; } $vwplv09c = array(); $vwplbyv6xk = array( 'Country' => 'PostalCode', 'Country2' => 'PostalCode2', 'Country3' => 'PostalCode3', ); $vwplelqi = array( 'United States' => '/^\d{5}(-\d{4})?$/', 'Canada' => '/^[ABCEGHJKLMNPRSTVXY]{1}\d{1}[A-Z]{1} *\d{1}[A-Z]{1}\d{1}$/', 'United Kingdom' => '/^([A-PR-UWYZ0-9][A-HK-Y0-9][AEHMNPRTVXY0-9]?[ABEHMNPRVWXY0-9]? {1,2}[0-9][ABD-HJLN-UW-Z]{2}|GIR 0AA)$/', ); if ($vwplnbzsux) { echo __LINE__, " - Set Contact ID: {$vwplvtmqd}\n"; echo __LINE__, " - Set Country: {$_POST['Country']}\n"; echo __LINE__, " - Set Country: {$_POST['Country2']}\n"; echo __LINE__, " - Set Country: {$_POST['Country3']}\n"; }  foreach ($vwplbyv6xk as $vwplyrnok=>$vwplyt2bw) { if ($_POST[$vwplyrnok] == '' && $_POST[$vwplyt2bw] > '') { foreach ($vwplelqi as $vwplh29aq => $country_regex) { if (preg_match($country_regex, $_POST[$vwplyt2bw]) ) { $_POST[$vwplyrnok] = $vwplh29aq; $vwplv09c[$vwplyrnok] = $vwplh29aq; if ($vwplnbzsux) echo __LINE__, " - Set {$_POST[$vwplyrnok]} to {$vwplh29aq}\n"; } } } } if ($vwplnbzsux) echo __LINE__, " - Updated Fields: ", print_r($vwplv09c, TRUE), "\n"; if (count($vwplv09c) ) { $vwplvtmqd = $this->isdk->updateCon($vwplvtmqd, $vwplv09c);  if ($vwplnbzsux) echo __LINE__, " - Updated Contact Id: ", print_r($vwplvtmqd, TRUE), "\n"; memberium_app()->wplj9ye($vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Synced Contact Id: ", print_r($vwplvtmqd, TRUE), "\n"; memberium_app()->wpln6xe(); if ($vwplnbzsux) { echo __LINE__, " - Cleared Cache Namespace\n"; echo __LINE__, " - Contact Updated\n"; } } memberium_app()->wpllfqh_('send_http_post'); echo 'Operation Completed'; }   function wpltf6e() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwplvtmqd = (int) $_POST['Id']; $vwplv09c = array(); $vwplv1usb = NULL; if ($vwplnbzsux) echo __LINE__, " - Set Contact ID: {$vwplvtmqd}\n"; if ($_POST['PostalCode'] > '') { switch ($_POST['Country']) { case 'Canada': switch (strtolower($_POST['PostalCode'], 0, 1) ) { case 'a': $vwplv1usb = 'NL'; break; case 'b': $vwplv1usb = 'NS'; break; case 'c': $vwplv1usb = 'PE'; break; case 'g': case 'h': case 'j': $vwplv1usb = 'QC'; break; case 'k': case 'l': case 'm': case 'n': case 'p': $vwplv1usb = 'ON'; break; case 's': $vwplv1usb = 'SK'; break; case 't': $vwplv1usb = 'AB'; break; case 'v': $vwplv1usb = 'BC'; break; case 'x': $vwplv1usb = 'NT'; break; case 'y': $vwplv1usb = 'YT'; break; } switch (strtolower($_POST['PostalCode'], 0, 3) ) { case 'x0a': case 'x0b': case 'x0c': $vwplv1usb = 'NU'; break; } break; case 'United States': $vwplwy9el = array( array('region'=>'MA', 'min'=>'01001', 'max'=>'05544'), array('region'=>'RI', 'min'=>'02801', 'max'=>'02940'), array('region'=>'NH', 'min'=>'00210', 'max'=>'00215'), array('region'=>'NH', 'min'=>'03031', 'max'=>'03897'), array('region'=>'ME', 'min'=>'03901', 'max'=>'04992'), array('region'=>'VT', 'min'=>'05001', 'max'=>'05907'), array('region'=>'CT', 'min'=>'06001', 'max'=>'06928'), array('region'=>'NJ', 'min'=>'07001', 'max'=>'08989'), array('region'=>'NY', 'min'=>'00501', 'max'=>'00544'), array('region'=>'NY', 'min'=>'06390', 'max'=>'06390'), array('region'=>'NY', 'min'=>'10001', 'max'=>'14925'), array('region'=>'PA', 'min'=>'15001', 'max'=>'19640'), array('region'=>'DE', 'min'=>'19701', 'max'=>'19980'), array('region'=>'DC', 'min'=>'20001', 'max'=>'20599'), array('region'=>'VA', 'min'=>'20101', 'max'=>'24658'), array('region'=>'MD', 'min'=>'20601', 'max'=>'21930'), array('region'=>'WV', 'min'=>'24701', 'max'=>'26886'), array('region'=>'NC', 'min'=>'27006', 'max'=>'28909'), array('region'=>'SC', 'min'=>'29001', 'max'=>'29945'), array('region'=>'GA', 'min'=>'30002', 'max'=>'39901'), array('region'=>'FL', 'min'=>'32004', 'max'=>'34997'), array('region'=>'AL', 'min'=>'35004', 'max'=>'36925'), array('region'=>'TN', 'min'=>'37010', 'max'=>'38589'), array('region'=>'MS', 'min'=>'38601', 'max'=>'39776'), array('region'=>'KY', 'min'=>'40003', 'max'=>'42788'), array('region'=>'OH', 'min'=>'43001', 'max'=>'45999'), array('region'=>'IN', 'min'=>'46001', 'max'=>'47997'), array('region'=>'MI', 'min'=>'48001', 'max'=>'49971'), array('region'=>'IA', 'min'=>'50001', 'max'=>'52809'), array('region'=>'WI', 'min'=>'53001', 'max'=>'54990'), array('region'=>'MN', 'min'=>'55001', 'max'=>'56763'), array('region'=>'SD', 'min'=>'57001', 'max'=>'57799'), array('region'=>'ND', 'min'=>'58001', 'max'=>'58856'), array('region'=>'MT', 'min'=>'59001', 'max'=>'59937'), array('region'=>'IL', 'min'=>'60001', 'max'=>'62999'), array('region'=>'MS', 'min'=>'63001', 'max'=>'65899'), array('region'=>'KS', 'min'=>'66002', 'max'=>'67954'), array('region'=>'NE', 'min'=>'68001', 'max'=>'69367'), array('region'=>'NE', 'min'=>'68001', 'max'=>'69367'), array('region'=>'LA', 'min'=>'70001', 'max'=>'71497'), array('region'=>'AR', 'min'=>'71601', 'max'=>'72959'), array('region'=>'OK', 'min'=>'73001', 'max'=>'74966'), array('region'=>'TX', 'min'=>'73301', 'max'=>'88595'), array('region'=>'CO', 'min'=>'80001', 'max'=>'81658'), array('region'=>'WY', 'min'=>'82001', 'max'=>'83128'), array('region'=>'ID', 'min'=>'83201', 'max'=>'83888'), array('region'=>'UT', 'min'=>'84001', 'max'=>'84791'), array('region'=>'AZ', 'min'=>'85001', 'max'=>'86556'), array('region'=>'NM', 'min'=>'87001', 'max'=>'88441'), array('region'=>'NV', 'min'=>'88901', 'max'=>'89883'), array('region'=>'HI', 'min'=>'96701', 'max'=>'96898'), array('region'=>'OR', 'min'=>'97001', 'max'=>'97920'), array('region'=>'AK', 'min'=>'99501', 'max'=>'99950'), array('region'=>'WA', 'min'=>'98001', 'max'=>'99403'), );  break; } } if ($vwplnbzsux) echo __LINE__, " - Set Contact ID: {$vwplvtmqd}\n"; if (count($vwplv09c) ) { $vwplvtmqd = $isdk->updateCon($vwplvtmqd, $vwplv09c);  memberium_app()->wplj9ye($vwplvtmqd); memberium_app()->wpln6xe(); $debug_message .= "\n\n" . 'Contact Updated'; } memberium_app()->wpllfqh_('send_http_post'); echo 'Operation Completed'; }    function wplozkywh() { $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; $vwplvtmqd = (int) $_POST['Id']; if (empty($vwplvtmqd) ) { return; } $vwplxixdwk = isset($_GET['noaccents']); $vwplkjx4fs = wplycjh::wplwlamwg($_POST['Id'], 'httppost', 'Prettify Contact'); wplycjh::wplxc5ht_($vwplkjx4fs, "Contact ID = {$vwplvtmqd}"); if ($vwplnbzsux) { echo __LINE__, " - Debug Mode Enabled\n"; echo __LINE__, " - Set Contact Id: ", $vwplvtmqd , "\n"; echo __LINE__, " - POST Data :", print_r($_POST, true), "\n"; echo __LINE__, " - Set Contact Id: ", $vwplvtmqd , "\n"; echo __LINE__, " - Remove Accents: ", (int) $vwplxixdwk , "\n"; } $vwplv09c = array(); $vwplfuc2 = array( 'Address2Street1', 'Address2Street2', 'Address3Street1', 'Address3Street2', 'AssistantName', 'City', 'City2', 'City3', 'Country', 'Country2', 'Country3', 'Company', 'State', 'State2', 'State3', 'FirstName', 'JobTitle', 'LastName', 'MiddleName', 'Nickname', 'SpouseName', 'StreetAddress1', 'StreetAddress2', ); $vwplx_57 = array( 'Email', 'EmailAddress2', 'EmailAddress3', ); $vwplam1ugh = array( 'PostalCode', 'PostalCode2', 'PostalCode3', ); $vwplcus2f = array( 'State', 'State2', 'State3', );  foreach ($vwplfuc2 as $vwple2yn) { if (! empty($_POST[$vwple2yn]) ) { $vwplr6kqy = $_POST[$vwple2yn]; $vwplkgfcse = ($vwplxixdwk) ? remove_accents($vwplr6kqy) : $vwplr6kqy; $vwplkgfcse = ucwords(strtolower(trim($vwplkgfcse) ) ); if ($vwplkgfcse <> $vwplr6kqy) { $vwplv09c[$vwple2yn] = $vwplkgfcse; } if ($vwplnbzsux) echo __LINE__, " - Updated Field ({$vwple2yn}):  Before: {$_POST[$vwple2yn]}/ After:{$vwplv09c[$vwple2yn]}\n"; } }  foreach ($vwplx_57 as $vwple2yn) { if (! empty($_POST[$vwple2yn]) ) { $vwplr6kqy = $_POST[$vwple2yn]; $vwplkgfcse = ($vwplxixdwk) ? remove_accents($vwplr6kqy) : $vwplr6kqy; $vwplkgfcse = strtolower(trim($vwplkgfcse) ); if ($vwplkgfcse <> $vwplr6kqy) { $vwplv09c[$vwple2yn] = $vwplkgfcse; } if ($vwplnbzsux) echo __LINE__, " - Updated Field ({$vwple2yn}):  Before: {$_POST[$vwple2yn]}/ After:{$vwplv09c[$vwple2yn]}\n"; } }  foreach ($vwplam1ugh as $vwple2yn) { if (! empty($_POST[$vwple2yn]) ) { $vwplr6kqy = $_POST[$vwple2yn]; $vwplkgfcse = ($vwplxixdwk) ? remove_accents($vwplr6kqy) : $vwplr6kqy; $vwplkgfcse = strtoupper(trim($vwplkgfcse) ); if ($vwplkgfcse <> $vwplr6kqy) { $vwplv09c[$vwple2yn] = $vwplkgfcse; } if ($vwplnbzsux) echo __LINE__, " - Updated Field ({$vwple2yn}):  Before: {$_POST[$vwple2yn]}/ After:{$vwplv09c[$vwple2yn]}\n"; } }  foreach ($vwplcus2f as $vwple2yn) { if (! empty($_POST[$vwple2yn]) ) { $vwplr6kqy = $_POST[$vwple2yn]; $vwplkgfcse = ($vwplxixdwk) ? remove_accents($vwplr6kqy) : $vwplr6kqy; if (strlen($vwplkgfcse) < 4) { $vwplkgfcse = strtoupper(trim($vwplkgfcse) ); } if ($vwplkgfcse <> $vwplr6kqy) { $vwplv09c[$vwple2yn] = $vwplkgfcse; } if ($vwplnbzsux) echo __LINE__, " - Updated Field ({$vwple2yn}):  Before: {$_POST[$vwple2yn]}/ After:{$vwplv09c[$vwple2yn]}\n"; } } if (count($vwplv09c) > 0) { $vwplvtmqd = $this->isdk->updateCon($vwplvtmqd, $vwplv09c);  $vwplsxda .= "\n\n" . 'Contact #' . $vwplvtmqd . ' Updated, '; } memberium_app()->wplj9ye($vwplvtmqd); if ($vwplnbzsux) { echo __LINE__, " - Updated Local and Remote Databases\n"; echo __LINE__, " - Operation Complete\n"; } echo 'Operation Completed'; memberium_app()->wpllfqh_('send_http_post'); } function wpll682() { global $wpdb; $vwplnbzsux = isset($_GET['debug']) ? TRUE : FALSE; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwpl_2cd9 = $this->options['settings']['username_field']; $vwplc_uoh4 = $_POST[$vwpl_2cd9]; $vwplgogvie = get_user_by('email', $vwplc_uoh4); $vwplna6u = $_GET['countername']; $vwploia7_d = strtolower($_GET['action']); $vwplph268z = $_GET['value']; if ($vwplnbzsux) { echo __LINE__, " - Username Field:  {$vwpl_2cd9}\n"; echo __LINE__, " - Username:  {$vwplc_uoh4}\n"; echo __LINE__, " - User:  {$vwplgogvie}\n"; echo __LINE__, " - Counter Name:  {$vwplna6u}\n"; echo __LINE__, " - Action:  {$vwploia7_d}\n"; echo __LINE__, " - Value:  {$vwplph268z}\n"; } if ($vwplgogvie) { if ($vwplnbzsux) echo __LINE__, " - Found User\n"; switch ($vwploia7_d) { case 'set': wplsbzgvp::wplq27h($vwplna6u, $vwplph268z, $vwplgogvie->ID); memberium_app()->wpln6xe(); if ($vwplnbzsux) echo __LINE__, " - Custom Counter Updated\n"; break; }  } else { if ($vwplnbzsux) echo __LINE__, " - Username {$vwplc_uoh4} not found.\n"; } echo 'Operation Completed'; memberium_app()->wpllfqh_('send_http_post'); }  function wplvigd() { $vwplnbzsux = isset($_GET['debug']) ? true : false; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplvtmqd = isset($_POST['Id']) ? (int) $_POST['Id'] : 0; $vwplhaqr2 = isset($_GET['destfield']) ? trim($_GET['destfield']) : ''; $vwplo5m1 = isset($_GET['subscriptionplans']) ? explode(',', $_GET['subscriptionplans']) : array(); if ($vwplnbzsux) { echo __LINE__, " - Contact Id: ", $vwplvtmqd, "\n"; echo __LINE__, " - Destination Field: ", $vwplhaqr2, "\n"; echo __LINE__, " - Subscription Types: ", $vwplo5m1, "\n"; } if ($vwplvtmqd > 0 && $vwplhaqr2 > '') { $vwplc0g3p = array( 'Id', 'BillingCycle', 'Frequency', 'Status', 'contactId', 'EndDate', 'LastBillDate', 'NextBillDate', 'PaidThruDate', 'StartDate', 'SubscriptionPlanId' ); $vwplv80sz = array( 'contactId' => $vwplvtmqd, 'Status' => 'Active', ); $vwplm2n3w = $this->isdk->dsQuery('RecurringOrder', 997, 0, $vwplv80sz, $vwplc0g3p); $vwplhpds8 = '99991231T12:59:59'; $vwpluaj7 = date('YmdTH:i:s'); if (is_array($vwplm2n3w) ) { foreach ($vwplm2n3w as $vwplpwet1) { if ($vwplnbzsux) echo __LINE__, " - RecurringOrders\n", print_r($vwplpwet1, true), "\n"; if (! empty($vwplpwet1['NextBillDate']) ) { if ($vwplpwet1['NextBillDate'] < $vwplhpds8) { if ($vwplpwet1['NextBillDate'] >= $vwpluaj7) { if (empty($vwplo5m1) || in_array($x, $vwplo5m1) ) { $vwplhpds8 = $vwplpwet1['NextBillDate']; } } } } } } if ($vwplnbzsux) echo __LINE__, " - Next Billing Date = ", $vwplhpds8, "\n"; if ($vwplhpds8 <> '99991231T12:59:59') { memberium_app()->wplox2qcd($vwplhaqr2, $vwplhpds8, $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Contact Updated (", $vwplvtmqd, ")\n"; } } }  function wplxmgfi0() { $vwplnbzsux = isset($_GET['debug']) ? true : false; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwplvtmqd = isset($_POST['Id']) ? (int) $_POST['Id'] : 0; $vwplhaqr2 = isset($_GET['destfield']) ? trim($_GET['destfield']) : ''; if (empty($vwplvtmqd) || empty($vwplhaqr2) ) { if ($vwplnbzsux) echo __LINE__, " - No Contact, or No Destination Field\n"; return; } $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplzibc = ''; $vwplo5m1 = isset($_GET['subscriptionplans']) ? explode(',', $_GET['subscriptionplans']) : ''; $vwpllfmy = isset($_GET['agoal']) ? trim($_GET['agoal']) : ''; $vwplosfi_ = isset($_GET['atagid']) ? (int) $_GET['atagid'] : 0; $vwplsfrm = isset($_GET['aactionset']) ? (int) $_GET['aactionset'] : 0; $vwplipn_ql = isset($_GET['igoal']) ? trim($_GET['igoal']) : ''; $vwpldnlt = isset($_GET['itagid']) ? (int) $_GET['itagid'] : 0; $vwploq6kd = isset($_GET['iactionset']) ? (int) $_GET['iactionset'] : 0; if ($vwplnbzsux) { echo __LINE__, " - Contact Id: ", $vwplvtmqd, "\n"; echo __LINE__, " - Destination Field: ", $vwplhaqr2, "\n"; echo __LINE__, " - Subscription Types: ", $vwplo5m1, "\n"; echo __LINE__, " - Active Goal: ", $vwpllfmy, "\n"; echo __LINE__, " - Active Tag ID:: ", $vwplosfi_, "\n"; echo __LINE__, " - Active Actionset: ", $vwplsfrm, "\n"; echo __LINE__, " - Inactive Goal: ", $vwplipn_ql, "\n"; echo __LINE__, " - Inactive Tag ID: ", $vwpldnlt, "\n"; echo __LINE__, " - Inactive Actionset: ", $vwploq6kd, "\n"; } $vwplc0g3p = array( 'Id', 'BillingCycle', 'Frequency', 'Status', 'EndDate', 'LastBillDate', 'NextBillDate', 'PaidThruDate', 'StartDate', 'SubscriptionPlanId' ); $vwplv80sz = array( 'contactId' => $vwplvtmqd ); $vwplm2n3w = $this->isdk->dsQuery('RecurringOrder', 996, 0, $vwplv80sz, $vwplc0g3p); if ($vwplnbzsux) echo __LINE__, " - RecurringOrders\n", print_r($vwplm2n3w, TRUE), "\n"; if (! is_array($vwplm2n3w) || empty($vwplm2n3w) ) { return; }  foreach ($vwplm2n3w as $vwplpwet1) { if ($vwplpwet1['Status'] == 'Inactive') { if ($vwplo5m1 == '' || in_array($vwplpwet1['SubscriptionPlanId'], $vwplo5m1) ) { if ($vwplnbzsux) echo __LINE__, " - Found Matching Inactive Subscription ID:", $vwplpwet1['Id'], "\n"; $vwplzibc = max( $vwplpwet1['EndDate'], $vwplpwet1['LastBillDate'], $vwplpwet1['PaidThruDate'], $vwplpwet1['StartDate'], $vwplpwet1['NextBillDate'], $vwplzibc ); } } else { if ($vwplnbzsux) echo __LINE__, " - Found Inactive Non-Matching Subscription ID:", $vwplpwet1['Id'], "\n"; } } foreach ($vwplm2n3w as $vwplpwet1) { if ($vwplpwet1['Status'] == 'Active') { if ($vwplo5m1 == '' || in_array($vwplpwet1['SubscriptionPlanId'], $vwplo5m1) ) { if ($vwplnbzsux) echo __LINE__, " - Found Matching Active Subscription ID:", $vwplpwet1['Id'], "\n"; $vwplzibc = ''; } else { if ($vwplnbzsux) echo __LINE__, " - Found Non-Matching Active Subscription ID:", $vwplpwet1['Id'], "\n"; } } } if ($vwplnbzsux) echo __LINE__, " - Expiration Date: {$vwplzibc}\n";  if ($vwplnbzsux) echo __LINE__, " - Updating Contact Id ({$vwplvtmqd})\n"; $vwplv09c = array( $vwplhaqr2 => $vwplzibc ); $this->isdk->updateCon($vwplvtmqd, $vwplv09c);  sleep(1);  if ($vwplzibc == '') { if ($vwpllfmy > '') { $this->isdk->achieveGoal(wplz8bid::wplm3z9k('appname'), $vwpllfmy, $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Achieving Goal {$vwplw5rgd3} - {$vwpllfmy} on Contact Id ({$vwplvtmqd})\n"; } if ($vwplosfi_ !== 0) { if ($vwplosfi_ < 0) { memberium_app()->wplt263_(array($vwplosfi_), $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Removing Tag {$vwplosfi_} from Contact Id ({$vwplvtmqd})\n"; } else { memberium_app()->wplt263_(array($vwplosfi_), $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Adding Tag {$vwplosfi_} to Contact Id ({$vwplvtmqd})\n"; } } if ($vwploq6kd !== 0) { $vwplyio4f = $this->isdk->runAs($vwplvtmqd, $vwplsfrm); if ($vwplnbzsux) { echo __LINE__, " - Running Action {$vwplsfrm} to Contact Id ({$vwplvtmqd})\n"; echo __LINE__, "\n", print_r($vwplyio4f, true), "\n"; } } } else { if ($vwplipn_ql > '') { $this->isdk->achieveGoal(wplz8bid::wplm3z9k('appname'), $vwplipn_ql, $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Achieving Goal {$vwplw5rgd3} - {$vwplipn_ql} on Contact Id ({$vwplvtmqd})\n"; } if ($vwpldnlt !== 0) { if ($vwpldnlt < 0) { memberium_app()->wplt263_(array($vwpldnlt), $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Removing Tag {$vwpldnlt} from Contact Id ({$vwplvtmqd})\n"; } else { memberium_app()->wplt263_(array($vwpldnlt), $vwplvtmqd); if ($vwplnbzsux) echo __LINE__, " - Adding Tag {$vwpldnlt} to Contact Id ({$vwplvtmqd})\n"; } } if ($vwploq6kd !== 0) { $this->isdk->runAs($vwplvtmqd, $vwploq6kd); if ($vwplnbzsux) { echo __LINE__, " - Running Action {$vwplsfrm} to Contact Id ({$vwplvtmqd})\n"; echo __LINE__, "\n", print_r($vwplyio4f, true), "\n"; } } } if ($vwplnbzsux) echo __LINE__, " - Operation Complete\n"; echo 'Operation Completed'; memberium_app()->wpllfqh_('send_http_post'); } function wplkx7fnl() { $vwplnbzsux = isset($_GET['debug']) ? true : false; if ($vwplnbzsux) echo __LINE__, " - Debug Mode Enabled\n"; $vwplkjx4fs = wplycjh::wplwlamwg($_POST['Id'], 'httppost', 'Expire Subscriptions'); date_default_timezone_set('America/New_York'); $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwpluaj7 = date('Y-m-d'); $vwplc0g3p = array( 'Id', ); $vwplv80sz = array( 'Status' => 'Active', 'EndDate' => '~<=~' . $vwpluaj7, ); if ($vwplnbzsux) { echo '<pre>$elv_query = ', print_r($vwplv80sz, true), '</pre>'; echo '<pre>$elv_recurringorders = ', print_r($vwplm2n3w, true), '</pre>'; } $vwplm2n3w = $this->isdk->dsQuery('RecurringOrder', 995, 0, $vwplv80sz, $vwplc0g3p); $vwplgvh0x = array('Status' => 'Inactive'); foreach($vwplm2n3w as $vwplpwet1) { set_time_limit(30); $this->isdk->dsUpdate('RecurringOrder', (int) $vwplpwet1['Id'], $vwplgvh0x); wplycjh::wplxc5ht_($vwplkjx4fs, "Deactivating Recurring Order #{$vwplpwet1['Id']}"); if ($vwplnbzsux) { echo 'Deactivating Recurring Order #', $vwplpwet1['Id'], '<br>'; } sleep(1); } exit; }  function wple6xzqe() { $vwplnbzsux = isset($_GET['debug']) ? true : false; if ($vwplnbzsux) { echo __LINE__, " - Debug Mode Enabled\n"; echo __LINE__, " - POST: ", print_r($_POST, true) , "\n"; } $vwplvtmqd = (int) $_POST['Id']; $vwpllzly5b = memberium_app()->wplvnitod($_POST['Email']); $vwplkjx4fs = wplycjh::wplwlamwg($_POST['Id'], 'httppost', "Update Contact\n"); wplycjh::wplxc5ht_($vwplkjx4fs, "Contact ID = {$_POST['Id']}\n"); wplycjh::wplxc5ht_($vwplkjx4fs, "User ID = {$vwpllzly5b}\n");  $_POST['!LastUpdated'] = time(); if ($vwplnbzsux) { echo __LINE__, " - Set Last Updated Timestamp: ", print_r($_POST['!LastUpdated'], TRUE) , "\n"; echo __LINE__, " - Updating Contact\n"; } wplycjh::wplxc5ht_($vwplkjx4fs, "Last Updated = {$_POST['!LastUpdated']}\n");  memberium_app()->wplto2h4($_POST); wplycjh::wplxc5ht_($vwplkjx4fs, "Contact Saved"); if ($vwpllzly5b > 0) { if ($vwplnbzsux) echo __LINE__, " - Updating User ", $vwpllzly5b, "\n"; if ($vwplvtmqd) { memberium_app()->wplaig81($vwplvtmqd, $vwpllzly5b); } memberium_app()->wplyte2($vwpllzly5b); $vwplyio4f = memberium_app()->wplae9h0($_POST['Id']); memberium_app()->wplnvgd4k(explode(',', $vwplyio4f['roles']), $vwpllzly5b); $this->wplo4tqd($_POST, 0);  } else { if ($vwplnbzsux) echo __LINE__, " - No matching user ID found for ", $_POST['Email'], "\n"; } if ($vwplnbzsux) echo __LINE__, " - Operation Complete\n"; memberium_app()->wpllfqh_('send_http_post'); wplycjh::wplxc5ht_($vwplkjx4fs, "Completed\n"); echo 'Operation Completed'; }           function wploz6jp4($vwplgm2dr, $vwplcmfju) { $vwplrh7i = (array) $this->options['ga_customvars']; if (is_array($vwplrh7i) ) { foreach ($vwplrh7i as $vwplcrqu) { unset($vwplsxeu); unset($vwple2yn); switch ($vwplcrqu['variable']) { case '!system.membership_level': $vwplsxeu = isset($_SESSION['memb_user']['membership_level']) ? $_SESSION['memb_user']['membership_level'] : ''; break; case '!system.membership_name': $vwplsxeu = isset($_SESSION['memb_user']['membership_names']) ? $_SESSION['memb_user']['membership_names'] : ''; break; case '!system.remote_auth': $vwplsxeu = isset($_SESSION['memb_user']['remote_auth']) ? $_SESSION['memb_user']['remote_auth'] : ''; break; case '!system.source': $vwplsxeu = isset($_SESSION['memb_user']['source']) ? $_SESSION['memb_user']['source'] : ''; break; } if (substr($vwplcrqu['variable'], 0, 9) == '!contact.') { $vwple2yn = strtolower(substr($vwplcrqu['variable'], 9) ); } if (substr($vwplcrqu['variable'], 0, 11) == '!affiliate.') { $vwple2yn = 'affiliate.' . strtolower(substr($vwplcrqu['variable'], 11) ); } if (! empty($vwple2yn) ) { $vwplsxeu = wplsbzgvp::wplc4na($vwple2yn); } $vwplgm2dr[] = "'_setCustomVar'," . $vwplcmfju . ",'" . addslashes($vwplcrqu['name']) . "','" . addslashes($vwplsxeu) . "', 3"; $vwplcmfju++; } } return $vwplgm2dr; }    function wploprv2($vwplz4g7n, $vwplx2mbjg) {     if (isset($vwplz4g7n['default_value']) ) { $vwplz4g7n['default_value'] = do_shortcode($vwplz4g7n['default_value']); }  return $vwplz4g7n; }    function wplkix_($vwpls74o2q, $vwplzzlf5b) { if (! wpln9_s::wplq6kurm() ) { return $vwpls74o2q; } $vwpltalx = $this->wpls9nje($vwplzzlf5b->ID); if (! $vwpltalx) { return $vwplzzlf5b->excerpt; } return null; }     function wpl_egq($vwpllzly5b, $vwplkmt9v) { return; if (! class_exists('WooCommerce') ) { return; } global $woocommerce; $vwplvtmqd = wpllbej::wplbmo_1($vwpllzly5b); if (! $vwplvtmqd) { return; } $vwplgon0p = wplsbzgvp::wplfhxj9(); $vwpleioy0b = ($vwplvtmqd == $vwplgon0p); $vwplvj7ip = wplj_l2t::wplm_vec(); $vwplld5uz6 = get_user_meta($vwpllzly5b);  $vwplu14sn = array(); foreach ($vwplvj7ip as $vwplxbiqv => $isfield) { $session_fieldname = strtolower($isfield); if (isset($vwplld5uz6[$vwplxbiqv][0]) ) { $vwpljczqj = $vwplld5uz6[$vwplxbiqv][0]; if ($vwplxbiqv == 'billing_country' || $vwplxbiqv == 'shipping_country') { $vwpljczqj = wplr6om::wpljeuy93($vwpljczqj); }  if ($vwpleioy0b) { wplsbzgvp::wplx9wl8g($session_fieldname, $vwpljczqj); }  $vwplu14sn[$isfield] = $vwpljczqj; } } if (! empty($vwplu14sn) ) {  $this->isdk->updateCon($vwplvtmqd, $vwplu14sn);   $vwplj4rq_ = wpllbej::wplrande($vwplvtmqd); foreach ($vwplu14sn as $vwple2yn=>$vwplnghzs1) { $vwplj4rq_[$vwple2yn] = $vwplnghzs1; } memberium_app()->wplto2h4($vwplj4rq_); } } function wplo4tqd($vwplj4rq_, $vwpllzly5b = 0) { return; if (! class_exists('WooCommerce') ) { return; } if (empty($vwpllzly5b) ) { return; } $vwplvj7ip = wplj_l2t::wplm_vec(); $vwpl_2cd9 = $this->options['settings']['username_field']; if ( (int) $vwpllzly5b == 0) { $vwpllzly5b = get_current_user_id(); } if ( (int) $vwpllzly5b == 0) { $vwplpqst = get_user_by('email', $vwplj4rq_[$vwpl_2cd9]); $vwpllzly5b = $vwplpqst->ID; } if ( (int) $vwpllzly5b == 0) { $vwplpqst = get_user_by('login', $vwplj4rq_[$vwpl_2cd9]); $vwpllzly5b = $vwplpqst->ID; } if ( (int) $vwpllzly5b > 0) { foreach ($vwplvj7ip as $woofield => $isfield) { if (isset($vwplj4rq_[$isfield]) ) { $vwpljczqj = trim($vwplj4rq_[$isfield]); if ($woofield == 'billing_country' || $woofield == 'shipping_country') { $vwpljczqj = wplr6om::wpljeuy93($vwpljczqj); } update_user_meta($vwpllzly5b, $woofield, $vwpljczqj); } } } } function wplcytk($user = NULL) { if (! class_exists('WooCommerce') ) { return; }  if (isset($_POST['password_1']) && isset($_POST['password_2']) && $_POST['password_1'] > '' && $_POST['password_1'] == $_POST['password_2']) { $user = wp_get_current_user(); $this->wplf_1qkv($user); } } function wplmb2sju() { if (empty($this->options['settings']['extended_reg_fields']) ) { return; } ?>
		<p class="woocommerce-form-row woocommerce-form-row--wide form-row form-row-wide">
		<label for="reg_billing_first_name">First Name <span class="required">*</span></label>
		<input type="text" class="woocommerce-Input woocommerce-Input--text input-text" name="account_first_name" id="account_first_name" value="" />
		</p>
		<p class="woocommerce-form-row woocommerce-form-row--wide form-row form-row-wide" style="margin-bottom:-1em;">
		<label for="reg_billing_last_name">Last Name <span class="required">*</span></label>
		<input type="text" class="woocommerce-Input woocommerce-Input--text input-text" name="account_last_name" id="account_last_name" value="" />
		</p>
		      <?php
 } function wplgsryeb($vwplc_uoh4, $vwplz4izhe, $vwplxl3z) { if (empty($this->options['settings']['extended_reg_fields']) ) { return; } if (isset($_POST['billing_first_name']) && empty($_POST['billing_first_name']) ) { $vwplxl3z->add('billing_first_name_error', __('<strong>Error</strong>: First name is required!', 'woocommerce') ); } if (isset($_POST['billing_last_name']) && empty($_POST['billing_last_name']) ) { $vwplxl3z->add('billing_last_name_error', __('<strong>Error</strong>: Last name is required!.', 'woocommerce') ); } return $vwplxl3z; }     function wpls7qiaf($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if ( ! class_exists('BadgeOS') ) { return; } if ( ! is_user_logged_in() ) { return; } $vwplsb_pf = array( 'id' => 0,  'uid' => '',  ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['id'] = (int) $vwplvpexdn['id']; $vwplvpexdn['uid'] = strtolower(trim($vwplvpexdn['uid']) ); if (! empty($vwplvpexdn['uid']) ) { $vwpla61zo = explode(',', get_user_meta(current_user_id(), 'memberium_achievement_uids', true) ); if (in_array($vwplvpexdn['uid'], $vwpla61zo) ) { return; } } if ($vwplvpexdn['id'] > 0) { badgeos_award_achievement_to_user( (int) $vwplvpexdn['id'], get_current_user_id() ); if (! empty($vwplvpexdn['uid']) ) { $vwpla61zo = explode(',', get_user_meta(current_user_id(), 'memberium_achievement_uids', true) ); $vwpla61zo[] = $vwplvpexdn['uid']; $vwpla61zo = implode(',', array_unique($vwpla61zo) ); update_user_meta(current_user_id(), 'memberium_achievement_uids', $vwpla61zo); } } }  function wpltetah($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if ( ! class_exists('BadgeOS') ) { return; } if ( ! is_user_logged_in() ) { return; } $vwpluvdiz = ''; $vwpltycqk9 = get_current_blog_id(); $vwpln5nhr = get_user_meta(get_current_user_id(), '_badgeos_achievements', true); if (empty($vwpln5nhr) ) { return; } $vwpln5nhr = $vwpln5nhr[$vwpltycqk9]; $vwplm1ug34 = array(); if (is_array($vwpln5nhr) ) { foreach ($vwpln5nhr as $achievement) { @$vwplm1ug34[$achievement->ID] = $achievement->ID; } } unset($vwpln5nhr); $vwplm1ug34 = array_flip($vwplm1ug34); foreach ($vwplm1ug34 as $vwplm1dqej) { $vwpluvdiz .= '[badgeos_achievement id=' . $vwplm1dqej . ']'; } $vwpltlkdcw = do_shortcode($vwpluvdiz); return $vwpltlkdcw; }  function wply_2wj($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if ( ! class_exists('BadgeOS') ) { return; } if ( ! is_user_logged_in() ) { return; } $vwplsb_pf = array( 'id' => 0,  'uid' => '',  ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['id'] = (int) $vwplvpexdn['id']; $vwplvpexdn['uid'] = strtolower(trim($vwplvpexdn['uid']) ); if ($vwplvpexdn['id'] > 0) { badgeos_revoke_achievement_from_user( (int) $vwplvpexdn['id'] , get_current_user_id() ); if (! empty($vwplvpexdn['uid']) ) { $vwpla61zo = explode(',', get_user_meta(current_user_id(), 'memberium_achievement_uids', true) ); if ( ($vwply17edn = array_search($vwplvpexdn['uid'], $vwpla61zo) ) !== false) { unset($vwpla61zo[$vwply17edn]); } $vwpla61zo = implode(',', array_unique($vwpla61zo) ); update_user_meta(current_user_id(), 'memberium_achievement_uids', $vwpla61zo); } } }    function wplgshx0($vwpllzly5b, $vwplblsc, $vwplf76o89) { $vwplatgvu = $vwplf76o89->module_id; $vwplax68 = get_option('memberium_wpcw', array() ); if (isset($vwplax68['modules']['completion_tag'][$vwplatgvu]) ) { $vwpls0hwb5 = $vwplax68['modules']['completion_tag'][$vwplatgvu]; if (! empty($vwpls0hwb5) ) { memberium_app()->wplt263_($vwpls0hwb5); } } } function wplb5az($vwpllzly5b, $vwplblsc, $vwplf76o89) { $vwpls0hwb5 = get_post_meta($vwplblsc, '_is4wp_wpcw_completion_tag', true); if ($vwpls0hwb5) { memberium_app()->wplt263_($vwpls0hwb5); } return; } function wplf04t8($vwpllzly5b, $vwplblsc, $vwplf76o89) { $vwplvbkdn = $vwplf76o89->course_id; $vwplax68 = get_option('memberium_wpcw', array() ); if (isset($vwplax68['courses']['completion_tag'][$vwplvbkdn]) ) { $vwpls0hwb5 = $vwplax68['courses']['completion_tag'][$vwplvbkdn]; if (! empty($vwpls0hwb5) ) { memberium_app()->wplt263_($vwpls0hwb5); } } }        function wplai7z_($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz) { if (! wpln9_s::wplq6kurm() ) { return; } if ( memberium_app()->wplubo6() < 1 ) { return; }    }  function wpled3xr($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if ( memberium_app()->wplubo6() < 1 ) { return; } $vwplsb_pf = array( 'button_text' => 'Pay Now', 'date_format' => 'M d, Y', 'active' => TRUE, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvtmqd = memberium_app()->wplubo6(); $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); if (trim($vwplckl3) == '') { $vwplckl3 .= '<tr>'; $vwplckl3 .= '<td>%%card.type%%</td>'; $vwplckl3 .= '<td>xxxxxxxxxxxx%%card.last4%%</td>'; $vwplckl3 .= '<td>%%card.month.dropdown%% / '; $vwplckl3 .= '%%card.year.dropdown%%</td>';  $vwplckl3 .= '</tr>'; } $vwplpq5a4 = wpllbej::wpllrqb(memberium_app()->wplubo6()); $vwplaegnu = 0; $vwpltlkdcw = ''; if (is_array($vwplpq5a4) ) { foreach ($vwplpq5a4 as $vwplq2f0) { $vwplun47e = base64_encode(serialize(array('creditcard_id' => (int) $vwplq2f0['Id'],) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplun47e); $vwpltlkdcw .= '<form method="post" action="">'; $vwpld576f2 .= "<input type=\"hidden\" name=\"memb_form_type\" value=\"memb_list_creditcards_form\">"; $vwpltlkdcw .= '<input type="hidden" name="parameters" value="' . $vwplun47e . '">'; $vwpltlkdcw .= '<input type="hidden" name="signature" value="' . $vwpltmfi . '">'; $vwpltlkdcw .= '<input type="hidden" name="Id" value="' . $vwplq2f0['Id'] . '">'; $vwplaegnu++; if ($vwplaegnu % 2) { $vwplyv8z = 'odd'; } else { $vwplyv8z = 'even'; } $vwplc5p08 = '<select name="ExpirationMonth">'; for ($vwplt_5ro = 1; $vwplt_5ro < 13; $vwplt_5ro++ ) { $vwpls8hd2s = str_pad($vwplt_5ro, 2, '0', STR_PAD_LEFT); $vwplc5p08 .= '<option value ="' . $vwpls8hd2s . '" ' . ($vwpls8hd2s == $vwplq2f0['ExpirationMonth'] ? ' selected="selected" ' : '') . '>' . $vwpls8hd2s . '</option>'; } $vwplc5p08 .= '</select>'; $vwplg21y_ = '<select name="ExpirationYear">'; for ($vwplt_5ro = date('Y'); $vwplt_5ro < (date('Y') + 10); $vwplt_5ro++ ) { $vwplg21y_ .= '<option value ="' . $vwplt_5ro . '" ' . ($vwplt_5ro == $vwplq2f0['ExpirationYear'] ? ' selected="selected" ' : '') . '>' . $vwplt_5ro . '</option>'; } $vwplg21y_ .= '</select>'; $vwplbvfs7o = '<input type="submit" value="Delete" class="deletebutton">'; $vwplzxhjbg = str_ireplace('%%card.id%%', $vwplq2f0['Id'], $vwplckl3); $vwplzxhjbg = str_ireplace('%%card.type%%', $vwplq2f0['CardType'], $vwplckl3); $vwplzxhjbg = str_ireplace('%%card.last4%%', $vwplq2f0['Last4'], $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%card.year%%', $vwplq2f0['ExpirationYear'], $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%card.month%%', $vwplq2f0['ExpirationMonth'], $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%card.month.dropdown%%', $vwplc5p08, $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%card.year.dropdown%%', $vwplg21y_, $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%card.id%%', $vwplq2f0['Id'], $vwplzxhjbg);  $vwpltlkdcw .= $vwplzxhjbg; $vwpltlkdcw .= '</form>'; } } return $vwpltlkdcw; }  function wpldgtrj($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if ( memberium_app()->wplubo6() < 1 ) { return; }        static $vwplihrt = 0; $vwplihrt++; $vwplsb_pf = array( 'date_fields' => '', 'failure_url' => '', 'form_id' => '', 'goal' => '', 'pass_fields' => true, 'pass_password' => false, 'remove_accents' => 'y', 'required_fields' => '', 'success_url' => '', 'tagids' => '',  ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (trim($vwplvpexdn['form_id']) == '') { $vwplvpexdn['form_id'] = 'registration_form_' . $vwplihrt; } $vwplsh985b = base64_encode(serialize(array( 'failure_url' => $vwplvpexdn['failure_url'], 'form_id' => $vwplvpexdn['form_id'], 'contact_id' => memberium_app()->wplubo6(), 'pass_fields' => $vwplvpexdn['pass_fields'], 'pass_password' => $vwplvpexdn['pass_password'], 'date_fields' => $vwplvpexdn['date_fields'], 'remove_accents' => $vwplvpexdn['remove_accents'], 'required_fields' => $vwplvpexdn['required_fields'], 'goal' => $vwplvpexdn['goal'], 'tagids' => $vwplvpexdn['tagids'], 'success_url' => $vwplvpexdn['success_url'],  ) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplsh985b); $vwpld576f2 = ''; if (isset($_SESSION['error_message']) && is_array($_SESSION['error_message']) ) { foreach ($_SESSION['error_message'] as $vwplcq9y) { $vwpld576f2 .= '<p class="memb_registration_error"> ' . $vwplcq9y . '</p>'; } unset($_SESSION['error_message']); } $vwpld576f2 .= '<form method="post" action="" id="' . $vwplvpexdn['form_id'] . '" name="">'; $vwpld576f2 .= "<input type=\"hidden\" name=\"memb_form_type\" value=\"memb_update_contact_form\">"; $vwpld576f2 .= wp_nonce_field($vwplsh985b, '_wpnonce', true, false); $vwpld576f2 .= '<input type="hidden" name="params" value="' . $vwplsh985b . '">'; $vwpld576f2 .= '<input type="hidden" name="signature" value="' . $vwpltmfi . '">'; $vwpld576f2 .= do_shortcode($vwplckl3); $vwpld576f2 .= '</form>'; return $vwpld576f2; }  function wpldkhl() { if (! wp_verify_nonce($_POST['_wpnonce'], $_POST['params']) ) { wp_die('Invalid Update Form Submission'); exit; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['params']) ) { wp_die('Security Check Failed - Signature Validation Error'); exit; } global $wpdb;  $vwplnrd9 = false; $vwplcq9y = array(); $vwplxsdxcp = false; $vwplonvfma = true; $vwplg6lz4 = unserialize(base64_decode($_POST['params']) ); $vwplup7mi = $this->options['settings']['password_field']; $vwpltalx = false; $vwpl_2cd9 = $this->options['settings']['username_field']; $vwplvtmqd = (int) $vwplg6lz4['contact_id']; $vwplsyz91 = wpllbej::wplwr_f(-1); if (memberium_app()->wplubo6() <> $vwplvtmqd) { wp_die('Security Check Failed - Signature Validation Error'); exit; }  foreach($vwplsyz91 as $vwplmoe2 => $vwplfj1es) { if (isset($_POST[$vwplmoe2]) ) { $vwplph268z = $_POST[$vwplmoe2]; if ($vwplfj1es == 5) {  if (strlen($vwplph268z) < 4) { $vwplph268z = strtoupper($vwplph268z); } } elseif ($vwplfj1es == 13 || $vwplfj1es == 14) {  $vwplgjp7v = strtotime($vwplph268z); if ($vwplgjp7v > 0) { $vwplph268z = date('Ymd\TH:i:s', strtotime($vwplph268z) ); } else { unset($_POST[$vwplmoe2]); } } elseif ($vwplfj1es == 17 || $vwplfj1es == 20 || $vwplfj1es == 23) {  if (is_array($vwplph268z) ) { $vwplph268z = implode(',', $vwplph268z); } } elseif ($vwplfj1es == 19) {  if (strpos($vwplph268z, '@') !== false) { $vwplph268z = strtolower(trim($vwplph268z) ); } else { $vwplph268z = ''; } } $_POST[$vwplmoe2] = stripslashes($vwplph268z); } else { } }  if (! empty($vwplg6lz4['required_fields']) ) { $vwplkwc4l3 = explode(',', $vwplg6lz4['required_fields']); if (is_array($vwplkwc4l3) ) { foreach ($vwplkwc4l3 as $vwplgzv5p) { if (! isset($_POST[$vwplgzv5p]) ) { $vwplonvfma = false; $vwplnrd9 = true; $vwplcq9y[] = 'You are missing required fields.'; } } } }  foreach ($_POST as $vwply17edn => $vwplph268z) { if (isset($_POST[$vwply17edn . '_confirmation']) && $_POST[$vwply17edn] <> $_POST[$vwply17edn . '_confirmation']) { $vwplnrd9 = true; $vwplcq9y[] = 'Your confirmed fields do not match.'; } }  if (! empty($vwplg6lz4['date_fields']) ) { $vwplm_bmqo = explode(',', $vwplg6lz4['date_fields']); if (is_array($vwplm_bmqo) ) { foreach($vwplm_bmqo as $vwplxb4o) { if (isset($_POST[$vwplxb4o]) ) { $vwplgjp7v = strtotime($_POST[$vwplxb4o]); $_POST[$vwplxb4o] = date('Ymd\TH:i:s', $vwplgjp7v); } } } }  if (! $vwplnrd9) { $vwplpv8rgm = wpllbej::wplntnyv('Contact'); $vwplrp9u24 = array(); foreach ($_POST as $vwply17edn => $vwplph268z) { if (in_array($vwply17edn, $vwplpv8rgm) ) { $vwplrp9u24[$vwply17edn] = $vwplph268z; } } if (! empty($vwplrp9u24) ) { $this->isdk->updateCon($vwplvtmqd, $vwplrp9u24);  if ($vwplvtmqd > 0) { if (! empty($vwplg6lz4['goal']) ) { memberium_app()->wplge1yc6($vwplg6lz4['goal'], $vwplvtmqd); } if (! empty($vwplg6lz4['tagids']) ) { memberium_app()->wplt263_($vwplg6lz4['tagids'], $vwplvtmqd); } memberium_app()->wplj9ye($vwplvtmqd); $_SESSION = memberium_app()->wplyte2();   $vwplgitq = array( 'table' => -1,  'type' => 19,  ); $vwplyh4870 = memberium_app()->wplngsu($vwplgitq); $vwplyh4870[] = 'Email'; $vwplyh4870[] = 'EmailAddress2'; $vwplyh4870[] = 'EmailAddress3'; $vwpl_jiwz0 = array(); foreach($vwplrp9u24 as $vwple2yn => $vwplnghzs1) { if (in_array($vwple2yn, $vwplyh4870) ) { if (! empty($vwplnghzs1) ) { $vwpl_jiwz0[] = strtolower(trim($vwplnghzs1) ); } } } $vwpl_jiwz0 = array_unique($vwpl_jiwz0); foreach($vwpl_jiwz0 as $vwplz4izhe) { $this->isdk->optin($vwplz4izhe, 'Memberium Update Form'); } } else { $vwplnrd9 = true; } } }  if ($vwplnrd9 || $vwplxsdxcp) { $vwplimo5 = $vwplg6lz4['failure_url']; } else { $vwplimo5 = $vwplg6lz4['success_url']; }   if (! empty($vwplrp9u24) && $vwplg6lz4['pass_fields']) { $vwply2vn = (strpos($vwplimo5, '?') === false) ? '?' : '&'; if ($vwplvtmqd > 0) { $vwply2vn .= 'id=' . $vwplvtmqd . '&'; } foreach ($vwplrp9u24 as $vwply17edn => $vwplph268z) { if ($vwply17edn <> $vwplup7mi || $vwplg6lz4['pass_password'] == true) { $vwply2vn .= $vwply17edn . '=' . urlencode($vwplph268z) . '&'; } } } $vwplimo5 = trim($vwplimo5 . $vwply2vn, '&');  if (! empty($vwplcq9y) ) { $_SESSION['error_message'] = $vwplcq9y; }  if (! empty($vwplimo5) ) { wplpwn3::wplbryv(); wp_redirect($vwplimo5); exit; } } function wplufhqxv($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! $this->license_status || memberium_app()->wplubo6() < 1) { return; } $vwplsb_pf = array( 'autorun' => 'y',  'bypass_commissions' => 'n', 'debug' => 'n',  'description' => '',  'failure_action' => '', 'failure_goal' => '', 'failure_tag' => '', 'failure_url' => '', 'wplid3nye' => '',  'wpl_z7ir' => '',  'id' => 0,  'keep_failed' => 'n',  'lead_affiliate_id' => isset($_SESSION['infusionsoft_affiliate']) ? (int) $_SESSION['infusionsoft_affiliate'] : 0, 'merchant_id' => $this->options['settings']['merchant_account_id'],  'name' => '',  'order_title' => '', 'payment_description' => 'Memberium Online Purchase', 'plan_autocharge' => 'n',  'plan_initial_payment' => -1,  'plan_max_retries' => 3,  'plan_payment_count' => 1,  'plan_payment_interval' => 30,  'plan_retry_days' => 2,  'plan_start_date' => 'now',  'price' => -1,  'quantity' => 1, 'sale_affiliate_id' => isset($_SESSION['infusionsoft_affiliate']) ? (int) $_SESSION['infusionsoft_affiliate'] : 0, 'success_action' => '', 'success_goal' => '', 'success_tag' => '', 'success_url' => '', ); $vwplvpexdn = shortcode_atts($defaults, $vwplvpexdn, 'memberium'); if (! empty($vwplvpexdn['wpl_z7ir']) ) { if (! wplj_l2t::wpl_n2s9($vwplvpexdn['wpl_z7ir']) ) { return; } } if (! empty($vwplvpexdn['wplid3nye']) ) { if (! wplj_l2t::wplid3nye($vwplvpexdn['wplid3nye']) ) { return; } } $vwplvpexdn['autorun'] = wplczvi98::wplbyhn($vwplvpexdn['autorun'], true); $vwplvpexdn['bypass_commissions'] = wplczvi98::wplbyhn($vwplvpexdn['bypass_commissions'], false); $vwplvpexdn['id'] = (int) $vwplvpexdn['id']; $vwplvpexdn['keep_failed'] = wplczvi98::wplbyhn($vwplvpexdn['keep_failed'], false); $vwplvpexdn['lead_affiliate_id'] = (int) $vwplvpexdn['lead_affiliate_id']; $vwplvpexdn['merchant_id'] = (int) $vwplvpexdn['merchant_id']; $vwplvpexdn['name'] = trim($vwplvpexdn['name']); $vwplvpexdn['price'] = (double) $vwplvpexdn['price']; $vwplvpexdn['quantity'] = (int) $vwplvpexdn['quantity']; $vwplvpexdn['sale_affiliate_id'] = (int) $vwplvpexdn['sale_affiliate_id']; $vwplvtmqd = (int) memberium_app()->wplubo6(); $vwpln2bu = 0; $vwplxl4jet = 0; $vwplvwi2o = memberium_app()->wplpg5eox(); $vwplt9si2 = true;  $vwploia7_d = $vwplvpexdn['failure_action']; $vwplhlbt = $vwplvpexdn['failure_goal']; $vwpltmveju = $vwplvpexdn['failure_tag']; $vwplfkojlf = $vwplvpexdn['failure_url']; if (isset($vwplvwi2o[$vwplvpexdn['id']]) ) { $vwplb3hm = $vwplvwi2o[$vwplvpexdn['id']]; } elseif ($vwplvpexdn['name'] > '') { $vwplvpexdn['id'] = 0; foreach($vwplvwi2o as $vwplb3hm) { if (0 === strcasecmp ($vwplb3hm['ProductName'] , $vwplvpexdn['name']) && $vwplb3hm['Status'] == 1) { $vwplvpexdn['id'] = (int) $vwplb3hm['Id']; break; } } } unset($vwplvwi2o);  if ($vwplvpexdn['id'] < 1) { $vwplt9si2 = false; } if ($vwplvpexdn['quantity'] < 1) { $vwplt9si2 = false; } if ($vwplt9si2 && $vwplvpexdn['merchant_id'] < 0) { $vwplt9si2 = false; } if ($vwplt9si2 && $vwplvpexdn['price'] < 0) { $vwplvpexdn['price'] = (double) $vwplb3hm['ProductPrice']; }   if ($vwplt9si2) { if (! ( (int) $vwpln2bu) ) { $vwplpq5a4 = wpllbej::wpllrqb(memberium_app()->wplubo6()); $vwplpq5a4 = wpllbej::wplfts7($vwplpq5a4); $vwpln2bu = (int) $vwplpq5a4['Id']; } }  if ($vwplt9si2) { $vwplvpexdn['order_title'] = empty($vwplvpexdn['order_title']) ? $vwplb3hm['ProductName'] : $vwplvpexdn['order_title']; $vwplkw6x = date_default_timezone_get(); date_default_timezone_set ('America/New_York'); $vwpluaj7 = date('Ymd\TH:i:s'); $vwplvrne94 = $this->isdk->blankOrder($vwplvtmqd, $vwplvpexdn['order_title'], $vwpluaj7, $vwplvpexdn['lead_affiliate_id'], $vwplvpexdn['sale_affiliate_id']); if ($vwplvrne94 > 0) { $vwplvrne94 = (int) $vwplvrne94; $vwplyio4f = $this->isdk->addOrderItem($vwplvrne94, $vwplvpexdn['id'], 4, $vwplvpexdn['price'], $vwplvpexdn['quantity'], $vwplb3hm['ProductName'], $vwplvpexdn['description']); if ($vwplb3hm['Taxable'] || $vwplb3hm['CountryTaxable'] || $vwplb3hm['StateTaxable'] || $vwplb3hm['CityTaxable']) { $this->isdk->recalculateTax($vwplvrne94); } $vwploye58 = $this->isdk->chargeInvoice($vwplvrne94, $vwplvpexdn['payment_description'], $vwpln2bu, $vwplvpexdn['merchant_id'], $vwplvpexdn['bypass_commissions']); if (! in_array(strtolower($vwploye58['Code']), array('declined', 'error') ) ) {  $vwploia7_d = $success_action; $vwplhlbt = $success_goal; $vwpltmveju = $success_tag; $vwplfkojlf = $success_url; } else {  if (! $vwplvpexdn['keep_failed']) { $this->isdk->deleteInvoice($vwplvrne94); } } } date_default_timezone_set ($vwplkw6x); } if (! empty($vwploia7_d) ) { memberium_app()->wplmupt($vwploia7_d, $vwplvtmqd); } if (! empty($vwplhlbt) ) { memberium_app()->wplge1yc6($vwplhlbt, $vwplvtmqd); } if (! empty($vwpltmveju) ) { memberium_app()->wplt263_($vwpltmveju, $vwplvtmqd); } memberium_app()->wplj9ye($vwplvtmqd); if (! empty($vwplfkojlf) ) {  echo '<script type="text/javascript"> window.location.replace("', $vwplfkojlf, '"); </script>'; exit; } } function wpluurn2k($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'capture' => '', 'htmlattr' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $languages = wplixy6zk::wpluuiq(); $vwplckl3 = wplczvi98::wplcwqgvf($vwplckl3, $languages, $vwpluvdiz); return wplczvi98::wplyhei6(true, $vwplckl3, $vwpljplc2, $vwplpz75pe, $vwplqgzu2); } function wpltdn3t8($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'contact_id' => memberium_app()->wplubo6(), ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpldkw7 = $this->isdk->listLinkedContacts($vwplvpexdn['contact_id']); return '<pre>' . print_r($vwpldkw7, true) . '</pre>'; } function wplt6ca($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { $vwplsb_pf = array( 'contact_id1' => memberium_app()->wplubo6(), 'contact_id2' => 0, 'link_type' => 0, ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplyio4f = $this->isdk->unlinkContacts($vwplvpexdn['contact_id1'], $vwplvpexdn['contact_id2'], $vwplvpexdn['link_type']); return '<pre>' . print_r($vwplyio4f, true) . '</pre>'; }     function wplhb4sz($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } static $vwplj4rq_ = array();      $vwplsb_pf = array( 'affiliate_id' => wplsbzgvp::wplc4na('affiliate.id', 0), 'after' => '', 'before' => '', 'capture' => '', 'default' => '', 'fields' => 'runningbalance', 'htmlattr' => '', 'money_format' => '$%(#10n', 'separator' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwpltlkdcw = ''; $vwpljk2g = (array) $vwplvpexdn['affiliate_id']; $vwplvpexdn['fields'] = explode(',', strtolower($vwplvpexdn['fields']) ); if (empty($vwplj4rq_[$vwplvpexdn['affiliate_id']]) ) { $vwplznwhdg = $this->isdk->affRunningTotals($vwpljk2g); if (! is_array($vwplznwhdg) ) { return; } $vwplznwhdg = array_change_key_case($vwplznwhdg[0], CASE_LOWER); $vwplj4rq_[$vwplvpexdn['affiliate_id']] = $vwplznwhdg; } else { $vwplznwhdg = $vwplj4rq_[$vwplvpexdn['affiliate_id']]; } foreach($vwplvpexdn['fields'] as $field) { $vwpltlkdcw .= (isset($vwplznwhdg[$field]) ? money_format($vwplvpexdn['money_format'], $vwplznwhdg[$field]) : $vwplvpexdn['default']) . $vwplvpexdn['separator']; } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }    function wplk5764_($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } global $wpdb; $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => false, 'contact_id' => memberium_app()->wplubo6(), 'days' => 0, 'htmlattr' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $tlv = '0.00'; if ($vwplvpexdn['contact_id']) { $vwplx1ap5_ = 'SELECT sum(`totalpaid`) FROM `' . MEMBERIUM_DB_INVOICES . '` WHERE `appname` = %s `contactid` = %d AND `payplanstatus` = 1 AND `paystatus` = 1; '; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, wplz8bid::wplm3z9k('appname'), $vwplvpexdn['contact_id']); $tlv = $wpdb->get_var($vwplx1ap5_); } return wplczvi98::wplyhei6(false, $tlv, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after']); }  function wplad_cn4($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; } static $vwplyqfz = 0; $vwplsb_pf = array( 'autorun' => 'no', 'button_name' => 'order_button', 'button_text' => '', 'bypass_commissions' => 'no', 'delete_failed' => 'yes', 'fail_action' => '', 'fail_goals' => '', 'fail_tags' => '', 'fail_url' => '', 'lead_affiliate_id' => 0, 'merchant_id' => (int) $this->options['settings']['merchant_account_id'], 'prod_description' => '', 'prod_id' => 0, 'prod_name' => '', 'prod_price' => '', 'prod_type' => 4, 'qty' => 1, 'sales_affiliate_id' => 0, 'success_action' => '', 'success_goals' => '', 'success_tags' => '', 'success_url' => '', 'taxable' => 'no', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['autorun'] = wplczvi98::wplbyhn($vwplvpexdn['autorun'], false); $vwplvpexdn['bypass_commissions'] = wplczvi98::wplbyhn($vwplvpexdn['bypass_commissions'], false); $vwplvpexdn['delete_failed'] = wplczvi98::wplbyhn($vwplvpexdn['delete_failed'], true); $vwplvpexdn['taxable'] = wplczvi98::wplbyhn($vwplvpexdn['taxable'], false); $vwplvpexdn['button_text'] = ($vwplvpexdn['button_text'] > '') ? $vwplvpexdn['button_text'] : 'Buy Now' . $price;  $vwplpq5a4 = wpllbej::wpllrqb(memberium_app()->wplubo6() ); if (is_array($vwplpq5a4) && count($vwplpq5a4) > 0) { $vwplq2f0 = end($vwplpq5a4); $vwpln2bu = (int) $vwplq2f0['Id']; unset($vwplq2f0, $vwplpq5a4); } else { return; } $vwplxdfh = array( 'autorun' => (bool) $vwplvpexdn['autorun'], 'bypass_commissions' => (bool) $vwplvpexdn['bypass_commissions'], 'creditcard_id' => (int) $vwpln2bu, 'delete_failed' => (bool) $vwplvpexdn['delete_failed'], 'fail_action' => trim($vwplvpexdn['fail_action']), 'fail_goals' => trim($vwplvpexdn['fail_goals']), 'fail_tags' => trim($vwplvpexdn['fail_tags']), 'fail_url' => trim($vwplvpexdn['fail_url']), 'has_payment_plan' => false, 'lead_affiliate_id' => (int) $vwplvpexdn['lead_affiliate_id'], 'merchant_id' => (int) $vwplvpexdn['merchant_id'], 'product_description' => trim($vwplvpexdn['prod_description']), 'product_id' => (int) $vwplvpexdn['prod_id'], 'product_name' => trim($vwplvpexdn['prod_name']), 'product_price' => (float) $vwplvpexdn['prod_price'], 'product_type' => (int) $vwplvpexdn['prod_type'], 'quantity' => (int) $vwplvpexdn['qty'], 'sales_affiliate_id' => (int) $vwplvpexdn['sales_affiliate_id'], 'success_action' => trim($vwplvpexdn['success_action']), 'success_goals' => trim($vwplvpexdn['success_goals']), 'success_tags' => trim($vwplvpexdn['success_tags']), 'success_url' => trim($vwplvpexdn['success_url']), 'taxable' => (bool) $vwplvpexdn['taxable'], ); if ($vwplvpexdn['autorun']) { $vwplvrne94 = (int) memberium_app()->wplwqy2z($vwplxdfh); if ($vwplvrne94) { if ($vwplvpexdn['success_url'] > '') { $vwplimo5 = $vwplvpexdn['success_url']; } } else { if ($vwplvpexdn['fail_url'] > '') { $vwplimo5 = $vwplvpexdn['fail_url']; } } memberium_app()->wpln6xe(memberium_app()->wplubo6() ); wplpwn3::wplbryv(); wp_redirect($vwplimo5); exit; } else { $vwplyqfz++; $vwplxdfh = base64_encode(serialize($vwplxdfh) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplxdfh);  $form_name = 'place_order_button-' . $vwplyqfz; $vwplvpexdn['button_name'] = 'place_order_button_' . $vwplyqfz; $vwpld576f2 = ''; $vwpld576f2 .= "<form name=\"{$form_name}\" id=\"{$form_name}\" method=\"post\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"memb_form_type\" value=\"memb_place_order\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"form_id\" value=\"{$vwplyqfz}\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"order_settings\" value=\"{$vwplxdfh}\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"digital_signature\" value=\"{$vwpltmfi}\">"; $vwpld576f2 .= wp_nonce_field('place_order_button-' . $vwplyqfz, '_wpnonce', true, false); if ($button_url == '') { $vwpld576f2 .= "<input type=\"submit\" class=\"{$css_class}\" id=\"{$vwplvpexdn['button_name']}\" value=\"{$vwplvpexdn['button_text']}\">"; } else { $vwpld576f2 .= "<input type=\"image\" src=\"{$button_url}\" class=\"{$css_class}\" id=\"{$vwplvpexdn['button_name']}\" >"; } $vwpld576f2 .= "</form>"; return $vwpld576f2; } } function wplrkg9ew() { if (! wpln9_s::wplq6kurm() ) { return; } if (! wp_verify_nonce($_POST['_wpnonce'], 'place_order_button-' . $_POST['form_id']) ) { wp_die('Security Check Failed - Nonce Validation Error'); exit; } if (! memberium_app()->wplc3l0b($_POST['digital_signature'], $_POST['order_settings']) ) { wp_die('Security Check Failed - Signature Validation Error'); exit; } $vwplvtmqd = (int) memberium_app()->wplubo6(); $vwplyqfz = (int) $_POST['form_id']; $vwplxdfh = unserialize(base64_decode($_POST['order_settings']) ); $vwplvrne94 = memberium_app()->wplwqy2z($vwplxdfh); if ($vwplvrne94) { if ($vwplxdfh['success_url'] > '') { $vwplimo5 = $vwplxdfh['success_url']; } } else { if ($vwplxdfh['fail_url'] > '') { $vwplimo5 = $vwplxdfh['fail_url']; } } memberium_app()->wplj9ye(memberium_app()->wplubo6() ); memberium_app()->wpln6xe(memberium_app()->wplubo6() ); if ($vwplimo5 > '') { wplpwn3::wplbryv(); wp_redirect($vwplimo5); exit; } }  function wplcyktm_($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } global $i2sdk; static $vwplyqfz = 0; if (! MEMBERIUM_DEBUG) { if (! is_ssl() ) { if (is_super_admin() ) { return '<p>Credit Card Update Form Disabled Due to Missing SSL.</p>'; } return; } } $vwplsb_pf = array( 'action_ids' => '', 'addonly' => 'no', 'backcharge' => 'no', 'cardtypes' => 'American Express,Discover,MasterCard,Visa', 'failureurl' => $_SERVER['REQUEST_URI'], 'goals' => '', 'ignoressl' => 'no', 'set_default' => 'yes', 'success_msg' => 'Your credit card was successfully updated.', 'successurl' => $_SERVER['REQUEST_URI'], 'tag_ids' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['addonly'] = wplczvi98::wplbyhn($vwplvpexdn['addonly'], false); $vwplvpexdn['ignoressl'] = wplczvi98::wplbyhn($vwplvpexdn['ignoressl'], false); $vwplvpexdn['set_default'] = wplczvi98::wplbyhn($vwplvpexdn['set_default'], true); $vwplvpexdn['backcharge'] = wplczvi98::wplbyhn($vwplvpexdn['backcharge'], true); $vwplvtmqd = memberium_app()->wplubo6(); $vwplgitq = array( 'action_ids' => $vwplvpexdn['action_ids'], 'backcharge' => $vwplvpexdn['backcharge'], 'goals' => $vwplvpexdn['goals'], 'success_msg' => $vwplvpexdn['success_msg'], 'tag_ids' => $vwplvpexdn['tag_ids'], ); $vwpldxnlv = base64_encode(serialize(array($vwplgitq) ) ); if (! $this->is_administrator) { if (memberium_app()->wplubo6() == 0) { return; } if ( (! is_ssl() ) && (! $vwplvpexdn['ignoressl']) ) { return; } } $vwplyqfz++; $vwpluj8al3 = 'memb_addupdate_creditcard-' . $vwplyqfz; $vwpluyar = 'Add Card'; $vwplvpexdn['cardtypes'] = explode(',', $vwplvpexdn['cardtypes']); $vwplq2f0['Id'] = 0; if ($vwplvpexdn['addonly'] == false && memberium_app()->wplubo6() > 0) {  $vwplpq5a4 = wpllbej::wpllrqb(memberium_app()->wplubo6()); $vwplq2f0 = end($vwplpq5a4); $vwplkwc4l3 = array( 'Id', 'FirstName', 'LastName', 'PhoneNumber', 'BillAddress1', 'BillAddress2', 'BillCity', 'BillState', 'BillZip', 'BillCountry', 'NameOnCard', 'Last4', 'ExpirationMonth', 'ExpirationYear', 'CardType', ); foreach ($vwplkwc4l3 as $vwply17edn) { if (empty($vwplq2f0[$vwply17edn]) ) { $vwplq2f0[$vwply17edn] = ''; } } } if ($vwplq2f0['Id'] > 0) {  $vwpln2bu = $vwplq2f0['Id']; $vwpllzld = $vwplq2f0['FirstName']; $vwpl_csbu = $vwplq2f0['LastName']; $vwpleetzq = '************' . $vwplq2f0['Last4']; $vwplbnj3 = $vwplq2f0['CardType']; $vwplkxt4 = $vwplq2f0['ExpirationMonth']; $vwplsv2fue = $vwplq2f0['ExpirationYear']; $vwplw5mh = trim($vwplq2f0['NameOnCard']); $vwplhk96 = $vwplq2f0['PhoneNumber']; $vwplyo5k9 = $vwplq2f0['BillAddress1']; $vwplgnu2 = $vwplq2f0['BillAddress2']; $vwplavf521 = $vwplq2f0['BillCity']; $vwplc2bvs = $vwplq2f0['BillState']; $vwplrwvj = $vwplq2f0['BillCountry']; $vwplxuvg = $vwplq2f0['BillZip']; $vwplu4iv = isset($vwplq2f0['CVV2']) ? (string) $vwplq2f0['CVV2'] : ''; $vwplsfdb_t = 'wpllk1g'; $vwplk8e_u = ' disabled '; } else {  $vwpln2bu = 0; $vwpllzld = wplsbzgvp::wplc4na('firstname'); $vwpl_csbu = wplsbzgvp::wplc4na('lastname'); $vwpleetzq = ''; $vwplbnj3 = ''; $vwplkxt4 = ''; $vwplsv2fue = ''; $vwplw5mh = trim($vwpllzld . ' ' . $vwpl_csbu); $vwplhk96 = wplsbzgvp::wplc4na('phone1'); $vwplyo5k9 = wplsbzgvp::wplc4na('streetaddress1'); $vwplgnu2 = wplsbzgvp::wplc4na('streetaddress2'); $vwplavf521 = wplsbzgvp::wplc4na('city'); $vwplc2bvs = wplsbzgvp::wplc4na('state'); $vwplrwvj = wplsbzgvp::wplc4na('country'); $vwplxuvg = wplsbzgvp::wplc4na('postalcode'); $vwplu4iv = ''; $vwplsfdb_t = 'add'; $vwplk8e_u = ' '; } if (empty($vwplq2f0['NameOnCard']) ) { $vwplq2f0['NameOnCard'] = $vwpllzld . ' ' . $vwpl_csbu; $vwplw5mh = trim($vwplq2f0['NameOnCard' ]); } $vwplun47e = base64_encode(serialize(array( 'contact_id' => $vwplvtmqd, 'successurl' => $vwplvpexdn['successurl'], 'failureurl' => $vwplvpexdn['failureurl'], 'creditcard_id' => $vwpln2bu, 'set_default' => $vwplvpexdn['set_default'], 'tag_ids' => $vwplvpexdn['tag_ids'], 'action_ids' => $vwplvpexdn['action_ids'], 'goals' => $vwplvpexdn['goals'], 'success_msg' => $vwplvpexdn['success_msg'], 'backcharge' => $vwplvpexdn['backcharge'], ) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplun47e); $vwpld576f2 = ''; $vwpld576f2 .= "<form name=\"{$vwpluj8al3}\" id=\"{$vwpluj8al3}\" method=\"post\">"; $vwpld576f2 .= wp_nonce_field('creditcard_add_' . $vwplyqfz, '_wpnonce', true, false); $vwpld576f2 .= "<input type=\"hidden\" name=\"memb_form_type\" value=\"memb_add_creditcard_button\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"form_id\" value=\"{$vwplyqfz}\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"parameters\" value=\"{$vwplun47e}\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"signature\" value=\"{$vwpltmfi}\">"; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Card Number:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="text" size="20" maxlength="20" required pattern="[0-9]{13,16}" name="cc-number" x-autocompletetype="cc-number" placeholder="' . _x('Credit Card Number', 'memb_add_creditcard', 'memberium') . '" value="' . $vwpleetzq . '" ' . $vwplk8e_u . '>'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Card Type:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<select name="cardtype" required ' . $vwplk8e_u . '>'; $vwpld576f2 .= "<option value=\"\"></option>"; foreach ($vwplvpexdn['cardtypes'] as $vwplc9mk1b) { $vwpld576f2 .= "<option value=\"{$vwplc9mk1b}\" " . ( ($vwplc9mk1b == $vwplbnj3 ? ' selected ' : ' ') ) . ">{$vwplc9mk1b}</option>"; } $vwpld576f2 .= '</select>'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Expiration Month:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<select name="expirationmonth" required >'; for ($vwplt_5ro = 1; $vwplt_5ro < 13; $vwplt_5ro++) { $vwpls8hd2s = date('F', mktime(1, 1, 1, $vwplt_5ro, 1, 2000) ); $vwpls8hd2s = _x($vwpls8hd2s, 'memb_add_creditcard', 'memberium'); $vwpld576f2 .= "<option " . ( ($vwplkxt4 == $vwplt_5ro) ? " selected='selected' " : "") . " value=\"" . sprintf('%02d', $vwplt_5ro) . "\">" . sprintf('%02d', $vwplt_5ro) . ' - ' . $vwpls8hd2s . "</option>"; } $vwpld576f2 .= '</select>'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Expiration Year:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<select name="expirationyear" required>'; for ($vwplt_5ro = date('Y'); $vwplt_5ro < date('Y') + 15; $vwplt_5ro++) { $vwpld576f2 .= "<option " . ( ($vwplsv2fue == $vwplt_5ro) ? " selected='selected' " : ''). " value=\"{$vwplt_5ro}\">{$vwplt_5ro}</option>"; } $vwpld576f2 .= '</select>'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('CVV Code:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="text" size="4" maxlength="4" required placeholder="" value="" name="cvv2">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Name on Card:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="text" size="30" required placeholder="' . _x('Full Name on Card', 'memb_add_creditcard', 'memberium') . '" value="' . $vwplw5mh . '" name="nameoncard">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Phone Number:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="tel" size="20" required value="' . $vwplhk96 . '" name="phonenumber" placeholder="' . _x('Best Phone Number', 'memb_add_creditcard', 'memberium') . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Street Address:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="text" size="30" value="' . $vwplyo5k9 . '" name="streetaddress1" required placeholder="' . _x('Address Line 1', 'memb_add_creditcard', 'memberium') . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Street Address:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="text" size="30" value="' . $vwplgnu2 . '" name="streetaddress2" placeholder="' . _x('Optional Address Line 2', 'memb_add_creditcard', 'memberium') . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('City:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="text" required value="' . $vwplavf521 . '" name="city" placeholder="' . _x('City', 'memb_add_creditcard', 'memberium') . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('State/Province:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="text" size="30" required name="state" placeholder="' . _x('N/A if none', 'memb_add_creditcard', 'memberium') . '" value="' . $vwplc2bvs . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Postal Code:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<input type="text" size="15" required name="postalcode" placeholder="' . _x('Zip or Postal Code', 'memb_add_creditcard', 'memberium') . '" value="' . $vwplxuvg . '">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label>' . _x('Country:', 'memb_add_creditcard', 'memberium') . '</label>'; $vwpld576f2 .= '<select name="country" required>'; $vwpld576f2 .= $i2sdk->getCountryOptions($vwplrwvj); $vwpld576f2 .= '</select>'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= '<div>'; $vwpld576f2 .= '<label></label>'; $vwpld576f2 .= '<input type="submit" value="' . _x('Submit', 'memb_add_creditcard', 'memberium') . '" name="defaultcard">'; $vwpld576f2 .= '</div>'; $vwpld576f2 .= "</form>"; return $vwpld576f2; } function wplywai() { global $i2sdk; if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; }  if (! wp_verify_nonce($_POST['_wpnonce'], 'creditcard_add_' . $_POST['form_id']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_add_creditcard', 'memberium') ); exit; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_add_creditcard', 'memberium') ); exit; } $vwplun47e = unserialize(base64_decode($_POST['parameters']) ); $vwplt9si2 = true; $vwplz0lv2q = (bool) $vwplun47e['backcharge']; $vwpln2bu = (int) $vwplun47e['creditcard_id']; $vwplyqfz = (int) $_POST['form_id']; $vwply_yxi = trim($vwplun47e['successurl']); $vwplgm4p8u = trim($vwplun47e['failureurl']); $vwplaeit = (bool) $vwplun47e['set_default']; $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwpl_5_m1 = false; $vwplimo5 = $vwplgm4p8u;  $vwplvtmqd = (int) $vwplun47e['contact_id']; if ($vwplvtmqd < 1) { $vwplt9si2 = false; $_SESSION['flash']['add_creditcard'] = _x('Invalid User ID', 'memb_add_creditcard', 'memberium'); } $_SESSION['flash']['add_creditcard'] = $vwplun47e['success_msg'];  if (empty($_POST['cardtype']) && ! empty($_POST['cc-number']) ) { $_POST['cardtype'] = wplg_b85d::wplywf_r($_POST['cc-number']); }   if (! $vwpln2bu) { $vwplkwc4l3 = array( 'nameoncard', 'cc-number', 'expirationmonth', 'expirationyear', 'cardtype', 'streetaddress1', 'city', 'country', 'phonenumber', 'cvv2', ); } else { $vwplkwc4l3 = array( 'nameoncard', 'expirationmonth', 'expirationyear', 'streetaddress1', 'city', 'country', 'phonenumber', 'cvv2', ); } if (is_array($vwplkwc4l3) ) { foreach ($vwplkwc4l3 as $vwpl_s6l) { if (empty($_POST[$vwpl_s6l]) || trim($_POST[$vwpl_s6l]) == '') { $vwplt9si2 = false; $_SESSION['flash']['add_creditcard'] = _x('You need to fill out all required fields.', 'memb_add_creditcard', 'memberium'); break; } } }  if ($vwplt9si2) { if ( (date('Ym') > ($_POST['expirationyear'] . $_POST['expirationmonth']) ) ) { $_SESSION['flash']['add_creditcard'] = _x('The credit card is expired.', 'memb_add_creditcard', 'memberium'); $vwplt9si2 = false; } }  if ($vwpln2bu == 0) { if ($vwplt9si2) { if (! wplg_b85d::wplyhe8bc($_POST['cc-number']) ){ $_SESSION['flash']['add_creditcard'] = _x('The credit card number is invalid.', 'memb_add_creditcard', 'memberium'); $vwplt9si2 = false; } } } if (isset($_POST['cc-number']) && $vwplt9si2) {  $vwplwahx = substr($_POST['cc-number'], -4); $alt_card_id = $this->isdk->locateCard( (int) memberium_app()->wplubo6(), $vwplwahx); if ($alt_card_id > 0) { $vwplgwrm0 = wpllbej::wpllrqb(memberium_app()->wplubo6() ); if (isset($vwplgwrm0[$alt_card_id]) ) { $vwpln2bu = $alt_card_id; } } } if ($vwplt9si2) { if ($vwpln2bu == 0) { $vwplwbpn = array( 'ContactId' => $vwplvtmqd, 'BillName' => wp_strip_all_tags($_POST['nameoncard']), 'BillAddress1' => wp_strip_all_tags($_POST['streetaddress1']), 'BillAddress2' => wp_strip_all_tags($_POST['streetaddress2']), 'BillCity' => wp_strip_all_tags($_POST['city']), 'BillCountry' => wp_strip_all_tags($_POST['country']), 'BillState' => wp_strip_all_tags($_POST['state']), 'BillZip' => wp_strip_all_tags($_POST['postalcode']), 'CardNumber' => (string) wp_strip_all_tags($_POST['cc-number']), 'CardType' => wp_strip_all_tags($_POST['cardtype']), 'CVV2' => (string) $_POST['cvv2'],  'FirstName' => wplsbzgvp::wplc4na('firstname'), 'LastName' => wplsbzgvp::wplc4na('lastname'), 'ExpirationMonth' => wp_strip_all_tags($_POST['expirationmonth']), 'ExpirationYear' => wp_strip_all_tags($_POST['expirationyear']), 'NameOnCard' => wp_strip_all_tags($_POST['nameoncard']), 'Email' => strtolower(wplsbzgvp::wplc4na('email') ), 'PhoneNumber' => wp_strip_all_tags($_POST['phonenumber']), 'ShipAddress1' => wplsbzgvp::wplc4na('address2street1'), 'ShipAddress2' => wplsbzgvp::wplc4na('address2street2'), 'ShipCity' => wplsbzgvp::wplc4na('city2'), 'ShipCompanyName' => wplsbzgvp::wplc4na('company'), 'ShipCountry' => wplsbzgvp::wplc4na('country2'), 'ShipFirstName' => wplsbzgvp::wplc4na('firstname'), 'ShipLastName' => wplsbzgvp::wplc4na('lastname'), 'ShipMiddleName' => '', 'ShipName' => wp_strip_all_tags($_POST['nameoncard']), 'ShipPhoneNumber' => wp_strip_all_tags($_POST['phonenumber']), 'ShipState' => wplsbzgvp::wplc4na('state2'), 'ShipZip' => wplsbzgvp::wplc4na('postalcode2'), ); $vwpln2bu = $this->isdk->dsAdd('CreditCard', $vwplwbpn); if ($vwpln2bu > 0) { $vwpl_5_m1 = true; } } else { $vwplgvh0x = array( 'BillName' => wp_strip_all_tags($_POST['nameoncard']), 'BillAddress1' => wp_strip_all_tags($_POST['streetaddress1']), 'BillAddress2' => wp_strip_all_tags($_POST['streetaddress2']), 'BillCity' => wp_strip_all_tags($_POST['city']), 'BillCountry' => wp_strip_all_tags($_POST['country']), 'BillState' => wp_strip_all_tags($_POST['state']), 'BillZip' => wp_strip_all_tags($_POST['postalcode']), 'CVV2' => (string) $_POST['cvv2'], 'ExpirationMonth' => wp_strip_all_tags($_POST['expirationmonth']), 'Email' => strtolower(wplsbzgvp::wplc4na('email') ), 'FirstName' => wplsbzgvp::wplc4na('firstname'), 'LastName' => wplsbzgvp::wplc4na('lastname'), 'ExpirationYear' => wp_strip_all_tags($_POST['expirationyear']), 'NameOnCard' => wp_strip_all_tags($_POST['nameoncard']), 'PhoneNumber' => wp_strip_all_tags($_POST['phonenumber']), 'MaestroIssueNumber' => '', 'ShipAddress1' => wplsbzgvp::wplc4na('address2street1'), 'ShipAddress2' => wplsbzgvp::wplc4na('address2street2'), 'ShipCity' => wplsbzgvp::wplc4na('city2'), 'ShipCompanyName' => wplsbzgvp::wplc4na('company'), 'ShipCountry' => wplsbzgvp::wplc4na('country2'), 'ShipFirstName' => wplsbzgvp::wplc4na('firstname'), 'ShipLastName' => wplsbzgvp::wplc4na('lastname'), 'ShipMiddleName' => '', 'ShipName' => wp_strip_all_tags($_POST['nameoncard']), 'ShipPhoneNumber' => wp_strip_all_tags($_POST['phonenumber']), 'ShipState' => wplsbzgvp::wplc4na('state2'), 'ShipZip' => wplsbzgvp::wplc4na('postalcode2'), ); $vwpln2bu = (int) $this->isdk->dsUpdate('CreditCard', (int) $vwpln2bu, $vwplgvh0x); if ($vwpln2bu > 0) { $vwpl_5_m1 = true; } else { $vwpl_5_m1 = false; } } if ($vwpln2bu > 0) { $this->isdk->validateCard( (int) $vwpln2bu); } delete_transient('memb::creditcards::' . $vwplw5rgd3 . '::' . $vwplvtmqd); if ($vwpln2bu) {  if ($vwplaeit) { $vwplc0g3p = array( 'AutoCharge', 'CC1', 'ContactId', 'Id', 'MerchantAccountId', 'OriginatingOrderId', 'Status', ); $vwplv80sz = array( 'ContactId' => $vwplvtmqd,   ); $vwplanieul = 1000; $vwplho_n = 0; $vwply4j8x = $this->isdk->dsQueryOrderBy('RecurringOrder', $vwplanieul, $vwplho_n, $vwplv80sz, $vwplc0g3p, 'Id', false); $vwplhd61wa = wplz8bid::wplvf1d('settings', 'merchant_account_id'); foreach($vwply4j8x as $vwplheakg) { $vwplm2n3w[$vwplheakg['Id']] = array( 'CC1' => isset($vwplheakg['CC1']) ? $vwplheakg['CC1'] : 0, 'Id' => isset($vwplheakg['Id']) ? $vwplheakg['Id'] : 0, 'MerchantAccountId' => isset($vwplheakg['MerchantAccountId']) ? $vwplheakg['MerchantAccountId'] : $vwplhd61wa, 'OriginatingOrderId' => isset($vwplheakg['OriginatingOrderId']) ? $vwplheakg['OriginatingOrderId'] : 0, 'Status' => isset($vwplheakg['Status']) ? $vwplheakg['Status'] : 0, 'ContactId' => isset($vwplheakg['ContactId']) ? $vwplheakg['ContactId'] : 0, 'AutoCharge' => isset($vwplheakg['AutoCharge']) ? $vwplheakg['AutoCharge'] : 0, ); } unset($vwply4j8x, $vwplheakg); if (is_array($vwplm2n3w) ) { foreach ($vwplm2n3w as $vwply17edn => $vwplpwet1) { $vwpltjcgt = false; $vwpltjcgt = $vwpltjcgt || $vwplpwet1['Status'] !== 'Active'; $vwpltjcgt = $vwpltjcgt || $vwplpwet1['CC1'] == $vwpln2bu; if (! $vwpltjcgt) { $vwplopnf = (int) $vwplpwet1['Id']; $vwplv09c = array( 'CC1' => (int) $vwpln2bu, 'MerchantAccountId' => (int) $vwplpwet1['MerchantAccountId'],  'AutoCharge' => 1, ); $this->isdk->dsUpdate('RecurringOrder', $vwplopnf, $vwplv09c); } } } unset($vwplpwet1, $vwplv09c, $vwplc0g3p, $vwplv80sz, $vwply17edn); }   if ($vwplz0lv2q) { $vwplhd61wa = wplz8bid::wplvf1d('settings', 'merchant_account_id'); $vwplu2wa = memberium_app()->wplde7m6(memberium_app()->wplubo6(), false, true, true);   $vwplc0g3p = array( 'Id', 'JobRecurringId', ); $vwplv80sz = array( 'ContactId' => (int) $vwplvtmqd, ); $vwplanieul = 1000; $vwplho_n = 0; $vwply4j8x = $this->isdk->dsQuery('Job', $vwplanieul, $vwplho_n, $vwplv80sz, $vwplc0g3p); $vwplc69y = array(); foreach($vwply4j8x as $vwplheakg) {  $vwplc69y[$vwplheakg['Id']] = isset($vwplheakg['JobRecurringId']) ? $vwplheakg['JobRecurringId'] : 0;  } unset($vwply4j8x, $vwplheakg); $vwplgzxhr7 = array(); if (is_array($vwplu2wa)) { foreach($vwplu2wa as $vwpl_z_dl) { if ( ($vwpl_z_dl['TotalPaid'] < $vwpl_z_dl['TotalDue']) and ($vwpl_z_dl['PayStatus'] == '0') and ($vwpl_z_dl['TotalDue'] > 0) ) { $vwplv5ne_ = $vwpl_z_dl['Id']; $vwplqt3xfe = $vwpl_z_dl['JobId']; if (isset($vwplc69y[$vwplqt3xfe]) ) { $vwplgl57x = $vwplc69y[$vwplqt3xfe]; if (! empty($vwplm2n3w[$vwplgl57x]) && $vwplm2n3w[$vwplgl57x]['Status'] == 'Active') { $vwplgzxhr7[$vwplv5ne_] = array( 'invoice_id' => (int) $vwplv5ne_, 'recurringorder_id' => (int) $vwplgl57x, 'merchant_id' => (int) $vwplm2n3w[$vwplgl57x]['MerchantAccountId'], 'total_due' => $vwpl_z_dl['TotalDue'], ); } elseif (isset($vwplc69y[$vwplqt3xfe]) && $vwplc69y[$vwplqt3xfe] == 0) { $vwplgzxhr7[$vwplv5ne_] = array( 'invoice_id' => (int) $vwplv5ne_, 'recurringorder_id' => 0, 'merchant_id' => $vwplhd61wa, 'total_due' => $vwpl_z_dl['TotalDue'], ); } } } } }  usort($vwplgzxhr7, function($a, $b) { if ($a['total_due'] > $b['total_due']) return -1; if ($a['total_due'] < $b['total_due']) return 1; if ($a['invoice_id'] < $b['invoice_id']) return -1; if ($a['invoice_id'] > $b['invoice_id']) return 1; return 0; });  foreach($vwplgzxhr7 as $vwplm1dqej) { if ($vwplm1dqej['merchant_id']) { $vwplyio4f = $this->isdk->chargeInvoice($vwplm1dqej['invoice_id'], 'Updated Credit Card Back Charge', (int) $vwpln2bu, $vwplm1dqej['merchant_id'], false); if (is_string($vwplyio4f) ) { error_log("Memberium (" . __LINE__ . ' ' . __FUNCTION__ . "):  Error Charging Invoice ID {$vwplm1dqej['invoice_id']} - {$vwplyio4f}"); } } } }  } } if ($vwpl_5_m1) {  if (! empty($vwplun47e['action_ids']) ) { memberium_app()->wplmupt($vwplun47e['action_ids'], memberium_app()->wplubo6() ); } if (! empty($vwplun47e['goals']) ) { memberium_app()->wplge1yc6($vwplun47e['goals'], memberium_app()->wplubo6() ); } if (! empty($vwplun47e['tag_ids']) ) { memberium_app()->wplt263_($vwplun47e['tag_ids'], memberium_app()->wplubo6() ); } $vwplimo5 = $vwply_yxi;  memberium_app()->wpln6xe($vwplvtmqd); memberium_app()->wplj9ye($vwplvtmqd); wpllbej::wplw568u4($vwplvtmqd); } else { $vwplimo5 = $vwplgm4p8u; } if (! empty($vwplimo5) ) {  wplpwn3::wplbryv(); wp_redirect($vwplimo5); exit; } } function wplkfxk($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; } $vwplsb_pf = array( 'capture' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplpq5a4 = wpllbej::wpllrqb(memberium_app()->wplubo6() ); $vwplq2f0 = wpllbej::wplfts7($vwplpq5a4); unset($vwplpq5a4); $vwplsl8y = 0; if (count($vwplq2f0) > 0) { $vwpluaj7 = strtotime(date('Y-m-d') ); $vwplxp50 = strtotime(date($vwplq2f0['ExpirationYear'] . '-' . ($vwplq2f0['ExpirationMonth'] + 1) . '-01') ); $vwplsl8y = ( ($vwplxp50 - $vwpluaj7) / 86400); if ($vwplsl8y < 0) { $vwplsl8y = 0; } } $vwpltlkdcw = $vwplsl8y; return wplczvi98::wplyhei6(false, $vwpltlkdcw, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture']); } function wplrive($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; } $vwplsb_pf = array( 'capture' => '', 'days' => 0, 'debug' => false, 'subscription_ids' => '', 'txtfmt' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['debug'] = wplczvi98::wplbyhn($vwplvpexdn['debug'], false); $vwplvpexdn['days'] = (int) $vwplvpexdn['days']; $vwplpq5a4 = wpllbej::wpllrqb(memberium_app()->wplubo6() ); $vwplq2f0 = wpllbej::wplfts7($vwplpq5a4); if (! empty($vwplvpexdn['subscription_ids']) ) { } else { unset($vwplpq5a4); $vwplsl8y = 0; if (count($vwplq2f0) > 0) { $vwpluaj7 = strtotime(date('Y-m-d') ); $vwplxp50 = strtotime(date($vwplq2f0['ExpirationYear'] . '-' . $vwplq2f0['ExpirationMonth'] . '-28') ); $vwplsl8y = (int) ( ($vwplxp50 - $vwpluaj7) / 86400); if ($vwplsl8y < 0) { $vwplsl8y = 0; } } $vwpltalx = (boolean) ($vwplsl8y < $vwplvpexdn['days']); } $vwpltlkdcw = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwpltalx); if ($vwplvpexdn['txtfmt'] > '') { $vwpltlkdcw = wplczvi98::wpl_pkw6j($vwpltlkdcw, $vwplvpexdn['txtfmt']); } if ($vwplvpexdn['capture'] > '') { $vwpltlkdcw = wplczvi98::wplg6rw5y($vwpltlkdcw, $vwplvpexdn['capture']); }  foreach($vwplq2f0 as $vwply17edn => $vwplph268z) { $vwpltlkdcw = str_ireplace('%%' . $vwply17edn . '%%', $vwplph268z, $vwpltlkdcw); } $vwpltlkdcw = str_ireplace('%%days_left%%', $vwplsl8y, $vwpltlkdcw); return do_shortcode($vwpltlkdcw); } function wplb3pyha($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; } $vwplsb_pf = array( 'capture' => '', 'date_format' => '', 'default' => '', 'fields' => '', 'txtfmt' => '', 'separator' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium');  $vwplpq5a4 = wpllbej::wpllrqb(memberium_app()->wplubo6() ); $vwplq2f0 = array_change_key_case(wpllbej::wplfts7($vwplpq5a4), CASE_LOWER); $vwplfu1sbe = array_filter(array_map('strtolower', explode(',', $vwplvpexdn['fields']) ) ); $vwplx6yba = count($vwplfu1sbe); $vwple2rb_ = 0; $vwpltlkdcw = ''; unset($vwplpq5a4);  foreach ($vwplfu1sbe as $vwple2yn) { $vwple2yn = strtolower(trim($vwple2yn) ); if (isset($vwplq2f0[$vwple2yn]) ) { $vwplpg5x = strtotime($vwplq2f0[$vwple2yn]); if ($vwplvpexdn['date_format'] == '' || $vwplpg5x == 0) { $vwplnghzs1 = $vwplq2f0[$vwple2yn]; } else { $vwplnghzs1 = date($vwplvpexdn['date_format'], strtotime($vwplq2f0[$vwple2yn]) ); } } else { $vwplnghzs1 = $vwplvpexdn['default']; } $vwpltlkdcw .= $vwplnghzs1; if ($vwplx6yba > 1) { $vwpltlkdcw .= $vwplvpexdn['separator']; } } if ($vwplx6yba > 1 && strlen($vwplvpexdn['separator']) > 0) { $vwpltlkdcw = substr($vwpltlkdcw, 0, -strlen($vwplvpexdn['separator']) ); } return wplczvi98::wplyhei6(false, $vwpltlkdcw, $txtfmt, $vwplvpexdn['capture']); } function wpllxh83d($vwplvpexdn, $vwplckl3 = NULL, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (is_feed() ) { return; } $vwplsb_pf = array( 'button_text' => 'Pay Now', 'contact_id' => memberium_app()->wplubo6(), 'date_format' => 'M d, Y', 'redirect_url' => $_SERVER['REQUEST_URI'], 'form_class' => 'invoiceline', 'goal' => '', 'limit' => 0, 'merchant_id' => $this->options['settings']['merchant_account_id'], 'nocost' => true, 'only_prodids' => '', 'paid' => true, 'post' => '', 'pre' => '', 'reverse' => false, 'success_msg' => 'Your payment was successfully processed.', 'tag_id' => '', 'unpaid' => true,  ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (! $vwplvpexdn['contact_id']) { return; } $vwplvpexdn['nocost'] = wplczvi98::wplbyhn($vwplvpexdn['nocost'], false); $vwplvpexdn['paid'] = wplczvi98::wplbyhn($vwplvpexdn['paid'], false); $vwplvpexdn['reverse'] = wplczvi98::wplbyhn($vwplvpexdn['reverse'], false); $vwplvpexdn['unpaid'] = wplczvi98::wplbyhn($vwplvpexdn['unpaid'], false); if (trim($vwplckl3) == '') { $vwplckl3 .= '<div><span>%%invoice.id%%</span>'; $vwplckl3 .= '<span>%%description%%</span>'; $vwplckl3 .= '<span>$%%invoice.total%%</span>'; $vwplckl3 .= '<span>$%%total.paid%%</span>'; $vwplckl3 .= '<span>$%%refund.status%%</span>'; $vwplckl3 .= '<span>$%%amount.due%%</span>'; $vwplckl3 .= '<span>%%date.due%%</span>'; $vwplckl3 .= '<span>%%creditcard.dropdown%%</span>'; $vwplckl3 .= '<span>%%submit%%</span></div>'; } $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplvwi2o = memberium_app()->wplpg5eox(); $vwplu2wa = memberium_app()->wplde7m6($vwplvpexdn['contact_id'], $vwplvpexdn['paid'], $vwplvpexdn['unpaid']); if (is_array($vwplu2wa) && ! $vwplvpexdn['nocost']) { foreach($vwplu2wa as $vwply17edn => $vwpl_z_dl) { if ($vwpl_z_dl['InvoiceTotal'] == 0) { unset($vwplu2wa[$vwply17edn]); } } } if ($vwplvpexdn['reverse']) { $vwplu2wa = array_reverse($vwplu2wa, true); } $vwplpq5a4 = array(); $jobs = array(); if (! empty($vwplu2wa) ) { $vwplpq5a4 = wpllbej::wpllrqb($vwplvpexdn['contact_id']); }  if (empty($vwplpq5a4) ) { $vwpll_3b = ''; } else { $vwpll_3b = '<select name="creditcard_id">'; if (is_array($vwplpq5a4) ) { foreach ($vwplpq5a4 as $vwplq2f0) { $vwpll_3b .= '<option value="'. $vwplq2f0['Id'] . '">' . $vwplq2f0['CardType'] . ' ' . $vwplq2f0['Last4'] . '</option>'; } } $vwpll_3b .= '</select>'; } $vwplzstg = array( 0 => _x('No Credit', 'memb_list_invoices', 'memberium'), 1 => _x('Partial Credit Applied', 'memb_list_invoices', 'memberium'), 2 => _x('Full Credit Applied', 'memb_list_invoices', 'memberium'), ); $vwplu3pq = array( 0 => _x('Not Paid', 'memb_list_invoices', 'memberium'), 1 => _x('Paid', 'memb_list_invoices', 'memberium'), ); $vwplpn642 = array( 0 => _x('No Refund', 'memb_list_invoices', 'memberium'), 1 => _x('Partial Refund', 'memb_list_invoices', 'memberium'), 2 => _x('Full Refund', 'memb_list_invoices', 'memberium'), 3 => _x('Full Write-Off', 'memb_list_invoices', 'memberium'), 4 => _x('Partial Write-Off', 'memb_list_invoices', 'memberium'), ); $vwplaegnu = 0; $vwpltlkdcw = $vwplvpexdn['pre']; if (is_array($vwplu2wa) ) { if (count($vwplu2wa) > $vwplvpexdn['limit']) { } foreach ($vwplu2wa as $vwpl_z_dl) {  if ($vwplvpexdn['only_prodids'] > '') { } $vwplgzxhr7 = array_filter(explode(',', $vwpl_z_dl['ProductSold']) ); $vwplbcs_ = count($vwplgzxhr7); $vwplzfgcw9 = array_shift($vwplgzxhr7); $vwpls13xa = $vwplzstg[$vwpl_z_dl['CreditStatus']]; $vwpl_qm6 = $vwplu3pq[$vwpl_z_dl['PayStatus']]; $vwplgcwd1 = $vwplpn642[$vwpl_z_dl['RefundStatus']]; $vwplsb_pf = array( 'invoice_id' => (int) $vwpl_z_dl['Id'], 'merchant_id' => (int) $vwplvpexdn['merchant_id'], 'tag_id' => $vwplvpexdn['tag_id'], 'goal' => $vwplvpexdn['goal'], 'success_msg' => $vwplvpexdn['success_msg'], 'redirect_url' => $vwplvpexdn['redirect_url'], ); $vwplun47e = base64_encode(serialize($vwplsb_pf) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplun47e);  $vwplaegnu++; if ($vwplaegnu % 2) { $vwplyv8z = 'odd'; } else { $vwplyv8z = 'even'; }  if (in_array(trim($vwpl_z_dl['Description']), array('One-time:', 'Order Form') ) ) { if (isset($vwplvwi2o[$vwplzfgcw9]['ProductName']) ) { $vwpl_z_dl['Description'] = $vwplvwi2o[$vwplzfgcw9]['ProductName']; if ($vwplbcs_ > 1 ) { $vwpl_z_dl['Description'] .= sprintf(_x(', and %d other items.', 'memb_list_invoices', 'memberium'), ($vwplbcs_ - 1) ); } } } $vwplzxhjbg = '<form method="post" action="">'; $vwplzxhjbg .= wp_nonce_field('memb_payinvoice_' . $vwpl_z_dl['Id'], '_wpnonce', true, false); $vwplzxhjbg .= '<input type="hidden" name="memb_form_type" value="memb_pay_invoice">'; $vwplzxhjbg .= '<input type="hidden" name="parameters" value="' . $vwplun47e . '">'; $vwplzxhjbg .= '<input type="hidden" name="signature" value="' . $vwpltmfi . '">'; $vwplzxhjbg .= $vwplckl3; $vwplzxhjbg .= '</form>'; $vwplzxhjbg = str_ireplace('%%credit.status%%', $vwpls13xa, $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%cycler%%', $vwplyv8z, $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%description%%', $vwpl_z_dl['Description'], $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%invoice.id%%', $vwpl_z_dl['Id'], $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%invoice.total%%', sprintf('%0.2f', $vwpl_z_dl['InvoiceTotal']), $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%line%%', $vwplaegnu, $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%pay.status%%', $vwpl_qm6, $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%refund.status%%', $vwplgcwd1, $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%total.paid%%', sprintf('%0.2f', $vwpl_z_dl['TotalPaid']), $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%date.created%%', date($vwplvpexdn['date_format'], strtotime($vwpl_z_dl['DateCreated']) ), $vwplzxhjbg); if (! empty($vwpl_z_dl['!payment_due']) ) { $vwplzxhjbg = str_ireplace('%%amount.due%%', sprintf('%0.2f', $vwpl_z_dl['!payment_due']), $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%date.due%%', 'Past Due', $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%creditcard.dropdown%%', $vwpll_3b, $vwplzxhjbg); if ($vwplvpexdn['merchant_id'] > 0 && (! empty($vwplpq5a4) ) ) { $vwplzxhjbg = str_ireplace('%%submit%%', '<input type="submit" class="memb_invoice_payment_button" value="' . $vwplvpexdn['button_text'] . '">', $vwplzxhjbg); } else { $vwplzxhjbg = str_ireplace('%%submit%%', '', $vwplzxhjbg); } } else { $vwplzxhjbg = str_ireplace('%%amount.due%%', '0.00', $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%date.due%%', date($vwplvpexdn['date_format'], strtotime($vwpl_z_dl['DateCreated']) ), $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%creditcard.dropdown%%', '', $vwplzxhjbg); $vwplzxhjbg = str_ireplace('%%submit%%', '', $vwplzxhjbg); } $vwpltlkdcw .= $vwplzxhjbg; } } $vwpltlkdcw .= $vwplvpexdn['post']; return do_shortcode($vwpltlkdcw); } function wplq53du() { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6()) { return; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_list_invoices', 'memberium') ); exit; } $vwplun47e = unserialize(base64_decode($_POST['parameters']) ); $vwplvrne94 = (int) $vwplun47e['invoice_id']; if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_payinvoice_' . $vwplvrne94) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_list_invoices', 'memberium') ); exit; } $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplvtmqd = (int) memberium_app()->wplubo6(); $vwpln2bu = (int) $_POST['creditcard_id']; $vwplvrne94 = (int) $vwplun47e['invoice_id']; $vwplhg9w3d = (int) $vwplun47e['merchant_id']; $vwplqxosl = $vwplun47e['tag_id']; $vwplhlbt = $vwplun47e['goal']; $vwplewhxt_ = ''; $vwplu2wa = memberium_app()->wplde7m6($vwplvtmqd, false, true); $vwpl_z_dl = isset($vwplu2wa[$vwplvrne94]) ? $vwplu2wa[$vwplvrne94] : array(); $vwplc7ix = array( 'pay_action' => '', 'pay_goal' => '', ); $vwplyio4f = $this->isdk->chargeInvoice($vwplvrne94, _x('Memberium Customer Care', 'memb_list_invoices', 'memberium'), $vwpln2bu, $vwplhg9w3d, false); if (isset($vwplyio4f['Successful']) && $vwplyio4f['Successful']) { $vwplkat3k = memberium_app()->wplz8c3mi( (int) $vwpl_z_dl['JobId']); $vwplh8esw = $this->options['ecommerce']['actions']; foreach($vwplkat3k as $vwplopnf => $vwplpz7o9) { $vwplz1bp7 = isset($vwplh8esw[$vwplpz7o9['SubscriptionPlanId']]) ? $vwplh8esw[$vwplpz7o9['SubscriptionPlanId']] : false; if ($vwplz1bp7) { $vwplc7ix['pay_action'] .= empty($vwplz1bp7['pay_action']) ? '' : ',' . $vwplz1bp7['pay_action']; $vwplc7ix['pay_goal'] .= empty($vwplz1bp7['pay_goal']) ? '' : ',' . $vwplz1bp7['pay_goal']; } } foreach($vwplc7ix as $vwplyq9i7o => $vwplcjpa) { $vwplc7ix[$vwplyq9i7o] = trim($vwplc7ix[$vwplyq9i7o], ','); } $vwplewhxt_ = trim($vwplewhxt_ . ',' . $vwplc7ix['pay_action'], ','); $vwplhlbt = trim($vwplhlbt . ',' . $vwplc7ix['pay_goal'], ','); memberium_app()->wplt263_($vwplqxosl, $vwplvtmqd); memberium_app()->wplmupt($vwplewhxt_, $vwplvtmqd); memberium_app()->wplge1yc6($vwplhlbt, $vwplvtmqd);  $_SESSION['flash']['invoice_payment'] = $vwplun47e['success_msg'];  delete_transient('Memberium::' . $vwplw5rgd3 . '::Invoices::' . $vwplvtmqd); delete_transient('Memberium::' . $vwplw5rgd3 . '::PayPlans::' . $vwplvtmqd); delete_transient('Memberium::' . $vwplw5rgd3 . '::PayPlanItems::' . $vwplvtmqd); wplpwn3::wplbryv(); wp_redirect($vwplun47e['redirect_url']); exit; } else { $_SESSION['flash']['invoice_payment'] = _x('Payment failed.', 'memb_list_invoices', 'memberium'); } } function wpliw9d($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6()) { return; } static $vwplpq5a4 = false; static $vwplurqb3 = false; $vwplvtmqd = wplsbzgvp::wplfhxj9(); $vwplsb_pf = array( 'cancel_text' => 'Cancel', 'confirm_button' => 'Yes, Stop Subscription', 'confirm_cancel' => 'Keep Subscription', 'confirm_title' => 'Cancel Subscription?', 'confirm' => 0, 'date_format' => 'M d, Y', 'immediate' => false,  'jqueryui' => 1, 'onlyids' => '', 'orderby' => 'StartDate', 'sort' => 'a',  'status' => 'all',  ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['confirm'] = wplczvi98::wplbyhn($vwplvpexdn['confirm'], true); $vwplvpexdn['immediate'] = wplczvi98::wplbyhn($vwplvpexdn['immediate'], false); $vwplvpexdn['jqueryui'] = wplczvi98::wplbyhn($vwplvpexdn['jqueryui'], true); $vwplvpexdn['status'] = ucwords(trim($vwplvpexdn['status']) ); $vwplvpexdn['sort'] = substr(strtolower(trim($vwplvpexdn['sort']) ), 0, 1); $vwplvpexdn['orderby'] = trim($vwplvpexdn['orderby']); if ($vwplvpexdn['sort'] == 'a') { $vwplh6te = true; } else { $vwplh6te = false; }  $vwplvwi2o = get_transient('memberium_products'); if (! is_array($vwplvwi2o) ) { $vwplvwi2o = wpllbej::wplctzj(); set_transient('memberium_products', $vwplvwi2o, HOUR_IN_SECONDS * 24); }  $vwplqkp4 = get_transient('memberium_subscriptionplans'); if (! is_array($vwplqkp4) ) {  $vwplqkp4 = array(); $vwplv80sz = array( 'Id' => '%' ); $vwplc0g3p = array( 'Active', 'Cycle', 'Frequency', 'Id', 'PlanPrice', 'PreAuthorizeAmount', 'ProductId', 'Prorate' ); $vwply4j8x = $this->isdk->dsQuery('SubscriptionPlan', 1000, 0, $vwplv80sz, $vwplc0g3p); if (is_array($vwply4j8x) ) { foreach ($vwply4j8x as $vwplheakg) { $vwplqkp4[$vwplheakg['Id']] = $vwplheakg; } } set_transient('memberium_subscriptionplans', $vwplqkp4, HOUR_IN_SECONDS * 24); }  $vwplc0g3p = array( 'Last4', 'Status', 'ExpirationMonth', 'ExpirationYear', 'CardType', 'NameOnCard', 'Id', ); $vwplv80sz = array('ContactId' => memberium_app()->wplubo6() ); $vwply4j8x = $this->isdk->dsquery('CreditCard', 1000, 0, $vwplv80sz, $vwplc0g3p); if (is_array($vwply4j8x) ) { foreach ($vwply4j8x as $vwplheakg) { $vwplpq5a4[$vwplheakg['Id']] = $vwplheakg; } } set_transient('memberium_creditcards::' . memberium_app()->wplubo6(), $vwplpq5a4, HOUR_IN_SECONDS / 12);  $vwplurqb3 = memberium_app()->wpljkrho(memberium_app()->wplubo6() ); if (is_array($vwplurqb3) ) { if (! empty($vwplvpexdn['onlyids']) ) { $vwplvpexdn['onlyids'] = explode(',', $vwplvpexdn['onlyids']); foreach($vwplurqb3 as $vwply17edn => $vwplj4rq_) { if (! in_array($vwplj4rq_['ProgramId'], $vwplvpexdn['onlyids']) ) { unset($vwplurqb3[$vwply17edn]); } } } foreach ($vwplurqb3 as $vwply17edn=>$vwplm_r03) { if ($vwplvpexdn['status'] <> 'All') { if (strtolower($vwplvpexdn['status']) <> strtolower($vwplm_r03['Status']) ) { unset($vwplurqb3[$vwply17edn]); } } } usort($vwplurqb3, function($a, $b) use ($vwplvpexdn, $vwplh6te) { $orderby = $vwplvpexdn['orderby']; if ($a[$orderby] == $b[$orderby]) { $order = 0; } if ($vwplh6te) { $order = $a[$orderby] < $b[$orderby] ? -1 : 1; } else { $order = $a[$orderby] > $b[$orderby] ? -1 : 1; } return $order; }); } $vwplcice6 = (is_array($vwplurqb3) && ! empty($vwplurqb3) ); $vwplckl3 = wplczvi98::wplivoi98($vwplckl3, $vwpluvdiz, true, $vwplcice6); $vwplaegnu = 0; $vwpltlkdcw = ''; if ($vwplcice6 && trim($vwplckl3) == '') { $vwplckl3 = '<p>
			%%line%% - %%cycler%% -
			Subscription Name: %%subscription.name%%<br />
			Subscription Status:  %%subscription.status%%<br />
			Subscription Price: %%subscription.price%%<br />
			Subscription Billing Cycle:  %%subscription.billingcycle%%<br />
			Credit Card:  %%creditcard.last4%%<br />
			Card Type: %%creditcard.type%%<br />
			Card Expiration: %%creditcard.expmonth%% / %%creditcard.expyear%%<br />
			Subscription Start Date: %%subscription.startdate%%<br />
			Subscription Paid Through Date: %%subscription.paidthrough%%<br />
			Subscription Next Billing Date: %%subscription.nextbilling%%<br />
			Subscription Status: %%subscription.status%%<br />
			Keywords: %%subscription._keywords%%<br />
			%%cancel.button%%
			</p>'; } if ($vwplcice6) { $vwplmu62n = wpllbej::wplntnyv('RecurringOrder'); foreach ($vwplurqb3 as $vwply17edn=>$vwplm_r03) { $vwplaegnu++; $vwpljd3_a = false; switch ($vwplm_r03['BillingCycle']) { case 6: $vwplm_r03['BillingCycleWord1'] = _x('Daily', 'memb_list_subscriptions', 'memberium'); $vwplm_r03['BillingCycleWord2'] = _x('Days', 'memb_list_subscriptions', 'memberium'); break; case 3: $vwplm_r03['BillingCycleWord1'] = _x('Weekly', 'memb_list_subscriptions', 'memberium'); $vwplm_r03['BillingCycleWord2'] = _x('Weeks', 'memb_list_subscriptions', 'memberium'); break; case 2: $vwplm_r03['BillingCycleWord1'] = _x('Monthly', 'memb_list_subscriptions', 'memberium'); $vwplm_r03['BillingCycleWord2'] = _x('Months', 'memb_list_subscriptions', 'memberium'); break; case 1: $vwplm_r03['BillingCycleWord1'] = _x('Annually', 'memb_list_subscriptions', 'memberium'); $vwplm_r03['BillingCycleWord2'] = _x('Years', 'memb_list_subscriptions', 'memberium'); break; } if (empty($vwplm_r03['PaidThruDate']) ) { $vwplm_r03['PaidThruDate'] = $vwplm_r03['StartDate']; } $vwplun47e = base64_encode(serialize(array( 'cancel_text' => $vwplvpexdn['cancel_text'], 'immediate' => $vwplvpexdn['immediate'], 'next_bill_date' => $vwplm_r03['NextBillDate'], 'paid_through_date' => $vwplm_r03['PaidThruDate'], 'recurringorder_id' => (int) $vwplm_r03['Id'], 'subscriptionplan_id' => (int) $vwplm_r03['SubscriptionPlanId'], ) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplun47e); $vwpltv1b = '<form method="post" class="memberium-subscription-list" action="">'; $vwpltv1b .= wp_nonce_field('memb_cancelsubscription_' . $vwplm_r03['Id'], '_wpnonce', true, false); $vwpltv1b .= '<input type="hidden" name="memb_form_type" value="memb_cancel_subscription">'; $vwpltv1b .= '<input type="hidden" name="parameters" value="' . $vwplun47e . '">'; $vwpltv1b .= '<input type="hidden" name="signature" value="' . $vwpltmfi . '">'; $vwpltv1b .= $vwplckl3; if ($vwplm_r03['Frequency'] > 1) { $vwpl_2w3 = 'Every ' . $vwplm_r03['Frequency'] . ' ' . $vwplm_r03['BillingCycleWord2']; } else { $vwpl_2w3 = $vwplm_r03['BillingCycleWord1']; } if ($vwplaegnu % 2) { $vwplyv8z = 'odd'; } else { $vwplyv8z = 'even'; } $vwpltv1b = str_ireplace('%%line%%', $vwplaegnu, $vwpltv1b); $vwpltv1b = str_ireplace('%%cycler%%', $vwplyv8z, $vwpltv1b); $vwpltv1b = str_ireplace('%%creditcard.expmonth%%', isset($vwplpq5a4[$vwplm_r03['CC1']]['ExpirationMonth']) ? $vwplpq5a4[$vwplm_r03['CC1']]['ExpirationMonth'] : '', $vwpltv1b); $vwpltv1b = str_ireplace('%%creditcard.expyear%%', isset($vwplpq5a4[$vwplm_r03['CC1']]['ExpirationYear']) ? $vwplpq5a4[$vwplm_r03['CC1']]['ExpirationYear'] : '', $vwpltv1b); $vwpltv1b = str_ireplace('%%creditcard.id%%', (isset($vwplpq5a4['Id']) ? $vwplpq5a4['Id'] : ''), $vwpltv1b); $vwpltv1b = str_ireplace('%%creditcard.last4%%', isset($vwplpq5a4[$vwplm_r03['CC1'] ]['Last4']) ? 'XXXX-' . $vwplpq5a4[$vwplm_r03['CC1'] ]['Last4'] : '', $vwpltv1b); $vwpltv1b = str_ireplace('%%creditcard.type%%', isset($vwplpq5a4[ $vwplm_r03['CC1'] ]['CardType']) ? $vwplpq5a4[ $vwplm_r03['CC1'] ]['CardType'] : '', $vwpltv1b); $vwpltv1b = str_ireplace('%%subscription.billingcycle%%', $vwpl_2w3, $vwpltv1b); $vwpltv1b = str_ireplace('%%subscription.id%%', $vwplm_r03['Id'], $vwpltv1b); $vwpltv1b = str_ireplace('%%subscription.name%%', $vwplvwi2o[ $vwplqkp4[ $vwplm_r03['SubscriptionPlanId'] ]['ProductId'] ]['ProductName'], $vwpltv1b); $vwpltv1b = str_ireplace('%%subscription.paidthrough%%', date($vwplvpexdn['date_format'], strtotime($vwplm_r03['PaidThruDate']) ), $vwpltv1b); $vwpltv1b = str_ireplace('%%subscription.price%%', number_format($vwplm_r03['BillingAmt'], 2), $vwpltv1b); $vwpltv1b = str_ireplace('%%subscription.status%%', $vwplm_r03['Status'], $vwpltv1b); $vwplxb4o = empty($vwplm_r03['StartDate']) ? __('None') : date($vwplvpexdn['date_format'], strtotime($vwplm_r03['StartDate']) ); $vwpltv1b = str_ireplace('%%subscription.startdate%%', $vwplxb4o, $vwpltv1b); $vwplxb4o = empty($vwplm_r03['NextBillDate']) ? __('None') : date($vwplvpexdn['date_format'], strtotime($vwplm_r03['NextBillDate']) ); $vwpltv1b = str_ireplace('%%subscription.nextbilling%%', $vwplxb4o, $vwpltv1b); foreach($vwplmu62n as $vwpl_s6l) { if ($vwpl_s6l[0] == '_' && isset($vwplm_r03[$vwpl_s6l]) ) {; $vwpltv1b = str_ireplace('%%subscription.' . $vwpl_s6l . '%%', $vwplm_r03[$vwpl_s6l], $vwpltv1b); } } if (! empty($vwplm_r03['EndDate']) ) { $vwpltv1b = str_ireplace('%%subscription.enddate%%', date($vwplvpexdn['date_format'], strtotime($vwplm_r03['EndDate']) ), $vwpltv1b); } else { $vwpltv1b = str_ireplace('%%subscription.enddate%%', '', $vwpltv1b); } if (strtolower($vwplm_r03['Status']) == 'active' && empty($vwplm_r03['EndDate']) ) { $vwpltv1b = str_ireplace('%%cancel.button%%', '<input type="submit" class="memb_subscription_cancel_button" value="' . $vwplvpexdn['cancel_text'] . '">', $vwpltv1b); } elseif (! empty($vwplm_r03['EndDate']) ){ $vwpltv1b = str_ireplace('%%cancel.button%%', __('Cancelled', 'memberium'), $vwpltv1b); } else { $vwpltv1b = str_ireplace('%%cancel.button%%', '', $vwpltv1b); } $vwpltv1b .= '</form>'; $vwpltlkdcw .= do_shortcode($vwpltv1b); } unset($vwpl_2w3); } else { $vwpltlkdcw .= $vwplckl3; } if ($vwplvpexdn['confirm']) { $params = array( 'confirmTitle' => $vwplvpexdn['confirm_title'], 'confirmButton' => $vwplvpexdn['confirm_button'], 'confirmCancel' => $vwplvpexdn['confirm_cancel'], ); if ($vwplvpexdn['jqueryui']) { wp_enqueue_script('jqueryui', '//ajax.googleapis.com/ajax/libs/jqueryui/1.8.24/jquery-ui.min.js'); wp_enqueue_style('jqueryuitheme', '//ajax.googleapis.com/ajax/libs/jqueryui/1.8.24/themes/smoothness/jquery-ui.css'); } wp_enqueue_script('memberium-cancellation-confirmation', plugins_url('js/cancellation-confirm.js', MEMBERIUM_HOME) ); wp_localize_script('memberium-cancellation-confirmation', 'subscriptionCancelText', $params); }  $vwpltlkdcw = preg_replace('/(%%\S+%%)/', '', $vwpltlkdcw); return do_shortcode($vwpltlkdcw); } function wplt1khy() { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; } $vwplun47e = unserialize(base64_decode($_POST['parameters']) ); if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_cancelsubscription_' . $vwplun47e['recurringorder_id']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_list_subscriptions', 'memberium') ); exit; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_list_subscriptions', 'memberium') ); exit; } $vwplq1e6g5 = (int) $vwplun47e['recurringorder_id']; $vwplfp4fod = (int) $vwplun47e['subscriptionplan_id']; $vwpla7lyp = (bool) $vwplun47e['immediate']; $vwplzv9q = $vwplun47e['cancel_text']; $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplz1bp7 = isset($this->options['ecommerce']['actions'][$vwplfp4fod]) ? $this->options['ecommerce']['actions'][$vwplfp4fod] : array(); $vwpls2s9l = (isset($vwplz1bp7['cancel_action']) ) ? $vwplz1bp7['cancel_action'] : 0; $vwplng42n1 = (isset($vwplz1bp7['cancel_goal']) ) ? $vwplz1bp7['cancel_goal'] : ''; $vwplmrf5pm = (isset($vwplz1bp7['end_action']) ) ? $vwplz1bp7['end_action'] : 0; $vwplcbsv = (isset($vwplz1bp7['end_goal']) ) ? $vwplz1bp7['end_goal'] : ''; $vwpluaj7 = date('Ymd'); $vwplnqxjni = date('Ymd', strtotime($vwplun47e['next_bill_date'] . ' - 1 day') ); $vwplkr_qxf = $vwpla7lyp ? $vwpluaj7 : $vwplnqxjni;  $vwplv09c = array( 'AutoCharge' => 0, 'ReasonStopped' => sprintf(_x('Cancelled through Memberium on %s', 'memb_list_subscriptions', 'memberium'), date('Y-m-d') ), 'EndDate' => $vwplkr_qxf, ); if ($vwplkr_qxf <= $vwpluaj7) { $vwplv09c['Status'] = 'Inactive'; } $vwplyio4f = $this->isdk->dsUpdate('RecurringOrder', $vwplq1e6g5, $vwplv09c);  if ($vwpls2s9l > 0) { $this->isdk->runAS(memberium_app()->wplubo6(), $vwpls2s9l); } if ($vwplng42n1 > '') { $this->isdk->achieveGoal($vwplw5rgd3, $vwplng42n1, memberium_app()->wplubo6() ); }  if ($vwplmrf5pm > 0 || $vwplcbsv > '') { $vwplz4g7n = array( 'recurringorder_id' => $vwplq1e6g5, 'end_action' => $vwplmrf5pm, 'end_goal' => $vwplcbsv, ); if ($vwplmrf5pm > 0) { memberium_app()->wplbehq('actionset', $vwplnqxjni, $vwplz4g7n); } if ($vwplcbsv > '') { memberium_app()->wplbehq('achievegoal', $vwplnqxjni, $vwplz4g7n); } }  memberium_app()->wplde7m6(memberium_app()->wplubo6() ); $vwplurqb3 = memberium_app()->wpljkrho(memberium_app()->wplubo6(), true); $vwpllhfy0 = array( 'action' => 'Cancel', 'subscription_id' => $vwplq1e6g5, 'end_date' => date('Y-m-d', strtotime($vwplnqxjni) ), 'future_expiry' => (date('Ymd') <= $vwplkr_qxf) ? 0 : 1, ); $vwplfkojlf = add_query_arg($vwpllhfy0, $_SERVER['REQUEST_URI']); wplpwn3::wplbryv(); wp_redirect($vwplfkojlf); exit; }    function wpllv7zj3($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; } global $i2sdk_options, $i2sdk_registry, $memberium_options, $wpdb; static $vwplyqfz = 1001; $vwpluyar = _x('Submit', 'memb_one_click_sale', 'memberium'); if (isset($vwplvpexdn['unavailable_text']) ) { $vwply3b5 = $vwplvpexdn['unavailable_text']; } else { $vwply3b5 = _x('This offer is only available with a qualifying purchase.', 'memb_one_click_sale', 'memberium'); } if (isset($_SESSION['is4wp_purchase_session']['contactId']) ) { $vwplvtmqd = $_SESSION['is4wp_purchase_session']['contactId']; } else { return $vwply3b5; } if (isset($_SESSION['is4wp_purchase_session']['orderId']) ) { $vwplxl4jet = $_SESSION['is4wp_purchase_session']['orderId']; } else { return $vwply3b5; }  if ($vwplyqfz == 0) { $vwplyqfz = 1001; } $vwplj6iv7z = $vwplvpexdn['action_id']; $vwplnxb2 = $vwplvpexdn['button_url']; $vwplimo5 = $vwplvpexdn['success_url']; $vwpla0rswq = $vwplvpexdn['error_url']; $vwplrf7v = $vwplvpexdn['css_class']; $vwply3b5 = '<span class="is4wp_client_error">' . $vwply3b5 . '</span>'; if (isset($vwplvpexdn['button_text']) && $vwplvpexdn['button_text' > '']) $vwpluyar = $vwplvpexdn['button_text']; if (memberium_app()->wplubo6() == 0 || $vwplj6iv7z == 0 || $vwplxl4jet == 0 || ! isset($_GET['infusion_xid']) || ! isset($_GET['infusion_type']) || ! ($_GET['infusion_type'] == 'CustomFormSale') ) { return $vwply3b5; } $isdk = $i2sdk_registry->get_infusionsoft($i2sdk_options['app_name']);  $vwplmu62n = array('Id'); $vwplv80sz = array( 'Id' => $vwplxl4jet, 'ContactId' => memberium_app()->wplubo6(), ); $vwplu1i6 = $isdk->dsLoad('Job', intval($vwplxl4jet), $vwplmu62n); if ($vwplu1i6['Id'] <> $vwplxl4jet) { return $vwply3b5; } $vwplmu62n = array( 'Id', 'Last4', 'CardType', 'Status', 'ContactId' ); $vwplv80sz = array( 'ContactId' => $vwplvtmqd, ); $vwplv80sz = array( 'ContactId' => $vwplvtmqd, 'CardType' => $_GET['CreditCard0CardType'], 'ExpirationYear' => $_GET['CreditCard0ExpirationYear'], 'ExpirationMonth' => $_GET['CreditCard0ExpirationMonth'], ); $vwplovfs8 = $isdk->dsQuery('CreditCard', 1, 0, $vwplv80sz, $vwplmu62n); if (count($vwplovfs8) == 0) { return $vwply3b5; }  $vwplyqfz++; $vwpluj8al3 = 'is4wp_oneclick_sale_form_' . $vwplyqfz; $vwplcf6y18 = 'is4wp_oneclick_sale_button_' . $vwplyqfz; $vwplun47e = base64_encode(serialize(array( 'action_id' => $vwplj6iv7z, 'Contact0Email' => $_GET['Contact0Email'], 'contact_id' => $vwplvtmqd, 'order_id' => $vwplxl4jet, '$elv_redirect_url' => $vwplimo5, ) ) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplun47e); $vwpljm8vf = md5($i2sdk_options['api_key'] . $vwplxl4jet . $vwplvtmqd . $vwplj6iv7z); $vwpld576f2 = ''; $vwpld576f2 .= "<form name=\"{$vwpluj8al3}\" id=\"{$vwpluj8al3}\" method=\"post\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"is4wp_form_type\" value=\"is4wp_oneclick_sale\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"form_id\" value=\"{$vwplyqfz}\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"parameters\" value=\"{$vwplun47e}\">"; $vwpld576f2 .= "<input type=\"hidden\" name=\"digital_signature\" value=\"{$vwpltmfi}\">"; $vwpld576f2 .= wp_nonce_field('oneclick_sale_' . $vwplyqfz, '_wpnonce', true, false); if ($vwplnxb2 == '') { $vwpld576f2 .= "<input type=\"submit\" class=\"{$vwplrf7v}\" id=\"{$vwplcf6y18}\" value=\"{$vwpluyar}\">"; } else { $vwpld576f2 .= "<input type=\"image\" src=\"{$vwplnxb2}\" class=\"{$vwplrf7v}\" id=\"{$vwplcf6y18}\" >"; } $vwpld576f2 .= "</form>"; return $vwpld576f2; } function wplngjer() { if (! wpln9_s::wplq6kurm() ) { return; } if (! memberium_app()->wplubo6() ) { return; } if (! wp_verify_nonce($_POST['_wpnonce'], 'oneclick_sale_' . $_POST['form_id']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_one_click_sale', 'memberium') ); exit; } if (! memberium_app()->wplc3l0b($_POST['digital_signature'], $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_one_click_sale', 'memberium') ); exit; } $vwplun47e = unserialize(base64_decode($_POST['parameters']) ); $vwplxl4jet = (int) $vwplun47e['order_id']; $vwplj6iv7z = $vwplun47e['action_id']; if ($vwplj6iv7z > '') { memberium_app()->wplmupt($vwplj6iv7z, memberium_app()->wplubo6() ); } } function wplk82ajs($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! $this->license_status || memberium_app()->wplubo6() < 1) { return; } static $vwplpkticl = false; $vwplsb_pf = array( 'affiliate_id' => 0, 'allow_dupe' => 'n', 'autorun' => 'y',  'debug' => 'n', 'delay_days' => 0, 'dupe_action' => '', 'dupe_goal' => '', 'dupe_tag' => '', 'dupe_url' => '', 'failure_action' => '', 'failure_goal' => '', 'failure_tag' => '', 'failure_url' => '', 'first_only' => 'y', 'wplid3nye' => '', 'wpl_z7ir' => '', 'id' => 0, 'keep_failed' => 'n', 'merchant_id' => wplz8bid::wplvf1d( 'settings', 'merchant_account_id' ), 'price' => -1, 'quantity' => 1, 'success_action' => '', 'success_goal' => '', 'success_tag' => '', 'success_url' => '', 'taxable' => 'n', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['wpl_z7ir'] = trim($vwplvpexdn['wpl_z7ir']); $vwplvpexdn['wplid3nye'] = trim($vwplvpexdn['wplid3nye']); if (! empty($vwplvpexdn['wpl_z7ir']) ) { if (! wplj_l2t::wpl_n2s9($vwplvpexdn['wpl_z7ir']) ) { return; } } if (! empty($vwplvpexdn['wplid3nye']) ) { if (! wplj_l2t::wplid3nye($vwplvpexdn['wplid3nye']) ) { return; } } $vwplvtmqd = (int) memberium_app()->wplubo6(); $vwpln2bu = 0; $vwplkc7_ = 0; $vwplurqb3 = memberium_app()->wplvkevh(); $vwplt9si2 = true; $vwplvpexdn['allow_dupe'] = wplczvi98::wplbyhn($vwplvpexdn['allow_dupe'], false); $vwplvpexdn['autorun'] = wplczvi98::wplbyhn($vwplvpexdn['autorun'], true); $vwplvpexdn['debug'] = wplczvi98::wplbyhn($vwplvpexdn['debug'], true); $vwplvpexdn['delay_days'] = (int) $vwplvpexdn['delay_days']; $vwplvpexdn['first_only'] = wplczvi98::wplbyhn($vwplvpexdn['first_only'], true); $vwplvpexdn['id'] = (int) $vwplvpexdn['id']; $vwplvpexdn['keep_failed'] = wplczvi98::wplbyhn($vwplvpexdn['keep_failed'], false); $vwplvpexdn['merchant_id'] = (int) $vwplvpexdn['merchant_id']; $vwplvpexdn['quantity'] = (int) $vwplvpexdn['quantity']; $vwplvpexdn['taxable'] = wplczvi98::wplbyhn($vwplvpexdn['taxable'], false); if (empty($vwplvpexdn['affiliate_id']) ) { $vwplvpexdn['affiliate_id'] = memberium_app()->wplajl70($vwplvtmqd); } if ($vwplvpexdn['first_only'] && $vwplpkticl) { if ($vwplvpexdn['debug']) echo 'Already Executed.  Stopping.<br>'; return; } $vwplpkticl = true;  if (! isset($vwplurqb3[$vwplvpexdn['id']]) || $vwplurqb3[$vwplvpexdn['id']]['Active'] == 0) { $vwplt9si2 = false; } if ($vwplvpexdn['delay_days'] < 0) { $vwplt9si2 = false; } if ($vwplvpexdn['id'] < 0) { $vwplt9si2 = false; } if ($vwplvpexdn['merchant_id'] < 0) { $vwplt9si2 = false; } if ($vwplvpexdn['price'] < 0) { if (isset($vwplurqb3[$vwplvpexdn['id']]['PlanPrice']) ) { $vwplvpexdn['price'] = (double) $vwplurqb3[$vwplvpexdn['id']]['PlanPrice']; } else { $vwplt9si2 = false; } } $vwplvpexdn['price'] = (double) $vwplvpexdn['price']; if ($vwplvpexdn['quantity'] < 1) { $vwplt9si2 = false; } if ($vwplt9si2) {  if (! ( (int) $vwpln2bu) ) { $vwplpq5a4 = wpllbej::wpllrqb(memberium_app()->wplubo6() ); $vwplpq5a4 = wpllbej::wplfts7($vwplpq5a4); $vwpln2bu = (int) $vwplpq5a4['Id']; if ($vwplvpexdn['debug']) echo 'Credit Card ID = ', $vwpln2bu, '<br>'; } } if ( ! $vwpln2bu ) { $vwplt9si2 = false; } $vwploia7_d = $vwplvpexdn['failure_action']; $vwplhlbt = $vwplvpexdn['failure_goal']; $vwpltmveju = $vwplvpexdn['failure_tag']; $vwplfkojlf = $vwplvpexdn['failure_url']; if ($vwplt9si2) { $vwplpkticl = true; $vwplkc7_ = $this->isdk->addRecurringAdv($vwplvtmqd, $vwplvpexdn['allow_dupe'], $vwplvpexdn['id'], $vwplvpexdn['quantity'], $vwplvpexdn['price'], $vwplvpexdn['taxable'], $vwplvpexdn['merchant_id'], $vwpln2bu, $vwplvpexdn['affiliate_id'], $vwplvpexdn['delay_days']); if ($vwplvpexdn['debug']) echo 'Subscription ID  = ', $vwplkc7_, '<br>'; if ( (int) $vwplkc7_ > 0) { $vwplvrne94 = $this->isdk->recurringInvoice($vwplkc7_); $vwplyio4f = $this->isdk->chargeInvoice($vwplvrne94, _x('Memberium Subscription Purchase', 'memb_order_subscription', 'memberium'), $vwpln2bu, $vwplvpexdn['merchant_id'], false); if (! in_array($vwplyio4f['Code'], array('Declined', 'Error') ) ) { $vwploia7_d = $vwplvpexdn['success_action']; $vwplhlbt = $vwplvpexdn['success_goal']; $vwpltmveju = $vwplvpexdn['success_tag']; $vwplfkojlf = $vwplvpexdn['success_url']; } else { if (! $vwplvpexdn['keep_failed']) { $this->isdk->deleteSubscription($vwplkc7_); } } } else { if (stripos($vwplkc7_, 'Duplicate order') ) { if ($vwplvpexdn['debug']) echo 'Duplicate Order Detected<br>'; $vwploia7_d = $vwplvpexdn['dupe_action']; $vwplhlbt = $vwplvpexdn['dupe_goal']; $vwpltmveju = $vwplvpexdn['dupe_tag']; $vwplfkojlf = $vwplvpexdn['dupe_url']; } } } if (! empty($vwploia7_d) ) { if ($vwplvpexdn['debug']) echo 'Running Actionsets = ', $vwploia7_d, '<br>'; memberium_app()->wplmupt($vwploia7_d, $vwplvtmqd); } if (! empty($vwplhlbt) ) { if ($vwplvpexdn['debug']) echo 'Running Goals = ', $vwplhlbt, '<br>'; memberium_app()->wplge1yc6($vwplhlbt, $vwplvtmqd); } if (! empty($vwpltmveju) ) { if ($vwplvpexdn['debug']) echo 'Adding/Removing Tags = ', $vwpltmveju, '<br>'; memberium_app()->wplt263_($vwpltmveju, $vwplvtmqd); } if ($vwplvpexdn['debug']) echo 'Syncing Contact = ', $vwpltmveju, '<br>'; memberium_app()->wplj9ye($vwplvtmqd); if ($vwplvpexdn['debug']) echo 'Redirect URL = ', $vwplfkojlf, '<br>'; if ($vwplvpexdn['debug']) return; if ($vwplvpexdn['first_only'] && ! empty($vwplfkojlf) ) { echo '<script type="text/javascript"> window.location.replace("', $vwplfkojlf, '"); </script>'; exit; } }  function wplmm5zv($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { if (! $this->license_status) { return; } if (is_feed() ) { return; } if (empty($_SERVER['HTTPS']) ) { if (is_super_admin() ) { return '<p>Order Form Disabled Due to Missing SSL</p>'; } return; } $vwplsb_pf = array( 'autofill' => 'n', 'branding' => 'n', 'button_url' => '', 'cache' => HOUR_IN_SECONDS * 24, 'capture' => '', 'form_id' => '', 'form_url' => '', 'remove_styles' => 'y', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); if (false !== strpos($vwplvpexdn['form_url'], '.infusionsoft.com/saleform/') ) { $vwplvpexdn['form_url'] = str_ireplace('.infusionsoft.com/', '.infusionsoft.app/', $vwplvpexdn['form_url']); } if (false === strpos($vwplvpexdn['form_url'], '.infusionsoft.app/saleform/') ) { return _x('Invalid Form Embed', 'memb_orderform', 'memberium'); } if (false === stripos($vwplvpexdn['form_url'], '?cookieSearchStarted=true&cookieStopSearch=true') ) { $vwplvpexdn['form_url'] .= '?cookieSearchStarted=true&cookieStopSearch=true'; } $vwpltd9g = $vwplvpexdn['cache']; $vwpltlt6m = $vwplvpexdn['form_url']; $vwplvpexdn['branding'] = strtolower(substr($vwplvpexdn['branding'], 0, 1) ); $vwplvpexdn['autofill'] = strtolower(substr($vwplvpexdn['autofill'], 0, 1) ); $vwplvpexdn['remove_styles'] = strtolower(substr($vwplvpexdn['remove_styles'], 0, 1) ); $vwplrevno = false; $vwpllb314u = 'memberium_orderform_' . md5($vwpltlt6m); if ($vwpltd9g > 0) { $vwplrevno = get_transient($vwpllb314u); }  if ($vwplrevno == false) { $vwplt73pl = wp_remote_get($vwpltlt6m);  if (is_array($vwplt73pl) ) { preg_match('/<body>(.*)<\/body>/sm', $vwplt73pl['body'], $vwplyio4f); if (isset($vwplyio4f[1]) ) { $vwplrevno = $vwplyio4f[1]; set_transient($vwpllb314u, $vwplrevno, $vwpltd9g); } } else { return $vwplt73pl->errors['http_request_failed'][0]; } } if ($vwplvpexdn['remove_styles'] == 'y') { $vwplrevno = preg_replace('/<style>(.*)<\/style>/imU', '', $vwplrevno); } if ($vwplvpexdn['form_id'] > '') { $vwplrevno = str_replace('id="orderForm"', 'id="' . $vwplb0qgn . '"  ', $vwplrevno); } if ($vwplvpexdn['autofill'] == 'y') { foreach ($_GET as $vwply17edn => $vwplph268z) { $vwplrevno = str_replace('name=\'' . $vwply17edn . '\' value=\'\'', 'name="' . $vwply17edn . '" value="' . $vwplph268z . '"', $vwplrevno); } } if ($vwplvpexdn['button_url'] > '') { $vwplgoit = '<input type="image" value="Order" id="Order" class="default-input sale-orderbutton np inf-button" name="Order" src="' . $vwplvpexdn['button_url'] . '" style="width:auto;overflow:visible;"/>'; $vwplrevno = preg_replace('/<input(.*)id="Order"(.*)>/iU', $vwplgoit, $vwplrevno); } if ($vwplvpexdn['branding'] == 'n') { $vwplrevno = str_replace('Powered By Infusionsoft', '', $vwplrevno); } if ($vwplvpexdn['capture'] > '') { $vwplrevno = wplczvi98::wplg6rw5y($vwplrevno, $vwplvpexdn['capture']); } return $vwplrevno; } function wpldgw7o($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { static $vwplyqfz = 1; if (! $this->license_status || memberium_app()->wplubo6() < 1) { return; } $vwplsb_pf = array( 'autorun' => 0, 'button_text' => 'Buy Now', 'button_url' => '', 'clicked_button_text' => 'Processing Order', 'contact_id' => memberium_app()->wplubo6(), 'creditcard_id' => 0, 'css_class' => '', 'debug' => 0, 'delete_failed' => 1, 'failure_actionset' => 0, 'failure_goal' => '', 'failure_tag' => 0, 'failure_url' => '', 'lead_affiliate_id' => 0, 'nojs' => 0, 'order_title' => 'Memberium 1 Click Order', 'plan_id' => 0, 'process_specials' => true, 'product_ids' => '', 'promo_codes' => '', 'sale_affiliate_id' => 0, 'subscription_ids' => '', 'success_actionset' => 0, 'success_goal' => '', 'success_tag' => 0, 'success_url' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['nojs'] = wplczvi98::wplbyhn($vwplvpexdn['nojs'], false); $vwplvpexdn['debug'] = wplczvi98::wplbyhn($vwplvpexdn['debug'], false); if (empty($vwplvpexdn['contact_id']) ) { return; } if (empty($vwplvpexdn['product_ids']) ) { $vwplezsi = 0; } if ($vwplvpexdn['creditcard_id'] == 0) { $creditcard = wpllbej::wplfts7(wpllbej::wpllrqb() ); $vwplvpexdn['creditcard_id'] = $creditcard['Id']; } if ($vwplvpexdn['sale_affiliate_id'] == 0 && ! empty($_SESSION['infusionsoft_affiliate']) ) { $vwplvpexdn['sale_affiliate_id'] = (int) $_SESSION['infusionsoft_affiliate']; } $vwplezsi = (int) $vwplvpexdn['plan_id']; $vwplvpexdn['process_specials'] = (boolean) $vwplvpexdn['process_specials']; $vwplvpexdn['product_ids'] = array_filter(array_map('trim', explode(',', $vwplvpexdn['product_ids']) ) ); $vwplvpexdn['product_ids'] = array_filter(array_map('intval', $vwplvpexdn['product_ids']) ); $vwplvpexdn['promo_codes'] = array_filter(array_map('trim', explode(',', $vwplvpexdn['promo_codes']) ) ); $vwplvpexdn['subscription_ids'] = array_filter(array_map('trim', explode(',', $vwplvpexdn['subscription_ids']) ) ); $vwplvpexdn['subscription_ids'] = array_filter(array_map('intval', $vwplvpexdn['subscription_ids']) ); $vwplg6lz4 = array( 'contact_id' => $vwplvpexdn['contact_id'], 'creditcard_id' => $vwplvpexdn['creditcard_id'], 'debug' => $vwplvpexdn['debug'], 'delete_failed' => $vwplvpexdn['delete_failed'], 'failure_actionset' => $vwplvpexdn['failure_actionset'], 'failure_goal' => $vwplvpexdn['failure_goal'], 'failure_tag' => $vwplvpexdn['failure_tag'], 'failure_url' => $vwplvpexdn['failure_url'], 'lead_affiliate_id' => $vwplvpexdn['lead_affiliate_id'], 'order_title' => $vwplvpexdn['order_title'], 'payplan_id' => $vwplezsi, 'process_specials' => $vwplvpexdn['process_specials'], 'product_ids' => $vwplvpexdn['product_ids'], 'promo_codes' => $vwplvpexdn['promo_codes'], 'sale_affiliate_id' => $vwplvpexdn['sale_affiliate_id'], 'subscription_ids' => $vwplvpexdn['subscription_ids'], 'success_actionset' => $vwplvpexdn['success_actionset'], 'success_goal' => $vwplvpexdn['success_goal'], 'success_tag' => $vwplvpexdn['success_tag'], 'success_url' => $vwplvpexdn['success_url'], ); $vwplg6lz4 = base64_encode(serialize($vwplg6lz4) ); $vwpltmfi = memberium_app()->wpln4nyq2($vwplg6lz4); $vwpluj8al3 = 'memb_placeorder_form-' . $vwplyqfz; $vwplcf6y18 = 'memb_placeorder_button_' . $vwplyqfz;  $vwpld576f2 = ''; $vwpld576f2 .= "<form name='{$vwpluj8al3}' id='{$vwpluj8al3}' method='post'>"; $vwpld576f2 .= "<input type='hidden' name='memb_form_type' value='memb_placeorder_button'>"; $vwpld576f2 .= "<input type='hidden' name='params' value='{$vwplg6lz4}'>"; $vwpld576f2 .= "<input type='hidden' name='form_id' value='{$vwplyqfz}'>"; $vwpld576f2 .= "<input type='hidden' name='digital_signature' value='{$vwpltmfi}'>"; $vwpld576f2 .= wp_nonce_field('memb_placeorder_' . $vwplyqfz, '_wpnonce', true, false); if (empty($vwplvpexdn['button_url']) ) { $vwpld576f2 .= "<input type='submit' class='{$vwplvpexdn['css_class']}' id='{$vwplcf6y18}' value='{$vwplvpexdn['button_text']}'>"; } else { $vwpld576f2 .= "<input type='image' src='{$vwplvpexdn['button_url']}' class='{$vwplvpexdn['css_class']}' id='{$vwplcf6y18}'>"; } $vwpld576f2 .= "</form>"; if (! $vwplvpexdn['nojs']) { $vwpld576f2 .= "
			<script>
			jQuery(document).ready(function() {
				jQuery('#{$vwplcf6y18}').on('click', function() {
					jQuery('#{$vwplcf6y18}').prop('value', '{$vwplvpexdn['clicked_button_text']}');
					jQuery('#{$vwplcf6y18}').attr('disabled', 'disabled');
					jQuery('#{$vwpluj8al3}').submit();
					return true;
				});
			});
			</script>
			"; } $vwplyqfz++; return $vwpld576f2; } function wplqvqbum() { $vwplyqfz = $_POST['form_id']; if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_placeorder_' . $vwplyqfz) ) { wp_die('Security Check Failed - Nonce Validation Error'); exit; } if (! memberium_app()->wplc3l0b($_POST['digital_signature'], $_POST['params']) ) { wp_die('Security Check Failed - Signature Validation Error'); exit; } $vwplmh6qr = unserialize(base64_decode($_POST['params']) ); if (empty($vwplmh6qr['lead_affiliate_id']) || empty($vwplmh6qr['sale_affiliate_id']) ) {  $vwplnzlj0t = 'Invoice'; $vwplmu62n = array('AffiliateId', 'LeadAffiliateId'); $vwplv80sz = array('ContactId' => (int) $vwplmh6qr['contact_id']); $vwplj7k8y3 = 'Id'; $vwplh6te = false; $vwplu2wa = $this->isdk->dsQUeryOrderBy($vwplnzlj0t, 1, 0, $vwplv80sz, $vwplmu62n, $vwplj7k8y3, $vwplh6te); if (count($vwplu2wa) ) { if (empty($vwplmh6qr['lead_affiliate_id']) ) { $vwplmh6qr['lead_affiliate_id'] = isset($invoice[0]['LeadAffiliateId']) ? $invoice[0]['LeadAffiliateId'] : 0; } if (empty($vwplmh6qr['sale_affiliate_id']) ) { $vwplmh6qr['sale_affiliate_id'] = isset($invoice[0]['AffiliateId']) ? $invoice[0]['AffiliateId'] : 0; } } } $vwplf4y5 = $this->isdk->placeOrder( (int) $vwplmh6qr['contact_id'], (int) $vwplmh6qr['creditcard_id'], (int) $vwplmh6qr['payplan_id'], (array) $vwplmh6qr['product_ids'], (array) $vwplmh6qr['subscription_ids'], (bool) $vwplmh6qr['process_specials'], (array) $vwplmh6qr['promo_codes'], (int) $vwplmh6qr['lead_affiliate_id'], (int) $vwplmh6qr['sale_affiliate_id'] );  $vwplvrne94 = (int) $vwplf4y5['InvoiceId']; $vwplvzgui = (int) $vwplf4y5['OrderId']; if ($vwplf4y5['Successful'] == 'true') { $vwplvobnm0 = $vwplmh6qr['success_actionset']; $vwplhlbt = $vwplmh6qr['success_goal']; $vwpltmveju = $vwplmh6qr['success_tag']; $vwplfkojlf = $vwplmh6qr['success_url']; if (! empty($vwplmh6qr['order_title']) ) { $this->isdk->dsUpdate('Job', $vwplvzgui, array('JobTitle' => $vwplmh6qr['order_title']) ); } } else { $vwplvobnm0 = $vwplmh6qr['failure_actionset']; $vwplhlbt = $vwplmh6qr['failure_goal']; $vwpltmveju = $vwplmh6qr['failure_tag']; $vwplfkojlf = $vwplmh6qr['failure_url']; if ($vwplmh6qr['delete_failed']) { $this->isdk->deleteInvoice($vwplvrne94); if (! empty($vwplmh6qr['subscription_ids']) ) { memberium_app()->wplh543d2($vwplvzgui); } } } memberium_app()->wplovpy($vwplmh6qr['contact_id'], $vwpltmveju, $vwplvobnm0, $vwplhlbt); if (! empty($vwplfkojlf) ) { wplpwn3::wplbryv(); wp_redirect($vwplfkojlf); exit; } }  function wpli405r($vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '') { static $form_id = 0; if (memberium_app()->wplubo6() < 1) { return; } $form_id++; $vwplsb_pf = array( 'action_id' => '', 'button_text' => 'Submit', 'button_url' => '', 'contact_id' => memberium_app()->wplubo6(), 'css_class' => '', 'debug' => 'no', 'form_action' => '', 'fus_ids' => '', 'goals' => '', 'redirect_url' => '', 'tag_ids' => '', 'tagids' => '', 'target' => '_self', 'tokens' => '', ); $vwplvpexdn = shortcode_atts($vwplsb_pf, $vwplvpexdn, 'memberium'); $vwplvpexdn['debug'] = wplczvi98::wplbyhn($vwplvpexdn['debug'], false); $vwploia7_d = array(); $vwploia7_d['action_id'] = $vwplvpexdn['action_id']; $vwploia7_d['contact_id'] = $vwplvpexdn['contact_id']; $vwploia7_d['debug'] = $vwplvpexdn['debug']; $vwploia7_d['fus'] = $vwplvpexdn['fus_ids'] ; $vwploia7_d['goals'] = $vwplvpexdn['goals']; $vwploia7_d['redirect'] = $vwplvpexdn['redirect_url']; $vwploia7_d['tags'] = trim($vwplvpexdn['tagids'] . ',' . $vwplvpexdn['tag_ids'], ','); $vwploia7_d['tokens'] = trim($vwplvpexdn['tokens']); $vwplun47e = base64_encode(serialize($vwploia7_d) );  $vwpluj8al3 = 'memb_actionset_button-' . $form_id; $vwplcf6y18 = 'memb_actionset_button_' . $form_id; $vwpltmfi = memberium_app()->wpln4nyq2($vwplun47e); $vwpld576f2 = ''; $vwpld576f2 .= "<form name='{$vwpluj8al3}' id='{$vwpluj8al3}' method='post' target='{$vwplvpexdn['target']}' action='{$vwplvpexdn['form_action']}'>"; $vwpld576f2 .= "<input type='hidden' name='memb_form_type' value='memb_actionset_button'>"; $vwpld576f2 .= "<input type='hidden' name='form_id' value='{$form_id}'>"; $vwpld576f2 .= "<input type='hidden' name='action' value='{$vwplun47e}'>"; $vwpld576f2 .= "<input type='hidden' name='signature' value='{$vwpltmfi}'>"; $vwpld576f2 .= wp_nonce_field('memb_actionset_' . $form_id, '_wpnonce', true, false); if ($vwplvpexdn['button_url'] == '') { $vwpld576f2 .= "<input type='submit' class='{$vwplvpexdn['css_class']}' id='{$vwplcf6y18}' value='{$vwplvpexdn['button_text']}'>"; } else { $vwpld576f2 .= "<input type='image' src='{$vwplvpexdn['button_url']}' class='{$vwplvpexdn['css_class']}' id='{$vwplcf6y18}' >"; } $vwpld576f2 .= "</form>"; return $vwpld576f2; } function wplfpbou() { if (! $this->license_status || ! memberium_app()->wplubo6() ) { return; } if (! wp_verify_nonce($_POST['_wpnonce'], 'memb_actionset_' . $_POST['form_id']) ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'memb_actionset_button', 'memberium') ); exit; } if (! memberium_app()->wplc3l0b($_POST['signature'], $_POST['action']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'memb_actionset_button', 'memberium') ); exit; } $vwploia7_d = unserialize(base64_decode($_POST['action']) ); $vwplvtmqd = isset($vwploia7_d['contact_id']) ? $vwploia7_d['contact_id'] : memberium_app()->wplubo6(); $vwplyqfz = isset($_POST['form_id']) ? (int) $_POST['form_id'] : 0; $vwplxl4jet = isset($_POST['order_id']) ? (int) $_POST['order_id'] : 0; $vwplimo5 = isset($vwploia7_d['redirect']) ? $vwploia7_d['redirect'] : ''; if ($vwploia7_d['debug']) { echo '<pre>'; echo __LINE__, " - Set ActionSet = {$vwploia7_d['action_id']}<br />"; echo __LINE__, " - Set ContactId = {$vwploia7_d['contact_id']}<br />"; echo __LINE__, " - Set FUS       = {$vwploia7_d['fus']}<br />"; echo __LINE__, " - Set Goals     = {$vwploia7_d['goals']}<br />"; echo __LINE__, " - Set Tags      = {$vwploia7_d['tags']}<br />"; echo __LINE__, " - Set Tokens    = {$vwploia7_d['tokens']}<br />"; echo __LINE__, " - Set Redirect  = {$vwplimo5}<br />"; echo '</pre>'; } if (empty($vwplimo5) ) { $vwplimo5 = isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : $_SERVER['REQUEST_URI']; } if ($vwplvtmqd > 0) { if (! empty($vwploia7_d['tokens']) ) { memberium_app()->wplwuo3z8($vwploia7_d['tokens']); } if (! empty($vwploia7_d['fus']) ) { memberium_app()->wplz3_a($vwploia7_d['fus'], $vwplvtmqd); } if (! empty($vwploia7_d['goals']) ) { memberium_app()->wplge1yc6($vwploia7_d['goals'], $vwplvtmqd); } if (! empty($vwploia7_d['tags']) ) { memberium_app()->wplt263_($vwploia7_d['tags'], $vwplvtmqd); } if (! empty($vwploia7_d['action_id']) ) { $vwplyg7o = memberium_app()->wplmupt($vwploia7_d['action_id'], $vwplvtmqd); if ($vwploia7_d['debug']) { echo '<pre>', print_r($vwplyg7o, true), '</pre>'; } } } if ($vwploia7_d['debug']) { echo '<a href="', $vwplimo5, '">', _x('Continue...', 'memb_actionset_button', 'memberium'), '</a>'; exit; } if ($vwplimo5 > '') { wplpwn3::wplbryv(); wp_redirect($vwplimo5); exit; } if ($vwploia7_d['debug']) { exit; } }    function wplui5yo($vwplgogvie, $vwplgitq = array() ) { global $wpdb; if (is_a($vwplgogvie, 'WP_Error') ) { return $vwplgogvie; } $vwplc_uoh4 = ''; if (is_a($vwplgogvie, 'WP_User') ) { $vwplc_uoh4 = $vwplgogvie->user_login; } elseif (is_string($vwplgogvie) ) { $vwplc_uoh4 = $vwplgogvie; } $vwplsb_pf = array( 'appname' => wplz8bid::wplm3z9k('appname'), 'time' => time(), 'ipaddress' => wpll72jhi::wplol_bad(), ); $vwplgitq = wp_parse_args($vwplgitq, $vwplsb_pf); $vwpla54ov0 = MEMBERIUM_DB_LOGINLOG; $vwplx1ap5_ = "INSERT INTO `{$vwpla54ov0}` (`appname`, `logintime`, `ipaddress`, `username`) VALUES (%s, %d, %s, %s); "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $vwplgitq['appname'], $vwplgitq['time'], $vwplgitq['ipaddress'], $vwplc_uoh4); $wpdb->query($vwplx1ap5_); return $vwplgogvie; } function wplwxbl($vwplgogvie) { if (! is_a($vwplgogvie, 'WP_User') ) { return $vwplgogvie; } if (! memberium_app()->wplubo6() ) { $_SESSION = memberium_app()->wplyte2($vwplgogvie->ID); memberium_app()->wplwxbl( wplsbzgvp::wplfhxj9() ); } return $vwplgogvie; } function wplb4rv($vwplgogvie) { static $vwplqg64ib = array(); if (is_a($vwplgogvie, 'WP_User') ) { if (user_can($vwplgogvie, 'manage_options') ) { return $vwplgogvie; } if (memberium_app()->wplubo6() ) { $vwplrp9u24 = wpllbej::wplrande(memberium_app()->wplubo6() ); $vwpls0hwb5 = isset($vwplrp9u24['Groups']) ? explode(',', $vwplrp9u24['Groups']) : array();  if (in_array($this->options['settings']['site_ban_tag'], $vwpls0hwb5) ) { unset($_SESSION['memb_user'], $_SESSION['memb_db_fields']); if (empty($vwplqg64ib[$vwplgogvie->ID]) ) { $vwplzfi9q = wplycjh::wplwlamwg(memberium_app()->wplubo6(), 'loginfail', 'Site Ban Tag Found - ' . $vwplgogvie->user_email, wpll72jhi::wplol_bad(), true); $vwplqg64ib[$vwplgogvie->ID] = 1; } $vwplgogvie = new WP_Error( 'authentication_failed', __('Your access is currently suspended. Please contact customer support for further details.', 'memberium') ); wp_logout(); } } } return $vwplgogvie; } function wplqu9snq($vwplgogvie) {  if (! is_a($vwplgogvie, 'WP_User') ) { return $vwplgogvie; }  if (user_can($vwplgogvie, 'manage_options') ) { return $vwplgogvie; } $vwplvtmqd = memberium_app()->wplubo6(); if (! $vwplvtmqd) { return $vwplgogvie; } if (! empty($_SESSION['memb_user']['membership_names']) ) { return $vwplgogvie; } if (! isset($_SESSION['memb_user']['membership_names']) ) { $session = memberium_app()->wplyte2($vwplgogvie->ID); if (! empty($session['memb_user']['membership_names']) ) { return $vwplgogvie; } } $vwplzfi9q = wplycjh::wplwlamwg($vwplvtmqd, 'loginfail', 'No Active Membership Found - ' . $vwplgogvie->user_email, wpll72jhi::wplol_bad(), true); memberium_app()->wplwxbl(0); unset($_SESSION['memb_user'], $_SESSION['memb_db_fields']); $vwplgogvie = new WP_Error('authentication_failed', __('<strong>Error</strong>: Access Denied - No Active Membership.', 'memberium') ); return $vwplgogvie; } function wplh17gr4(&$vwplc_uoh4) { if (empty($vwplc_uoh4) ) { return $vwplc_uoh4; } $vwplgogvie = get_user_by('email', $vwplc_uoh4); if (! empty($vwplgogvie->user_login) ) { $vwplc_uoh4 = $vwplgogvie->user_login; } $_POST['log'] = $vwplc_uoh4; return $vwplc_uoh4; }  function wplgro1m($vwpln1la_j, $vwplgogvie = NULL) { if (isset($_POST['firstname']) || isset($_POST['lastname']) ) { if (isset($_POST['firstname']) ) { $vwpllzld = $_POST['firstname']; } if (isset($_POST['lastname']) ) { $vwpl_csbu = $_POST['lastname']; } } else { $vwpllzld = $vwplgogvie->first_name; $vwpl_csbu = $vwplgogvie->last_name; if (strpos($vwplgogvie->display_name, ' ') > 0) { $vwpllzld = trim(substr($vwplgogvie->display_name, 0, strpos($vwplgogvie->display_name, ' ') ) ); $vwpl_csbu = trim(substr($vwplgogvie->display_name, strpos($vwplgogvie->display_name, ' ') + 1) ); } } $vwpljw3d = trim($vwpllzld . ' ' . $vwpl_csbu); $vwpllzly5b = $vwplgogvie->ID; $vwplnwot = 0; $vwplrp9u24 = array( 'FirstName' => $vwpllzld, 'LastName' => $vwpl_csbu, 'Email' => $vwplgogvie->user_email, ); if ($vwplnwot > 0) { $vwplrp9u24['LeadSourceId'] = $vwplnwot; } if (get_user_meta($vwplgogvie->ID, '_fb_is_sync', TRUE) != 1) { if ($this->wplk1ie7_() ) { $vwplvtmqd = (int) $this->isdk->addWithDupCheck($vwplrp9u24, 'Email'); $this->isdk->OptIn($vwplrp9u24['Email'], 'Membership Site Registration'); if ( (int) $this->options['settings']['new_user_registration_tag'] > 0) { memberium_app()->wplt263_(array($this->options['settings']['new_user_registration_tag']), $vwplvtmqd); } delete_user_meta($vwplgogvie->ID, '_fb_is_sync'); add_user_meta($vwplgogvie->ID, '_fb_is_sync', 1); } }  $vwplgogvie = wp_get_current_user(); if (! is_a($vwplgogvie, 'WP_User') ) { return $vwplgogvie; } $this->wplh3645($vwplgogvie); }  function wpl_2qc($vwpln1la_j, $vwplgogvie = NULL) { if ($vwplgogvie == NULL) { $vwplgogvie = wp_get_current_user(); }  if (user_can($vwplgogvie, 'manage_options') ) { return; }  if (empty($_SESSION['memb_user']) ) { $_SESSION = memberium_app()->wplyte2($vwplgogvie->ID); } $_POST['redirect_to'] = empty($_POST['redirect_to']) ? '' : $_POST['redirect_to']; $_POST['redirect_to'] = empty($_POST['redirect']) ? $_POST['redirect_to'] : $_POST['redirect'];  if (0 == wplz8bid::wplvf1d('settings', 'allow_wpadmin') ) { if (stripos($_POST['redirect_to'], '/wp-admin') !== false) { $_POST['redirect_to'] = ''; } } $vwpllzly5b = (int) $vwplgogvie->ID; $vwplvtmqd = (int) wpllbej::wplbmo_1($vwpllzly5b); if ($vwpllzly5b) {  wpllbej::wplsxqmy($vwplvtmqd);  $vwplcgoq_4 = (int) get_user_meta($vwpllzly5b, 'login_count', true) + 1; $vwplyio4f = update_user_meta($vwpllzly5b, 'login_count', $vwplcgoq_4); $vwplyio4f = update_user_meta($vwpllzly5b, 'login_ip_address', wpll72jhi::wplol_bad() ); $vwplyio4f = update_user_meta($vwpllzly5b, 'last_login_time', time() ); if ($vwplvtmqd) { $vwplrp9u24 = wpllbej::wplrande($vwplvtmqd);  $this->wplo4tqd($vwplrp9u24, $vwpllzly5b); $vwplnkn4 = wplz8bid::wplvf1d('settings', 'login_actionset'); $vwple6xt = wplz8bid::wplvf1d('settings', 'login_tag'); $vwplivol = wplz8bid::wplvf1d('settings', 'last_login_field'); $vwplkqr4 = wplz8bid::wplvf1d('settings', 'sync_affiliate');  if (! empty($vwplnkn4) ) { memberium_app()->wplmupt($vwplnkn4, (int) $vwplvtmqd); }  if (! empty($this->options['settings']['login_tag']) ) { memberium_app()->wplt263_($vwple6xt, $vwplvtmqd); } if (! empty($vwplkqr4) ) { memberium_app()->wplei4rgx($vwplvtmqd); }  $vwplmu62n = array(); if (! empty($vwplivol) ) { $vwplqywoip = date_default_timezone_get(); date_default_timezone_set('America/New_York'); $vwplmu62n[$vwplivol] = date('Y-m-d\TH:i:s'); date_default_timezone_set($vwplqywoip); } if (! empty($vwplmu62n) ) { $this->isdk->updatecon($vwplvtmqd, $vwplmu62n);  } } } if (defined('DOING_AJAX') && DOING_AJAX) { $this->login_redirect_enabled = false; }  if ($this->login_redirect_enabled) {  $vwplfkojlf = ''; $vwplfkojlf = ! empty($_SESSION['memb_user']['login_page']) ? get_permalink($_SESSION['memb_user']['login_page']) : $vwplfkojlf; $vwplcgoq_4 = get_user_meta($vwplgogvie->ID, 'login_count', true);  if ($vwplcgoq_4 == 1) { $vwpl_bgfh = wplz8bid::wplvf1d('settings', 'first_login_page'); if (! empty($vwpl_bgfh) ) { $vwplfkojlf = get_permalink($vwpl_bgfh); } if (! empty($_SESSION['memb_user']['first_login_page']) ) { $vwplfkojlf = get_permalink($_SESSION['memb_user']['first_login_page']); } }  if (! empty($_POST['redirect_to']) ) { if ($_POST['redirect_to'] == '#current.page#') { $vwplfkojlf = $_SERVER['HTTP_REFERER']; } else { $vwplfkojlf = $_POST['redirect_to']; } } if (! empty($this->redirect_url) ) { $vwplfkojlf = $this->redirect_url; } if ($vwplfkojlf == '') { $vwplfkojlf = site_url(); }  $vwplfkojlf = apply_filters('memberium_login_redirect_url', $vwplfkojlf); if (! empty($vwplfkojlf) ) { if (function_exists('session_status') && PHP_SESSION_ACTIVE === session_status() ) {  } elseif (session_id() !== '') {  } wplpwn3::wplbryv(); $this->login_redirect_url = $vwplfkojlf; } } }  function wplpfyw($vwplc_uoh4) { $vwpl_2cd9 = wplz8bid::wplvf1d('settings', 'username_field'); if (! strpos($vwplc_uoh4, '@') && ! in_array($vwpl_2cd9, array('Email', 'EmailAddress2', 'EmailAddress3') ) ) { $vwplgogvie = get_user_by('login', $vwplc_uoh4); if (is_a($vwplgogvie, 'WP_User') ) { $vwplc_uoh4 = $vwplgogvie->data->user_email; } } return $vwplc_uoh4; }  function wplmmu74(&$vwplc_uoh4) { global $wpdb; if (empty($vwplc_uoh4)) { return false; }  $vwplc1ck3t = get_user_by('login', $vwplc_uoh4); if (is_a($vwplc1ck3t, 'WP_User') && (isset($vwplc1ck3t->caps['administrator']) && $vwplc1ck3t->caps['administrator'] == 1) || (isset($vwplc1ck3t->caps['super_admin']) && $vwplc1ck3t->caps['super_admin'] == 1) ) { return true; } if (! $this->license_status) { return false; } memberium_app()->wplwxbl(0); $vwplsjoas = ''; if (! headers_sent() && session_id() == '') { session_start(); } if (isset($_POST['pwd']) ) { $vwplsjoas = $_POST['pwd']; } if (isset($_POST['password']) ) { $vwplsjoas = $_POST['password']; } if (empty($vwplsjoas) ) { return false; } $vwpld7y5n0 = $this->wplpfyw($vwplc_uoh4); $vwpl_nky9 = wplz8bid::wplvf1d('settings', 'known_logins_only'); $vwplc1ck3t = get_user_by('email', $vwpld7y5n0); if (! $vwpl_nky9) { memberium_app()->wpllq6u($vwpld7y5n0); } memberium_app()->wplwxbl( memberium_app()->wplmgxs3($vwplc_uoh4, $vwplsjoas) ); if (memberium_app()->wplubo6() > 0) { $vwplc1ck3t = memberium_app()->wpli8mk07(memberium_app()->wplubo6() ); if ($vwplc1ck3t) { if (! username_exists($vwpld7y5n0) && ! email_exists($vwpld7y5n0) ) { if ($vwplc1ck3t->user_email <> $vwpld7y5n0) { if ($vwplc1ck3t->user_email == $vwplc1ck3t->user_login) { $vwplx1ap5_ = "UPDATE `{$wpdb->users}` SET `user_email` = %s, `user_login` = %s WHERE `ID` = %d; "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, strtolower($vwpld7y5n0), strtolower($vwpld7y5n0), $vwplc1ck3t->ID); } else { $vwplx1ap5_ = "UPDATE `{$wpdb->users}` SET `user_email` = %s WHERE `ID` = %d; "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, strtolower($vwpld7y5n0), $vwplc1ck3t->ID); } $wpdb->query($vwplx1ap5_); } } } } $vwplc1ck3t = get_user_by('login', $vwplc_uoh4); if (! $vwplc1ck3t) { $vwplc1ck3t = get_user_by('email', $vwplc_uoh4); } if (! memberium_app()->wplubo6() ) { $user = new WP_Error('authentication_failed', __('ERROR: Unknown Account.', 'memberium') ); return NULL; } $vwplywan = (int) wplz8bid::wplvf1d('settings', 'max_contact_age'); if ( $vwplywan == 0) { memberium_app()->wplj9ye(memberium_app()->wplubo6() ); } else { $vwplx1ap5_ = 'SELECT `value` FROM `' . MEMBERIUM_DB_CONTACTS . '` WHERE `id` = %d AND `appname` =  %s AND `fieldname` = "!LastUpdated" '; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, memberium_app()->wplubo6(), wplz8bid::wplm3z9k('appname') ); $vwplomw_9 = $wpdb->get_col($vwplx1ap5_); if ($vwplomw_9 < (time() - $this->options['settings']['max_contact_age']) ) { memberium_app()->wplj9ye(memberium_app()->wplubo6() ); } } memberium_app()->wplqd_lae(memberium_app()->wplubo6() ); $vwplrp9u24 = wpllbej::wplrande(memberium_app()->wplubo6() ); if (stripslashes($vwplsjoas) != $vwplrp9u24[$this->options['settings']['password_field']]) { $user = new WP_Error('authentication_failed', __('<strong>ERROR</strong>: Incorrect Password.', 'memberium') ); return NULL; } $vwplinyk0 = wplz8bid::wplvf1d('settings', 'sync_ecommerce'); $vwplnn16 = wplz8bid::wplvf1d('settings', 'sync_tag_details');   if (! empty($vwplnn16)) { memberium_app()->wplt52wpo(memberium_app()->wplubo6() ); } if (! empty($vwplinyk0)) { wpllbej::wplw568u4(memberium_app()->wplubo6() ); memberium_app()->wpljkrho(memberium_app()->wplubo6(), true); } $vwplpxqj4 = get_user_by('login', $vwplc_uoh4); if (! $vwplpxqj4) { $vwplpxqj4 = get_user_by('email', $vwplc_uoh4); } if ($vwplpxqj4) { $user = $vwplpxqj4; wp_set_current_user($user->ID); $_POST['username'] = $user->user_login; $vwplc_uoh4 = $user->user_login; } memberium_app()->doing_user_update = true; if (! $user) { $vwpldj4of = array(); $vwpldj4of['user_pass'] = isset($vwplrp9u24[$this->options['settings']['password_field']]) ? $vwplrp9u24[$this->options['settings']['password_field']] : ''; $vwpldj4of['user_login'] = $vwplc_uoh4; $vwpldj4of['user_url'] = isset($vwplrp9u24['Website']) ? $vwplrp9u24['Website'] : ''; $vwpldj4of['user_email'] = strtolower($vwplrp9u24['Email']); $vwpldj4of['first_name'] = $vwplrp9u24['FirstName']; $vwpldj4of['last_name'] = $vwplrp9u24['LastName']; $vwplgitq = array('contact' => $vwplrp9u24); $vwpldj4of['display_name'] = apply_filters('memberium/wpuser/display_name', memberium_app()->wplc4zac($vwplgitq), $vwplrp9u24); $vwpldj4of['nickname'] = apply_filters('memberium/wpuser/nickname', $vwpldj4of['display_name'], $vwplrp9u24); $vwpldj4of['user_nicename'] = apply_filters('memberium/wpuser/nicename', sanitize_title($vwpldj4of['nickname'], $vwpldj4of['display_name']), $vwplrp9u24); $vwpl_ma6z = wp_insert_user($vwpldj4of); if ($vwpl_ma6z) { memberium_app()->wplaig81($vwplvtmqd, $vwpl_ma6z); } do_action('user_register', $vwpl_ma6z); } else { $vwplhwubl = wplz8bid::wplvf1d('settings', 'disable_displayname_update'); $vwplh1d50 = wplz8bid::wplvf1d('settings', 'local_auth_only'); $vwplup7mi = wplz8bid::wplvf1d('settings', 'password_field'); $vwpldj4of = array(); $vwpldj4of['ID'] = username_exists(sanitize_user($vwplc_uoh4, true) ); $vwpldj4of['user_url'] = isset($vwplrp9u24['Website']) ? $vwplrp9u24['Website'] : ''; $vwpldj4of['user_email'] = strtolower($vwplrp9u24['Email']); $vwpldj4of['first_name'] = isset($vwplrp9u24['FirstName']) ? $vwplrp9u24['FirstName'] : ''; $vwpldj4of['last_name'] = isset($vwplrp9u24['LastName']) ? $vwplrp9u24['LastName'] : '';  if (empty($vwplhwubl) ) { $vwplgitq = array('contact' => $vwplrp9u24, 'user_id' => $user->ID); $vwpldj4of['display_name'] = apply_filters('memberium/wpuser/display_name', memberium_app()->wplc4zac($vwplgitq), $vwplrp9u24); $vwpldj4of['nickname'] = apply_filters('memberium/wpuser/nickname', $vwpldj4of['display_name'], $vwplrp9u24); $vwpldj4of['user_nicename'] = apply_filters('memberium/wpuser/nicename', sanitize_title($vwpldj4of['nickname'], $vwpldj4of['display_name']), $vwplrp9u24); }  if (empty($vwplh1d50) ) { if (! in_array($vwplsjoas, array('', 'PASSWORD_PLACEHOLDER') ) ) { if ( (! wp_check_password($vwplsjoas, $user->data->user_pass, $user->ID) ) ) { $vwpldj4of['user_pass'] = addslashes($vwplrp9u24[$$vwplup7mi]); } } } add_filter('send_password_change_email', array(memberium_app(), 'wplj4_rn8'), PHP_INT_MAX, 3); wp_update_user($vwpldj4of); remove_filter('send_password_change_email', array(memberium_app(), 'wplj4_rn8'), PHP_INT_MAX); $vwpl_ma6z = $vwpldj4of['ID']; $user = wp_set_current_user($vwpl_ma6z); memberium_app()->wplaig81(memberium_app()->wplubo6(), $vwpl_ma6z); } if ($vwpl_ma6z) { $user = wp_set_current_user($vwpl_ma6z);  } $vwpls0hwb5 = isset($vwplrp9u24['Groups']) ? explode(',', $vwplrp9u24['Groups']) : array(); memberium_app()->doing_user_update = false; }   function wplc4eb8($vwplgogvie, $vwplc_uoh4 = '', $vwplsjoas = '') { global $wpdb; if (is_a($vwplgogvie, 'WP_Error') ) { return $vwplgogvie; } if (isset($vwplgogvie->caps['administrator']) && $vwplgogvie->caps['administrator'] == 1 || isset($vwplgogvie->caps['super_admin']) && $vwplgogvie->caps['super_admin'] == 1) { return $vwplgogvie; } $vwpl_nky9 = wplz8bid::wplvf1d('settings', 'known_logins_only'); if ($vwpl_nky9) { return $vwplgogvie; } $vwpllzly5b = isset($vwplgogvie->ID) ? $vwplgogvie->ID : 0; $vwplsjoas = stripslashes($vwplsjoas); if ( (! empty($vwplc_uoh4) || ! empty($vwplsjoas) ) || $vwpllzly5b > 0) { if (! $this->license_status) { $vwplzfi9q = wplycjh::wplwlamwg(memberium_app()->wplubo6(), 'loginfail', 'Logins Disabled - Invalid License', wpll72jhi::wplol_bad(), true); $vwplgogvie = new WP_Error('authentication_failed', __('<center><strong>All Logins Temporarily Disabled for Maintenance Mode</strong></center>', 'memberium') ); return $vwplgogvie; }  if (empty($_SESSION['memb_user']) ) { $_SESSION = memberium_app()->wplyte2($vwplgogvie->ID); } $vwpld7y5n0 = $this->wplpfyw($vwplc_uoh4); memberium_app()->wpllq6u($vwpld7y5n0);  if (! memberium_app()->wplubo6() ) { memberium_app()->wplwxbl( (int) memberium_app()->wplmgxs3($vwplc_uoh4, $vwplsjoas) ); if (! memberium_app()->wplubo6() ) { memberium_app()->wplwxbl( (int) memberium_app()->wplmgxs3($vwplgogvie->user_email, $vwplsjoas) ); } }  if (memberium_app()->wplubo6() > 0) { $vwplrp9u24 = wpllbej::wplrande(memberium_app()->wplubo6() ); $vwpls0hwb5 = isset($vwplrp9u24['Groups']) ? explode(',', $vwplrp9u24['Groups']) : array(); $vwpllkmgq = wplz8bid::wplvf1d('settings', 'maximum_login_ips'); $vwplk3pg = wplz8bid::wplvf1d('settings', 'maximum_login_timeframe'); $vwpli7fym = wplz8bid::wplvf1d('settings', 'login_log'); $vwplqgcvs = wplz8bid::wplvf1d('settings', 'sync_affiliate');  if (! empty($vwpllkmgq) && ! empty($vwplk3pg) ) { $vwpla54ov0 = MEMBERIUM_DB_LOGINLOG; $vwplx1ap5_ = "SELECT count(distinct(`ipaddress`) ) as `logins` FROM `{$vwpla54ov0}` WHERE `appname` = %s AND `logintime` >= %d AND `username` = %s AND `ipaddress` != %s "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, wplz8bid::wplm3z9k('appname'), (int) (time() - (3600 * $vwplk3pg) ), $vwplc_uoh4, wpll72jhi::wplol_bad() ); $vwplyio4f = $wpdb->get_col($vwplx1ap5_); $vwplcgoq_4 = end($vwplyio4f); if ($vwplcgoq_4 >= $vwpllkmgq) { $vwplzfi9q = wplycjh::wplwlamwg(memberium_app()->wplubo6(), 'loginfail', 'Maximum Logins Exceeded ' . $vwplgogvie->user_email, wpll72jhi::wplol_bad(), true); $vwplgogvie = new WP_Error('authentication_failed', __('<strong>Error</strong>:  Maximum Logins Exceeded', 'memberium') ); return $vwplgogvie; } } elseif (! empty($vwpli7fym) ) { }  return $vwplgogvie; } $vwplag4ju = wplz8bid::wplvf1d('settings', 'allow_local_logins'); if (empty($vwplag4ju) ) { $vwplzfi9q = wplycjh::wplwlamwg(memberium_app()->wplubo6(), 'loginfail', 'Local Logins Prohibited ' . $vwplgogvie->user_email, wpll72jhi::wplol_bad(), true); $vwplgogvie = new WP_Error('authentication_failed', __('<strong>ERROR</strong>: Memberium Login Error', 'memberium') ); return $vwplgogvie; } } return $vwplgogvie; } function wpletmwei() { if (memberium_app()->wplubo6() > 0) { $vwplmjze = (int) wplz8bid::wplvf1d('settings', 'autologout_time'); $vwplfzym5i = wplz8bid::wplvf1d('settings', 'default_logout_page'); if (! empty($_SESSION['memb_user']['logout_page']) ) { $vwplwlb6m = wp_logout_url(get_permalink($_SESSION['memb_user']['logout_page']) ); } elseif (! empty($vwplfzym5i) ) { $vwplwlb6m = wp_logout_url($vwplfzym5i); } else { $vwplwlb6m = wp_logout_url(get_site_url() ); } echo '<meta http-equiv="refresh" content="', $vwplmjze, ';url=', $vwplwlb6m, '">'; } }    function wplewep($vwplc_uoh4, $vwplsjoas = '', $vwplhzdrbf = false) { global $wpdb; if (is_user_logged_in() ) { return false; } $vwpl_2cd9 = wplz8bid::wplvf1d('settings', 'username_field'); $vwplup7mi = wplz8bid::wplvf1d('settings', 'password_field'); $vwplvtmqd = memberium_app()->wplmgxs3($vwplc_uoh4, $vwplsjoas); $vwpl_nky9 = wplz8bid::wplvf1d('settings', 'known_logins_only'); $vwplw5rgd3 = wplz8bid::wplm3z9k('appname');  if ($vwpl_nky9) { $vwplx1ap5_ = 'SELECT id FROM ' . MEMBERIUM_DB_CONTACTS . ' WHERE id = %d AND appname = %s LIMIT 1;'; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $vwplvtmqd, $vwplw5rgd3 ); $vwplbu2j = (int) $wpdb->get_var($vwplx1ap5_); if ($vwplbu2j <> $vwplvtmqd) { return false; } } if ($vwplvtmqd) { $vwplrp9u24 = wpllbej::wplrande($vwplvtmqd); memberium_app()->wplqd_lae($vwplvtmqd); }  if (wplsbzgvp::wplfhxj9() == $vwplvtmqd) { if ($vwplhzdrbf) { return get_current_user_id(); } else { if (! empty($_SESSION['memb_user']['login_page']) ) {  wplpwn3::wplbryv(); wp_redirect(get_permalink($_SESSION['memb_user']['login_page']) ); exit; } else { return; } } } $vwpld7y5n0 = $this->wplpfyw($vwplc_uoh4); memberium_app()->wpllq6u($vwpld7y5n0); $vwplgogvie = get_user_by('email', $vwpld7y5n0); $vwpllzly5b = $vwplgogvie->ID; $_POST['pwd'] = $vwplrp9u24[$vwplup7mi]; $this->wplmmu74($vwplc_uoh4); if ($vwpllzly5b > 0) { wp_set_auth_cookie($vwpllzly5b); wp_set_current_user($vwpllzly5b); $this->wplmmu74($vwplc_uoh4); $this->wplh3645($vwpllzly5b);     if ($vwplhzdrbf) { return $vwpllzly5b; } else {  wplpwn3::wplbryv(); if (! empty($_SESSION['memb_user']['login_page']) ) { wp_redirect(get_permalink($_SESSION['memb_user']['login_page']) ); exit; } else { return; } } } return false; } function wplmc_jil($vwpllzly5b) {   $vwplgogvie = get_user_by('id', $vwpllzly5b); wp_set_auth_cookie($vwpllzly5b); wp_set_current_user($vwpllzly5b); $this->wplmmu74($vwplgogvie->user_login); do_action('wp_login', $user_login, $vwplgogvie);   }  function wplpvgs() { if (! $this->license_status) { return; } global $i2sdk, $wpdb; if (empty($GLOBALS['wp_rewrite']) ) { $GLOBALS['wp_rewrite'] = new WP_Rewrite(); } $vwpl_2cd9 = wplz8bid::wplvf1d('settings', 'username_field'); $vwplup7mi = wplz8bid::wplvf1d('settings', 'password_field'); $vwplh1d50 = wplz8bid::wplvf1d('settings', 'local_auth_only', 0); $vwplgist5g = explode(',', wplz8bid::wplvf1d('settings', 'autologin_authkeys') ); $vwplb5d6 = wplz8bid::wplvf1d('settings', 'first_login_page'); $vwplvtmqd = empty($_GET['Id']) ? 0 : (int) $_GET['Id']; $vwplxl4jet = empty($_GET['orderId']) ? 0 : (int) $_GET['orderId']; $vwpln1la_j = empty($_GET[$vwpl_2cd9]) ? '' : strtolower(stripslashes(trim($_GET[$vwpl_2cd9]) ) ); $vwpln1la_j = strtr($vwpln1la_j, ' ', '+'); $vwpldmyu = empty($_GET['auth_key']) ? '' : trim($_GET['auth_key']); $vwpltancmh = empty($_GET['redir']) ? '' : $_GET['redir']; $vwplqczmat = empty($_GET['forcelogin']) ? '' : $_GET['forcelogin']; $vwplahvu = empty($_GET['tag_ids']) ? '' : $_GET['tag_ids']; $vwplcg4j3 = ! empty($_GET['debug']); $vwplgogvie = false;  if ($vwpltancmh > '') { $this->redirect_url = $vwpltancmh; }    if (! empty($_GET['Contact0Email']) ) { $vwpln1la_j = strtolower(trim($_GET['Contact0Email']) ); } if (! empty($_GET['inf_field_Email']) ) { $vwpln1la_j = strtolower(trim($_GET['inf_field_Email']) ); } if (! empty($_GET['contactId']) ) { $vwplvtmqd = (int) $_GET['contactId']; }  if ($vwplvtmqd == 0 && $vwplxl4jet > 0) { $vwplmu62n = array('ContactId'); $vwplu1i6 = $this->isdk->dsLoad('Job', $vwplxl4jet, $vwplmu62n); if (is_array($vwplu1i6) ) { $vwplvtmqd = (int) $vwplu1i6['ContactId']; } else { sleep(1); $vwplu1i6 = $this->isdk->dsLoad('Job', $vwplxl4jet, $vwplmu62n); if (is_array($vwplu1i6) ) { $vwplvtmqd = (int) $vwplu1i6['ContactId']; } } }  $vwplkjx4fs = wplycjh::wplwlamwg($vwplvtmqd, 'autologin', "Autologin"); if (! empty($_SERVER['REQUEST_URI']) ) { wplycjh::wplxc5ht_($vwplkjx4fs, "Parameters " . $_SERVER['REQUEST_URI']); } else { wplycjh::wplxc5ht_($vwplkjx4fs, "Parameters " . serialize($_GET) ); } if ($vwplcg4j3) { echo __LINE__, ' - NOTICE:  Email = ', $vwpln1la_j, '<p>'; echo __LINE__, ' - NOTICE:  Contact ID = ', $vwplvtmqd, '<p>'; echo __LINE__, ' - NOTICE:  Order ID = ', $vwplxl4jet, '<p>'; echo __LINE__, ' - NOTICE:  Redirect URL set to ', $vwpltancmh, '<p>'; }  if (! in_array($vwpldmyu , $vwplgist5g) ) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Auth Key Mismatch'); if ($vwplcg4j3) echo __LINE__, ' - FAILURE:  Auth Key mismatch<p>';  wplpwn3::wplbryv(); wp_redirect(get_bloginfo('wpurl') ); exit; } if (! $vwplvtmqd) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Invalid Contact Id'); if ($vwplcg4j3) echo __LINE__, ' - FAILURE:  Invalid Contact ID<p>'; wplpwn3::wplbryv(); wp_redirect(get_bloginfo('wpurl') ); exit; }  if (empty($vwpln1la_j) ) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Invalid User Login'); if ($vwplcg4j3) echo __LINE__, ' - FAILURE:  Invalid User Login<p>'; wplpwn3::wplbryv(); wp_redirect(get_bloginfo('wpurl') ); exit; } $vwplsnrf = false; $vwplrp9u24 = wpllbej::wplrande($vwplvtmqd); if (empty($vwplrp9u24) ) { $vwplsnrf = true; } if (! $vwplsnrf) { if (isset($vwplrp9u24['!LastUpdated']) ) { $vwplywan = empty($this->options['settings']['max_contact_age']) ? 0 : $this->options['settings']['max_contact_age']; if (time() - $vwplrp9u24['!LastUpdated'] > $vwplywan) { $vwplsnrf = true; } } } else { memberium_app()->wplj9ye($vwplvtmqd); $vwplrp9u24 = wpllbej::wplrande($vwplvtmqd); }  if (empty($vwplrp9u24) ) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Empty Contact Record'); if ($vwplcg4j3) echo __LINE__, ' - FAILURE:  Empty Contact Record<p>'; wplpwn3::wplbryv(); wp_redirect(get_bloginfo('wpurl') ); exit; }  if (strtolower(trim($vwplrp9u24[$vwpl_2cd9]) ) <> $vwpln1la_j) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Contact Email does not match Autologin Email'); wplpwn3::wplbryv(); wp_redirect(get_bloginfo('wpurl') ); exit; }  if ($vwplahvu > '') { if ($vwplcg4j3) echo __LINE__, ' - Setting Tags ', $vwplahvu, '<br />'; wplycjh::wplxc5ht_($vwplkjx4fs, 'Setting Tags', $vwplahvu); memberium_app()->wplt263_($vwplahvu, $vwplvtmqd); }  if ($vwplqczmat) { if (empty($vwplrp9u24[$vwplup7mi]) ) { $vwplckqhw = memberium_app()->wpleh1zcw(); $vwplrp9u24[$vwplup7mi] = $vwplckqhw; memberium_app()->wplun7pt5($vwplvtmqd, array($vwplup7mi => $vwplckqhw), true); memberium_app()->wplto2h4($vwplrp9u24); } memberium_app()->wplqd_lae($vwplvtmqd); $vwplgogvie = get_user_by('email', $vwpln1la_j); }   if ($this->options['settings']['known_logins_only']) { $vwplgogvie = $vwplgogvie || get_user_by('email', $vwpln1la_j); if (! $vwplgogvie) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Known Login Check Failed.'); wplpwn3::wplbryv(); wp_redirect(get_bloginfo('wpurl') ); exit; } }  if (! $vwplh1d50) { if (empty($vwplrp9u24[$vwplup7mi]) ) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Password Field Empty.'); wplpwn3::wplbryv(); wp_redirect(get_bloginfo('wpurl') ); exit; } }  memberium_app()->wplqd_lae($vwplvtmqd); $vwplgogvie = get_user_by('email', $vwpln1la_j);  $vwplkqnhaj = false; if ($vwplgogvie) { $vwplo2t7 = array( 'manage_options', 'edit_plugins', 'edit_themes', 'edit_users', 'create_users', 'delete_users', 'delete_others_pages', 'delete_others_posts', 'edit_others_pages', 'edit_others_posts', ); foreach($vwplo2t7 as $vwpl__qx) { if (user_can($vwplgogvie, $vwpl__qx) ) { $vwplkqnhaj = true; wplycjh::wplxc5ht_($vwplkjx4fs, 'User is a non-subscriber:  ' . $vwpl__qx); if ($vwplcg4j3) echo __LINE__, ' - Blocked Capability:  ' . $vwpl__qx . '<br />'; break; } } } if ($vwplkqnhaj) { if ($vwplcg4j3) { echo __LINE__, ' - FAILURE:  Auto-Login attempt by non-subscriber.<p>'; exit; }  wplpwn3::wplbryv(); wp_redirect(get_bloginfo('wpurl') ); exit; }  if (is_user_logged_in() ) { if (wplsbzgvp::wplfhxj9() == $vwplvtmqd) { wplycjh::wplxc5ht_($vwplkjx4fs, 'Already Logged In, Redirecting'); if (empty($vwpltancmh) ) { if (! empty($_SESSION['memb_user']['login_page']) ) { $vwpltancmh = get_permalink($_SESSION['memb_user']['login_page']); } } if (empty($vwpltancmh) ) { $vwpltancmh = get_site_url(); } wplpwn3::wplbryv(); wp_redirect($vwpltancmh); exit; } if ($vwplcg4j3) { echo __LINE__, ' - FAILURE:  Login Session Exists, Logging Out>'; exit; } wplycjh::wplxc5ht_($vwplkjx4fs, 'Login Session Exists, Logging Out'); wp_destroy_current_session(); wp_clear_auth_cookie(); memberium_app()->wplwxbl(0); memberium_app()->wplne7ys2(); }  $vwplgogvie = is_a($vwplgogvie, 'WP_User') ? $vwplgogvie : get_user_by('email', $vwpln1la_j); $vwpllzly5b = $vwplgogvie->ID; $_POST['pwd'] = $vwplrp9u24[$vwplup7mi]; memberium_app()->wplwxbl($vwplvtmqd); $this->wplmmu74($vwpln1la_j); wp_set_current_user($vwpllzly5b); memberium_app()->wplyte2($vwpllzly5b); if ($vwplcg4j3) { echo '<p>User ID = ', $vwpllzly5b, '</p>'; echo '<p>Email = ', wplsbzgvp::wplc4na($vwpl_2cd9), '</p>'; } $vwplgogvie = apply_filters('wp_authenticate_user', $vwplgogvie, ''); if (empty($vwpltancmh) ) { if ($vwplb5d6) { if (get_user_meta($vwpllzly5b, 'login_count', true) == 0) { $vwpltancmh = get_permalink($vwplb5d6); } } } if (empty($vwpltancmh) ) { $vwpltancmh = empty($_SESSION['memb_user']['login_page']) ? get_home_url() : get_permalink($_SESSION['memb_user']['login_page']); }  if (is_a($vwplgogvie, 'WP_User') ) { if ($vwplcg4j3) { echo '<p>', __LINE__, ': SUCCESS:  Logging in to ', $vwpltancmh, '.</p>'; exit; } memberium_app()->wpllfqh_('do_autologin'); wp_set_auth_cookie($vwpllzly5b); wp_set_current_user($vwpllzly5b); $_SESSION['memb_user']['autologin'] = 1; $this->wplmmu74($vwpln1la_j); do_action('wp_login', $vwpln1la_j, $vwplgogvie); $this->wplo4tqd($vwplrp9u24, $vwpllzly5b); $this->wplh3645();  wplpwn3::wplbryv(); wp_redirect($vwpltancmh); exit; } else { if ($vwplcg4j3) { echo '<p>User Failure:</p>'; echo '<pre>', print_r($vwplgogvie, true), '</pre>'; } wp_set_current_user(0); } if ($vwplcg4j3) { echo '<p>', __LINE__, ': Failure:  Redirecting to ', $vwpltancmh, '.</p>'; exit; }  wplpwn3::wplbryv(); wp_redirect($vwpltancmh); exit; } function wplicnz() { add_action('init', array($this, 'wplf5yc6'), 1000); add_action('login_head', array($this, 'wplpxe6') ); add_action('memberium_populate_session', array($this, 'wplh3645'), 10, 1); add_action('password_reset', array($this, 'wplf_1qkv'), 2); add_action('plugins_loaded', array($this, 'wplhyibo') ); add_action('wplss4f', array($this, 'wpllhjalp') ); add_action('plugins_loaded', array($this, 'wpllhjalp'), 1000); add_action('profile_update', array($this, 'wplznudl'), 10, 2); add_action('register_form', array($this, 'wpldplb'), 5); add_action('template_redirect', array($this, 'wpllerm'), 25); add_action('template_redirect', array($this, 'wplmhf761'), 900); add_action('template_redirect', array($this, 'wplkptly9'), 15); add_action('the_post', array($this, 'wplbbxrn9'), 10); add_action('transition_comment_status', array($this, 'wplkwq1k4'), 99, 3); add_action('wp_authenticate', array($this, 'wplmmu74'), 10);  add_action('wp_authenticate', array($this, 'wplh17gr4'), 1); add_action('wp_footer', array($this, 'wplu4wg'), 100); add_action('wp_head', array($this, 'wplwgb3hq') ); add_action('wp_head', array($this, 'wplpxe6') ); add_action('wp_insert_comment', array($this, 'wpljfs95n'), 99, 2); add_action('wp_login', array($this, 'wplgro1m'), 20, 2);  add_action('wp_login', array($this, 'wpl_2qc'), 900, 2);  add_action('wp_logout', array($this, 'wploiyv') );  add_filter('authenticate', array($this, 'wplc4eb8'), PHP_INT_MAX, 3);  add_filter('comments_array', array($this, 'wpllq1e_') ); add_filter('comments_open', array($this, 'wplm74z'), 10, 2); add_filter('found_posts', array($this, 'wplzzfb8'), 10, 2); add_filter('get_comments_number', array($this, 'wplhl6ru'), 10, 2); add_filter('get_pages', array($this, 'wplvxewv'), 11, 2); add_filter('memberium_has_post_access', array($this, 'wplmbsvq'), 10, 2); add_filter('memberium/hide_titlebar', array($this, 'wplv2hd68'), 10, 1); add_filter('option_stylesheet', array($this, 'wplhert_j') ); add_filter('option_template', array($this, 'wplhert_j') );  add_filter('posts_pre_query', array($this, 'wplal6qwa'), 10, 2); add_filter('template', array($this, 'wplhert_j') ); add_filter('the_posts', array($this, 'wplor78'), 10, 2); add_filter('wp_authenticate_user', array($this, 'wplwxbl'), 1); add_filter('wp_get_nav_menu_items', array($this, 'wplvj8m9'), 1, 3); add_filter('wp_nav_menu_objects', array($this, 'wplpadc') ); add_filter('wp_search_stopwords', array($this, 'wplr0rwu'), 10, 1); add_filter('wpal/blocks/can_access_asset', array($this, 'wpltibt'), 10, 4); $vwplsndko = wplz8bid::wplvf1d('settings', 'wp_autop'); if ($vwplsndko == 1) { remove_filter('the_content', 'wpautop'); } elseif ($vwplsndko == 2) { $vwplic6u = has_filter('the_content', 'wpautop'); if ($vwplic6u !== false && $vwplic6u < 11) { remove_filter('the_content', 'wpautop'); add_filter('the_content', 'wpautop', 11); } } } function __construct() { global $i2sdk, $session_driver, $wpdb; static $vwplkp4j = 0; if ($vwplkp4j) { $vwplkp4j++; return; } $vwplkp4j = true; $this->wplicnz(); do_action('wplss4f');    $this->options = wplz8bid::wplvf1d(); $this->i2sdk_options = get_option('i2sdk'); $this->i2sdk = $i2sdk; $this->isdk = $this->i2sdk->isdk; $this->license_status = wpln9_s::wplio5sck(); $this->always_shown_post_types = array(     );  if (is_array($_GET) ) { foreach ($_GET as $vwply17edn => $vwplph268z) { if (substr($vwply17edn, 0, 4) == 'amp;') { $vwplthvsf = substr($vwply17edn, 4); $_GET[$vwplthvsf] = $vwplph268z; unset($_GET[$vwply17edn]); } } }    if (is_object($session_driver) ) { $vwplh6zjmd = wplz8bid::wplvf1d('settings', 'simultaneous_logins'); $vwplpoyp = wplz8bid::wplvf1d('settings', 'session_timeout'); $session_driver->wplccj4($vwplh6zjmd); if ( (int) $this->options['settings']['session_timeout'] > 0) { if (session_id() == '') { ini_set('session.gc_maxlifetime', (int) $vwplpoyp); } $session_driver->wplr1stv( (int) $vwplpoyp); } } if ($_SERVER['REQUEST_METHOD'] == 'GET') { $vwplakryo = wplz8bid::wplvf1d('settings', 'affiliate_detect'); if (empty($_GET['action']) && $vwplakryo == 1) { add_action('template_redirect', array($this, 'wplew0p1'), PHP_INT_MAX );  } } if (wplsbzgvp::wplfhxj9() > 0) { memberium_app()->wplwxbl(wplsbzgvp::wplfhxj9() ); } $this->wplyhl4i(); $vwplvzg4f1 = wplz8bid::wplvf1d('settings', 'disable_lost_password'); $vwplrasri = wplz8bid::wplvf1d('settings', 'disable_password_reset'); $vwplkgl8 = wplz8bid::wplvf1d('settings', 'autologout_time'); $vwplxf_kan = wplz8bid::wplvf1d('settings', 'protect_feeds'); $vwplg7kz2i = wplz8bid::wplvf1d('settings', 'site_ban_tag'); $vwplesatlj = wplz8bid::wplvf1d('settings', 'require_membership'); $vwpli7fym = wplz8bid::wplvf1d('settings', 'login_log'); if ($vwplvzg4f1) { add_filter('gettext', array($this, 'wpl_3k7zy') ); } if ($vwplrasri) { add_filter('allow_password_reset', array($this, 'wplrqi5') ); } if ($vwplkgl8) { add_action('wp_head', array($this, 'wpletmwei') ); } if ($vwplg7kz2i) { add_filter('wp_authenticate_user', array($this, 'wplb4rv'), 1000); } if ($vwplesatlj) { add_filter('wp_authenticate_user', array($this, 'wplqu9snq'), 1000); } if ($vwpli7fym) { add_filter('wp_authenticate_user', array($this, 'wplui5yo'), 2000); } if (! empty($_GET['rss_user']) ) { add_filter('posts_pre_query', array('wplutf3y', 'wplddjn3'), 10, 2); } if ($vwplxf_kan) {  add_action('do_feed_atom_comments', array($this, 'wplmr4w0'), 1); add_action('do_feed_atom', array($this, 'wplmr4w0'), 1); add_action('do_feed_rdf', array($this, 'wplmr4w0'), 1); add_action('do_feed_rss', array($this, 'wplmr4w0'), 1); add_action('do_feed_rss2_comments', array($this, 'wplmr4w0'), 1); add_action('do_feed_rss2', array($this, 'wplmr4w0'), 1); add_action('do_feed', array($this, 'wplmr4w0'), 1); remove_action('wp_head', 'feed_links_extra', 3); remove_action('wp_head', 'feed_links', 2); remove_action('wp', 'bp_activity_action_favorites_feed', 3); remove_action('wp', 'bp_activity_action_friends_feed', 3); remove_action('wp', 'bp_activity_action_mentions_feed', 3); remove_action('wp', 'bp_activity_action_my_groups_feed', 3); remove_action('wp', 'bp_activity_action_personal_feed', 3); remove_action('wp', 'bp_activity_action_sitewide_feed', 3); remove_action('wp', 'groups_action_group_feed', 3); } else { add_action('do_feed_atom', array($this, 'wplobs0co'), 1); add_action('do_feed_rdf', array($this, 'wplobs0co'), 1); add_action('do_feed_rss', array($this, 'wplobs0co'), 1); add_action('do_feed_rss2', array($this, 'wplobs0co'), 1); }         if (! is_admin() ) {  add_filter('widget_text', 'do_shortcode'); add_filter('widget_title', 'do_shortcode'); add_filter('the_title', 'do_shortcode'); add_filter('the_excerpt', 'do_shortcode'); add_filter('get_the_excerpt', 'do_shortcode', 10); add_filter('get_the_author_description', 'do_shortcode'); add_filter('shortcode_atts_memberium', array($this, 'wplme4b3a') ); add_filter('excerpt_length', array($this, 'wplq3wt6'), 999); add_filter('login_redirect', array($this, 'wplevrzp'), 999999999, 3);  } if ($_SERVER['REQUEST_METHOD'] == 'POST') { $vwplh8j5 = ! empty($_GET['operation']) && ! empty($_GET['auth_key']) || (! empty($_GET['i4w_genpass']) ); add_action('init', array($this, 'wplt314'), 11); add_action('plugins_loaded', array($this, 'wplbunm'), 100); if ($vwplh8j5) { $this->httppost_service = new wplu03so; } } if (class_exists('WooCommerce') ) { add_filter('wplqaem', array($this, 'wplqaem'), 999999, 2); } if (! empty($_GET['memb_autologin']) ) { $autologin_enabled = ! empty($this->options['settings']['allow_autologin']); $autologin_enabled = $autologin_enabled || ! empty($this->options['settings']['thrivecart_secret']); if ($autologin_enabled) { add_action('plugins_loaded', array($this, 'wplpvgs'), 999999);  } } if (! empty($_GET['memb_setcookie']) ) { add_action('send_headers', array($this, 'wplvak2'), 1); } if (isset($_GET['memb_s3link']) && isset($_GET['verification']) ) { add_action('init', array($this, 'wplm36eu') ); }       }  function wplew0p1() { if (is_admin() || is_super_admin() ) { return; } if (isset($_SESSION['infusionsoft_affiliate']) ) { return; } if (isset($_COOKIE['infusionsoft_affiliate']) ){ return; } if (isset($_GET['affiliate']) ) { $vwplg_xkl = (int) $_GET['affiliate']; $vwplze6yns = $_SERVER['REQUEST_URI']; $_SESSION['infusionsoft_affiliate'] = $vwplg_xkl; setcookie('infusionsoft_affiliate', $vwplg_xkl, 0, '/'); if (strpos($vwplze6yns, '?') !== false) { $vwplze6yns = substr($vwplze6yns, 0, strpos($vwplze6yns, '?') ); } $vwplze6yns = str_ireplace('index.php', '', $vwplze6yns); $vwplzmu7z3 = false; $vwpllvq0m = 0; $blocked_keys = array( 'affiliate', 'cookieUUID', ); foreach($_GET as $vwply17edn => $vwplph268z) { if (! in_array($vwply17edn, $blocked_keys) ) { $vwplze6yns .= ( (! $vwplzmu7z3) ? '?' : '&') . $vwply17edn . '=' . urlencode($vwplph268z); } }  header('Location: ' . $vwplze6yns); exit; } else { $_SESSION['infusionsoft_affiliate'] = 0; setcookie('infusionsoft_affiliate', 0, 0, '/'); $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $_SERVER['HTTPS'] = isset($_SERVER['HTTPS']) ? $_SERVER['HTTPS'] : ''; if (strtolower($_SERVER['REQUEST_METHOD']) == 'get' && ! isset($_SESSION['affiliate_id']) ) { $vwpln9ub = ($_SERVER['HTTPS'] == 'on' ? 'https://' : 'http://') . $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI'];  header("Location: https://{$vwplw5rgd3}.infusionsoft.com/aff.html?to={$vwpln9ub}"); exit; } } } function __destruct() { } private $always_shown_post_types = array(); private $cache_namespace = 0; private $can_cache = FALSE; private $contact_count = 0; private $contact_id = 0; private $core = NULL; private $disable_login_redirect = FALSE; private $error_message = ''; private $flash = ''; private $footer_json = array(); private $footer_code = NULL; private $forloop = 0; private $i2sdk = NULL; private $i2sdk_options = array(); private $in_init = FALSE; private $in_list = 0; private $index = 0; private $is_administrator = false; private $isdk = NULL; private $license_status = false; private $nested_shortcodes = array(); private $options = array(); private $redirect_url = NULL;  private $set_cookie = array(); private $shortcodes = array(); private $shortcodes_registered = false; private $signature = false; private $sso_mode = false; private $successful_upload = NULL; private $url_id = 0; private $login_redirect_enabled = true; private $login_redirect_url = ''; private $optimizepress_page = false; private $shortcode_tags = array(); private $found_posts = null; protected $httppost_service = null; public $post_type = 0; }
