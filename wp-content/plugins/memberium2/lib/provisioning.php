<?php
/**
 * Copyright (c) 2012-2020 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (! defined('ABSPATH') ) { die(); }  final class wpln9_s { const LICENSE_SERVER_HOST = 'https://licenseserver.webpowerandlight.com/'; const LICENSE_SERVER_URL = 'https://licenseserver.webpowerandlight.com/getlicense.php'; private static $license_key_name; private static $license_status; private static $trial_mode = false; private function __construct() { } static function wplq6kurm() { return self::$license_status; }   static function wpls6_8y9() { $vwpls0hwb5 = ''; $vwplyysi_ = self::wplc2v0sx(); if (isset($vwplyysi_['tags']) ) { $vwpls0hwb5 = $vwplyysi_['tags']; } $vwpls0hwb5 = explode(',', strtolower($vwpls0hwb5) ); return $vwpls0hwb5; }  static function wplp32l() { return (boolean) self::$trial_mode; }   static function wplahoe0() { global $wpdb; static $vwpltidk1 = 0; if ($vwpltidk1 > 0) { return (int) $vwpltidk1; } $vwpltidk1 = $wpdb->get_var('SELECT COUNT(*) FROM `' . $wpdb->users . '`'); return $vwpltidk1; }  static function wplc2v0sx($vwplnzjs = '') { $vwplyd05 = self::wplfdzy(); $vwplkhep = wplz8bid::wplvf1d('settings', 'random_seed'); if (empty($vwplnzjs) ) { $vwplnzjs = self::wplj7qr(); } $vwplsfdb_t = 3; $vwply0w2d = 32; $vwplyio4f['valid'] = 0; $vwplyio4f['trial_mode'] = 0; $vwplm2zjqr = self::wplyp8s(); $vwplj0bkdl = strtolower(trim($vwplkhep . $vwplm2zjqr) ); $vwplc652 = $vwplkhep; if ($vwplsfdb_t == 1) { $vwplm49zh = new memberiumHashids($vwplj0bkdl, $vwply0w2d);  $vwplmgco = $vwplm49zh->decrypt($vwplnzjs); $vwplyio4f['version'] = $vwplmgco[0]; $vwplyio4f['min_version'] = $vwplmgco[1]; $vwplyio4f['max_version'] = $vwplmgco[2]; $vwplyio4f['next_check'] = $vwplmgco[3]; $vwplyio4f['renewal_date'] = $vwplmgco[4]; $vwplyio4f['check_ttl'] = $vwplyio4f['next_check'] - time(); $vwplyio4f['expiration_ttl'] = $vwplyio4f['renewal_date'] - time(); $vwplyio4f['valid'] = 1; } elseif ($vwplsfdb_t == 2) { $vwplmgco = unserialize(base64_decode(substr($vwplnzjs, 32) ) ); $vwpljyzf = substr($vwplnzjs, 0, 32); $vwpliimnw1 = md5(serialize($vwplmgco) . strtolower($vwplc652) . strtolower($vwplm2zjqr) ); if ($vwpliimnw1 == $vwpljyzf) { $vwplyio4f = $vwplmgco; $vwplyio4f['valid'] = 1; } else { $vwplyio4f['valid'] = 0; } $vwplyio4f['version'] = $vwplmgco[1]; $vwplyio4f['min_version'] = $vwplmgco[2]; $vwplyio4f['max_version'] = $vwplmgco[3]; $vwplyio4f['next_check'] = $vwplmgco[4]; $vwplyio4f['renewal_date'] = $vwplmgco[5]; $vwplyio4f['check_ttl'] = $vwplyio4f['next_check'] - time(); $vwplyio4f['expiration_ttl'] = $vwplyio4f['renewal_date'] - time(); $vwplyio4f['trial_mode'] = $vwplmgco[6];; $vwplyio4f['now'] = time(); } elseif ($vwplsfdb_t == 3) { $vwplmgco = unserialize(base64_decode(substr($vwplnzjs, 32) ) ); $vwpljyzf = substr($vwplnzjs, 0, 32); $vwpliimnw1 = md5(serialize($vwplmgco) . strtolower($vwplc652) . strtolower($vwplm2zjqr) ); if ($vwpliimnw1 == $vwpljyzf) { $vwplyio4f = $vwplmgco; $vwplyio4f['valid'] = 1; } else { $vwplyio4f['valid'] = 0; } $vwplyio4f['version'] = isset($vwplmgco['version']) ? $vwplmgco['version'] : 0; $vwplyio4f['min_version'] = isset($vwplmgco['min_version']) ? $vwplmgco['min_version'] : 0; $vwplyio4f['max_version'] = isset($vwplmgco['max_version']) ? $vwplmgco['max_version'] : 0; $vwplyio4f['next_check'] = isset($vwplmgco['next_check']) ? $vwplmgco['next_check'] : 0; $vwplyio4f['renewal_date'] = isset($vwplmgco['renewal_date']) ? $vwplmgco['renewal_date'] : 0; $vwplyio4f['check_ttl'] = $vwplyio4f['next_check'] - time(); $vwplyio4f['expiration_ttl'] = $vwplyio4f['renewal_date'] - time(); $vwplyio4f['trial_mode'] = isset($vwplmgco['trial_mode']) ? $vwplmgco['trial_mode'] : 0; $vwplyio4f['kill'] = isset($vwplmgco['kill']) ? $vwplmgco['kill'] : 0; $vwplyio4f['active'] = isset($vwplmgco['active']) ? $vwplmgco['active'] : 0; $vwplyio4f['max_users'] = isset($vwplmgco['max_users']) ? $vwplmgco['max_users'] : 999999999; $vwplyio4f['tags'] = isset($vwplmgco['tags']) ? $vwplmgco['tags'] : ''; $vwplyio4f['now'] = time(); if (! empty($vwplyio4f['kill']) ) { deactivate_plugins(plugin_basename(MEMBERIUM_HOME) ); wp_die('Plugin Deactived due to Terminated License'); } }  if ($vwplyio4f['expiration_ttl'] < 1) { $vwplyio4f['active'] = 0; } if ($vwplyio4f['min_version'] > intval(MEMBERIUM_VERSION) ) { $vwplyio4f['active'] = 0; } if ($vwplyio4f['max_version'] < intval(MEMBERIUM_VERSION) ) { $vwplyio4f['active'] = 0; } if ( ($vwplyio4f['max_users'] <> 999999999) && $vwplyio4f['max_users'] < self::wplahoe0() ) { $vwplyio4f['active'] = 0; } self::$trial_mode = (int) $vwplyio4f['trial_mode']; return $vwplyio4f; }   static function wplfdzy() { static $vwply17edn = ''; if (! empty($vwply17edn) ) { return $vwply17edn; } $vwplfkojlf = get_bloginfo('url'); $vwply17edn = strtolower(soundex($vwplfkojlf) . metaphone($vwplfkojlf, 16) ) . '_' . abs(crc32($vwplfkojlf) ) . '_memberium_license'; return $vwply17edn; }  static function wplj7qr() { return get_option(wpln9_s::wplfdzy() ); } static function wplyp8s() { return preg_replace('/^www\./', '', strtolower(parse_url(get_bloginfo('url'), PHP_URL_HOST) ) ); }   static function wplzjhtq($vwplyclph = false) { $vwplw5rgd3 = wplz8bid::wplm3z9k('appname'); $vwplkhep = wplz8bid::wplvf1d('settings', 'random_seed'); $vwplyd05 = self::wplfdzy(); if (empty($vwplw5rgd3) ) { return false; } if (! $vwplyclph) { $vwplu0a5x = (time() - get_option('memberium_last_license_check', 0) ); if ($vwplu0a5x < 1800) { return self::wplj7qr(); } } update_option('memberium_last_license_check', time(), 'yes'); if (extension_loaded('IonCube Loader') && function_exists('ioncube_loader_version') ) { $vwplf2zyqk = ioncube_loader_version(); } else { $vwplf2zyqk = 'None'; } $config = array( 'method' => 'POST', 'timeout' => 10, 'redirection' => 5, 'httpversion' => '1.0', 'blocking' => true, 'headers' => array(), 'body' => array( 'admin_email' => get_bloginfo('admin_email'), 'appname' => $vwplw5rgd3, 'checksum' => $vwplkhep, 'hostname' => self::wplyp8s(), 'interval' => 32, 'ioncube_version' => $vwplf2zyqk, 'ip_address' => $_SERVER['SERVER_ADDR'], 'license_key' => '', 'php_version' => phpversion(), 'protocol_version' => 3, 'sku' => 'M4IS', 'url' => get_bloginfo('url'), 'user_count' => self::wplahoe0(), 'version' => memberium_app()->wplnm1h(), ), 'cookies' => array(), ); $vwplyysi_ = ''; $vwplu_gxri = wp_remote_post(self::LICENSE_SERVER_URL, $config); if (is_array($vwplu_gxri) ) { $vwplyysi_ = $vwplu_gxri['body']; $vwpldu3vq1 = self::wplc2v0sx($vwplyysi_); if ($vwpldu3vq1['valid'] == 1) { update_option($vwplyd05, $vwplyysi_); } else { $vwplyysi_ = self::wplj7qr(); } } return $vwplyysi_; }   static function wplio5sck() { static $vwploa8hy = -1;  if ($vwploa8hy > -1) { return (boolean) $vwploa8hy; } $vwplyysi_ = self::wplj7qr(); $vwpldu3vq1 = self::wplc2v0sx($vwplyysi_); $vwplo796v3 = false; if (! $vwpldu3vq1['active']) { $vwplo796v3 = true; } if (! $vwpldu3vq1['valid']) { $vwplo796v3 = true; } if ($vwpldu3vq1['check_ttl'] < 3600) { $vwplo796v3 = true; } if ($vwplo796v3) { $vwplyysi_ = self::wplzjhtq(); $vwpldu3vq1 = self::wplc2v0sx($vwplyysi_); }  $vwploa8hy = isset($vwpldu3vq1['active']) ? (int) $vwpldu3vq1['active'] : 0;  if ($vwploa8hy && isset($vwpldu3vq1['max_users']) ) { if ($vwpldu3vq1['max_users'] < self::wplahoe0() ) { $vwploa8hy = 0; } } if ($vwploa8hy && isset($vwpldu3vq1['max_version']) ) { if (version_compare($vwpldu3vq1['max_version'], memberium_app()->wplnm1h() ) <= 0) { $vwploa8hy = 0; } } self::$license_status = $vwploa8hy; return (boolean) self::$license_status; }   static function wplq953($vwplcth8ke) {  if (! is_array($vwplcth8ke) ) { $vwplcth8ke = explode(',', $vwplcth8ke); } if (is_array($vwplcth8ke) ) {  $vwplgk2wx = self::wpls6_8y9(); foreach($vwplcth8ke as $vwpltmveju) { if (in_array($vwpltmveju, $vwplgk2wx) ) { return true; } } } return false; } }
