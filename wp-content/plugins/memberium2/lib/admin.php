<?php
/**
 * Copyright (c) 2012-2020 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (! defined('ABSPATH') ) { die(); }   final class wpliebn { function __construct() {  global $i2sdk; if (! method_exists($i2sdk, 'isVerified') || ! $i2sdk->isVerified() ) { add_action('admin_menu', array($this, 'wplm27b') ); return; } $this->settings = wplz8bid::wplvf1d(); $vwpl_ai1ct = isset($this->settings['settings']['version']) ? $this->settings['settings']['version'] : 0; if ($vwpl_ai1ct <> memberium_app()->wplnm1h() ) { wple8cx::wplldr75(); $this->settings = wplz8bid::wplvf1d(); } $this->notices = array(); $this->i2sdk = $i2sdk; $this->isdk = $i2sdk->isdk; $this->advanced_mode = $this->settings['settings']['show_advanced_options'] == 1 ? true : false; $this->appname = wplz8bid::wplm3z9k('appname'); $this->preview_mode = (int) $this->settings['settings']['preview_mode']; $this->license_status = wpln9_s::wplio5sck(); if (! $this->license_status) { wpln9_s::wplzjhtq(); $this->license_status = wpln9_s::wplio5sck(); } add_action('wpmu_new_blog', array($this, 'wplst1o'), 10, 6); add_filter('plugin_action_links', array($this, 'wpllvgtu'), 10, 4); add_filter('plugin_action_links', array($this, 'wplms2cu5'), 10, 2); add_action('admin_post_memberium_scan_users', array($this, 'wplvsar') ); add_action('admin_enqueue_scripts', array($this, 'wplxhs2mc'), 1); add_action('admin_init', array($this, 'wplsnlh1x'), 1); add_action('admin_notices', array($this, 'wplfut6da') ); if (! $this->license_status) { add_action('admin_menu', array($this, 'wplm27b') ); return; } add_action('admin_init', array($this, 'wplssknw'), 1); add_action('admin_init', array($this, 'wplb1twj') ); add_action('admin_print_scripts-edit.php', array($this, 'wpli5fh_t') ); add_action('edit_form_after_title', array($this, 'wplj4i2e7') ); add_action('init', array($this, 'wplv4u_'), 5); add_action('init', array($this, 'wplkmc9bd'), 999999); add_action('save_post', array($this, 'wplccn9_m') ); add_action('save_post', array($this, 'wplbnbfw') ); add_action('wp_ajax_memberium_save_bulk_edit', array($this, 'wpljh0lm') );  add_filter('bulk_actions-edit-post', array(__CLASS__, 'wplq051_') ); add_filter('bulk_actions-edit-page', array(__CLASS__, 'wplq051_') ); add_filter('handle_bulk_actions-edit-post', array(__CLASS__, 'wplw1kd'), 10, 3); add_filter('handle_bulk_actions-edit-page', array(__CLASS__, 'wplw1kd'), 10, 3); add_filter('gutenberg_can_edit_post_type', array($this, 'wplniwb8'), PHP_INT_MAX, 2); add_post_type_support('page', 'excerpt'); if (function_exists('wp_generate_password') ) { if (!isset($this->settings['settings']['random_seed']) || $this->settings['settings']['random_seed'] == '') { $this->settings['settings']['random_seed'] = wp_generate_password(16, FALSE, FALSE); update_option('memberium', $this->settings); } } include_once ABSPATH . 'wp-admin/includes/plugin.php'; if (empty($this->settings['plugins']['google-analytics-for-wordpress']) ) { $this->settings['plugins']['google-analytics-for-wordpress'] = FALSE; } if (is_plugin_active('google-analytics-for-wordpress/googleanalytics.php') != $this->settings['plugins']['google-analytics-for-wordpress']) { $this->settings['plugins']['google-analytics-for-wordpress'] = is_plugin_active('google-analytics-for-wordpress/googleanalytics.php'); update_option('memberium', $this->settings); } if (empty($this->settings['plugins']['nextend-facebook-connect']) ) $this->settings['plugins']['nextend-facebook-connect'] = false; if (is_plugin_active('nextend-facebook-connect/nextend-facebook-connect.php') != $this->settings['plugins']['nextend-facebook-connect']) { $this->settings['settings']['nextend-facebook-connect'] = is_plugin_active('nextend-facebook-connect/nextend-facebook-connect.php'); update_option('memberium', $this->settings); } if (isset($_GET['memberium_ignore_notice']) ) { add_action('init', array($this, 'wplrt3_e5') );  } if (false && $_SERVER['REMOTE_ADDR'] == '71.92.64.210') {  $taxonomies = array( 'category', ); foreach($taxonomies as $taxonomy) { add_action($taxonomy . '_add_form_fields', array($this, 'wplshagp'), 1000); add_action($taxonomy . '_edit_form_fields', array($this, 'wplxkmar'), 1000); add_action('create_' . $taxonomy, 'wplcon7ks', 1000); add_action('edited_' . $taxonomy, 'wplk5u62', 1000); } add_action('edit_category_form', array($this, 'wpls6eutq'), 10, 1); } require_once __DIR__ . '/vendor/wpal/marketplace/init.php'; } static function wplq051_($vwplz1bp7) { $vwplz1bp7['memberium-page-export'] = 'Page Export'; return $vwplz1bp7; } static function wplw1kd($vwplwpg_6, $vwplsdp5l, $vwplp4pw) { if ($vwplsdp5l == 'memberium-page-export') { $vwplb32x = wpli_8q::wpluw6dj($vwplp4pw); return get_admin_url() . 'upload.php?item=' .(int) $vwplb32x; return get_permalink($vwplb32x); } return $vwplwpg_6; } function wplms2cu5($vwplf9ob, $vwplf_3k79) { if ($vwplf_3k79 == 'memberium2/memberium2.php') { $vwplf9ob['starthere'] = sprintf('<a href="%s"> %s </a>', admin_url('admin.php?page=memberium'), __('Start Here', 'plugin_domain') ); $vwplf9ob['settings'] = sprintf('<a href="%s"> %s </a>', admin_url('admin.php?page=memberium-options'), __('Settings', 'plugin_domain') ); $vwplf9ob['help'] = sprintf('<a href="%s" target="_blank"> %s </a>', 'https://memberium.com/documentation/', __('Docs', 'plugin_domain') ); $vwplf9ob['support'] = sprintf('<a href="%s" target="_blank"> %s </a>', 'https://memberium.com/support/', __('Support', 'plugin_domain') ); } return $vwplf9ob; } function wplniwb8($vwplnz7ie9, $vwplo43m) { if ($vwplnz7ie9) { $vwplnod_e = array( 'memb_shortcodeblocks', 'partials', ); $vwplo43m = strtolower($vwplo43m); $vwplnz7ie9 = ! in_array($vwplo43m, $vwplnod_e); } return $vwplnz7ie9; } function wpllvgtu($vwplz1bp7, $vwplg5x2fa, $vwplsmnrzf, $vwplcl13) { if ($vwplg5x2fa == 'i2sdk2/i2sdk2.php') { $vwplz1bp7['deactivate'] = '<em style="color:#000;">Required by Memberium</em>'; } return $vwplz1bp7; }    function wplv4u_() { if (is_plugin_active('memberium2-installer/memberium2-installer.php') ) { deactivate_plugins('memberium2-installer/memberium2-installer.php'); } if (current_user_can('manage_options') ) { add_action('admin_menu', array($this, 'wplm27b') ); add_action('delete_user', array($this, 'wplmix1') ); add_action('edit_user_profile', array($this, 'wplouhn'), 2000); add_action('edit_user_profile_update', array($this, 'wplvn54'), 1); add_action('profile_update', array($this, 'wplkr64o_'), 10, 2); add_action('show_user_profile', array($this, 'wplouhn') ); } add_action('personal_options_update', array($this, 'wplvn54'), 1); add_action('user_register', array($this, 'wpler9l'), PHP_INT_MAX, 1); add_action('user_new_form', array($this, 'wplkhq0'), 1, 1); if (current_user_can('manage_options') ) { require_once MEMBERIUM_LIB . '/vendor/wpal/health/init.php'; if (MEMBERIUM_BETA) { add_action('admin_notices', array($this, 'wplz87k') ); } } add_filter('get_sample_permalink_html', array($this, 'wplrbkfy4'), 10, 5); } function wplrbkfy4($vwplu9w10, $vwplcltpy, $vwpla452f, $new_slug, $vwplzzlf5b) { if (property_exists($vwplzzlf5b, 'post_type') ) { if (in_array($vwplzzlf5b->post_type, array('partials', 'memb_shortcodeblocks') ) ) { return null; } } return $vwplu9w10; } function wplkmc9bd() { $this->wplssknw(); $this->non_enhanced_post_types = wpljwbf2::wplv1_wlp(); $vwplo43m = isset($_GET['post_type']) ? $_GET['post_type'] : 'post'; $vwplh_cv = ! in_array($vwplo43m, $this->non_enhanced_post_types); $vwplh_cv = $vwplh_cv || in_array($vwplo43m, array('memb_shortcodeblocks') ); if ($vwplh_cv) { add_action('manage_pages_custom_column', array($this, 'wplwlbn'), 10, 2); add_action('manage_posts_custom_column', array($this, 'wplwlbn'), 10, 2); add_action('quick_edit_custom_box', array($this, 'wpltfqa'), 10, 2); add_action('bulk_edit_custom_box', array($this, 'wplg0yix'), 10, 2); add_filter('manage_pages_columns', array($this, 'wplodfb0') ); add_filter('manage_posts_columns', array($this, 'wplodfb0') ); } } function wplj4i2e7() { if (isset($_GET['post']) ) { $vwplzzlf5b = get_post($_GET['post']); if (empty($vwplzzlf5b->post_name) ) { return; } } else { return; } $vwplxo3wtv = ''; if ($vwplzzlf5b->post_type == 'partials') { $vwplxo3wtv = '[memb_include_partial id=' . $vwplzzlf5b->ID . ']'; } elseif ($vwplzzlf5b->post_type == 'memb_shortcodeblocks') { $vwplxo3wtv = '[membc_' . $vwplzzlf5b->post_name . ']'; } if (! empty($vwplxo3wtv) ) { echo '<h2>', $vwplxo3wtv, '</h2>'; } }    function wplshd5q() { $vwple9jfu1 = 30; global $wpdb; $this->settings['settings']['referral_partner_order'] = $this->isdk->dsGetSetting('Affiliate', 'chooseaffiliate'); $vwplx1ap5_ = "DELETE FROM `{$wpdb->options}` WHERE `option_name` LIKE '%transient_memberium%' OR `option_name` LIKE '%transient_timeout_memberium%' ; "; $wpdb->query($vwplx1ap5_); set_time_limit($vwple9jfu1); $this->i2sdk->syncCustomFields(); set_time_limit($vwple9jfu1); $rows = memberium_app()->wplaw3p(); set_time_limit($vwple9jfu1); $rows = wpllbej::wplwwbm9(); set_time_limit($vwple9jfu1); wpllbej::wplbv190(); set_time_limit($vwple9jfu1); memberium_app()->wplgfugwo(); set_time_limit($vwple9jfu1); wpllbej::wplctzj(); set_time_limit($vwple9jfu1); memberium_app()->wplrtxvdy(); if (! empty($this->settings['settings']['sync_ecommerce']) ) { set_time_limit($vwple9jfu1); memberium_app()->wplblz7(); }   $vwplktq3k = get_option('memberium_tables_updated', array() ); $vwplktq3k['actionsets'] = time(); $vwplktq3k['i2sdk_customfields'] = time(); $vwplktq3k['tagcategories'] = time(); $vwplktq3k['tags'] = time(); $vwplktq3k['products'] = time(); $vwplktq3k['subscriptionplans'] = time(); update_option('memberium_tables_updated', $vwplktq3k); update_option('memberium', $this->settings, true); wpljwbf2::wplc1on7('Infusionsoft Synchronized', 'wpllk1g'); } static function wplgc765() { $vwplj7bzf = get_option('memberium_tables', array() ); $vwply2zs = array(); global $wpdb; $vwplx1ap5_ = 'SHOW TABLES'; $vwplhnahql = $wpdb->get_col($vwplx1ap5_); foreach($vwplj7bzf as $vwplnzlj0t) { if (! in_array($vwplnzlj0t, $vwplhnahql) ) { $vwply2zs[] = $vwplnzlj0t; } } return $vwply2zs; } function wplc7m14() {       } function wplxhs2mc($vwpld48u) {   $vwplq3f9 = false; $vwplq3f9 = $vwplq3f9 || strpos($vwpld48u, 'memberium') !== false; $vwpldqjgk = array( 'edit.php', 'post-new.php', 'post.php', 'user-edit.php', ); $vwpldqjgk = apply_filters('memberium\enhanced_admin_scripts', $vwpldqjgk);  $vwplq3f9 = $vwplq3f9 || in_array($vwpld48u, $vwpldqjgk); if ($vwplq3f9) { $vwplwb1w = plugin_dir_url(MEMBERIUM_HOME); $vwplur3yz = memberium_app()->wplnm1h(); wp_register_style('m4is_s2css', $vwplwb1w . 'css/memb_select2.css', false, $vwplur3yz, 'all'); wp_register_script('m4is_s2js', $vwplwb1w . 'js/memb_select2.js', array('jquery'), $vwplur3yz, true); wp_enqueue_style('m4is_s2css'); wp_enqueue_script('m4is_s2js'); wp_register_style('memberium_admin_css', $vwplwb1w . 'css/admin.css', false, $vwplur3yz, 'all'); wp_enqueue_style('memberium_admin_css'); wp_register_script('memberium_adminsettings', $vwplwb1w . 'js/admin-settings.js', false, $vwplur3yz); wp_enqueue_script('memberium_adminsettings'); wp_enqueue_style('font-awesome', 'https://use.fontawesome.com/releases/v5.12.0/css/all.css', false, '5.12.0'); } } function wplsnlh1x() {  if (is_network_admin() || isset($_GET['activate-multi']) ) { return; } if (is_admin() ) { $vwply17edn = 'memberium/activation_timestamp'; $vwplw9l7tf = (time() - get_option($vwply17edn, 0) ); if ($vwplw9l7tf < 20) { update_option($vwply17edn, 0);  wp_safe_redirect(add_query_arg(array('page' => 'memberium-welcome-screen'), admin_url('index.php') ) ); exit; } } } function wplz87k() { $vwpldaph = $_GET; if (isset($vwpldaph['tab']) && $vwpldaph['tab'] == 'checklist' || ! current_user_can('manage_options') ) { return; } if (! get_user_meta(get_current_user_id(), 'memberium_ignore_notice_checklist', true) ) { $vwplv2ult = $this->wplz23_(true); if (! empty($vwplv2ult['active']) ) { $vwpln208 = wpljwbf2::wplg2sle('checklist'); $vwpl_7gr2b = "updated"; $vwplygr2 = '<h3 style="margin-bottom:6px;">Memberium Setup CheckList</h3>' . '<p>Your next setup checklist step is to ' . $vwplv2ult['active'][0]['t'] . '</p><p><a href="admin.php?page=dashboard&tab=checklist"><strong>Click here</strong></a> to return to the setup checklist.</p>' . '<div style="text-align:right;"><p><a href="'. $vwpln208 .'">Hide these Reminders</a></p></div>'; echo"<div class='{$vwpl_7gr2b}'>{$vwplygr2}</div>"; } } } function wplrt3_e5() { $vwpldaph = $_GET; $vwpllzly5b = get_current_user_id(); $vwply17edn = isset($vwpldaph['memberium_ignore_notice']) ? sanitize_text_field($vwpldaph['memberium_ignore_notice']) : ''; if (! empty($vwply17edn) ) { update_option("memberium/notice/{$vwply17edn}", 1); if (wp_get_referer() ) { wp_safe_redirect(wp_get_referer() ); } else { wp_safe_redirect(site_url() ); } } } function wplfut6da() { $vwpln208 = wpljwbf2::wplypewkt(1226); if (! wpln9_s::wplio5sck() ) { echo '<div class="error"><p><strong style="font-size:150%;color:red;">Memberium License Missing / Expired', $vwpln208, '</strong></p>'; echo '<p>For possible causes, <a target="_blank" href="https://memberium.com/?p=1226">click here</a>.</p>'; echo '<p>If you have not yet purchased a license, please <a target="_blank" href="https://memberium.com/pricing/">purchase a license by clicking here</a></p>'; echo '<p>If you already have a license please <a target="_blank" href="https://memberium.com/support/">contact support by clicking here</a>.</p></div>'; } }  function wplssknw() { if (defined('DOING_AJAX') && DOING_AJAX) { return; } if (function_exists('wp_doing_ajax') && wp_doing_ajax() ) { return; } if (isset($_SERVER['SCRIPT_NAME']) && basename($_SERVER['SCRIPT_NAME']) == 'admin-post.php') { return; } if (is_super_admin() ) { return; } $vwple_3xad = false; $vwpllzly5b = get_current_user_id(); $vwplrlx4if = explode(',', $this->settings['settings']['allow_wpadmin_dashboard']); if (! empty($vwplrlx4if) ) { $vwple_3xad = true; foreach($vwplrlx4if as $vwpl__qx) { if (user_can($vwpllzly5b, $vwpl__qx) ) { $vwple_3xad = false; } } } if (! $vwple_3xad) { $vwplt90t = isset($this->settings['settings']['allow_wpadmin']) ? (bool) $this->settings['settings']['allow_wpadmin'] : false; if ($vwplt90t) { $vwple_3xad = false; } else { $vwple_3xad = true; } } if (! $vwple_3xad) { return; }    $vwplimo5 = wp_login_url($_SERVER['REQUEST_URI']);  if (is_user_logged_in() ) { $vwplc0nobe = memberium_app()->wplyte2(get_current_user_id() ); if (! empty($vwplc0nobe['memb_user']['login_page']) ) { $vwplimo5 = get_permalink($vwplc0nobe['memb_user']['login_page']); } else { $vwplimo5 = get_site_url(); }  $vwpli1ef7u = function_exists('get_current_screen') ? get_current_screen() : false; if ($vwpli1ef7u && $vwpli1ef7u->id == 'user-edit') { if (function_exists('bp_loggedin_user_domain') ) { $vwplimo5 = bp_loggedin_user_domain(); } else { $pages = get_option('memberium_pages', array() ); $vwplimo5 = isset($pages['profile_page']) ? get_permalink($pages['profile_page']) : $vwplimo5; } } } wp_redirect($vwplimo5); exit; }    function wplst1o($vwpltycqk9, $vwpllzly5b, $vwplmy6d, $vwplg38x51, $vwpld0_3k1, $vwply4fkhi) { global $wpdb; if (is_plugin_active_for_network('memberium2/memberium2.php') ) { $vwpler1vp = $wpdb->blogid; switch_to_blog($vwpltycqk9); wple8cx::wplbq5x9(); switch_to_blog($vwpler1vp); } }    function wplte96u($vwpltidk1 = 0, $vwplxo3wtv = '') { $vwpltidk1 = (int) $vwpltidk1; if (! $vwpltidk1) { return; } if (empty($vwplxo3wtv) ) { $vwplxo3wtv = $vwpltidk1; } return "<span class='update-plugins count-{$vwpltidk1}' title='{$vwplxo3wtv}'><span class='update-count'>{$vwplxo3wtv}</span></span>"; } function wplxt4f() { static $vwpltidk1; if ($vwpltidk1) { return $vwpltidk1; } global $wpdb; $vwplu_t2ic = wplz8bid::wplm3z9k('appname'); $vwpltidk1 = $wpdb->get_var("SELECT count(*) FROM `" . MEMBERIUM_DB_HTTPPOST . "` WHERE `appname` = '{$vwplu_t2ic}';"); $vwpltidk1 = $vwpltidk1 + $wpdb->get_var("SELECT count(*) FROM `" . MEMBERIUM_DB_LOGINLOG . "` WHERE `appname` = '{$vwplu_t2ic}';"); return $vwpltidk1; } function wplvuh7et() { static $vwpltidk1; if ($vwpltidk1) { return $vwpltidk1; } $i2sdk_options = get_option('i2sdk'); $vwpltidk1 = $i2sdk_options['server_verified'] ? 0 : 1; $vwpltidk1 = $vwpltidk1 + empty($i2sdk_options['app_name']) ? 1 : 0; $vwpltidk1 = $vwpltidk1 + empty($i2sdk_options['api_key']) ? 1 : 0; $vwpltidk1 = $vwpltidk1 + class_exists('i2sdk_class') ? 0 : 1; return $vwpltidk1; } function wplm27b() { $vwplf51r = 'manage_options'; if (! current_user_can($vwplf51r) ) { return; } global $i2sdk; $vwploa8hy = $this->license_status; $vwplg1n5d = 'dashicons-groups';  $vwplfqgl3j = get_option('i2sdk'); $vwplmml58c = 'memberium'; $vwploc9adn = $vwplf51r; $vwpltd3zi = 2; $vwplt_5ro = $this->wplvuh7et();  if (! empty($vwplt_5ro) ) { add_menu_page('', 'Memberium ' . $this->wplte96u(1, 'Alert'), $vwplf51r, $vwplmml58c, array($this, 'wplc37dwk'), $vwplg1n5d, $vwpltd3zi); add_submenu_page($vwplmml58c, 'Memberium Support', 'Support', $vwploc9adn, 'memberium-support', array($this, 'wplgbwouq') ); if (class_exists('i2sdk_class') ) { add_submenu_page($vwplmml58c, 'i2SDK', "i2SDK " . $this->wplte96u(1, 'Unconfigured'), $vwplf51r, 'i2sdk-admin', 'i2sdk_admin_menu'); } return; }  if (! $vwploa8hy) { add_menu_page('Memberium', 'Memberium', $vwplf51r, $vwplmml58c, array($this, 'wplc37dwk'), $vwplg1n5d, $vwpltd3zi); add_submenu_page($vwplmml58c, 'Memberium Support', 'Support', $vwploc9adn, 'memberium-support', array($this, 'wplgbwouq') ); add_submenu_page($vwplmml58c, 'i2SDK', 'i2SDK', $vwplf51r, 'i2sdk-admin', 'i2sdk_admin_menu'); add_submenu_page($vwplmml58c, '', '', $vwplf51r, $vwplmml58c, array($this, 'wplvaskz') ); return; }  if (! class_exists('i2sdk_class') || ! method_exists($i2sdk, 'isVerified') || ! $i2sdk->isVerified() ) { add_menu_page('Memberium', 'Memberium', $vwplf51r, $vwplmml58c, array($this, 'wplc37dwk'), $vwplg1n5d, $vwpltd3zi); add_submenu_page($vwplmml58c, 'Memberium Support', 'Support', $vwploc9adn, 'memberium-support', array($this, 'wplgbwouq') ); if (class_exists('i2sdk_class') ) { add_submenu_page($vwplmml58c, 'i2SDK', 'i2SDK', $vwplf51r, 'i2sdk-admin', 'i2sdk_admin_menu'); } return; }  add_menu_page('', 'Memberium', $vwploc9adn, $vwplmml58c, '', $vwplg1n5d, $vwpltd3zi); add_submenu_page($vwplmml58c, 'Start Here', 'Start Here', $vwploc9adn, $vwplmml58c, array($this, 'wplvaskz') ); add_submenu_page($vwplmml58c, 'Memberium Support', 'Support', $vwploc9adn, 'memberium-support', array($this, 'wplgbwouq') ); add_submenu_page($vwplmml58c, 'Memberium Settings', 'Settings', $vwploc9adn, 'memberium-options', array($this, 'wpljw17') ); add_submenu_page($vwplmml58c, 'Memberium Memberships', 'Memberships', $vwploc9adn, 'memberium-memberships', array($this, 'wplp6ay') ); add_submenu_page($vwplmml58c, 'Memberium Partials', 'Partials', $vwploc9adn, 'edit.php?post_type=partials'); add_submenu_page($vwplmml58c, 'Memberium Custom Shortcodes', 'Custom Shortcodes', $vwploc9adn, 'edit.php?post_type=memb_shortcodeblocks'); add_submenu_page($vwplmml58c, 'Memberium eCommerce Integration', 'eCommerce', $vwploc9adn, 'memberium-ecommerce', array($this, 'wplei5p6') ); add_submenu_page($vwplmml58c, 'Memberium Remote Files Configuration', 'Remote Files', $vwploc9adn, 'memberium-remote-files', array($this, 'wplyjr1') ); add_submenu_page($vwplmml58c, 'Sync Options', 'Sync Options', $vwploc9adn, 'memberium-sync-options', array($this, 'wplensod') ); do_action('memberium_admin_menu_addons', $vwplmml58c); if (false) { add_submenu_page($vwplmml58c, 'Add-on Store', 'Add-on Store', $vwplf51r, 'addon-store', array($this, 'wplset0wq') ); if (extension_loaded('newrelic') ) { add_submenu_page($vwplmml58c, 'Memberium New Relic', 'New Relic', $vwplf51r, 'new-relic', array($this, 'wplc_082') ); } } if (defined('WPCW_PLUGIN_ID') ) { add_submenu_page($vwplmml58c, 'Memberium WP Courseware', 'WP Courseware', $vwplf51r, 'memberium-wpcw', array($this, 'wplqvpb') ); }  if (defined('WPSEO_FILE') || defined('GAWP_FILE') ) { add_submenu_page($vwplmml58c, 'Memberium Google Analytics', 'Google Analytics', $vwplf51r, 'memberium-ga', array($this, 'wplfmni7') ); } $vwplt_5ro = $this->wplxt4f(); add_submenu_page($vwplmml58c, 'Memberium Logs', 'Logs '. $this->wplte96u($vwplt_5ro), $vwplf51r, 'memberium-logs', array($this, 'wplc42m') ); add_submenu_page($vwplmml58c, 'i2SDK', 'i2SDK', $vwplf51r, 'i2sdk-admin', 'i2sdk_admin_menu'); if (MEMBERIUM_DEBUG) {  } add_submenu_page(null, null, null, $vwploc9adn, 'dashboard', array($this, 'wplvaskz') ); add_submenu_page(null, null, null, $vwploc9adn, 'memberium-welcome-screen', array($this, 'wplvaskz') ); }     static function wplq2bzv() { $vwplsekv = 'memberium::manualupdate::list'; $vwpl_l3i = base64_decode('aHR0cHM6Ly9saWNlbnNlc2VydmVyLndlYnBvd2VyYW5kbGlnaHQuY29tL3VwZGF0ZXMvdXBkYXRlLWxpc3QucGhw');  $vwplz4g7n = get_transient($vwplsekv); $result = array(); if (is_array($vwplz4g7n) ) { $result = $vwplz4g7n; } else { $vwplz4g7n = wp_remote_get($vwpl_l3i);  if (is_array($vwplz4g7n) ) { $vwplz4g7n = json_decode($vwplz4g7n['body'], true); set_transient($vwplsekv, $vwplz4g7n, 600); } } return $vwplz4g7n; } static function wplqr0p8k($vwplunqg_ = 'memberium2') { if (! wp_is_writable(__DIR__) ) { echo 'Plugin Folder Not Writeable</p>'; return; } $vwplaoadv5 = self::wplq2bzv(); $vwplpz0qty = memberium_app()->wplnm1h(); $output = '<select name="manual_upgrade" style="width:250px !important;">'; if (is_array($vwplaoadv5) ) { foreach ($vwplaoadv5 as $vwplopnf=>$vwpljvo4) { $output .= '<option value="' . $vwplopnf . '" ' .($vwplpz0qty == $vwpljvo4['version'] ? ' selected="selected" ' : '') . '>' . $vwpljvo4['name'] . ' ' . $vwpljvo4['comments'] . '</option>'; } } $output .= '</select>&nbsp;<input name="manual_upgrade_confirm" value="1" type="checkbox">Confirm Update'; return $output; } static function wplh1pi($vwplogstma = false, $vwplunqg_) { $vwplaoadv5 = self::wplq2bzv($vwplunqg_); if (isset($vwplaoadv5[$vwplogstma]['url']) ) { $vwplwfqz = WP_PLUGIN_DIR; $vwplz9fv6 = ABSPATH . '.maintenance'; $vwplcbl2ex = 'PD9waHAgJHVwZ3JhZGluZyA9IHRpbWUoKTs=';  $vwplffk4 = $vwplaoadv5[$vwplogstma]['url'];  ignore_user_abort();   file_put_contents($vwplz9fv6, $vwplcbl2ex);  $vwplunjt8q = $vwplu_gxri = download_url($vwplffk4, 300);  if (file_exists($vwplunjt8q) ) { require_once ABSPATH .'/wp-admin/includes/file.php';  WP_Filesystem(); unzip_file($vwplunjt8q, $vwplwfqz); unlink($vwplunjt8q); } unlink(ABSPATH . '.maintenance'); echo '<p>Upgrade Process Completed.</p>'; echo '<p><a href="', admin_url(), 'admin.php?page=memberium">Continue</a></p>'; exit; } else { wpljwbf2::wplc1on7('<p><strong>Memberium</strong>:  Unable to install update</p>', 'error'); } }    function wplkr64o_($user_id, $old_user_data) {   } function wplmix1($vwpllzly5b) { global $wpdb; $vwplgogvie = get_userdata($vwpllzly5b); $vwplvtmqd = wpllbej::wplbmo_1($vwpllzly5b); if ($vwplvtmqd > 0) { memberium_app()->wpld5vqwz($vwplvtmqd); } } function wplxchtr() {  global $wpdb;  $vwplx1ap5_ = 'SET SQL_BIG_SELECTS = 1;'; $wpdb->query($vwplx1ap5_); $vwpla54ov0 = MEMBERIUM_DB_TAGS; $vwplx1ap5_ = "SELECT " . "`{$vwpla54ov0}_2`.`id` as `id`, " . "{$vwpla54ov0}.id as payf_id, " . "{$vwpla54ov0}_3.id as cancel_id, " . "{$vwpla54ov0}_4.id as suspend_id, " . "{$vwpla54ov0}_2.name " . "FROM " . "{$vwpla54ov0}, " . "{$vwpla54ov0} as {$vwpla54ov0}_2 " . "LEFT OUTER JOIN  {$vwpla54ov0} as {$vwpla54ov0}_3 ON CONCAT({$vwpla54ov0}_2.name, 'CANC') = {$vwpla54ov0}_3.name AND {$vwpla54ov0}_3.appname = '{$this->appname}' " . "LEFT OUTER JOIN  {$vwpla54ov0} as {$vwpla54ov0}_4 ON CONCAT({$vwpla54ov0}_2.name, 'SUSP') = {$vwpla54ov0}_4.name AND {$vwpla54ov0}_4.appname = '{$this->appname}' " . "WHERE CONCAT({$vwpla54ov0}_2.name, 'PAYF') = {$vwpla54ov0}.name " . "AND {$vwpla54ov0}.appname   = '{$this->appname}' " . "AND {$vwpla54ov0}_2.appname = '{$this->appname}' " . "ORDER BY " . "{$vwpla54ov0}_2.name ASC"; $vwplcr3c9 = $wpdb->get_results($vwplx1ap5_, ARRAY_A); $vwplxx_do = array(); foreach ($vwplcr3c9 as $vwpleanth) { $vwplxx_do[$vwpleanth['id']] = array( 'name' => $vwpleanth['name'], 'payf_id' => $vwpleanth['payf_id'], 'cancel_id' => $vwpleanth['cancel_id'], 'suspend_id' => $vwpleanth['suspend_id'] );  } return $vwplxx_do; } function wplbd7a($vwplmoe2, $vwple6pqif = 'Text', $vwplkskov7 = 0) { global $i2sdk; if (empty($vwplmoe2) ) { return; } $vwplmoe2 = trim($vwplmoe2); $vwplkskov7 = (int) $vwplkskov7; $vwple6pqif = trim($vwple6pqif); if ($vwplkskov7 == 0) { $vwplc0g3p = array('Id', 'Name'); $vwplv80sz = array('Id' => '%'); $vwplggoe = $i2sdk->isdk->dsQuery('DataFormGroup', 1000, 0, $vwplv80sz, $vwplc0g3p); $vwplkskov7 = (int)$vwplggoe[0]['Id']; } if ($vwplkskov7 > 0) { $vwplyio4f = $i2sdk->isdk->addCustomField('Contact', trim($_POST['new_password_field']), $vwple6pqif, $vwplkskov7); $i2sdk->syncCustomFields(); } else { wpljwbf2::wplc1on7('Unable to add new custom field.  Please create a custom tab and custom group in Infusionsoft first.'); } }  static function wplfb48t($vwplg6lz4 = array() ) { global $wpdb; $vwplsb_pf = array( 'exclude' => 'topic,reply' . (defined('MEMBERIUM_IGNORE_POSTTYPE') ? (',' . MEMBERIUM_IGNORE_POSTTYPE) : ''), 'entries' => array(), ); $vwplg6lz4 = wp_parse_args($vwplg6lz4, $vwplsb_pf); $vwplg6lz4['exclude'] = "'" . implode("','", explode(',', $vwplg6lz4['exclude']) ) . "'"; unset($vwplsb_pf); $vwplx1ap5_ = "SELECT `ID`, `post_title` FROM `{$wpdb->posts}` WHERE `post_status` = 'publish' AND `post_type` IN ('" . implode("','", wpljwbf2::wplb9z47() ) . "') AND `post_type` NOT IN (" . $vwplg6lz4['exclude'] . ") ORDER BY `id` ASC;"; $vwpldqjgk = $wpdb->get_results($vwplx1ap5_, ARRAY_A); $vwplrx1f[] = array('id' => 0, 'text' => '(Default / Homepage)'); foreach ($vwpldqjgk as $vwplopnf=>$vwplho_n) { $vwplrx1f[] = array('id' => $vwplho_n['ID'], 'text' => $vwplho_n['post_title'] . ' (' . $vwplho_n['ID'] . ')'); unset($vwpldqjgk[$vwplopnf]); } unset($vwplho_n, $vwplx1ap5_); $vwplrx1f = json_encode($vwplrx1f); return $vwplrx1f; } function wplxoyz($vwplg6lz4 = array() ) { $vwplg6lz4['remove_tags'] = isset($vwplg6lz4['remove_tags']) ? (bool) $vwplg6lz4['remove_tags'] : false; $vwplg6lz4['remove_prefix'] = isset($vwplg6lz4['remove_prefix']) ? trim($vwplg6lz4['remove_prefix']) : 'Remove '; $vwplg6lz4['none'] = isset($vwplg6lz4['none']) ? trim($vwplg6lz4['none']) : ''; $vwpls0hwb5 = wplj_l2t::wplaajf(true); $vwpls0hwb5 = $vwpls0hwb5['mc']; $vwplechli = array(); if (! empty($vwplg6lz4['none']) ) { $vwplechli[] = array('id' => 0, 'text' => $vwplg6lz4['none']); } foreach ( (array) $vwpls0hwb5 as $vwplopnf => $vwpltmveju) { $vwplechli[] = array('id' => $vwplopnf, 'text' => $vwpltmveju . ' (' . $vwplopnf . ')'); if (! empty($vwplg6lz4['remove_tags']) ) { $vwplechli[] = array('id' => (0 - $vwplopnf), 'text' => $vwplg6lz4['remove_prefix'] . ' ' . $vwpltmveju . ' (' . $vwplopnf . ')'); } } $vwplechli = json_encode($vwplechli); return $vwplechli; } function wplcq3ce4($vwplgitq = array() ) { $vwplgogvie = get_user_by('id', get_current_user_id() ); $vwplbrs36 = $vwplgogvie->allcaps; $vwplsdm1vb = array(); foreach($vwplbrs36 as $cap => $caps) { $vwplsdm1vb[] = array( 'id' => $cap, 'text' => ucwords(strtr($cap, '_', ' ') ) ); } return json_encode($vwplsdm1vb); } function wplyy2e($args = array() ) { }    function wplb1twj() { $vwplcltpy = isset($_GET['post']) ? $_GET['post'] : 0; if ($vwplcltpy == 0) { $vwplcltpy = isset($_POST['post_ID']) ? $_POST['post_ID'] : 0; } if ($vwplcltpy > 0) { $vwplo43m = get_post_type($vwplcltpy); } if (empty($vwplo43m) ) { $vwplo43m = isset($_GET['post_type']) ? $_GET['post_type'] : 'post'; } if (! in_array($vwplo43m, $this->non_enhanced_post_types) ) { add_meta_box('is4wp-member-access', 'Content Protection', array($this, 'wplq7k53f'), $vwplo43m, 'side'); add_meta_box('is4wp-page-templates', 'Membership Templates', array($this, 'wpluu0d6'), $vwplo43m, 'normal'); add_meta_box('is4wp-member-access', 'Content Protection', array($this, 'wplq7k53f'), $vwplo43m, 'side'); add_action('save_post', array($this, 'wplhw5_r') ); add_action('save_post', array($this, 'wplxukxg2') ); if (user_can(get_current_user_id(), 'manage_options') ) { if (in_array($vwplo43m, wpljwbf2::wplb9z47() ) ) { if (! in_array($vwplo43m, array('partials', 'memb_shortcodeblocks', 'elementor_library') ) ) { add_meta_box('is4wp-custom-code', 'Memberium Custom Page Code', array($this, 'wpliw1xi'), $vwplo43m, 'normal'); add_action('save_post', array($this, 'wplx5mhz') ); } } } } if (class_exists('WooCommerce') ) { $vwplfmdyx = array( 'product', ); $vwpli064 = isset($_GET['post_type']) ? $_GET['post_type'] : 'post'; if (defined('MEMBERIUM_BETA') && MEMBERIUM_BETA) { if (in_array($vwplo43m, $vwplfmdyx) ) { add_meta_box('is4wp-woocommerce', 'WooCommerce', array($this, 'wpldr0mc'), $vwplo43m, 'side'); } } } if (class_exists('LearnPress') ) { $vwpls9ry = array( 'lp_course', 'lp_lesson', 'lp_quiz', ); if (in_array($vwplo43m, $vwpls9ry) ) { add_meta_box('is4wp-learnpress-actions', 'LearnPress Memberium Integration', array($this, 'wpliogv0'), $vwplo43m, 'side'); } } if (defined('WPCW_PLUGIN_ID') ) { $vwplcjdw = array( 'course_unit', ); if (in_array($vwplo43m, $vwplcjdw) ) { add_meta_box('is4wp-wpcw-actions', 'WP Courseware Memberium Integration', array($this, 'wpllmir'), $vwplo43m, 'side'); } } if (class_exists('LifterLMS') ) { $vwpljrp5m = array( 'course', 'lesson', 'llms_quiz', ); if (in_array($vwplo43m, $vwpljrp5m) ) { add_meta_box('is4wp-lifterlms-actions', 'LifterLMS Memberium Integration', array($this, 'wplruce'), $vwplo43m, 'side'); } } if (class_exists('Sensei_Main') ) { $vwpld6r3dc = array( 'course', 'lesson', ); if (in_array($vwplo43m, $vwpld6r3dc) ) { add_meta_box('is4wp-sensei-actions', 'Sensei Memberium Integration', array($this, 'wplguz74'), $vwplo43m, 'side'); } } unset($vwplcjdw, $vwpld6r3dc, $vwpljrp5m); $vwpldaer = array('memb_shortcodeblocks', 'reply', 'topic',); if (class_exists('BadgeOS') ) { $vwpldaer[] = 'achievement-type'; $vwpldaer[] = 'badges'; $vwpldaer[] = 'nomination'; $vwpldaer[] = 'badgeos-log-entry'; } add_action('admin_footer', array($this, 'wplyo590_') ); add_action('save_post', array($this, 'wplbrsg') ); add_action('save_post', array($this, 'wpli5qne4') ); }  function wplbrsg($vwplcltpy) { $vwplzzlf5b = $_POST;  if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) { return; }  if (empty($vwplzzlf5b['memberium_membershipaccess_nonce']) || ! wp_verify_nonce($vwplzzlf5b['memberium_membershipaccess_nonce'], MEMBERIUM_LIB) ) { return; } if (! current_user_can('edit_posts', $vwplcltpy) ) { return; } $vwplv7a_9m = array( '_is4wp_learndash_achievement', '_is4wp_learndash_actions', '_is4wp_learndash_assignment_approved_actions', '_is4wp_learndash_assignment_approved_tags', '_is4wp_learndash_assignment_upload_actions', '_is4wp_learndash_assignment_upload_tags', '_is4wp_learndash_autoenroll', '_is4wp_learndash_autojoin', '_is4wp_learndash_badges', '_is4wp_learndash_fail_actions', '_is4wp_learndash_fail_goals', '_is4wp_learndash_fail_tags', '_is4wp_learndash_goals', '_is4wp_learndash_orientation', '_is4wp_learndash_pdfformat', '_is4wp_learndash_redirect', '_is4wp_learndash_shortcodes', '_is4wp_learndash_tags', '_is4wp_lms_complete_percent', '_is4wp_lms_completed', '_is4wp_lms_grade', '_is4wp_lms_start_date', ); foreach($vwplv7a_9m as $vwply17edn) { $vwplzzlf5b[$vwply17edn] = isset($vwplzzlf5b[$vwply17edn]) ? $vwplzzlf5b[$vwply17edn] : ''; add_post_meta($vwplcltpy, $vwply17edn, $vwplzzlf5b[$vwply17edn], true) or update_post_meta($vwplcltpy, $vwply17edn, $vwplzzlf5b[$vwply17edn]); } } function wplyo590_() { echo '<!-- metabox footer -->';   $vwpls0hwb5 = wplj_l2t::wplaajf(TRUE); $vwpls0hwb5 = $vwpls0hwb5['mc']; $vwplechli = array(); $vwplechli[] = array('id' => 0, 'text' => '(None)'); foreach ( (array) $vwpls0hwb5 as $vwplh0kmic => $vwpltmveju) { $vwplechli[] = array('id' => $vwplh0kmic, 'text' => $vwpltmveju . ' (' . $vwplh0kmic . ')'); } $vwplechli = json_encode($vwplechli); unset($vwpls0hwb5, $vwplh0kmic, $vwpltmveju); echo '<script>'; echo '	var taglist = ', $vwplechli, ';'; echo '</script>'; unset($actionsets, $vwpls0hwb5); wp_register_script('memberium_postmeta', plugin_dir_url(MEMBERIUM_HOME) . '/js/postmetabox.js', null, true); wp_enqueue_script('memberium_postmeta'); } function wpldr0mc() {   } function wpluzw0h() {   } function wpluu0d6() { $vwpl_9x2wn = $this->wplh0wfvl(); echo '<div class="memb_template_options">'; echo '<label for="_is4wp_page_template">' . _e("Install Page Template", 'memberium') . '</label> '; echo '<select class="actionset-selector" name="_is4wp_page_template" style="width:100%; max-width:100%">'; echo '<option value="">(No Template)</option>'; if (is_array($vwpl_9x2wn) ) { foreach ($vwpl_9x2wn as $vwplmwynkc => $vwplzxhjbg) { echo '<option value="', $vwplmwynkc + 1, '">', $vwplzxhjbg['name'], '</option>'; } } echo '</select>'; echo '</div>'; } function wplxukxg2() { $vwplzzlf5b = $_POST; if (! empty($vwplzzlf5b['_is4wp_page_template']) ) { $this->wplkr2a9x($vwplzzlf5b['post_ID'], ($vwplzzlf5b['_is4wp_page_template'] - 1) ); } return; } function wpliw1xi() { global $post; $vwply4fkhi = get_post_meta($post->ID, '_iswp_custom_code', true); $defaults = array( 'head' => '', 'css' => '', 'js' => '', ); $vwply4fkhi = wp_parse_args($vwply4fkhi, $defaults); wp_nonce_field(MEMBERIUM_LIB, 'memberium_customcode_nonce'); echo '<p>HTML Head Code</p>'; echo '<textarea id="is4wp_html_head" name="is4wp_html_head" placeholder="Head HTML Code" rows="3" cols="30" style="width:100%;">', $vwply4fkhi['head'], '</textarea>'; echo '<p>CSS Code</p>'; echo '<textarea id="is4wp_css" name="is4wp_css" placeholder="Enter your custom CSS code here.  <style> tags are automatically included." rows="3" cols="30" style="width:100%;">', $vwply4fkhi['css'], '</textarea>'; echo '<p>JavaScript Code</p>'; echo '<textarea id="is4wp_js" name="is4wp_js" rows=3 cols=30 placeholder="JavaScript Code.  <script> tags are automatically included." style="width:100%;">', $vwply4fkhi['js'], '</textarea>'; $vwplj0su2c = method_exists('wp_screen','is_block_editor') ? get_current_screen()->is_block_editor() : false;  if (! $vwplj0su2c) { echo '<style>
				.CodeMirror { height: auto !important; border: 1px solid #ddd; }
				.CodeMirror-scroll { min-height: 100px !important; max-height:300px !important; }
				</style>';  if (get_bloginfo('version') >= '4.9') { $vwplco7r1e = array( 'is4wp_css' => 'text/css', 'is4wp_html_head' => 'text/html',  'is4wp_js' => 'application/javascript', ); foreach($vwplco7r1e as $vwplopnf => $vwplsfdb_t) { $vwplelob86 = wp_enqueue_code_editor(array('type' => $vwplsfdb_t) ); wp_add_inline_script( 'code-editor', sprintf( 'jQuery(function() { wp.codeEditor.initialize("' . $vwplopnf . '", %s); });', wp_json_encode($vwplelob86) ) ); } } } } function wplx5mhz($vwplcltpy) { $vwplzzlf5b = $_POST;  if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) { return; }  if (empty($vwplzzlf5b['memberium_customcode_nonce']) || ! wp_verify_nonce($vwplzzlf5b['memberium_customcode_nonce'], MEMBERIUM_LIB) ) { return; }  if (! empty($vwplzzlf5b['post_type']) && 'page' == $vwplzzlf5b['post_type']) { if (! current_user_can('edit_pages', $vwplcltpy) ) { return; } } else { if (! current_user_can('edit_posts', $vwplcltpy) ) { return; } } $vwply4fkhi = array( 'head' => isset($vwplzzlf5b['is4wp_html_head']) ? trim($vwplzzlf5b['is4wp_html_head']) : '', 'css' => isset($vwplzzlf5b['is4wp_css']) ? trim($vwplzzlf5b['is4wp_css']) : '', 'js' => isset($vwplzzlf5b['is4wp_js']) ? trim($vwplzzlf5b['is4wp_js']) : '', ); wpla0ovhi::wplkcvs8y($vwplcltpy, 'custom_code', $vwply4fkhi); }   function wpllmir() { global $vwplzzlf5b;  $vwplct26 = get_post_meta($vwplzzlf5b->ID); $vwply4fkhi = array(); $vwplv7a_9m = array( '_is4wp_wpcw_completion_tag', ); foreach($vwplv7a_9m as $vwply17edn) { $vwply4fkhi[$vwply17edn] = isset($vwplct26[$vwply17edn][0]) ? $vwplct26[$vwply17edn][0] : ''; } wp_nonce_field(MEMBERIUM_LIB, 'memberium_membershipaccess_nonce'); if (in_array($vwplzzlf5b->post_type, array('course_unit') ) ) { echo '<label for="_is4wp_wpcw_completion_tag">' . _e("Unit Completion Tag", 'memberium') . ':</label> '; echo '<input name="_is4wp_wpcw_completion_tag" class="tag-selector" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_wpcw_completion_tag'] > '' ? $vwply4fkhi['_is4wp_wpcw_completion_tag'] : ''), '"><br /><br />'; } } function wpli5qne4($vwplcltpy) {  if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) { return; } $vwplabwuy = $_POST;  if (empty($vwplabwuy['memberium_membershipaccess_nonce']) || ! wp_verify_nonce($vwplabwuy['memberium_membershipaccess_nonce'], MEMBERIUM_LIB) ) { return; } if (! current_user_can('edit_posts', $vwplcltpy) ) { return; } $fieldnames = array( '_is4wp_wpcw_completion_tag', ); foreach($fieldnames as $key) { $vwplabwuy[$key] = isset($vwplabwuy[$key]) ? $vwplabwuy[$key] : ''; add_post_meta($vwplcltpy, $key, $vwplabwuy[$key], true) or update_post_meta($vwplcltpy, $key, $vwplabwuy[$key]); } }  function wpliogv0() { global $post;  $vwplq_4y = get_post_meta($post->ID); $vwply4fkhi = array(); $vwplv7a_9m = array( '_is4wp_learndash_achievement', '_is4wp_learndash_actions', '_is4wp_learndash_autoenroll', '_is4wp_learndash_autojoin', '_is4wp_learndash_badges', '_is4wp_learndash_fail_actions', '_is4wp_learndash_fail_goals', '_is4wp_learndash_fail_tags', '_is4wp_learndash_goals', '_is4wp_learndash_orientation', '_is4wp_learndash_pdfformat', '_is4wp_learndash_redirect', '_is4wp_learndash_shortcodes', '_is4wp_learndash_tags', '_is4wp_lms_complete_percent', '_is4wp_lms_completed', '_is4wp_lms_grade', '_is4wp_lms_start_date', ); foreach($vwplv7a_9m as $vwply17edn) { $vwply4fkhi[$vwply17edn] = isset($vwplq_4y[$vwply17edn][0]) ? $vwplq_4y[$vwply17edn][0] : ''; } unset($vwplct26, $vwplv7a_9m, $vwply17edn); wp_nonce_field(MEMBERIUM_LIB, 'memberium_membershipaccess_nonce'); $vwplv7a_9m = array('' => '(None)'); $vwplmu62n = wpllbej::wplntnyv('contact', true); foreach($vwplmu62n as $vwpl_s6l) { $vwplv7a_9m[$vwpl_s6l] = $vwpl_s6l; } unset($vwplmu62n, $vwpl_s6l); $vwplgitq = array( 'class' => 'actionset-selected', 'style' => 'width:250px;', ); $vwplwih5 = array('lp_course', 'lp_lesson', 'lp_quiz'); if (in_array($post->post_type, $vwplwih5) ) { if (in_array($post->post_type, array('lp_course') ) ) { echo '<label for="_is4wp_learndash_autoenroll">' . _e("AutoEnroll Tags", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_autoenroll" class="tag-selector" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_autoenroll'] > '' ? $vwply4fkhi['_is4wp_learndash_autoenroll'] : ''), '"><br /><br />'; } echo '<p>On completion of this section, execute the following actions:</p>'; echo '<label for="_is4wp_learndash_goals">' . _e("Achieve these Goals", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_goals" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_goals'] > '' ? $vwply4fkhi['_is4wp_learndash_goals'] : ''), '"><br /><br />'; echo '<label for="_is4wp_learndash_tags">' . _e("Apply these Tags", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_tags" class="tag-selector" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_tags'] > '' ? $vwply4fkhi['_is4wp_learndash_tags'] : ''), '"><br /><br />'; echo '<label for="_is4wp_learndash_actions">' . _e("Run this Actionset", 'memberium') . ':</label> '; echo '<select class="actionset-selector" name="_is4wp_learndash_actions" style="width:100%; max-width:100%">'; echo '<option value="0">(No Actions)</option>'; $vwplewhxt_ = memberium_app()->wpletmsz(); foreach ($vwplewhxt_ as $vwpleklnhm=>$vwplp1g6b) { echo '<option value="', $vwpleklnhm, '" ', ($vwply4fkhi['_is4wp_learndash_actions'] == $vwpleklnhm ? ' selected="selected" ' : '') , '>', $vwplp1g6b, '</option>'; } unset($vwpleklnhm, $vwplp1g6b); echo '</select>'; echo '<br /><br />'; if (in_array($post->post_type, array('lp_quiz') ) ) { echo '<p>If the student <strong style="color:red;">fails</strong> this test, execute the following actions:</p>'; echo '<label for="_is4wp_learndash_fail_goals">' . _e("Achieve these Goals", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_fail_goals" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_fail_goals'] > '' ? $vwply4fkhi['_is4wp_learndash_fail_goals'] : ''), '"><br /><br />'; echo '<label for="_is4wp_learndash_fail_tags">' . _e("Apply these Tags", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_fail_tags" class="tag-selector" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_fail_tags'] > '' ? $vwply4fkhi['_is4wp_learndash_fail_tags'] : ''), '"><br /><br />'; echo '<label for="_is4wp_learndash_fail_actions">' . _e("Run this Actionset", 'memberium') . ':</label> '; echo '<select class="actionset-selector" name="is4wp_learndash_fail_actions" style="width:100%; max-width:100%">'; echo '<option value="0">(No Actions)</option>'; foreach ($vwplewhxt_ as $vwpleklnhm=>$vwplp1g6b) { echo '<option value="', $vwpleklnhm, '" ', ($vwply4fkhi['_is4wp_learndash_fail_actions'] == $vwpleklnhm ? ' selected="selected" ' : '') , '>', $vwplp1g6b, '</option>'; } echo '</select>'; $vwplph268z = isset($vwply4fkhi['_is4wp_lms_start_date']) ? $vwply4fkhi['_is4wp_lms_start_date'] : ''; echo '<label for="_is4wp_lms_start_date">' . _e("Start Date Field", 'memberium') . ':</label><br />'; wpljwbf2::wplves0('_is4wp_lms_start_date', $vwplv7a_9m, $vwplph268z, $vwplgitq); echo '<br>'; $vwplph268z = isset($vwply4fkhi['_is4wp_lms_complete_percent']) ? $vwply4fkhi['_is4wp_lms_complete_percent'] : ''; echo '<label for="_is4wp_lms_complete_percent">' . _e("Percent Complete", 'memberium') . ':</label><br />'; wpljwbf2::wplves0('_is4wp_lms_complete_percent', $vwplv7a_9m, $vwplph268z, $vwplgitq); echo '<br>'; } unset($vwplewhxt_, $vwpleklnhm, $vwplp1g6b);   $vwple4jt = memberium_app()->wpla2myl(); if (! empty($vwple4jt) ) { echo '<label for="_is4wp_learndash_achievement">' . _e("Award this Achievement", 'memberium') . ':</label> '; echo '<select class="actionset-selector" name="_is4wp_learndash_achievement" style="width:100%; max-width:100%">'; echo '<option value="0">(No Achievement)</option>'; foreach ($vwple4jt as $vwplhvka=>$vwpltoyi) { echo '<option value="', $vwplhvka, '" ', ($vwply4fkhi['_is4wp_learndash_achievement'] == $vwplhvka ? ' selected="selected" ' : '') , '>', $vwpltoyi, '</option>'; } unset($vwplhvka, $vwpltoyi); echo '</select>'; echo '<br /><br />'; } } }  function wplguz74() { global $post; $vwplq_4y = get_post_meta($post->ID); $vwply4fkhi = array(); $vwplv7a_9m = array( '_is4wp_learndash_actions', '_is4wp_learndash_autoenroll', '_is4wp_learndash_autojoin', '_is4wp_learndash_goals', '_is4wp_learndash_redirect', '_is4wp_learndash_shortcodes', '_is4wp_learndash_tags', '_is4wp_lms_complete_percent', '_is4wp_lms_completed', '_is4wp_lms_grade', '_is4wp_lms_start_date', ); foreach($vwplv7a_9m as $vwply17edn) { $vwply4fkhi[$vwply17edn] = isset($vwplq_4y[$vwply17edn][0]) ? $vwplq_4y[$vwply17edn][0] : ''; } unset($metas, $vwplv7a_9m, $vwply17edn); wp_nonce_field(MEMBERIUM_LIB, 'memberium_membershipaccess_nonce'); $vwplwih5 = array('course', 'lesson'); if (in_array($post->post_type, $vwplwih5) ) { if ($post->post_type == 'course') { echo '<label for="_is4wp_learndash_autoenroll">' . _e("AutoEnroll Tags", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_autoenroll" class="tag-selector" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_autoenroll'] > '' ? $vwply4fkhi['_is4wp_learndash_autoenroll'] : ''), '"><br /><br />'; } echo '<p>On completion of this section, execute the following actions:</p>'; echo '<label for="_is4wp_learndash_goals">' . _e("Achieve these Goals", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_goals" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_goals'] > '' ? $vwply4fkhi['_is4wp_learndash_goals'] : ''), '"><br /><br />'; echo '<label for="_is4wp_learndash_tags">' . _e("Apply these Tags", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_tags" class="tag-selector" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_tags'] > '' ? $vwply4fkhi['_is4wp_learndash_tags'] : ''), '"><br /><br />'; echo '<label for="_is4wp_learndash_actions">' . _e("Run this Actionsets", 'memberium') . ':</label> '; echo '<select class="actionset-selector" name="_is4wp_learndash_actions" style="width:100%; max-width:100%">'; echo '<option value="0">(No Actions)</option>'; $vwplewhxt_ = memberium_app()->wpletmsz(); foreach ($vwplewhxt_ as $vwpleklnhm=>$vwplp1g6b) { echo '<option value="', $vwpleklnhm, '" ', ($vwply4fkhi['_is4wp_learndash_actions'] == $vwpleklnhm ? ' selected="selected" ' : '') , '>', $vwplp1g6b, '</option>'; } unset($vwplewhxt_, $vwpleklnhm, $vwplp1g6b); echo '</select>'; echo '<hr />'; $vwplv7a_9m = array('' => '(None)'); $vwplmu62n = wpllbej::wplntnyv('contact', true); foreach($vwplmu62n as $vwpl_s6l) { $vwplv7a_9m[$vwpl_s6l] = $vwpl_s6l; } unset($vwplmu62n, $vwpl_s6l); $vwplgitq = array( 'class' => 'actionset-selected', 'style' => 'width:250px;', ); $vwplph268z = isset($vwply4fkhi['_is4wp_lms_start_date']) ? $vwply4fkhi['_is4wp_lms_start_date'] : ''; echo '<label for="_is4wp_lms_start_date">' . _e("Start Date Field", 'memberium') . ':</label><br />'; wpljwbf2::wplves0('_is4wp_lms_start_date', $vwplv7a_9m, $vwplph268z, $vwplgitq); echo '<br>'; if ($post->post_type == 'course') { $vwplph268z = isset($vwply4fkhi['_is4wp_lms_complete_percent']) ? $vwply4fkhi['_is4wp_lms_complete_percent'] : ''; echo '<label for="_is4wp_lms_complete_percent">' . _e("Percent Complete", 'memberium') . ':</label><br />'; wpljwbf2::wplves0('_is4wp_lms_complete_percent', $vwplv7a_9m, $vwplph268z, $vwplgitq); echo '<br>'; } if ($post->post_type == 'lesson') { $vwplph268z = isset($vwply4fkhi['_is4wp_lms_grade']) ? $vwply4fkhi['_is4wp_lms_grade'] : ''; echo '<label for="_is4wp_lms_grade">' . _e("Grade", 'memberium') . ':</label><br />'; wpljwbf2::wplves0('_is4wp_lms_grade', $vwplv7a_9m, $vwplph268z, $vwplgitq); echo '<br>'; $vwplph268z = isset($vwply4fkhi['_is4wp_lms_completed']) ? $vwply4fkhi['_is4wp_lms_completed'] : ''; echo '<label for="_is4wp_lms_completed">' . _e("Quiz Passed", 'memberium') . ':</label><br />'; wpljwbf2::wplves0('_is4wp_lms_completed', $vwplv7a_9m, $vwplph268z, $vwplgitq); echo '<br>'; } echo '<hr />'; } }  function wplruce() {  global $post; $vwplq_4y = get_post_meta($post->ID); $vwply4fkhi = array(); $vwplv7a_9m = array( '_is4wp_learndash_achievement', '_is4wp_learndash_actions', '_is4wp_learndash_autoenroll', '_is4wp_learndash_autojoin', '_is4wp_learndash_goals', '_is4wp_learndash_redirect', '_is4wp_learndash_shortcodes', '_is4wp_learndash_tags', '_is4wp_lms_complete_percent', '_is4wp_lms_completed', '_is4wp_lms_grade', '_is4wp_lms_start_date', ); foreach($vwplv7a_9m as $vwply17edn) { $vwply4fkhi[$vwply17edn] = isset($vwplq_4y[$vwply17edn][0]) ? $vwplq_4y[$vwply17edn][0] : ''; } unset($meta, $vwplv7a_9m, $vwply17edn); wp_nonce_field(MEMBERIUM_LIB, 'memberium_membershipaccess_nonce'); $vwplwih5 = array('course', 'lesson', 'llms_quiz'); if (in_array($post->post_type, $vwplwih5) ) { if ($post->post_type == 'course') { echo '<label for="_is4wp_learndash_autoenroll">' . _e("AutoEnroll Tags", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_autoenroll" class="tag-selector" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_autoenroll'] > '' ? $vwply4fkhi['_is4wp_learndash_autoenroll'] : ''), '"><br /><br />'; } echo '<p>On completion of this section, execute the following actions:</p>'; echo '<label for="_is4wp_learndash_goals">' . _e("Achieve these Goals", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_goals" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_goals'] > '' ? $vwply4fkhi['_is4wp_learndash_goals'] : ''), '"><br /><br />'; echo '<label for="_is4wp_learndash_tags">' . _e("Apply these Tags", 'memberium') . ':</label> '; echo '<input name="_is4wp_learndash_tags" class="tag-selector" style="width:100%; max-width:100%" value="', ($vwply4fkhi['_is4wp_learndash_tags'] > '' ? $vwply4fkhi['_is4wp_learndash_tags'] : ''), '"><br /><br />'; echo '<label for="_is4wp_learndash_actions">' . _e("Run this Actionsets", 'memberium') . ':</label> '; echo '<select class="actionset-selector" name="_is4wp_learndash_actions" style="width:100%; max-width:100%">'; echo '<option value="0">(No Actions)</option>'; $vwplewhxt_ = memberium_app()->wpletmsz(); foreach ($vwplewhxt_ as $vwpleklnhm=>$vwplp1g6b) { echo '<option value="', $vwpleklnhm, '" ', ($vwply4fkhi['_is4wp_learndash_actions'] == $vwpleklnhm ? ' selected="selected" ' : '') , '>', $vwplp1g6b, '</option>'; } unset($vwplewhxt_, $vwpleklnhm, $vwplp1g6b); echo '</select>';  $vwple4jt = memberium_app()->wpla2myl(); if (! empty($vwple4jt) ) { echo '<label for="_is4wp_learndash_achievement">' . _e("Award this Achievement", 'memberium') . ':</label> '; echo '<select class="actionset-selector" name="_is4wp_learndash_achievement" style="width:100%; max-width:100%">'; echo '<option value="0">(No Achievement)</option>'; foreach ($vwple4jt as $vwplhvka=>$vwpltoyi) { echo '<option value="', $vwplhvka, '" ', ($vwply4fkhi['_is4wp_learndash_achievement'] == $vwplhvka ? ' selected="selected" ' : '') , '>', $vwpltoyi, '</option>'; } unset($vwplhvka, $vwpltoyi); echo '</select>'; echo '<br /><br />'; } } } function wpli5fh_t() { wp_enqueue_script('memberium-admin-edit', plugins_url('js/quickedit.js', MEMBERIUM_HOME), array('jquery', 'inline-edit-post'), '', TRUE); }       function wplodfb0($vwpljerm8_) { $vwplamdi = $_GET; $vwplo43m = isset($vwplamdi['post_type']) ? $vwplamdi['post_type'] : ''; $vwplz6txv8 = array(); if ($vwplo43m == 'memb_shortcodeblocks') { $vwplz6txv8['memb_custom_shortcode'] = __('Shortcode'); unset($vwpljerm8_['categories'], $vwpljerm8_['date']); } else { if ($vwplo43m == 'partials') { $vwplz6txv8['memb_partial_shortcode'] = __('Shortcode'); unset($vwpljerm8_['categories'], $vwpljerm8_['date']); } $vwplz6txv8['memberships'] = __('Membership Levels'); $vwplz6txv8['tag_ids'] = __('Tag ID\'s'); $vwplz6txv8['prohibited_action'] = __('Prohibited Action'); if (! empty($this->settings['settings']['show_post_columns']) ) { $vwplz6txv8['contact_ids'] = __('Contact ID\'s'); $vwplz6txv8['anonymous_only'] = __('Logged Out Only'); $vwplz6txv8['facebook_crawler'] = __('Facebook crawler'); $vwplz6txv8['google_1stclick'] = __('Google First Click Free'); } } $vwpljerm8_ = array_merge( $vwpljerm8_, $vwplz6txv8 ); return $vwpljerm8_; } function wplwlbn($vwplhzsync, $vwplcltpy) { switch ($vwplhzsync) { case 'memb_custom_shortcode': echo '<div style="white-space:nowrap;">', '[membc_', get_post($vwplcltpy)->post_name, ']', '</div>'; break; case 'memb_partial_shortcode': echo '<div style="white-space:nowrap;">', '[memb_include_partial id=', $vwplcltpy, ']', '</div>'; break; case 'anonymous_only': $vwplph268z = get_post_meta($vwplcltpy, '_is4wp_anonymous_only', TRUE); if ($vwplph268z) { $vwplxo3wtv = '<strong style="color:green;">Yes</strong>'; $vwpljypm = 1; } else { $vwplxo3wtv = '<strong style="color:red;">No</strong>'; $vwpljypm = 0; } echo '<div>', $vwplxo3wtv, '</div>';  echo '<input type="hidden" id="memb-anonymousonly-', $vwplcltpy, '" value="', $vwpljypm, '">'; break; case 'contact_ids': $vwplph268z = get_post_meta($vwplcltpy, '_is4wp_contact_ids', true); echo '<div id="memb-contactids-' . $vwplcltpy . '">' . $vwplph268z . '</div>'; break; case 'facebook_crawler': $vwplph268z = get_post_meta($vwplcltpy, '_is4wp_facebook_crawler', true); if ($vwplph268z) { $vwplxo3wtv = '<strong style="color:green;">Yes</strong>'; $vwpljypm = 1; } else { $vwplxo3wtv = '<strong style="color:red;">No</strong>'; $vwpljypm = 0; } echo '<div>', $vwplxo3wtv, '</div>';  echo '<input type="hidden" id="memb-facebookcrawler-', $vwplcltpy, '" value="', $vwpljypm, '">'; break; case 'google_1stclick': $vwplph268z = get_post_meta($vwplcltpy, '_is4wp_google_1stclick', true); if ($vwplph268z) { $vwplxo3wtv = '<strong style="color:green;">Yes</strong>'; $vwpljypm = 1; } else { $vwplxo3wtv = '<strong style="color:red;">No</strong>'; $vwpljypm = 0; } echo '<div>', $vwplxo3wtv, '</div>';  echo '<input type="hidden" id="memb-google1stclick-', $vwplcltpy, '" value="', $vwpljypm, '">'; break; case 'memberships': $vwplgxrbm = explode(',', get_post_meta($vwplcltpy, '_is4wp_membership_levels', true) ); $vwplcl3zn = count($vwplgxrbm); $vwplhqago = array(); $vwplgyte5 = 0; $vwplcgnyth = get_post_meta($vwplcltpy, '_is4wp_any_loggedin_user', true); $vwplaicq = get_post_meta($vwplcltpy, '_is4wp_any_membership', true); if ($vwplcl3zn > 0) { foreach($vwplgxrbm as $vwply17edn => $vwplbquy) { $vwplhqago[] = $vwplbquy; echo isset($this->settings['memberships'][$vwplbquy]['name']) ? $this->settings['memberships'][$vwplbquy]['name'] : ''; if (++$vwplgyte5 < $vwplcl3zn) { echo ', '; } } echo '<input type="hidden" id="memb-memberships-', $vwplcltpy, '" value="', implode(',', $vwplhqago), '" >'; } if ($vwplcgnyth) { echo '<span style="white-space:nowrap;">(Any Logged In User)</span> '; } if ($vwplaicq) { echo '<span style="white-space:nowrap;">(Any Membership)</span> '; } break; case 'prohibited_action': $vwpls96d = get_post_meta($vwplcltpy, '_is4wp_prohibited_action', TRUE); $vwplimo5 = trim(get_post_meta($vwplcltpy, '_is4wp_redirect_url', true) );   echo '<input type="hidden" id="memb-prohibitedaction-', $vwplcltpy, '" value="', $vwpls96d, '">'; echo '<input type="hidden" id="memb-redirecturl-', $vwplcltpy, '" value="', $vwplimo5, '">'; echo ucwords($vwpls96d), '<br />'; echo $vwplimo5, '<br />'; break; case 'tag_ids': $vwplph268z = get_post_meta($vwplcltpy, '_is4wp_access_tags', TRUE); echo '<div id="memb-accesstagids-', $vwplcltpy, '">', $vwplph268z, '</div>'; break; } } function wplg0yix($vwplhfrs, $vwplo43m) { static $vwpljua7 = true; if ($vwpljua7) { $vwpljua7 = false; wp_nonce_field(MEMBERIUM_LIB, 'memb_accesscontrol_bulkedit_nonce'); } echo '<fieldset class="inline-edit-col-right inline-edit-', $vwplhfrs, '">'; echo '<div class="inline-edit-col column-', $vwplhfrs , '">'; echo '<label class="inline-edit-group">'; switch ($vwplhfrs) { case 'memberships': $vwplgxrbm = is_array($this->settings['memberships']) ? $this->settings['memberships'] : array(); $vwplzsbug = array(); foreach ($vwplgxrbm as $vwply17edn => $vwplj4rq_) { $vwplzsbug[] = $vwply17edn; } $vwplzsbug = implode(',', $vwplzsbug); echo '<input type="hidden" name="bulkedit-membershiplist" id="bulkedit-membershiplist" value="', $vwplzsbug, '">';  if (count($vwplgxrbm) > 0) { echo '<ul class="cat-checklist category-checklist">'; echo '<em>Membership Access</em>'; echo '<label for="memb_useexisting"><input type="checkbox" name="memb_useexisting" value="1" id="memb_useexisting"> <em>Use Existing Memberships</em></label>'; foreach ($vwplgxrbm as $vwplopnf => $vwplbquy) { echo '<label for="memb_membership_level_' . $vwplopnf . '"><input type="checkbox" name="memb_membership_level_' . $vwplopnf . '" value="' . $vwplopnf . '" id="memb_membership_level_' . $vwplopnf . '"> ' . stripslashes($vwplbquy['name']) . '</label>'; } } echo '<label for="memb_anonymousonly"><input type="checkbox" name="memb_anonymousonly" value="1" id="memb_anonymousonly"> Logged Out Only</label>'; echo '<label for="memb_anyloggedinuser"><input type="checkbox" name="memb_anyloggedinuser" value="1" id="memb_anyloggedinuser"> Any Logged In User</label>'; echo '<label for="memb_google1stclick"><input type="checkbox" name="memb_google1stclick" value="1" id="memb_google1stclick"> Google 1st Click Free</label>'; echo '<label for="memb_facebookcrawler"><input type="checkbox" name="memb_facebookcrawler" value="1" id="memb_facebookcrawler"> Facebook Crawler Access</label>'; echo '</ul>'; echo '<hr />'; echo '<label for="memb_prohibitedaction"><span class="title" style="width:75px;">Prohibited</span><select name="memb_prohibitedaction" id="memb_prohibitedaction">'; echo '<option value="default">Default</option>'; echo '<option value="redirect">Redirect</option>'; echo '<option value="hide">Hide Completely</option>'; echo '<option value="excerpt">Show Excerpt Only</option>'; echo '</select></label>'; echo '<label><span class="title" style="width:75px;">Redirect URL  </span><input type="text" name="memb_redirecturl" value="" placeholder="" id="memb_redirecturl"></label>'; break; } echo '</label></div></fieldset>'; } function wplccn9_m() { $vwplb4fry = array('memb_shortcodeblocks',); if (isset($_POST['post_type']) && !in_array($_POST['post_type'], $vwplb4fry) ) { return; }; if (!current_user_can('edit_post', 0) ) { return; }    }    function wplx7cr() { if (!current_user_can('manage_options') ) { wp_die(__('You do not have sufficient permissions to access this page.') ); } } function wplfmni7() { require_once MEMBERIUM_SCREEN_DIR . 'googleanalytics.php'; } function wplc_082() {   } function wplfwm12($vwpl_p58) { if (! is_array($vwpl_p58) || empty($vwpl_p58) ) { return false; } global $wpdb; $vwplx1ap5_ = "SELECT `post_id`, `meta_value` FROM {$wpdb->postmeta} WHERE `meta_key` = '_is4wp_membership_levels' AND `meta_value` > '' "; $vwplob9i24 = $wpdb->get_results($vwplx1ap5_, ARRAY_A); foreach ($vwplob9i24 as $vwplzzlf5b) { $vwplfmog5 = explode(',', $vwplzzlf5b['meta_value']); $vwplwabz = implode(',', array_diff($vwplfmog5, $vwpl_p58) ); wpla0ovhi::wplkcvs8y($vwplzzlf5b['post_id'], 'memberships', $vwplwabz); } return true; } function wplyjr1() { require_once MEMBERIUM_SCREEN_DIR . 'remotefiles.php'; }  function wplh0wfvl() { $vwplsekv = 'memberium::page_templates'; $vwplwyw1_ = 'https://licenseserver.webpowerandlight.com/updates/page-templates.php';  $vwplz4g7n = get_transient($vwplsekv, false); $vwplyio4f = array(); if (is_array($vwplz4g7n) ) { $vwplyio4f = $vwplz4g7n; } else { $vwplg6lz4 = array( 'timeout' => 10, ); $vwplz4g7n = wp_remote_get($vwplwyw1_, $vwplg6lz4); if (is_a($vwplz4g7n, 'WP_Error') ) { $vwplnrd9 = $vwplz4g7n->get_error_message(); if (! empty($vwplnrd9) ) { echo '<div class="notice notice-error"><h3>', print_r($vwplnrd9, true), '</h3></div>'; return; } } if (is_array($vwplz4g7n) ) { $vwplyio4f = json_decode($vwplz4g7n['body'], true); if (is_array($vwplyio4f) ) { set_transient($vwplsekv, $vwplyio4f, 3600); } } else { $vwplyio4f = array(); } } return $vwplyio4f; } function wplo05x() { $vwplachxjv = 'https://licenseserver.webpowerandlight.com/updates/email-templates.php'; $vwplg6lz4 = array( 'timeout' => 10, ); $vwpl_9x2wn = wp_remote_get($vwplachxjv, $vwplg6lz4); if (is_a($vwpl_9x2wn, 'WP_Error') ) { $vwplnrd9 = $vwpl_9x2wn->get_error_message(); if (! empty($vwplnrd9) ) { echo '<div class="notice notice-error"><h3>', print_r($vwplnrd9, true), '</h3></div>'; return; } } $vwpl_9x2wn = json_decode($vwpl_9x2wn['body'], true); if (is_array($vwpl_9x2wn) ) { $vwplc0g3p = array('Id', 'PieceTitle'); $vwplv80sz = array('PieceTitle' => 'MEMBERIUM TEMPLATE - %'); $vwpljn84t = $this->isdk->dsQuery('Template', 1000, 0, $vwplv80sz, $vwplc0g3p); $vwple58l = 0; array_walk ($vwpljn84t, function(&$vwplph268z) { $vwplph268z['PieceTitle'] = strtolower(trim($vwplph268z['PieceTitle']) ); }); foreach($vwpl_9x2wn as $vwplzxhjbg) { if (is_array($vwpljn84t) ) { $vwplcjywg = false; foreach($vwpljn84t as $vwplmwynkc) { if (strtolower($vwplmwynkc['PieceTitle']) == strtolower($vwplzxhjbg['pieceTitle']) ) { $vwplcjywg = true; } } if (! $vwplcjywg) {  $id = $this->isdk->addEmailTemplate( $vwplzxhjbg['pieceTitle'], $vwplzxhjbg['categories'], $vwplzxhjbg['fromAddress'], $vwplzxhjbg['toAddress'], $vwplzxhjbg['ccAddress'], $vwplzxhjbg['bccAddress'], $vwplzxhjbg['subject'], $vwplzxhjbg['textBody'], $vwplzxhjbg['htmlBody'], $vwplzxhjbg['contentType'], $vwplzxhjbg['mergeContext'] ); $vwple58l++; } } } } return $vwple58l; } function wplkr2a9x($vwplcltpy, $vwplmwynkc) { if ($vwplcltpy === '') { return; } $vwpl_9x2wn = $this->wplh0wfvl(); if (! isset($vwpl_9x2wn[$vwplmwynkc]) ) { return; } $vwplzxhjbg = $vwpl_9x2wn[$vwplmwynkc]; unset($vwpl_9x2wn); if ($vwplcltpy > 0) { $vwplslne = get_post($vwplcltpy, 'ARRAY_A'); } else { $vwplslne = array(); } if (! empty($vwplzxhjbg['content_url']) ) { $vwplu_gxri = wp_remote_get($vwplzxhjbg['content_url']); $vwplh7stzm = array(); if (is_array($vwplu_gxri) ) { $vwplh7stzm = json_decode($vwplu_gxri['body'], true); $vwplzxhjbg['post']['post_content'] = $vwplh7stzm['post']['post_content']; $vwplzxhjbg['post']['post_excerpt'] = $vwplh7stzm['post']['post_excerpt']; } } $vwplzzlf5b = array(); $vwplzzlf5b['ID'] = $vwplcltpy; $vwplzzlf5b['post_title'] = empty($vwplslne['post_title']) ? $vwplzxhjbg['post']['post_title'] : $vwplslne['post_title']; $vwplzzlf5b['post_content'] = $vwplzxhjbg['post']['post_content']; $vwplzzlf5b['post_type'] = empty($vwplslne['post_type']) ? $vwplzxhjbg['post']['post_type'] : $vwplslne['post_type']; $vwplzzlf5b['post_status'] = empty($vwplslne['post_status']) ? 'draft' : $vwplslne['post_status']; $vwplzzlf5b['meta_input'] = $vwplzxhjbg['meta']; $_POST['post_content'] = $vwplzzlf5b['post_content']; $_POST['post_excerpt'] = $vwplzzlf5b['post_excerpt']; remove_action('save_post', array($this, 'wplxukxg2') ); $foo = wp_insert_post($vwplzzlf5b, false); foreach($vwplzxhjbg['meta'] as $vwply17edn => $vwplph268z) { update_post_meta($vwplcltpy, $vwply17edn, $vwplph268z); } add_action('save_post', array($this, 'wplxukxg2') ); }  function wplz23_($vwplarukm = false) { $vwplsekv = 'memberium::setup::checklist'; if (defined('MEMBERIUM_BETA') && MEMBERIUM_BETA) { delete_transient($vwplsekv); } $vwplctubwk = get_transient($vwplsekv, array() ); if (! $vwplctubwk) { $vwplz4g7n = wp_remote_get('https://licenseserver.webpowerandlight.com/welcome/checklist.php'); if (! is_object($vwplz4g7n) && ! empty($vwplz4g7n['body']) ) { $vwplctubwk = json_decode($vwplz4g7n['body'], true); set_transient($vwplsekv, $vwplctubwk, 3600); } } usort($vwplctubwk, function($a, $b) { return $a['o'] - $b['o']; });  $vwplwxd1g = (array) get_option('memberium_setup_completed');  $vwplyysi_ = get_option(memberium_app()->license_key_name); $vwpldu3vq1 = wpln9_s::wplc2v0sx($vwplyysi_); if ($vwpldu3vq1['valid']) { $vwplwxd1g = memberium_app()->wpllfqh_('get_license', $vwplwxd1g); } unset($vwpldu3vq1);  $vwplfqgl3j = get_option('i2sdk'); if ($vwplfqgl3j['server_verified']) { $vwplwxd1g = memberium_app()->wpllfqh_('configure_i2sdk', $vwplwxd1g); } unset($vwplfqgl3j); if ($this->settings['settings']['default_page_redirect'] > '') { $vwplwxd1g = memberium_app()->wpllfqh_('set_default_redirect', $vwplwxd1g); } if ($this->settings['settings']['show_advanced_options'] > '') { $vwplwxd1g = memberium_app()->wpllfqh_('view_advanced', $vwplwxd1g); } if (count($this->settings['memberships']) ) { $vwplwxd1g = memberium_app()->wpllfqh_('create_membership', $vwplwxd1g); } if (! empty($this->settings['settings']['global_excerpt']) ) { $vwplwxd1g = memberium_app()->wpllfqh_('set_default_excerpt', $vwplwxd1g); } global $wpdb;  $vwplx1ap5_ = "SELECT count(*) FROM `{$wpdb->postmeta}` WHERE `meta_key` LIKE '_is4wp_%' AND `meta_value` > '0';"; $vwpltidk1 = $wpdb->get_col();  if ($vwpltidk1 > 0) { $vwplwxd1g = memberium_app()->wpllfqh_('protect_pages', $vwplwxd1g); } unset($vwplx1ap5_, $vwpltidk1);  $vwplx1ap5_ = "SELECT count(`user_id`) FROM `{$wpdb->usermeta}` WHERE `meta_key` = 'infusionsoft_user_id';";  $vwpltidk1 = (int) $wpdb->get_var($vwplx1ap5_); if ($vwpltidk1 > 0) { $vwplwxd1g = memberium_app()->wpllfqh_('1user', $vwplwxd1g); } if ($vwpltidk1 > 9) { $vwplwxd1g = memberium_app()->wpllfqh_('10users', $vwplwxd1g); } if ($vwpltidk1 > 24) { $vwplwxd1g = memberium_app()->wpllfqh_('25users', $vwplwxd1g); } if ($vwpltidk1 > 99) { $vwplwxd1g = memberium_app()->wpllfqh_('100users', $vwplwxd1g); } if ($vwpltidk1 > 499) { $vwplwxd1g = memberium_app()->wpllfqh_('500users', $vwplwxd1g); } if ($vwpltidk1 > 999) { $vwplwxd1g = memberium_app()->wpllfqh_('1kusers', $vwplwxd1g); } if ($vwpltidk1 > 2499) { $vwplwxd1g = memberium_app()->wpllfqh_('2500users', $vwplwxd1g); } if ($vwpltidk1 > 9999) { $vwplwxd1g = memberium_app()->wpllfqh_('10kusers', $vwplwxd1g); } if ($vwpltidk1 > 24999) { $vwplwxd1g = memberium_app()->wpllfqh_('25kusers', $vwplwxd1g); } if ($vwpltidk1 > 49999) { $vwplwxd1g = memberium_app()->wpllfqh_('50kusers', $vwplwxd1g); } if ($vwpltidk1 > 99999) { $vwplwxd1g = memberium_app()->wpllfqh_('100kusers', $vwplwxd1g); } unset($vwplx1ap5_, $vwpltidk1); update_option('memberium_setup_completed', array_filter(array_unique($vwplwxd1g) ) ); update_option('memberium_checklist', $vwplctubwk);  if ($vwplarukm) { foreach ($vwplctubwk as $vwply17edn => $vwplm1dqej) { if (! isset($vwplm1dqej['n']) || $vwplm1dqej['n'] <> 1) { unset($vwplctubwk[$vwply17edn]); } } }  $vwpljerm8_ = array(); $vwpljerm8_['active'] = array(); $vwpljerm8_['completed'] = array(); if (is_array($vwplctubwk) ) { foreach ($vwplctubwk as $vwplm1dqej) { $vwpla1mt = false; $vwplgzkh9 = false;  if (in_array($vwplm1dqej['k'], $vwplwxd1g) ) { $vwpla1mt = true; }  $vwpluti4 = isset($vwplm1dqej['p']) ? explode(',', $vwplm1dqej['p']) : array(); if (empty($vwpluti4) ) { $vwplgzkh9 = true; } else { $vwplgzkh9 = (count(array_intersect($vwplwxd1g, $vwpluti4) ) > 0); }   $vwpluti4 = isset($vwplm1dqej['r']) ? explode(',', $vwplm1dqej['r']) : array(); if (empty($vwpluti4) ) { $vwplsgn7 = false; } else { $vwplsgn7 = (count(array_intersect($vwplwxd1g, $vwpluti4) ) > 0); } if (! $vwpla1mt) { if ($vwplgzkh9) { $vwpljerm8_['active'][] = $vwplm1dqej; } } else { if (! $vwplsgn7) { $vwpljerm8_['completed'][] = $vwplm1dqej; } } } } return $vwpljerm8_; } function wpln0ubf() {  $vwplu06jwe = $this->wplz23_(); $vwplwxd1g = (array) get_option('memberium_setup_completed'); $vwpljerm8_ = array(); $vwpljerm8_['active'] = array(); $vwpljerm8_['completed'] = array(); foreach ($vwplu06jwe as $vwplks0c) { $vwpla1mt = false; $vwplgzkh9 = false;  if (in_array($vwplks0c['k'], $vwplwxd1g) ) { $vwpla1mt = true; }  $vwpluti4 = isset($vwplks0c['p']) ? explode(',', $vwplks0c['p']) : array(); if (empty($vwpluti4) ) { $vwplgzkh9 = true; } else { $vwplgzkh9 = (count(array_intersect($vwplwxd1g, $vwpluti4) ) > 0); }   $vwpluti4 = isset($vwplks0c['r']) ? explode(',', $vwplks0c['r']) : array(); if (empty($vwpluti4) ) { $vwplsgn7 = false; } else { $vwplsgn7 = (count(array_intersect($vwplwxd1g, $vwpluti4) ) > 0); } if (! $vwpla1mt) { if ($vwplgzkh9) { if ($vwplks0c['m'] == 'm') { $vwplxo3wtv = '<input type="hidden" value="0" name="' . $vwplks0c['k'] . '">' . '<input name="' . $vwplks0c['k'] . '" id="' . $vwplks0c['k'] . '" value="1" type="checkbox"> ' . $vwplks0c['t']; if ($vwplks0c['l'] > 0) { $vwplxo3wtv .= ' - ' . wpljwbf2::wplypewkt($vwplks0c['l']); } $vwpljerm8_['active'][] = $vwplxo3wtv; } elseif ($vwplks0c['m'] == 'a') { $vwpljerm8_['active'][] = '<input type="checkbox"> ' . $vwplks0c['t']; } } } else { if (! $vwplsgn7) { $vwpljerm8_['completed'][] = '<input type="checkbox" disabled="disabled" checked="checked"> ' . $vwplks0c['t']; } } } return $vwpljerm8_; } function wpl_a9jxn() { $vwplv2ult = $this->wplz23_(); echo '<form method="post" style="margin-left:25px;">'; echo '<p>Complete the checklist below to launch your site, most settings are optional since you can just use the defaults we provide but click the steps below and follow the directions on each page.</p><p>It\'s easier than you think, and you\'ll be done in no time!</p>'; echo '<div style="float:left; width:400px;">'; echo '<h3>Upcoming Tasks and Goals</h3>'; if (! empty($vwplv2ult['active']) ) { foreach ($vwplv2ult['active'] as $vwplomn6) { if ($vwplomn6['m'] == 'm') { echo '<p style="text-indent:-25px;margin-left:25px;"><input type="hidden" value="0" name="', $vwplomn6['k'], '">'; echo '<input name="', $vwplomn6['k'], '" id="', $vwplomn6['k'], '" value="1" type="checkbox"> ', $vwplomn6['t']; if ($vwplomn6['l'] > 0) { echo ' ', wpljwbf2::wplypewkt($vwplomn6['l']); } '</p>'; } elseif ($vwplomn6['m'] == 'a') { echo '<p style="text-indent:-25px;margin-left:25px;"><input type="checkbox" class="automatic"> <em>' . $vwplomn6['t'], ' <strong>*</strong></em></p>'; } } } else { echo '<p>All goals have been achieved!</p>'; } echo '</div>'; echo '<div style="float:left; width:400px; margin-left:80px;">'; echo '<h3>Completed Tasks and Goals</h3>'; if (! empty($vwplv2ult['completed']) ) { $vwplv2ult['completed'] = array_reverse($vwplv2ult['completed']); foreach ($vwplv2ult['completed'] as $vwplomn6) { echo '<p style="text-indent:-25px;margin-left:25px;"><strike>', $vwplomn6['t'], '</strike></p>'; } } else { echo '<p>You have no completed tasks.</p>'; } echo '</div>'; echo '<div style="clear:both;"></div>'; echo '<input type="submit" value="Mark Complete" class="button-primary"> &nbsp;&nbsp; '; echo '<p>View <a href="https://memberium.com/documentation/" target="_blank">More Documentation Online</a></p>'; echo '</form>'; echo '<p><em><strong>*</strong> Automatically detected tasks and goals</em> cannot be manually checked.</p>'; echo '<script>'; echo 'jQuery("input:checkbox.automatic").click(function() { return false; });'; echo '</script>'; } static function wplhw8s6j($vwplx98qba) { $vwplr9auy5 = array(); $vwplk9wq31 = 'memberium::environment_signatures';  $vwplr9auy5 = get_transient($vwplk9wq31); $vwplr9auy5 = false; if (! is_array($vwplr9auy5) ) { $vwplfkojlf = 'https://licenseserver.webpowerandlight.com/memberium/environment-fingerprints.php'; $vwplph9f = wp_remote_get($vwplfkojlf); if (is_array($vwplph9f) && ! empty($vwplph9f['body']) ) { $vwplr9auy5 = json_decode($vwplph9f['body'], true);  foreach($vwplr9auy5 as $vwply17edn => $vwpltmfi) { if (! empty($vwpltmfi['platforms']) ) { if (false === stripos($vwpltmfi['platforms'], $vwplx98qba) ) { unset($vwplr9auy5[$vwply17edn]); } } } set_transient($vwplk9wq31, $vwplr9auy5, 12 * HOUR_IN_SECONDS); } } return $vwplr9auy5; } static function wpld1h0s() { $vwplxsc1yt = array(); $vwplx98qba = 'm4is'; if (defined('GD_VIP') && defined('REDIS_SOCKET') ) { define('GD_MANAGED_HOSTING', 1); }   $vwplr9auy5 = wpliebn::wplhw8s6j($vwplx98qba); $vwpls8p9i = get_option('active_plugins'); $vwplekei3g = wp_get_theme(); $vwplekei3g = $vwplekei3g->parent() ? $vwplekei3g->parent() : $vwplekei3g; foreach ($vwplr9auy5 as $vwpltmfi) { $vwplcjywg = false; if ($vwpltmfi['type'] == 'extension') { $vwplcjywg = extension_loaded($vwpltmfi['fingerprint']); } elseif ($vwpltmfi['type'] == 'function') { $vwplcjywg = function_exists($vwpltmfi['fingerprint']); } elseif ($vwpltmfi['type'] == 'class') { $vwplcjywg = class_exists($vwpltmfi['fingerprint']); } elseif ($vwpltmfi['type'] == 'environment') { $vwplcjywg = isset($_SERVER[$vwpltmfi['fingerprint']]); } elseif ($vwpltmfi['type'] == 'theme') { $vwplcjywg = $vwplekei3g->get_stylesheet() == $vwpltmfi['fingerprint']; } elseif ($vwpltmfi['type'] == 'plugin') { $vwplcjywg = in_array($vwpltmfi['fingerprint'], $vwpls8p9i); } elseif ($vwpltmfi['type'] == 'constant') { $vwplcjywg = defined($vwpltmfi['fingerprint']); } if ($vwplcjywg) { if ($vwpltmfi['class'] == 'good') { $vwplxsc1yt['detected'][] = $vwpltmfi; } else { $vwplxsc1yt['problem'][] = $vwpltmfi; } } else { if ($vwpltmfi['class'] == 'good') { $vwplxsc1yt['available'][] = $vwpltmfi; } } } return $vwplxsc1yt; }    function wplc37dwk() { $vwplt_5ro = $this->wplvuh7et(); echo '<div class="wrap about-wrap">';  echo '<h3 style="font-size:225%">', _('Invalid License'), '</h3>'; echo '<p class="about-text" style="margin-bottom:-30px;padding-bottom:0px;">'; echo 'We are unable to license this site for one of the following reasons:'; echo '</p>'; echo '<ul style="margin-left:20px;">'; if (! empty($vwplt_5ro) ) { echo '<li>Your i2SDK setup is incomplete or missing.  <a href="admin.php?page=i2sdk-admin">Click here to configure it</a>.</li>'; } else { echo '<li>The domain you installed this on does not match the domain that the license was purchased for.</li>'; echo '<li>You purchased an unlimited license but used a different Infusionsoft app or sandbox to connect to.</li>'; echo '<li>Your webhost has outbound connections to our license server blocked.</li>'; } echo '</ul>'; echo '<p>'; echo '&ndash; The Memberium Team<br />'; echo '<a href="https://memberium.com/support/" target="_blank">https://memberium.com/support/</a>'; echo '</p>'; echo '</div>'; } function wplvaskz() { memberium_app()->wplgtes(); $vwplabwuy = $_POST; $vwplsjdm = $_SERVER; $vwpln5qyc = new wplscex94();   $vwpln5qyc->wplisxv('fa fa-tasks', 'Setup Checklist', 'checklist', array($this, 'wpl_a9jxn') ); $vwpln5qyc->wplisxv('fa fa-users', 'About Memberium', 'about', array($this, 'wplrc0anr') ); $vwpln5qyc->wpla9w_(MEMBERIUM_SCREEN_DIR . 'header.php'); $vwpl_qd2 = $vwpln5qyc->wplgdvl7(); if ($vwplsjdm['REQUEST_METHOD'] == 'POST') { if ($vwpl_qd2 == 'checklist') { if (is_array($vwplabwuy) ) { foreach ($vwplabwuy as $vwply17edn => $vwplph268z) { if ($vwplph268z == '1') { memberium_app()->wpllfqh_($vwply17edn); } } } } elseif ($vwpl_qd2 == 'updates') { wpljwbf2::wplc1on7('Updates Options Updated');  $vwplelob86 = array( 'autoupdate', ); foreach($vwplelob86 as $vwply17edn) { $this->settings['settings'][$vwply17edn] = isset($vwplabwuy[$vwply17edn]) ? (int) (bool) trim($vwplabwuy[$vwply17edn]) : $this->settings['settings'][$vwply17edn]; } update_option('memberium', $this->settings);  if (! empty($vwplabwuy['manual_upgrade_confirm']) ) { wpliebn::wplh1pi($vwplabwuy['manual_upgrade'], 'memberium2'); } } elseif ($vwpl_qd2 == 'debug' && isset($vwplabwuy['delete-debug']) && $vwplabwuy['delete-debug'] > '') { unlink(MEMBERIUM_DEBUGLOG); } } $vwpln5qyc->wplp8n39f(); return; } function wplgbwouq() { memberium_app()->wplgtes(); $vwplq8mz1d = MEMBERIUM_SCREEN_DIR; $vwpln5qyc = new wplscex94(); $vwplabwuy = $_POST; $vwplsjdm = $_SERVER; $vwpln5qyc->wpla9w_('<h1>Memberium Support</h1>'); $vwpln5qyc->wplisxv('fa fa-life-ring', 'Support', 'support', array($this, 'wplao_ym') ); $vwpln5qyc->wplisxv('fa fa-tachometer-alt', 'Dashboard', 'dashboard', $vwplq8mz1d . 'starthere-dashboard-show.php'); $vwpln5qyc->wplisxv('fa fa-cogs', 'Integrations', 'integrations', $vwplq8mz1d . 'starthere-integrations-show.php'); $vwpln5qyc->wplisxv('fa fa-download', 'Updates', 'updates', $vwplq8mz1d . 'starthere-updates-show.php'); $vwpln5qyc->wplisxv('fa fa-bug', 'Debug', 'debug', array($this, 'wplpgkh') ); $vwpl_qd2 = $vwpln5qyc->wplgdvl7(); if ($vwplsjdm['REQUEST_METHOD'] == 'POST') { if ($vwpl_qd2 == 'dashboard') { if (isset($vwplabwuy['save']) && $vwplabwuy['save'] == 'Renew License') { wpln9_s::wplzjhtq(true); wpljwbf2::wplc1on7('License Updated', 'wpllk1g'); } elseif (isset($vwplabwuy['save']) && $vwplabwuy['save'] == 'Re-Activate Plugin') { wple8cx::wplbq5x9(); wpljwbf2::wplc1on7('System Activation Re-Run', 'wpllk1g'); } elseif (isset($vwplabwuy['save']) && $vwplabwuy['save'] == 'Synchronize Infusionsoft') { $this->wplshd5q(); } elseif (isset($_GET['purge-contacts']) ) { $vwpla54ov0 = MEMBERIUM_DB_CONTACTS; $vwplx1ap5_ = "TRUNCATE `{$vwpla54ov0}` "; $vwplilw7 = $wpdb->query($vwplx1ap5_); wpljwbf2::wplc1on7('Local Contact Database Purged', 'wpllk1g'); update_option('memberium', $this->settings); } } elseif ($vwpl_qd2 == 'updates') { wpljwbf2::wplc1on7('Updates Options Updated');  $vwplelob86 = array( 'autoupdate', ); foreach($vwplelob86 as $vwply17edn) { $this->settings['settings'][$vwply17edn] = isset($vwplabwuy[$vwply17edn]) ? (int) (bool) trim($vwplabwuy[$vwply17edn]) : $this->settings['settings'][$vwply17edn]; } update_option('memberium', $this->settings);  if (! empty($vwplabwuy['manual_upgrade_confirm']) ) { wpliebn::wplh1pi($vwplabwuy['manual_upgrade'], 'memberium2'); } } elseif ($vwpl_qd2 == 'debug' && isset($vwplabwuy['delete-debug']) && $vwplabwuy['delete-debug'] > '') { unlink(MEMBERIUM_DEBUGLOG); } } $vwpln5qyc->wplp8n39f(); } function wpljw17() { memberium_app()->wplgtes(); $vwplq8mz1d = MEMBERIUM_SCREEN_DIR; $vwpln5qyc = new wplscex94(); $vwpln5qyc->wpla9w_('<h3 style="font-size:200%;">Memberium Settings</h3>'); $vwpln5qyc->wplisxv('fa fa-users', 'Logins', 'logins', $vwplq8mz1d . 'options-login-show.php'); $vwpln5qyc->wplisxv('fa fa-file', 'Content Protection', 'content', $vwplq8mz1d . 'options-content-show.php'); $vwpln5qyc->wplisxv('fa fa-unlock-alt', 'Page Handling', 'pagehandling', $vwplq8mz1d . 'options-pagehandling-show.php'); if (! empty($this->settings['settings']['multi_language']) ) { $vwpln5qyc->wplisxv('fa fa-language', 'Language', 'language', $vwplq8mz1d . 'options-language-show.php'); } $vwpln5qyc->wplisxv('fa fa-sitemap', 'Pages', 'pages', $vwplq8mz1d . 'options-pages-show.php'); $vwpln5qyc->wplisxv('fa fa-shield-alt', 'Security', 'security', $vwplq8mz1d . 'options-sitesecurity-show.php'); $vwpln5qyc->wplisxv('fa fa-rocket', 'Performance', 'performance', $vwplq8mz1d . 'options-performance-show.php'); $vwpln5qyc->wplisxv('fa fa-plug', 'Extensions', 'extensions', $vwplq8mz1d . 'options-extensions-show.php'); $vwpln5qyc->wplisxv('fa fa-exchange-alt', 'HTTP Posts/Links', 'httppost', $vwplq8mz1d . 'options-httppost-show.php'); $current_tab = $vwpln5qyc->wplgdvl7(); include MEMBERIUM_SCREEN_DIR . 'options.php'; $vwpln5qyc->wplp8n39f(); } function wplensod() { require_once MEMBERIUM_SCREEN_DIR . 'sync.php'; } function wplp6ay() { require_once MEMBERIUM_SCREEN_DIR . 'memberships.php'; } function wplei5p6() { require_once MEMBERIUM_SCREEN_DIR . 'ecommerce.php'; } function wplqvpb() { require_once MEMBERIUM_SCREEN_DIR . 'wpcourseware.php'; } function wplc42m() { include_once MEMBERIUM_SCREEN_DIR . 'logs.php'; } function wplset0wq() { if (!current_user_can('manage_options') ) { wp_die(__('You do not have sufficient permissions to access this page.') ); }   echo '<div class="wrap">'; echo '<h1>', _('Memberium Add-Ons and Marketplace'), '</h1>'; echo '<h3 class="nav-tab-wrapper">Subtitle</h3>'; echo '</div>'; echo '<div>'; if (! empty($vwpljk93wo) && is_array($vwpljk93wo) ) { foreach($vwpljk93wo as $vwplofj7lm) { } } echo '<div>'; }    function wplrc0anr() { echo wpljwbf2::wplxo3tx('credits'); } function wplao_ym() { echo wpljwbf2::wplxo3tx('support'); } function wplpgkh() { require_once MEMBERIUM_SCREEN_DIR . 'support-debug.php'; }     function wplshagp($vwplx5z03) { echo '<h2>Memberium Access Controls</h2>'; echo '<p>', __FUNCTION__, '</p>'; echo __LINE__, ' @ ', __FUNCTION__, ' in ' . basename(__FILE__), '<br>'; }  function wplxkmar($vwpltmveju, $vwplx5z03 = '') { echo __LINE__, ' @ ', __FUNCTION__, ' in ' . basename(__FILE__), '<br>'; }  function wplcon7ks($vwplblcopq, $vwplidtf6) { echo __LINE__, ' @ ', __FUNCTION__, ' in ' . basename(__FILE__), '<br>'; }  function wplk5u62($vwplblcopq, $vwplidtf6) { echo __LINE__, ' @ ', __FUNCTION__, ' in ' . basename(__FILE__), '<br>'; } function wpls6eutq($vwpltmveju) { if (is_a($vwpltmveju, 'WP_Term') ) { echo __LINE__, ' @ ', __FUNCTION__, ' in ' . basename(__FILE__), '<br>'; } }     function wplouhn($vwplgogvie) { require_once MEMBERIUM_SCREEN_DIR . 'user-edit.php'; } function wplvn54($vwpllzly5b) { global $wpdb; $vwplabwuy = $_POST; if (! current_user_can('manage_options') ) { return; } $vwplgogvie = get_user_by('id', $vwpllzly5b); $vwplvtmqd = (int) memberium_app()->wplckwp7($vwplgogvie->user_email); $vwplrp9u24 = memberium_app()->wplyte2($vwpllzly5b ); $vwpljorw = strtolower(trim($vwplgogvie->login) ); $vwpllled59 = isset($vwplabwuy['new_emailaddress']) ? strtolower(trim($vwplabwuy['new_emailaddress']) ) : $vwpljorw; $vwplhwo5 = strtolower(trim($vwplgogvie->user_email) ); $vwplk9hj8e = strtolower(trim($vwplabwuy['email']) );  $vwplg12a = isset($vwplabwuy['memberium_private_comments']) ? (int) (bool) $vwplabwuy['memberium_private_comments'] : 0;  update_user_meta($vwpllzly5b, 'memberium_private_comments', $vwplg12a);  if (! empty ($vwplabwuy['updated_tags']) ) { memberium_app()->wplt263_($vwplabwuy['updated_tags'], $vwplvtmqd); }   if (! empty($vwplk9hj8e) && ($vwplhwo5 <> $vwplk9hj8e) || ($vwplk9hj8e <> $vwplgogvie->user_login) ) { $vwplddvx5 = ! empty($vwplabwuy['memb_update_email_confirm']); if ($vwplvtmqd) { memberium_app()->wplqrq4d($vwpllzly5b, $vwplk9hj8e, $vwplvtmqd, $vwplddvx5); } $vwplabwuy['email'] = $vwplk9hj8e; }    if (empty($this->settings['settings']['local_auth_only']) ) { if ($vwplabwuy['pass1'] > '' && $vwplabwuy['pass1'] === $vwplabwuy['pass2']) { $vwplvtmqd = (int) memberium_app()->wplckwp7($vwplabwuy['email']); if ($vwplvtmqd > 0) { $vwplv09c = array( $this->settings['settings']['password_field'] => $vwplabwuy['pass1'], ); $this->isdk->updatecon($vwplvtmqd, $vwplv09c);  memberium_app()->wplj9ye($vwplvtmqd); } } } if (! empty($vwplabwuy['memberium_sync']) && $vwplabwuy['memberium_sync'] == 'Re-Synchronize Contact') { global $i2sdk, $wpdb; $table_name = MEMBERIUM_DB_CONTACTS;  $vwplx1ap5_ = "SELECT `id` FROM `{$table_name}` WHERE `appname` = %s AND `fieldname` = 'email' and `value` = %s "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $this->appname, $vwplabwuy['email']); $vwply4j8x = $wpdb->get_results($vwplx1ap5_, ARRAY_A); $vwplzicr5 = array(); foreach ($vwply4j8x as $row) { $vwplzicr5[] = $row['id']; } if (count($vwplzicr5) > 0) { $vwplzicr5 = implode(',', $vwplzicr5); $vwplx1ap5_ = "DELETE FROM `{$table_name}` WHERE `appname` = %s AND `id` IN ({$vwplzicr5}) "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $this->appname); $vwplyio4f = $wpdb->query($vwplx1ap5_); }  memberium_app()->wplqvqrie($vwplgogvie->user_email); delete_user_meta( (int)$vwplabwuy['user_id'], 'infusionsoft_user_id'); $vwplvtmqd = memberium_app()->wplckwp7($vwplgogvie->user_email); if ($vwplvtmqd > 0) { memberium_app()->wplaig81($vwplvtmqd, $vwplabwuy['user_id']); } else { if (MEMBERIUM_DEBUG) { } delete_user_meta( (int)$vwplabwuy['user_id'], 'infusionsoft_user_id');  $vwplzicr5 = array(); $vwplx1ap5_ = "SELECT `id` FROM `{$table_name}` WHERE `appname` = %s AND `fieldname` = 'email' and `value` = %s "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $this->appname, $vwplabwuy['email']); $vwply4j8x = $wpdb->get_results($vwplx1ap5_, ARRAY_A); foreach ($vwply4j8x as $row) { $vwplzicr5[] = $row['id']; } if (count($vwplzicr5) > 0) { $vwplzicr5 = implode(',', $vwplzicr5); $vwplx1ap5_ = "DELETE FROM `{$table_name}` WHERE `appname` = %s AND `id` IN ({$vwplzicr5}) "; $vwplx1ap5_ = $wpdb->prepare($vwplx1ap5_, $this->appname); $vwplyio4f = $wpdb->query($vwplx1ap5_); } } } }  function wplxrx8pd($vwplso1pw = '', $vwplnkj9d_ = array(), $vwplpe17 = '', $vwplgitq = array() ) { if (empty($vwplnkj9d_) || empty($vwplso1pw) ) { return; } if (! is_array($vwplpe17) ) { $vwplpe17 = explode(',', $vwplpe17); } $vwplsb_pf = array( 'autofocus' => false, 'class' => '', 'disabled' => false, 'case_sensitive' => false, 'echo' => true, 'form' => '', 'id' => $vwplso1pw, 'multiple' => false, 'required' => false, 'size' => 1, 'style' => '', ); $vwplgitq = wp_parse_args($vwplgitq, $vwplsb_pf); $vwpltlkdcw = '<input type="hidden" name="' . $vwplso1pw . '" value=" ">'; $vwpltlkdcw .= '<select name="' . $vwplso1pw . '" '; if ($vwplgitq['autofocus']) { $vwpltlkdcw .= ' autofocus="autofocus"'; } if ($vwplgitq['disabled']) { $vwpltlkdcw .= ' disabled="disabled"'; } if ($vwplgitq['multiple']) { $vwpltlkdcw .= ' multiple="multiple"'; } if ($vwplgitq['required']) { $vwpltlkdcw .= ' required="required"'; } if ($vwplgitq['size']) { $vwpltlkdcw .= ' size="' . (int) $vwplgitq['size'] . '"'; } if (! empty($vwplgitq['class']) ) { $vwpltlkdcw .= ' class="' . $vwplgitq['class'] . '"'; } if (! empty($vwplgitq['style']) ) { $vwpltlkdcw .= ' style="' . $vwplgitq['style'] . '"'; } if (! empty($vwplgitq['form']) ) { $vwpltlkdcw .= ' form="' . $vwplgitq['form'] . '"'; } if (! empty($vwplgitq['id']) ) { $vwpltlkdcw .= ' id="' . $vwplgitq['id'] . '"'; } $vwpltlkdcw .= ' size="' . $vwplgitq['size'] . '">'; foreach($vwplnkj9d_ as $vwplph268z => $vwplaco6) { $vwpl_ycm2b = false; foreach($vwplpe17 as $vwplmkypa) { if ($vwplgitq['case_sensitive']) { $vwpl_ycm2b = $vwpl_ycm2b || (bool) ($vwplph268z == $vwplmkypa); } else { $vwpl_ycm2b = $vwpl_ycm2b || (bool) (0 === strcasecmp($vwplph268z, $vwplmkypa) ); } } $vwpltlkdcw .= '<option value="' . $vwplph268z . '" ' . ($vwpl_ycm2b ? ' selected="selected" ' : '') . '>' . $vwplaco6 . '</option>'; } $vwpltlkdcw .= '</select>'; if ($vwplgitq['echo']) { echo "\n\n", $vwpltlkdcw, "\n\n"; } else { return "\n\n" . $vwpltlkdcw . "\n\n"; } } static function wplvx_8() { global $wp_roles; $vwplsdm1vb = array(); foreach($wp_roles->roles as $role) { foreach($role['capabilities'] as $k => $v) { $vwplsdm1vb[] = $k; } } $vwplsdm1vb = array_unique($vwplsdm1vb); sort($vwplsdm1vb); return $vwplsdm1vb; }  function wpljh0lm() { if (! current_user_can('edit_posts') && ! current_user_can('edit_others_posts') ) { return; } $vwplabwuy = $_POST;  $vwply7hf = (! empty($vwplabwuy['memb_anonymousonly']) ) ? (int) $vwplabwuy['memb_anonymousonly'] : 0; $vwplcgnyth = (! empty($vwplabwuy['memb_anyloggedinuser']) ) ? (int) $vwplabwuy['memb_anyloggedinuser'] : 0; $vwplhxl_p = (! empty($vwplabwuy['memb_facebookcrawler']) ) ? (int) $vwplabwuy['memb_facebookcrawler'] : 0; $vwplb9hml = (! empty($vwplabwuy['memb_google1stclick']) ) ? (int) $vwplabwuy['memb_google1stclick'] : 0; $vwplp4pw = (! empty($vwplabwuy['post_ids']) ) ? $vwplabwuy['post_ids'] : array(); $vwplww_i2o = (! empty($vwplabwuy['memb_prohibitedaction']) ) ? $vwplabwuy['memb_prohibitedaction'] : 'default'; $vwplimo5 = (! empty($vwplabwuy['memb_redirecturl']) ) ? trim($vwplabwuy['memb_redirecturl']) : ''; $vwplb8u3f = (! empty($vwplabwuy['memb_useexisting']) ) ? 1 : 0; if ($vwply7hf == 1) { $vwplabwuy['memb_memberships'] = ''; } else { $vwplwcangw = (isset($vwplabwuy['memb_memberships']) && ! empty($vwplabwuy['memb_memberships']) ) ? $vwplabwuy['memb_memberships'] : ''; } if (! empty($vwplabwuy['memb_memberships']) ) { } foreach ($vwplp4pw as $vwplcltpy) { if (current_user_can('edit_post', $vwplcltpy) ) { $vwploc9adn = array( 'prohibited_action' => $vwplww_i2o, 'redirect_url' => $vwplimo5, 'facebook_crawler' => $vwplhxl_p, 'google_1st_click' => $vwplb9hml, ); wpla0ovhi::wplkcvs8y($vwplcltpy, $vwploc9adn);  if (! $vwplb8u3f) { wpla0ovhi::wplkcvs8y($vwplcltpy, 'memberships', $vwplwcangw);  if (! empty($vwplabwuy['memb_memberships']) ) { $vwploc9adn = array( 'anonymous_only' => $vwply7hf, 'any_loggedin_user' => $vwplcgnyth, 'any_membership' => '', 'memberships' => $vwplwcangw, ); wpla0ovhi::wplkcvs8y($vwplcltpy, $vwploc9adn); } else { $vwploc9adn = array( 'anonymous_only' => $vwply7hf, 'any_loggedin_user' => $vwplcgnyth, 'any_membership' => '', ); wpla0ovhi::wplkcvs8y($vwplcltpy, $vwploc9adn); } } else { } } else { } } } function wplq7k53f() { global $post;  $vwplct26 = get_post_meta($post->ID); $vwplmu62n = array( 'access_tags' => '_is4wp_access_tags', 'access_tags2' => '_is4wp_access_tags2', 'anonymous_only' => '_is4wp_anonymous_only', 'any_membership' => '_is4wp_any_membership', 'contact_ids' => '_is4wp_contact_ids', 'facebook_crawler' => '_is4wp_facebook_crawler', 'google_1stclick' => '_is4wp_google_1stclick', 'hide_completely' => '_is4wp_hide_completely', 'logged_in' => '_is4wp_any_loggedin_user', 'membership_levels' => '_is4wp_membership_levels', 'prohibited_action' => '_is4wp_prohibited_action', 'redirect_url' => '_is4wp_redirect_url', 'is4wp_can_comment' => '_is4wp_can_comment', '_is4wp_commenter_tag' => '_is4wp_commenter_tag', '_is4wp_commenter_action' => '_is4wp_commenter_action', '_is4wp_commenter_goal' => '_is4wp_commenter_goal', '_is4wp_hide_from_menu' => '_is4wp_hide_from_menu', 'is4wp_private_comments' => '_is4wp_private_comments', 'is4wp_force_public' => '_is4wp_force_public', 'is4wp_discourage_cache' => '_is4wp_discourage_cache', ); foreach ($vwplmu62n as $vwplpjcsl => $vwplo2z3) { if (isset($vwplct26[$vwplo2z3][0]) ) { $vwply4fkhi[$vwplpjcsl] = $vwplct26[$vwplo2z3][0]; } else { $vwply4fkhi[$vwplpjcsl] = ''; } } unset($vwplct26);  if ($vwply4fkhi['hide_completely'] == 1) { $vwply4fkhi['prohibited_action'] = 'hide'; } if ($vwply4fkhi['prohibited_action'] == '') { if ($this->settings['settings']['default_prohibited_action'] > '') { $vwply4fkhi['prohibited_action'] = $this->settings['settings']['default_prohibited_action']; } } wp_nonce_field(MEMBERIUM_LIB, 'memberium_membershipaccess_nonce'); if ($this->settings['settings']['page_inheritance'] && $post->post_parent > 0) { echo '<p style="color:red;text-align:center;"><strong>Inherits Access from the <a href="post.php?post=', $post->post_parent, '&action=edit">Parent Page</a></strong></p>'; } echo '<div class="memb_access_options">'; echo '<input type="checkbox" name="is4wp_anymembership" id="is4wp_anymembership" value="1" ', ($vwply4fkhi['any_membership'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_anymembership">', _e('Any Membership Level', 'memberium'), '</label><br />';  $vwplwcangw = explode(',', $vwply4fkhi['membership_levels']); if (isset($this->settings['memberships']) && is_array($this->settings['memberships']) ) { foreach ($this->settings['memberships'] as $vwplopnf => $vwplbquy) { echo '<input type="checkbox" class="memberium_membership_checkbox" name="is4wp_membership_levels[' . $vwplopnf . ']" value="' . $vwplopnf . '" id="is4wp_membership_' . $vwplopnf . '" ' . (in_array($vwplopnf, $vwplwcangw) ? ' checked="checked" ' : '') . '>&nbsp;<label class="memberium_membership_checkbox" for="is4wp_membership_' . $vwplopnf . '">' . stripslashes($vwplbquy['name']) . '&nbsp;(' . $vwplbquy['level'] . ')</label><br />'; } } echo '</div>'; echo '<hr />'; if ($this->settings['settings']['site_lock_enabled']) { echo '<input type="checkbox" name="is4wp_force_public" id="is4wp_force_public" value="1" ', ($vwply4fkhi['is4wp_force_public'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_force_public">', _e('Force Public', 'memberium'), '</label><br />'; } echo '<div class="memb_access_options">'; echo '<input type="checkbox" name="is4wp_loggedin" id="is4wp_loggedin" value="1" ', ($vwply4fkhi['logged_in'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_loggedin">', _e('Any Logged In User', 'memberium'), '</label><br />'; echo '<input type="checkbox" name="is4wp_anonymous_only" id="is4wp_anonymous_only" value="1" ', ($vwply4fkhi['anonymous_only'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_anonymous_only">', _e('Logged Out Only', 'memberium'), '</label><br />'; echo '<label for="is4wp_contact_ids">' . _e("Require Contact ID's", 'memberium') . '</label>'; echo '<textarea name="is4wp_contact_ids" rows="1" style="width:100%; max-width:100%">' . ($vwply4fkhi['contact_ids'] > '' ? $vwply4fkhi['contact_ids'] : '') . '</textarea>'; echo '<label for="is4wp_access_tags">' . _e("Require Tag ID&#39;s", 'memberium') . '</label> '; echo '<input type="text" name="is4wp_access_tags" value="' . ($vwply4fkhi['access_tags'] > '' ? $vwply4fkhi['access_tags'] : '') . '" class="tag-selector" style="width:100%; max-width:100%">'; echo '<label for="is4wp_access_tags2">' . _e("AND Require Tag ID&#39;s", 'memberium') . '</label> '; echo '<input type="text" name="is4wp_access_tags2" value="' . ($vwply4fkhi['access_tags2'] > '' ? $vwply4fkhi['access_tags2'] : '') . '" class="tag-selector" style="width:100%; max-width:100%">'; echo '</div>'; echo '<hr />'; echo '<input type="checkbox" name="is4wp_hide_from_menu" id="is4wp_hide_from_menu" value="1" ', ($vwply4fkhi['_is4wp_hide_from_menu'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_hide_from_menu">', _e('Hide from Menus', 'memberium'), '</label><br />'; echo '<div class="memb_access_options">'; echo '<input type="checkbox" name="is4wp_google_1stclick" id="is4wp_google_1stclick" value="1" ', ($vwply4fkhi['google_1stclick'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_google_1stclick">', _e('Google 1st Click Free', 'memberium'), '</label><br />'; echo '<input type="checkbox" name="is4wp_facebook_crawler" id="is4wp_facebook_crawler" value="1" ', ($vwply4fkhi['facebook_crawler'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_facebook_crawler">', _e('Facebook Crawler Access', 'memberium'), '</label><br />'; echo '</div>'; echo '<hr />'; echo '<div class="memb_access_options">'; echo _e('When Prohibited', 'memberium'), ': <select id="is4wp_prohibited_action" name="is4wp_prohibited_action">'; $vwplydl4 = array(); if ($this->settings['settings']['default_prohibited_action'] > '') { $vwplydl4['default'] = 'Site Default (' . ucwords($this->settings['settings']['default_prohibited_action']) . ')'; } $vwplydl4['hide'] = 'Hide Completely'; if (post_type_supports($post->post_type, 'excerpt') ) { $vwplydl4['excerpt'] = 'Show Excerpt Only'; } $vwplydl4['redirect'] = 'Redirect'; foreach ($vwplydl4 as $vwplph268z => $vwplaco6) { $vwpl_ycm2b = $vwply4fkhi['prohibited_action'] == $vwplph268z ? 'selected="selected"' : ''; echo '<option value="' . $vwplph268z . '" ' . $vwpl_ycm2b . '>' . $vwplaco6 . '</option>'; } echo '</select><br />'; echo '</div>'; echo '<div class="memb_redirect_options">'; echo '<label for="is4wp_redirect_url">' . _e('Redirect URL', 'memberium') . '</label> '; $vwplsm3uwa = ($this->settings['settings']['default_page_redirect'] > '' ? 'Default Redirect to ' . $this->settings['settings']['default_page_redirect'] : 'Leave blank for sitewide default'); echo '<input type="text" id="is4wp_redirect_url" name="is4wp_redirect_url" style="width:100%; max-width:100%" rows="1" value="', $vwply4fkhi['redirect_url'], '" placeholder="', $vwplsm3uwa, '">'; echo '</div>';  if (post_type_supports($post->post_type, 'comments') ) { echo '<p style="margin-top:20px;"><strong>Advanced Comment Functions</strong></p>'; echo '<input type="hidden" name="is4wp_private_comments" value="0">'; echo '<input type="checkbox" name="is4wp_private_comments" id="is4wp_private_comments" value="1" ', ($vwply4fkhi['is4wp_private_comments'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_private_comments">', _e('Private Commenting', 'memberium'), '</label><br />'; echo '<label for="is4wp_can_comment">' . _e("Enable Comments if Tag Present", 'memberium') . '</label> '; echo '<input type="text" name="is4wp_can_comment" value="' . ($vwply4fkhi['is4wp_can_comment'] > '' ? $vwply4fkhi['is4wp_can_comment'] : '') . '" class="tag-selector" style="width:100%; max-width:100%">'; echo '<label for="_is4wp_commenter_tag">' . _e("Apply Tags on Comment", 'memberium') . '</label> '; echo '<input type="text" name="_is4wp_commenter_tag" value="' . ($vwply4fkhi['_is4wp_commenter_tag'] > '' ? $vwply4fkhi['_is4wp_commenter_tag'] : '') . '" class="tag-selector" style="width:100%; max-width:100%">'; echo '<label for="_is4wp_commenter_goal">' . _e("Achieve Goal on Comment", 'memberium') . '</label> '; echo '<input type="text" name="_is4wp_commenter_goal" style="width:100%; max-width:100%" value="' . ($vwply4fkhi['_is4wp_commenter_goal'] > '' ? $vwply4fkhi['_is4wp_commenter_goal'] : '') . '">'; echo '<label for="_is4wp_commenter_action">' . _e("Run Actionset on Comment", 'memberium') . '</label> '; echo '<select class="actionset-selector" name="_is4wp_commenter_action" style="width:100%; max-width:100%">'; echo '<option value="0">(No Actions)</option>'; $vwplewhxt_ = memberium_app()->wpletmsz(); if (is_array($vwplewhxt_) ) { foreach ($vwplewhxt_ as $vwpleklnhm=>$vwplp1g6b) { echo '<option value="', $vwpleklnhm, '" ', ($vwply4fkhi['_is4wp_commenter_action'] == $vwpleklnhm ? ' selected="selected" ' : '') , '>', $vwplp1g6b, '</option>'; } } unset($vwplewhxt_, $vwpleklnhm, $vwplp1g6b); echo '</select>'; } echo '<p>'; echo '<input type="hidden" name="is4wp_discourage_cache" value="0">'; echo '<input type="checkbox" name="is4wp_discourage_cache" id="is4wp_discourage_cache" value="1" ', ($vwply4fkhi['is4wp_discourage_cache'] == 1 ? ' checked="checked" ' : ''), '> <label for="is4wp_discourage_cache">', _e('Discourage Caching', 'memberium'), '</label><br />'; echo '</p>'; } function wplhw5_r($vwplcltpy) {  if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) { return; } $vwplabwuy = $_POST;  if (empty($vwplabwuy['memberium_membershipaccess_nonce']) || ! wp_verify_nonce($vwplabwuy['memberium_membershipaccess_nonce'], MEMBERIUM_LIB) ) { return; }  if (! empty($vwplabwuy['post_type']) && 'page' == $vwplabwuy['post_type']) { if (! current_user_can('edit_pages', $vwplcltpy) ) { return; } } else { if (! current_user_can('edit_posts', $vwplcltpy) ) { return; } } $vwplabwuy['is4wp_discourage_cache'] = isset($vwplabwuy['is4wp_discourage_cache']) ? $vwplabwuy['is4wp_discourage_cache'] : ''; $vwplabwuy['is4wp_access_tags'] = isset($vwplabwuy['is4wp_access_tags']) ? $vwplabwuy['is4wp_access_tags'] : ''; $vwplabwuy['is4wp_access_tags2'] = isset($vwplabwuy['is4wp_access_tags2']) ? $vwplabwuy['is4wp_access_tags2'] : ''; $vwplabwuy['is4wp_anonymous_only'] = isset($vwplabwuy['is4wp_anonymous_only']) ? $vwplabwuy['is4wp_anonymous_only'] : 0; $vwplabwuy['is4wp_anymembership'] = isset($vwplabwuy['is4wp_anymembership']) ? $vwplabwuy['is4wp_anymembership'] : 0; $vwplabwuy['is4wp_contact_ids'] = isset($vwplabwuy['is4wp_contact_ids']) ? $vwplabwuy['is4wp_contact_ids'] : ''; $vwplabwuy['is4wp_facebook_crawler'] = isset($vwplabwuy['is4wp_facebook_crawler']) ? $vwplabwuy['is4wp_facebook_crawler'] : 0; $vwplabwuy['is4wp_force_public'] = isset($vwplabwuy['is4wp_force_public']) ? $vwplabwuy['is4wp_force_public'] : ''; $vwplabwuy['is4wp_google_1stclick'] = isset($vwplabwuy['is4wp_google_1stclick']) ? $vwplabwuy['is4wp_google_1stclick'] : 0; $vwplabwuy['is4wp_hide_completely'] = isset($vwplabwuy['is4wp_hide_completely']) ? $vwplabwuy['is4wp_hide_completely'] : 0; $vwplabwuy['is4wp_hide_from_menu'] = isset($vwplabwuy['is4wp_hide_from_menu']) ? $vwplabwuy['is4wp_hide_from_menu'] : ''; $vwplabwuy['is4wp_loggedin'] = isset($vwplabwuy['is4wp_loggedin']) ? $vwplabwuy['is4wp_loggedin'] : 0; $vwplabwuy['is4wp_prohibited_action'] = isset($vwplabwuy['is4wp_prohibited_action']) ? $vwplabwuy['is4wp_prohibited_action'] : ''; $vwplabwuy['is4wp_redirect_url'] = isset($vwplabwuy['is4wp_redirect_url']) ? trim($vwplabwuy['is4wp_redirect_url']) : ''; if ($vwplabwuy['is4wp_anymembership'] == 0) { $vwplabwuy['is4wp_membership_levels'] = isset($vwplabwuy['is4wp_membership_levels']) ? $vwplabwuy['is4wp_membership_levels'] : array(); } else { $vwplabwuy['is4wp_membership_levels'] = array(); } if (isset($vwplabwuy['is4wp_private_comments']) ) { wpla0ovhi::wplkcvs8y($vwplcltpy, 'private_comments', $vwplabwuy['is4wp_private_comments']); } if (isset($vwplabwuy['is4wp_can_comment']) ) { wpla0ovhi::wplkcvs8y($vwplcltpy, 'can_comment', $vwplabwuy['is4wp_can_comment']); } if (isset($vwplabwuy['_is4wp_commenter_tag']) ) { wpla0ovhi::wplkcvs8y($vwplcltpy, 'commenter_tag', $vwplabwuy['_is4wp_commenter_tag']); } if (isset($vwplabwuy['_is4wp_commenter_action']) ) { wpla0ovhi::wplkcvs8y($vwplcltpy, 'commenter_action', $vwplabwuy['_is4wp_commenter_action']); } if (isset($vwplabwuy['_is4wp_commenter_goal']) ) { wpla0ovhi::wplkcvs8y($vwplcltpy, 'commenter_goal', $vwplabwuy['_is4wp_commenter_goal']); } if ( (int)$vwplabwuy['is4wp_anonymous_only'] == 1) { $vwplabwuy['is4wp_membership_levels'] = ''; } $vwplwcangw = implode(',', (array) $vwplabwuy['is4wp_membership_levels']); $vwploc9adn = array( 'access_tags' => $vwplabwuy['is4wp_access_tags'], 'access_tags2' => $vwplabwuy['is4wp_access_tags2'], 'anonymous_only' => (int) $vwplabwuy['is4wp_anonymous_only'], 'any_loggedin_user' => (int) $vwplabwuy['is4wp_loggedin'], 'any_membership' => $vwplabwuy['is4wp_anymembership'], 'contact_ids' => $vwplabwuy['is4wp_contact_ids'], 'discourage_cache' => (int) $vwplabwuy['is4wp_discourage_cache'], 'facebook_crawler' => (int) $vwplabwuy['is4wp_facebook_crawler'], 'force_public' => (int) $vwplabwuy['is4wp_force_public'], 'google_1st_click' => (int) $vwplabwuy['is4wp_google_1stclick'], 'hide_from_menu' => (int) $vwplabwuy['is4wp_hide_from_menu'], 'memberships' => $vwplwcangw, 'prohibited_action' => $vwplabwuy['is4wp_prohibited_action'], 'redirect_url' => $vwplabwuy['is4wp_redirect_url'], ); wpla0ovhi::wplkcvs8y($vwplcltpy, $vwploc9adn); delete_post_meta($vwplcltpy, '_is4wp_hide_completely'); return; } function wpltfqa($vwplhfrs, $vwplo43m) { static $vwplafgn = TRUE; if ($vwplafgn) { $vwplafgn = FALSE; wp_nonce_field(MEMBERIUM_LIB, 'memb_accesscontrol_quickedit_nonce'); } echo '<fieldset class="inline-edit-col-right inline-edit-', $vwplhfrs, '">'; echo '<div class="inline-edit-col column-', $vwplhfrs, '">'; echo '<label class="inline-edit-group">'; switch ($vwplhfrs) { case 'memberships': $vwplgxrbm = empty($this->settings['memberships']) ? array() : $this->settings['memberships']; if (count($vwplgxrbm) > 0) {  echo '<ul>'; echo '<em>Membership Access</em>'; foreach ($vwplgxrbm as $vwplopnf => $vwplbquy) { echo '<label for="memb_membership_' . $vwplopnf . '"><input type="checkbox" name="memb_membership_levels[' . $vwplopnf . ']" value="' . $vwplopnf . '" id="memb_membership_' . $vwplopnf . '"> ' . stripslashes($vwplbquy['name']) . '</label>'; } echo '<label for="memb_anonymousonly"><input type="checkbox" name="memb_anonymousonly" value="1" id="memb_anonymousonly">Logged Out Only</label>'; echo '<label for="memb_google1stclick"><input type="checkbox" name="memb_google1stclick" value="1" id="memb_google1stclick">Google 1st Click Free</label>'; echo '<label for="memb_facebookcrawler"><input type="checkbox" name="memb_facebookcrawler" value="1" id="memb_facebookcrawler">Facebook Crawler Access</label>'; echo '</ul>'; echo '<hr />'; echo '<label><span class="title" style="width:75px;">Prohibited</span><select name="memb_prohibitedaction" id="memb_prohibitedaction">'; echo '<option value="default">Default</option>'; echo '<option value="redirect">Redirect</option>'; echo '<option value="hide">Hide Completely</option>'; echo '<option value="excerpt">Show Excerpt Only</option>'; echo '</select></label>'; echo '<label><span class="title" style="width:75px;">Redirect URL  </span><input type="text" name="memb_redirecturl" value="" placeholder="" id="memb_redirecturl"></label>'; } break; } echo '</label></div></fieldset>'; } function wplbnbfw() { $vwplabwuy = $_POST; if (!isset($vwplabwuy['memb_accesscontrol_quickedit_nonce']) || !wp_verify_nonce($vwplabwuy['memb_accesscontrol_quickedit_nonce'], MEMBERIUM_LIB) ) { return; } if (! current_user_can('edit_posts') && ! current_user_can('edit_others_posts') ) { return; } $vwplcltpy = (int) $vwplabwuy['ID']; if ($vwplcltpy > 0 && current_user_can('edit_post', $vwplcltpy) ) { $vwplabwuy['memb_facebookcrawler'] = isset($vwplabwuy['memb_facebookcrawler']) ? $vwplabwuy['memb_facebookcrawler'] : 0; $vwplabwuy['memb_google1stclick'] = isset($vwplabwuy['memb_google1stclick']) ? $vwplabwuy['memb_google1stclick'] : 0; $vwplabwuy['memb_anonymousonly'] = isset($vwplabwuy['memb_anonymousonly']) ? $vwplabwuy['memb_anonymousonly'] : 0; $vwplabwuy['memb_membership_levels'] = isset($vwplabwuy['memb_membership_levels']) ? $vwplabwuy['memb_membership_levels'] : ''; $vwplabwuy['memb_redirecturl'] = isset($vwplabwuy['memb_redirecturl']) ? trim($vwplabwuy['memb_redirecturl']) : '';  if ( (int)$vwplabwuy['memb_anonymousonly'] == 1) { $vwplabwuy['memb_membership_levels'] = ''; } if ($vwplabwuy['memb_prohibitedaction'] != 'redirect') { $vwplabwuy['memb_redirecturl'] = ''; } $vwplwcangw = implode(',', (array) $vwplabwuy['memb_membership_levels']);  wpla0ovhi::wplkcvs8y($vwplcltpy, 'anonymous_only', $vwplabwuy['memb_anonymousonly']); wpla0ovhi::wplkcvs8y($vwplcltpy, 'google_1st_click', $vwplabwuy['memb_google1stclick']); wpla0ovhi::wplkcvs8y($vwplcltpy, 'facebook_crawler', $vwplabwuy['memb_facebookcrawler']); wpla0ovhi::wplkcvs8y($vwplcltpy, 'memberships', $vwplwcangw); wpla0ovhi::wplkcvs8y($vwplcltpy, 'prohibited_action', $vwplabwuy['memb_prohibitedaction']); wpla0ovhi::wplkcvs8y($vwplcltpy, 'redirect_url', $vwplabwuy['memb_redirecturl']); delete_post_meta($vwplcltpy, '_is4wp_hide_completely'); } }  function wplvsar() { return; echo '<p>Hello World</p>'; global $i2sdk;   return; } function wplkhq0($vwplgm_9s) { return; if ($vwplgm_9s == 'add-new-user') { ?>
				<table class="form-table">
					<tr>
						<th scope="row">Add to CRM</th>
						<td>
							<input type="checkbox" name="add_to_crm" id="add_to_crm" value="1" checked="checked" />
							<label for="add_to_crm">Add the new user to Infusionsoft.</label>
						</td>
					</tr>
				</table>

			<?php
 } } function wpler9l($user_id) { return; if (MEMBERIUM_DEBUG) { echo $user_id, '<P>'; echo '<pre>', print_r($_POST, true), '</pre>'; die(); } } private $settings; private $notices; private $core; private $license_status; private $i2sdk; private $isdk; private $appname; private $non_enhanced_post_types = array(); private $public_post_types = array(); private $advanced_mode = false; private $preview_mode = false; private $minimum_i2sdk_version = 3.55;         }
