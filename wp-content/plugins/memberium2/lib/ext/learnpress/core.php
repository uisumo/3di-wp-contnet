<?php
 if ( !defined( 'ABSPATH' ) ) { die(); } final class wplawndqm { function wplla0m5k($vwplexo_) { $vwplexo_[] = 'lp_order'; return $vwplexo_; } function wple4mqf($vwplc0nobe = false) { global $wpdb; static $vwploya1is = array(); if (empty($vwplc0nobe['memb_db_fields']['groups']) ) { return; } $vwpllzly5b = isset($vwplc0nobe['memb_user']['Id']) ? $vwplc0nobe['memb_user']['Id'] : 0; $vwplwc60 = $wpdb->posts; $vwplz39do = $wpdb->postmeta; $vwplx1ap5_ = "SELECT ID, meta_value FROM {$vwplwc60}, {$vwplz39do} WHERE post_status = 'publish' AND post_type = 'lp_course' AND  post_id = ID AND meta_key = '_is4wp_learndash_autoenroll' AND meta_value > '' "; $vwplob9i24 = $wpdb->get_results( $vwplx1ap5_, ARRAY_A ); if (empty($vwplob9i24) ) { return; } $vwplvgobd = $this->wplr1aio6( $vwpllzly5b ); foreach ( $vwplob9i24 as $vwplzzlf5b ) { $vwplcltpy = $vwplzzlf5b['ID']; $vwplbaur9 = in_array($vwplcltpy, $vwplvgobd) || in_array($vwplcltpy, $vwploya1is); $vwplmdjuoa = trim($vwplzzlf5b['meta_value'], ','); if ( ! $vwplbaur9 ) { if ( wplj_l2t::wpl_n2s9($vwplmdjuoa, $vwplc0nobe) ) { $this->wplobls( $vwpllzly5b, $vwplcltpy ); $vwploya1is[] = $vwplcltpy; } } } } function wplobls($vwpllzly5b, $vwplvbkdn) { if ( empty($vwplvbkdn) || empty($vwpllzly5b) ) { return false; } $vwpldgfx = new lp_user($vwpllzly5b); $vwplf4y5 = learn_press_create_order(null); $vwplxl4jet = $vwplf4y5->get_id(); $vwplf4y5->set_user_id($vwpllzly5b); $vwplf4y5->save(); learn_press_add_order_item( $vwplxl4jet, $vwplvbkdn ); learn_press_update_order_status( $vwplxl4jet, 'lp-completed' ); $vwpldgfx->enroll($vwplvbkdn, $vwplxl4jet); return $vwplxl4jet; } function wplr1aio6( $vwpllzly5b ) { if (empty($vwpllzly5b) ) { return array(); } $vwpldgfx = new lp_user( $vwpllzly5b ); $vwpljrgj8 = $vwpldgfx->get_orders(); $vwplpmts = array(); foreach($vwpljrgj8 as $vwplvbkdn => $vwplxl4jet) { $vwplpmts[] = $vwplvbkdn; } return $vwplpmts; } function wplei1q($vwplgdujg, $vwpllzly5b, $vwplvbkdn ) { $vwplmdjuoa = get_post_meta($vwplvbkdn, '_is4wp_learndash_autoenroll', true); if (! empty($vwplmdjuoa) ) { $vwplc0nobe = (isset($_SESSION['memb_user']['Id']) && $vwpllzly5b == $_SESSION['memb_user']['Id']) ? $_SESSION : memberium_app()->wplyte2($vwpllzly5b); if (isset($_SESSION['memb_db_fields']['id']) ) { $vwplgdujg = wplj_l2t::wpl_n2s9( $vwplmdjuoa, $vwplc0nobe ); } } return $vwplgdujg; } function wplkln27p( $vwpl_cpfi, $vwplyio4f, $vwpllzly5b ) { $vwplvtmqd = (int) wpllbej::wplbmo_1( $vwpllzly5b ); if ( ! $vwplvtmqd || ! $vwpllzly5b ) { return; } $vwply4fkhi = get_post_meta( $vwpl_cpfi ); if ( ! empty( $vwply4fkhi['_is4wp_learndash_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_actions'][0], $vwplvtmqd ); } if ( function_exists( 'badgeos_award_achievement_to_user' ) && ! empty( $vwply4fkhi['_is4wp_learndash_achievement'][0] ) ) { badgeos_award_achievement_to_user( (int) $vwply4fkhi['_is4wp_learndash_achievement'][0], $vwpllzly5b ); } } function wploz0j( $vwplsmd9, $vwplvbkdn, $vwpllzly5b ) { $vwplvtmqd = (int) wpllbej::wplbmo_1( $vwpllzly5b ); if ( $vwplvtmqd && $vwplsmd9 ) { $vwplup3my = get_post_meta( $vwplsmd9, '_lp_passing_grade', true ); if ( $vwplup3my !== false ) {  $vwplup3my = (int) $vwplup3my; $vwpldgfx = new LP_User( $vwpllzly5b ); $vwplwhufe = $vwpldgfx->get_quiz_results( $vwplsmd9, $vwplvbkdn ); $vwpldths1e = (int) $vwplwhufe; $vwpljfi5 = ( $vwpldths1e >= $vwplup3my ); $vwply4fkhi = get_post_meta( $vwplsmd9 ); if ( $vwpljfi5 ) { if ( ! empty( $vwply4fkhi['_is4wp_learndash_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_actions'][0], $vwplvtmqd ); } if ( function_exists( 'badgeos_award_achievement_to_user' ) && ! empty( $vwply4fkhi['_is4wp_learndash_achievement'][0] ) ) { badgeos_award_achievement_to_user( (int) $vwply4fkhi['_is4wp_learndash_achievement'][0], $vwplvtmqd ); } } else { if ( ! empty( $vwply4fkhi['_is4wp_learndash_fail_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_fail_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_fail_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_fail_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_fail_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_fail_actions'][0], $vwplvtmqd ); } } } }  } function wply6cioq($vwplvbkdn, $vwpllzly5b, $vwplr_7cl) { $vwplvtmqd = (int) wpllbej::wplbmo_1( $vwpllzly5b ); if ( ! $vwplvtmqd || ! $vwpllzly5b ) { return; } $vwply4fkhi = get_post_meta($vwplvbkdn); if ( ! empty( $vwply4fkhi['_is4wp_learndash_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_actions'][0], $vwplvtmqd ); } if ( function_exists( 'badgeos_award_achievement_to_user' ) && ! empty( $vwply4fkhi['_is4wp_learndash_achievement'][0] ) ) { badgeos_award_achievement_to_user( (int) $vwply4fkhi['_is4wp_learndash_achievement'][0], $vwpllzly5b ); } } function __construct() { $this->wplicnz(); } private function wplicnz() { add_action('learn-press/user-course-finished', array( $this, 'wply6cioq' ), 10, 3 );  add_action('learn-press/user-completed-lesson', array( $this, 'wplkln27p' ), 10, 3 );  add_action('learn-press/user/quiz-finished', array( $this, 'learn_press_user_finish_quiz_actions_action' ), 10, 3 );  add_action('memberium_session_created', array( $this, 'wple4mqf' ), 10, 1 ); add_filter('learn-press/has-enrolled-course', array( $this, 'wplei1q' ), 10, 3 ); add_filter('memberium_unenhanced_posts', array( $this, 'wplla0m5k' ), 10, 1 ); } }
