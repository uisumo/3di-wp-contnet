<?php
 if ( ! defined( 'ABSPATH' ) ) { die(); } new wpllpkq; final class wpllpkq { function wplicnz() { add_filter('gform_pre_render', array($this, 'wplejs0vi'), 1, 3); add_filter('gform_after_submission', array($this, 'wplumb0_i'), 10, 2); add_filter('gform_field_value_memb_city', array($this, 'wpljudg90') ); add_filter('gform_field_value_memb_country', array($this, 'wplbm9ub') ); add_filter('gform_field_value_memb_email', array($this, 'wplkwuks0') ); add_filter('gform_field_value_memb_firstname', array($this, 'wpllhb5wm') ); add_filter('gform_field_value_memb_firstname', array($this, 'wplxhktv') ); add_filter('gform_field_value_memb_lastname', array($this, 'wpld7h8sn') ); add_filter('gform_field_value_memb_phone', array($this, 'wpllogmjn') ); add_filter('gform_field_value_memb_postalcode', array($this, 'wplr14tw') ); add_filter('gform_field_value_memb_state', array($this, 'wplsqbfxy') ); add_filter('gform_field_value_memb_streetaddress1', array($this, 'wpl_m8p') ); add_filter('gform_field_value_memb_streetaddress2', array($this, 'wplakp8rf') ); } function init() { } function wploj43() { add_shortcode( 'memb_gravityform_field', array( $this, 'wplzlqk0' ) ); } function wplltnuv0( $vwpligjn = '', $vwplmkypa = '' ) { $vwplph268z = ''; if ( ! empty( $vwpligjn ) ) { if ( substr( $vwpligjn, 0, 13 ) == 'memb.contact.' ) { $vwple2yn = strtolower( substr( $vwpligjn, 13 ) ); $vwplph268z = wplsbzgvp::wplc4na( $vwple2yn ); } } if ( empty( $vwplph268z ) && ! empty( $vwplmkypa ) ) { $vwplph268z = $vwplmkypa; } return do_shortcode( $vwplph268z ); } function wplumb0_i( $vwplofj7lm, $vwplt73pl ) { if ( is_array( $vwplt73pl['fields'] ) ) { $vwplo0t9 = array(); foreach( $vwplt73pl['fields'] as $vwplx2mbjg => $vwpl_s6l ) { if ( ! empty( $vwpl_s6l->memberiumfieldsync ) ) { if ( $vwpl_s6l->type == 'address' ) { $vwplopnf = $vwpl_s6l->id; $vwplv7a_9m = array(); if ( $vwpl_s6l->memberiumfieldsync == 'StreetAddress1' ) { $vwplv7a_9m = array( 'street1' => 'StreetAddress1', 'street2' => 'StreetAddress2', 'city' => 'City', 'state' => 'State', 'postalcode' => 'PostalCode', 'country' => 'Country', ); } elseif ( $vwpl_s6l->memberiumfieldsync == 'Address2Street1' ) { $vwplv7a_9m = array( 'street1' => 'Address2Street1', 'street2' => 'Address2Street2', 'city' => 'City2', 'state' => 'State2', 'postalcode' => 'PostalCode2', 'country' => 'Country2', ); } elseif ( $vwpl_s6l->memberiumfieldsync == 'Address3Street1' ) { $vwplv7a_9m = array( 'street1' => 'Address3Street1', 'street2' => 'Address3Street2', 'city' => 'City3', 'state' => 'State3', 'postalcode' => 'PostalCode3', 'country' => 'Country3', ); } if ( ! empty( $vwplv7a_9m ) ) { if ( isset( $vwplofj7lm[$vwplopnf.'.1'] ) ) { $vwplo0t9[$vwplv7a_9m['street1']] = trim( $vwplofj7lm[$vwplopnf.'.1'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.2'] ) ) { $vwplo0t9[$vwplv7a_9m['street2']] = trim( $vwplofj7lm[$vwplopnf.'.2'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.3'] ) ) { $vwplo0t9[$vwplv7a_9m['city']] = trim( $vwplofj7lm[$vwplopnf.'.3'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.4'] ) ) { $vwplo0t9[$vwplv7a_9m['state']] = trim( $vwplofj7lm[$vwplopnf.'.4'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.5'] ) ) { $vwplo0t9[$vwplv7a_9m['postalcode']] = trim( $vwplofj7lm[$vwplopnf.'.5'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.6'] ) ) { $vwplo0t9[$vwplv7a_9m['country']] = trim( $vwplofj7lm[$vwplopnf.'.6'] ); } } } elseif ( $vwpl_s6l->type == 'name' ) { $vwplopnf = $vwpl_s6l->id; if ( $vwpl_s6l->memberiumfieldsync == 'FirstName' ) { if ( isset( $vwplofj7lm[$vwplopnf.'.2'] ) ) { $vwplo0t9['Title'] = trim( $vwplofj7lm[$vwplopnf.'.2'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.3'] ) ) { $vwplo0t9['FirstName'] = trim( $vwplofj7lm[$vwplopnf.'.3'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.4'] ) ) { $vwplo0t9['MiddleName'] = trim( $vwplofj7lm[$vwplopnf.'.4'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.6'] ) ) { $vwplo0t9['LastName'] = trim( $vwplofj7lm[$vwplopnf.'.6'] ); } if ( isset( $vwplofj7lm[$vwplopnf.'.8'] ) ) { $vwplo0t9['Suffix'] = trim( $vwplofj7lm[$vwplopnf.'.8'] ); } } else { $vwplpe17 = array(); if ( ! empty( $vwplofj7lm[$vwplopnf.'.2'] ) ) { $vwplpe17[] = $vwplofj7lm[$vwplopnf.'.2']; } if ( ! empty( $vwplofj7lm[$vwplopnf.'.3'] ) ) { $vwplpe17[] = $vwplofj7lm[$vwplopnf.'.3']; } if ( ! empty( $vwplofj7lm[$vwplopnf.'.4'] ) ) { $vwplpe17[] = $vwplofj7lm[$vwplopnf.'.4']; } if ( ! empty( $vwplofj7lm[$vwplopnf.'.6'] ) ) { $vwplpe17[] = $vwplofj7lm[$vwplopnf.'.6']; } if ( ! empty( $vwplofj7lm[$vwplopnf.'.8'] ) ) { $vwplpe17[] = $vwplofj7lm[$vwplopnf.'.8']; } $vwplo0t9[$vwpl_s6l->memberiumfieldsync] = trim( implode( ' ', $vwplpe17 ) ); } } elseif ( $vwpl_s6l->type == 'list' ) {    } elseif ( $vwpl_s6l->type == 'date' ) { $vwplph268z = trim( $vwplofj7lm[$vwpl_s6l->id] ); if ( ! empty( $vwplph268z ) ) { $vwplo0t9[$vwpl_s6l->memberiumfieldsync] = date( 'Ymd\TH:i:s', strtotime( $vwplph268z ) ); } } elseif ( $vwpl_s6l->type == 'number' ) { $vwplo0t9[$vwpl_s6l->memberiumfieldsync] = (int) trim( $vwplofj7lm[$vwpl_s6l->id] ); } elseif ( in_array( $vwpl_s6l->type, array( 'checkbox' ) ) ) { $vwplpe17 = array(); foreach( $vwpl_s6l->inputs as $input_id => $input ) { if ( ! empty( $vwplofj7lm[$input['id']] ) ) { $vwplpe17[] = $vwplofj7lm[$input['id']]; } } if ( substr( $vwplpe17, 0, 2 ) == '["' ) { $vwplpe17 = json_decode( $vwplpe17 ); } else { $vwplpe17 = implode( ',', $vwplpe17 ); } $vwplo0t9[$vwpl_s6l->memberiumfieldsync] = $vwplpe17; } elseif ( in_array( $vwpl_s6l->type, array('multiselect') ) ) { $vwplpe17 = $vwplofj7lm[$vwpl_s6l->id]; if ( substr( $vwplpe17, 0, 2) == '["' ) { $vwplpe17 = implode( ',', json_decode( $vwplpe17 ) ); } $vwplo0t9[$vwpl_s6l->memberiumfieldsync] = $vwplpe17; } else { $vwplo0t9[$vwpl_s6l->memberiumfieldsync] = trim( $vwplofj7lm[$vwpl_s6l->id] ); } } } if ( ! empty( $vwplo0t9 ) ) { $vwpl_2cd9 = wplz8bid::wplvf1d('settings', 'username_field'); $vwplup7mi = wplz8bid::wplvf1d('settings', 'password_field'); $vwplyjx8 = is_user_logged_in(); $vwplad7z = strtolower( wplsbzgvp::wplc4na( 'email' ) ); $vwplyosfdm = isset( $vwplo0t9['Email'] ) ? strtolower( trim( $vwplo0t9['Email'] ) ) : ''; $vwplvtmqd = 0; $vwpllzly5b = get_current_user_id(); $vwplqxosl = isset( $vwplt73pl['memberiumformtag'] ) ? (int) $vwplt73pl['memberiumformtag'] : 0; if ( empty( $vwplyosfdm ) && is_user_logged_in() ) { $vwplgogvie = get_current_user(); $vwplyosfdm = $vwplgogvie->user_email; }  unset( $vwplo0t9[$vwplup7mi] );  if ( is_user_logged_in() ) { if ( empty( $vwplyosfdm ) || $vwplyosfdm == $vwplad7z ) { $vwplvtmqd = wplsbzgvp::wplfhxj9(); } } if ( $vwplvtmqd ) { unset( $vwplo0t9[$vwpl_2cd9] ); memberium_app()->wplt263_( $vwplqxosl, $vwplvtmqd ); $vwplyio4f = memberium_app()->isdk->updateCon( $vwplvtmqd, $vwplo0t9 ); memberium_app()->wplj9ye( $vwplvtmqd ); memberium_app()->wplqd_lae( $vwplvtmqd ); $_SESSION = memberium_app()->wplyte2( $vwpllzly5b ); } else { $vwplvtmqd = memberium_app()->isdk->addWithDupCheck( $vwplo0t9, 'Email' ); memberium_app()->isdk->optIn( $vwplo0t9['Email'], "GravityForms Enrollment - Form '{$vwplt73pl['title']}'\nIP Address ' . {$vwplofj7lm['ip']}" ); memberium_app()->wplt263_( $vwplqxosl, $vwplvtmqd ); }  if ( $vwplvtmqd ) {  $vwplgitq = array( 'table' => -1, 'type' => 19, ); $vwplyh4870 = memberium_app()->wplngsu( $vwplgitq ); $vwplyh4870[] = 'Email'; $vwplyh4870[] = 'EmailAddress2'; $vwplyh4870[] = 'EmailAddress3'; $vwpl_jiwz0 = array(); foreach( $vwplo0t9 as $vwple2yn => $vwplnghzs1 ) { if ( in_array( $vwple2yn, $vwplyh4870 ) ) { if ( ! empty( $vwplnghzs1 ) ) { $vwpl_jiwz0[] = strtolower( trim( $vwplnghzs1 ) ); } } } $vwpl_jiwz0 = array_unique( $vwpl_jiwz0 ); foreach( $vwpl_jiwz0 as $vwplz4izhe ) { memberium_app()->isdk->optin( $vwplz4izhe, 'Memberium Gravity Form Submission' ); } } } } }  function wplejs0vi( $vwplt73pl, $vwplboszw, $vwplonxjo_ ) { if ( is_array( $vwplt73pl ) ) { foreach ( $vwplt73pl['fields'] as &$vwpl_s6l ) { $vwple6pqif = property_exists( $vwpl_s6l, 'type' ) ? $vwpl_s6l->type : ''; $vwplph268z = ''; $vwpligjn = property_exists( $vwpl_s6l, 'inputName' ) ? $vwpl_s6l->inputName : ''; $vwplmkypa = property_exists( $vwpl_s6l, 'defaultValue' ) ? $vwpl_s6l->defaultValue : ''; $vwplph268z = $this->wplltnuv0( $vwpligjn, $vwplmkypa ); if ( property_exists( $vwpl_s6l, 'defaultValue' ) ) { $vwpl_s6l->defaultValue = $vwplph268z; } if ( $vwple6pqif == 'date' ) { if ( ! empty( $vwplph268z ) ) { $vwplgv_bhp = strtotime( $vwplph268z ); if ( $vwpl_s6l->dateType == 'datepicker') { $vwpl_s6l->defaultValue = date( 'm\/d\/Y', $vwplgv_bhp ); } elseif ( $vwpl_s6l->dateType == 'datefield' ) { $vwpl_s6l->inputs[0]['defaultValue'] = date( 'n', $vwplgv_bhp ); $vwpl_s6l->inputs[1]['defaultValue'] = date( 'j', $vwplgv_bhp ); $vwpl_s6l->inputs[2]['defaultValue'] = date( 'Y', $vwplgv_bhp ); } elseif ( $vwpl_s6l->dateType == 'datedropdown' ) { $vwpl_s6l->inputs[0]['defaultValue'] = date( 'n', $vwplgv_bhp ); $vwpl_s6l->inputs[1]['defaultValue'] = date( 'j', $vwplgv_bhp ); $vwpl_s6l->inputs[2]['defaultValue'] = date( 'Y', $vwplgv_bhp ); } } } elseif ( $vwple6pqif == 'name' ) { foreach( $vwpl_s6l->inputs as $vwply17edn => $vwplubap ) { $vwpligjn = isset( $vwplubap['name'] ) ? $vwplubap['name'] : ''; $vwplmkypa = isset( $vwplubap['defaultValue'] ) ? $vwplubap['defaultValue'] : ''; $vwpl_s6l->inputs[$vwply17edn]['defaultValue'] = $this->wplltnuv0( $vwpligjn, $vwplmkypa ); } } elseif ( $vwple6pqif == 'address' ) { foreach( $vwpl_s6l->inputs as $vwply17edn => $vwplubap ) { $vwpligjn = isset( $vwplubap['name'] ) ? $vwplubap['name'] : ''; $vwplmkypa = isset( $vwplubap['defaultValue'] ) ? $vwplubap['defaultValue'] : ''; $vwpl_s6l->inputs[$vwply17edn]['defaultValue'] = $this->wplltnuv0( $vwpligjn, $vwplmkypa ); } } elseif ( $vwple6pqif == 'checkbox' ) { $selections = array(); if ( property_exists( $vwpl_s6l, 'defaultValue' ) ) { $selections = strtolower( $vwpl_s6l->defaultValue ); $selections = explode( ',', $selections );  } foreach( $vwpl_s6l->choices as $choice_id => $choice ) { if ( in_array( strtolower( $choice['value'] ), $selections ) ) { $vwpl_s6l->choices[$choice_id]['isSelected'] = 1; } } } else { if ( is_array( $vwpl_s6l->inputs ) ) { foreach( $vwpl_s6l->inputs as $vwply17edn => $vwplubap ) { $vwpligjn = isset( $vwplubap['name'] ) ? $vwplubap['name'] : ''; $vwplmkypa = isset( $vwplubap['defaultValue'] ) ? $vwplubap['defaultValue'] : ''; $vwpl_s6l->inputs[$vwply17edn]['defaultValue'] = $this->wplltnuv0( $vwpligjn, $vwplmkypa ); } } } } } return $vwplt73pl; } function wplu1t5j( $vwplt73pl, $vwplboszw, $vwplonxjo_ ) { } function wplzlqk0( $vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '' ) { $vwplsb_pf = array( 'after' => '', 'before' => '', 'capture' => '', 'debug' => 0, 'default' => '', 'field' => '', 'form_id' => 0, 'htmlattr' => '', 'input' => '', 'offset' => 0, 'order' => 'DESC', 'page_size' => 1, 'status' => 'active', 'txtfmt' => '', 'user_id' => get_current_user_id(), ); $vwplvpexdn = shortcode_atts( $vwplsb_pf, $vwplvpexdn, 'memberium' ); $vwplvpexdn['field'] = strtolower( trim($vwplvpexdn['field']) ); $vwplvpexdn['input'] = strtolower( trim($vwplvpexdn['input']) ); $vwplvpexdn['form_id'] = (int) $vwplvpexdn['form_id']; $vwplvpexdn['page_size'] = (int) $vwplvpexdn['page_size']; $vwplvpexdn['offset'] = (int) $vwplvpexdn['offset']; $vwplt73pl = GFAPI::get_form($vwplvpexdn['form_id']); $vwplx2mbjg = 0; if ( empty( $vwplvpexdn['field'] ) ) { if ( is_super_admin() ) return '<p>Error:  No Fieldname Provided.</p>'; return; } if ( empty( $vwplt73pl ) ) { if ( is_super_admin() ) return '<p>Error:  Invalid Form Id.</p>'; return; } if ( empty( $vwplt73pl['fields'] ) ) { if ( is_super_admin() ) return '<p>Error:  This form has no fields.</p>'; return; } $vwplsgedja = array(); $vwplsgedja['field_filters'][] = array('key' => 'created_by', 'value' => $user_id); $vwplsgedja['status'] = 'active'; $vwplhvebnw = array('direction' => $order, 'is_numeric' => true); $vwplkbxy30 = array('offset' => $vwplvpexdn['offset'], 'page_size' => $vwplvpexdn['page_size']); $vwplptlnxq = 1; $vwplofj7lm = GFAPI::get_entries($vwplvpexdn['form_id'], $vwplsgedja, $vwplhvebnw, $vwplkbxy30, $vwplptlnxq); if ( $debug ) { return print_r( $vwplofj7lm, true ); }  foreach( $vwplt73pl['fields'] as $vwplmu62n ) { $vwplv_qo = ( $vwplvpexdn['field'] == strtolower( $vwplmu62n->memberiumfieldsync ) ); $vwplv_qo = $vwplv_qo || ( $vwplvpexdn['field'] == strtolower( $vwplmu62n->adminLabel ) ); $vwplv_qo = $vwplv_qo || ( $vwplvpexdn['field'] == strtolower( $vwplmu62n->label ) ); if ( $vwplv_qo ) { if ( ! is_array( $vwplmu62n->inputs ) ) { $vwplx2mbjg = $vwplmu62n->id; } else { foreach ( $vwplmu62n->inputs as $vwplexobfw ) { if ( $vwplvpexdn['input'] == strtolower( $vwplexobfw['label'] ) || $vwplvpexdn['input'] == strtolower( $vwplexobfw['name'] ) ) { $vwplx2mbjg = $vwplexobfw['id']; } } } } } unset( $vwplhvebnw, $vwplsgedja, $vwplkbxy30, $vwplptlnxq, $vwpl_dw8u ); $vwplx2mbjg = empty( $vwplx2mbjg ) ? $vwplvpexdn['field'] : $vwplx2mbjg; if ( $vwplx2mbjg ) { $vwplph268z = isset( $vwplofj7lm[0][$vwplx2mbjg] ) ? $vwplofj7lm[0][$vwplx2mbjg] : $default; $vwpl_dw8u = json_decode( $vwplph268z ); $vwplph268z = empty( $vwpl_dw8u ) ? $vwplph268z : $vwpl_dw8u; } return wplczvi98::wplyhei6( false, $vwplph268z, $vwplvpexdn['txtfmt'], $vwplvpexdn['capture'], $vwplvpexdn['htmlattr'], $vwplvpexdn['before'], $vwplvpexdn['after'] ); }    function wpllhb5wm($vwplph268z) { return wplsbzgvp::wplfhxj9(); } function wplxhktv($vwplph268z) { return wplsbzgvp::wplc4na('firstname'); } function wpld7h8sn($vwplph268z) { return wplsbzgvp::wplc4na('lastname'); } function wplkwuks0($vwplph268z) { return wplsbzgvp::wplc4na('email'); } function wpllogmjn($vwplph268z) { return wplsbzgvp::wplc4na('phone1'); } function wpl_m8p($vwplph268z) { return wplsbzgvp::wplc4na('streetaddress1'); } function wplakp8rf($vwplph268z) { return wplsbzgvp::wplc4na('streetaddress2'); } function wpljudg90($vwplph268z) { return wplsbzgvp::wplc4na('city'); } function wplsqbfxy($vwplph268z) { return wplsbzgvp::wplc4na('state'); } function wplr14tw($vwplph268z) { return wplsbzgvp::wplc4na('postalcode'); } function wplbm9ub($vwplph268z) { return wplsbzgvp::wplc4na('country'); } function __call($vwpljuiz, $vwplgitq) { } static $fieldnames = array(); private $options = null; private $core = null; function __construct() { $this->wplicnz(); $this->wploj43(); } }
