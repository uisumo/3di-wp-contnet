<?php
 if ( ! defined( 'ABSPATH' ) ) { die(); } new wplrdjla; final class wplrdjla { private $core; private $system; function __construct() { $this->wplicnz(); } private function wplicnz() { add_action('init', array( $this, 'wplcudq8' ), 200 ); add_action('learndash_course_completed', array( $this, 'wplj4sw6' ), 5, 1 ); add_action('learndash_lesson_completed', array( $this, 'wplskhe1q' ), 5, 1 ); add_action('learndash_quiz_completed', array( $this, 'wpl_q5iv_' ), 5, 2 ); add_action('learndash_topic_completed', array( $this, 'wplaui1_q' ), 5, 1 ); add_action('template_redirect', array( $this, 'wplkptly9' ), 901 ); add_action('wplss4f', array( $this, 'wplss4f' ) ); add_action('memberium_remove_shortcodes', array( $this, 'wplovnmyj' ) ); add_action('learndash_assignment_uploaded', array( $this, 'wply83f9' ), 10, 2 ); add_action('learndash_assignment_approved', array( $this, 'wplpkrzue' ), 10, 1 ); add_filter('learndash_certificate_pdf_page_formats', array( $this, 'wplrc6q2' ), 10 ); add_filter('learndash_content_access', array( $this, 'wplkix_' ), 5, 2 ); add_filter('learndash_course_completion_url', array( $this, 'wplevdlt7' ), 5, 2 ); add_filter('sfwd_lms_has_access', array( $this, 'wpln6cxz' ), PHP_INT_MAX, 3 ); } function wplcudq8() { } function wpln6cxz($vwplph268z, $vwplcltpy, $vwpllzly5b) { if ( is_admin() ) { return true; } if ($vwplph268z) { $vwpllzly5b = empty($vwpllzly5b) ? get_current_user_id() : $vwpllzly5b; $vwplph268z = memberium_app()->frontend_class->wpls9nje( $vwplcltpy ); } return $vwplph268z; } function wplhjudh( $vwpl_knw, $vwplzzlf5b, $vwplgogvie ) { if ( ! is_a( $vwplzzlf5b, 'WP_Post' ) ) { return; } if ( $vwpl_knw ) { $vwpllzly5b = (int) $vwplgogvie->ID; $vwplcltpy = (int) $vwplzzlf5b->ID; $vwplvtmqd = (int) wpllbej::wplbmo_1( $vwpllzly5b ); if ( $vwplvtmqd ) { $vwplsfuhs = get_post( $vwplcltpy, 'ARRAY_A' ); $vwplxdj2 = get_user_meta( $vwpllzly5b, '_sfwd-quizzes', true ); foreach( $vwplxdj2 as $vwplfgq1 ) { if ( $vwplfgq1['quiz'] == $vwplcltpy ) { $vwplvhe0 = false; } } } }  }    static function wplwl9j2d($vwpllzly5b = 0, $vwplc0nobe = array() ) { global $wpdb; if ( ! function_exists( 'learndash_set_groups_users' ) ) { return; } if (user_can($vwpllzly5b, 'manage_options')) { return; } $vwplwc60 = $wpdb->posts; $vwplz39do = $wpdb->postmeta; $vwplx1ap5_ = "SELECT ID, meta_value FROM {$vwplwc60}, {$vwplz39do} WHERE post_status = 'publish' AND post_type = 'groups' AND  post_id = ID AND meta_key = '_is4wp_learndash_autojoin' AND meta_value > '' "; $vwplob9i24 = $wpdb->get_results( $vwplx1ap5_, ARRAY_A ); if ( is_array( $vwplob9i24 ) && ! empty( $vwplob9i24 ) ) { foreach ( $vwplob9i24 as $vwplzzlf5b ) { $vwplap4j97 = false; $vwply17edn = 'learndash_group_users_' . $vwplzzlf5b['ID']; $vwplshl0kg = (boolean) get_user_meta( $vwpllzly5b, $vwply17edn, true ); $vwple1ah = wplj_l2t::wpl_n2s9( $vwplzzlf5b['meta_value'], $vwplc0nobe ); if ( $vwple1ah || $vwplshl0kg ) { $vwplooqc = learndash_get_groups_user_ids($vwplzzlf5b['ID'], true); } if ( $vwple1ah && ! $vwplshl0kg ) { $vwplooqc[] = $vwpllzly5b; $vwplap4j97 = true; } elseif ( ! $vwple1ah && $vwplshl0kg ) { $vwplooqc = array_diff( $vwplooqc, array( $vwpllzly5b) ); $vwplap4j97 = true; } if ( $vwplap4j97 ) { learndash_set_groups_users( $vwplzzlf5b['ID'], $vwplooqc ); } } } } static function wplszehtw($vwpllzly5b = 0, $vwplc0nobe = array() ) { global $wpdb; if (! function_exists('ld_update_course_access') ) { return; } if (user_can($vwpllzly5b, 'manage_options') ) { return; } $vwplwc60 = $wpdb->posts; $vwplz39do = $wpdb->postmeta; $vwplvgobd = learndash_get_user_course_access_list($vwpllzly5b);  $vwplx1ap5_ = "SELECT ID, meta_value FROM {$vwplwc60}, {$vwplz39do} WHERE post_status = 'publish' AND post_type = 'sfwd-courses' AND  post_id = ID AND meta_key = '_is4wp_learndash_autoenroll' AND meta_value > '' "; $vwplob9i24 = $wpdb->get_results( $vwplx1ap5_, ARRAY_A ); if ( is_array( $vwplob9i24 ) ) { foreach ( $vwplob9i24 as $vwplzzlf5b ) { $vwplbaur9 = in_array( $vwplzzlf5b['ID'], $vwplvgobd ); $vwplu724oh = wplj_l2t::wpl_n2s9($vwplzzlf5b['meta_value'], $vwplc0nobe); $vwplvbkdn = $vwplzzlf5b['ID']; if ($vwplu724oh) { if (! $vwplbaur9) { ld_update_course_access($vwpllzly5b, $vwplvbkdn, false); } } else { ld_update_course_access($vwpllzly5b, $vwplvbkdn, true); } } } } function wplj4sw6( $vwplz4g7n ) {  $vwpllzly5b = isset( $vwplz4g7n['user']->ID ) ? $vwplz4g7n['user']->ID : get_current_user_id(); $vwplvtmqd = (int) wpllbej::wplbmo_1( $vwpllzly5b ); if ( ! $vwplvtmqd || ! $vwpllzly5b ) { return; } $vwply4fkhi = get_post_meta( $vwplz4g7n['course']->ID ); if ( ! empty( $vwply4fkhi['_is4wp_learndash_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_actions'][0], $vwplvtmqd ); } if ( function_exists( 'badgeos_award_achievement_to_user' ) && ! empty( $vwply4fkhi['_is4wp_learndash_achievement'][0] ) ) { badgeos_award_achievement_to_user( (int) $vwply4fkhi['_is4wp_learndash_achievement'][0], $vwpllzly5b ); } } function wplskhe1q( $vwplz4g7n ) { $vwpllzly5b = isset( $vwplz4g7n['user']->ID ) ? $vwplz4g7n['user']->ID : get_current_user_id(); $vwplvtmqd = (int) wpllbej::wplbmo_1( $vwpllzly5b ); if ( ! $vwplvtmqd || ! $vwpllzly5b ) { return; } $vwply4fkhi = get_post_meta( $vwplz4g7n['lesson']->ID ); if ( ! empty( $vwply4fkhi['_is4wp_learndash_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_actions'][0], $vwplvtmqd ); } if ( function_exists( 'badgeos_award_achievement_to_user' ) && ! empty( $vwply4fkhi['_is4wp_learndash_achievement'][0] ) ) { badgeos_award_achievement_to_user( (int) $vwply4fkhi['_is4wp_learndash_achievement'][0], $vwpllzly5b ); } } function wplaui1_q( $vwplz4g7n) {  $vwpllzly5b = isset( $vwplz4g7n['user']->ID ) ? $vwplz4g7n['user']->ID : get_current_user_id(); $vwplvtmqd = (int) wpllbej::wplbmo_1( $vwpllzly5b ); if ( ! $vwplvtmqd || ! $vwpllzly5b ) { return; } $vwply4fkhi = get_post_meta( $vwplz4g7n['topic']->ID ); if ( ! empty( $vwply4fkhi['_is4wp_learndash_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_actions'][0], $vwplvtmqd ); } if ( function_exists( 'badgeos_award_achievement_to_user' ) && ! empty( $vwply4fkhi['_is4wp_learndash_achievement'][0] ) ) { badgeos_award_achievement_to_user( (int) $vwply4fkhi['_is4wp_learndash_achievement'][0], $vwpllzly5b ); } } function wpl_q5iv_( $vwplz4g7n, $vwplgogvie ) { $vwpllzly5b = isset( $vwplgogvie->ID ) ? $vwplgogvie->ID : get_current_user_id(); $vwplvtmqd = (int) wpllbej::wplbmo_1( $vwpllzly5b ); if ( $vwplvtmqd ) { $vwply4fkhi = get_post_meta( $vwplz4g7n['quiz']->ID ); if ( $vwplz4g7n['pass'] ) { if ( ! empty( $vwply4fkhi['_is4wp_learndash_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_actions'][0], $vwplvtmqd ); } if ( function_exists( 'badgeos_award_achievement_to_user' ) && ! empty( $vwply4fkhi['_is4wp_learndash_achievement'][0] ) ) { badgeos_award_achievement_to_user( (int) $vwply4fkhi['_is4wp_learndash_achievement'][0], $vwplvtmqd ); } } else { if ( ! empty( $vwply4fkhi['_is4wp_learndash_fail_goals'][0] ) ) { memberium_app()->wplge1yc6( $vwply4fkhi['_is4wp_learndash_fail_goals'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_fail_tags'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_is4wp_learndash_fail_tags'][0], $vwplvtmqd ); } if ( ! empty( $vwply4fkhi['_is4wp_learndash_fail_actions'][0] ) ) { memberium_app()->wplmupt( $vwply4fkhi['_is4wp_learndash_fail_actions'][0], $vwplvtmqd ); } } } } function wplss4f() { add_shortcode( 'memb_learndash_is_completed', array( 'wplkg39h1', 'wpln9ey' ) ); add_shortcode( 'memb_learndash_course_enroll', array( $this, 'wplkkbr' ) ); add_shortcode( 'memb_learndash_course_unenroll', array( $this, 'wplkkbr' ) ); } function wplovnmyj() { remove_shortcode( 'memb_learndash_course_enroll' ); remove_shortcode( 'memb_learndash_course_unenroll' ); } function wplkptly9() { if ( memberium_app()->frontend_class->post_type == 'sfwd-quiz' ) {   } }    function wplkix_( $vwpls74o2q, $vwplzzlf5b ) { if ( method_exists( memberium_app()->frontend_class, 'wpls9nje') ) { $success = memberium_app()->frontend_class->wpls9nje( $vwplzzlf5b->ID ); if ( ! $success ) { return $vwplzzlf5b->excerpt; } } return null; } function wplevdlt7( $vwpln208, $vwplcltpy ) { $vwplimo5 = get_post_meta( $vwplcltpy, '_is4wp_learndash_redirect', TRUE ); if ( $vwplimo5 ) { return do_shortcode( $vwplimo5 ); } else { return $vwpln208; } } function wplrc6q2( $vwplnkj9d_ ) { $vwplnkj9d_['A4_EXTRA'] = 'A4 Extra'; $vwplnkj9d_['A4_LONG'] = 'A4 Long'; $vwplnkj9d_['A4_SUPER'] = 'A4 Super'; $vwplnkj9d_['COMPACT'] = 'Compact'; $vwplnkj9d_['FOOLSCAP'] = 'Foolscap'; $vwplnkj9d_['GLETTER'] = 'Government Letter'; $vwplnkj9d_['GOVERNMENTLEGAL'] = 'Government Legal'; $vwplnkj9d_['JLEGAL'] = 'Junior Legal'; $vwplnkj9d_['LEDGER'] = 'Ledger'; $vwplnkj9d_['LEGAL'] = 'Legal'; $vwplnkj9d_['TABLOID'] = 'Tabloid'; return $vwplnkj9d_; }    function wplkkbr( $vwplvpexdn, $vwplckl3 = null, $vwpluvdiz = '' ) { if ( ! is_user_logged_in() ) { return; } if ( ! function_exists( 'ld_update_course_access' ) ) { return 'LearnDash not installed<br />'; } $vwplsb_pf = array( 'course_id' => 0, 'user_id' => get_current_user_id(), ); $vwplvpexdn = shortcode_atts( $vwplsb_pf, $vwplvpexdn, 'memberium' ); $vwplvpexdn['course_id'] = (int) $vwplvpexdn['course_id']; if ( $vwplvpexdn['course_id'] > 0 && $vwplvpexdn['user_id'] > 0 ) { if ( ! get_post_status( $vwplvpexdn['course_id'] ) ) { return 'Invalid Course ID<br />'; } $vwplz658 = (bool) ( strtolower( trim( $vwpluvdiz ) ) == 'memb_learndash_course_unenroll' ); ld_update_course_access( $vwplvpexdn['user_id'], $vwplvpexdn['course_id'], $vwplz658 ); } } function wply83f9( $vwpl_xhp1 = 0, $vwplucqrv = array() ) { if ( ! $vwpl_xhp1 ) { return; } $vwpllzly5b = isset( $vwplucqrv['user_id'] ) ? $vwplucqrv['user_id'] : 0; $vwplvtmqd = wpllbej::wplbmo_1( $vwpllzly5b ); if ( ! $vwplvtmqd ) { return; } $vwplcltpy = isset( $vwplucqrv['lesson_id'] ) ? $vwplucqrv['lesson_id'] : 0; if ( ! $vwplcltpy ) { return; } $vwply4fkhi = get_post_meta( $vwplcltpy ); if ( ! empty( $vwply4fkhi['_memberium_lms_assignment_upload_tag'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_memberium_lms_assignment_upload_tag'][0], $vwplvtmqd ); } } function wplpkrzue( $vwplxipubc = 0 ) { $vwplxipubc = (int) $vwplxipubc; if ( ! $vwplxipubc ) { return; } $vwplucqrv = get_post_meta( $vwplxipubc ); $vwplcltpy = isset( $vwplucqrv['lesson_id'][0] ) ? $vwplucqrv['lesson_id'][0] : 0; $vwpllzly5b = isset( $vwplucqrv['user_id'][0] ) ? $vwplucqrv['user_id'][0] : 0; $vwplvtmqd = wpllbej::wplbmo_1( $vwpllzly5b ); if ( ! $vwplvtmqd ) { return; } $vwply4fkhi = get_post_meta( $vwplcltpy ); if ( ! empty( $vwply4fkhi['_memberium_lms_assignment_approval_tag'][0] ) ) { memberium_app()->wplt263_( $vwply4fkhi['_memberium_lms_assignment_approval_tag'][0], $vwplvtmqd ); } } }
