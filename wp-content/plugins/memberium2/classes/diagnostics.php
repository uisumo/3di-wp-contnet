<?php
/**
 * Copyright (c) 2020 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (!defined('ABSPATH') ) { header('Location: /'); die(); } final class wplwqrn9f { static function wpli0mo() { self::wplhnsx(); self::wpln_sn4(); self::wpll8krsh(); self::wplgtwa(); self::wplhx2lt(); self::wplupq17(); self::wplyean1(); self::wplbuy51l(); self::wpldbgq4(); self::wplajn2(); self::wpla83ui(); self::wplfiq3sn(); self::wplmq7p_(); self::wplav0xd(); self::wpljb1se(); self::wplqvqso(); self::wplbdu40(); } static function wplhx2lt() { global $wpdb; $vwplxc60_ = get_option('memberium_tables', array() ); $vwply2zs = array(); if (is_array($vwplxc60_)) { foreach($vwplxc60_ as $vwplj1r5i) { $vwplx1ap5_ = "SELECT 1 FROM `{$vwplj1r5i}` LIMIT 1;"; $wpdb->get_var($vwplx1ap5_); $vwpll1_x = $wpdb->last_error; if ($vwpll1_x) { $vwply2zs[] = "Table '{$vwplj1r5i}' : <span style='font-weight:bold;color:red;'>{$vwpll1_x}</span><br />"; } } } echo '<h3>Missing Database Tables</h3>'; echo '<div class="indented">'; if (! empty($vwply2zs)) { foreach($vwply2zs as $vwpluj27) { echo $vwpluj27, '<br>'; } } else { echo '<p>None</p>'; } echo '</div>'; } static function wplfiq3sn() { echo '<h3>wp-admin php.ini</h3>'; if (file_exists(get_home_path() . '/wp-admin/php.ini') ) { echo '<textarea readonly=readonly cols="100" rows="10">', file_get_contents(get_home_path() . '/wp-admin/php.ini'), '</textarea>'; } else { echo '<p>Not Found</p>'; } } static function wpljb1se() { $vwpljg_0u = get_defined_constants(true); if (isset($vwpljg_0u['user']) ) { ksort($vwpljg_0u['user']); echo '<h3>Constants</h3>'; echo '<table>'; foreach($vwpljg_0u['user'] as $k => $v) { echo '<tr><td>', $k, '</td><td>', $v, '</td></tr>'; } echo '</table>'; } } static function wplbb5c() { $vwpla6y_1q = '<strong style="color:red;">Unknown</strong>'; if (is_file('/proc/cpuinfo') ) { $vwpld0cgp = file('/proc/cpuinfo'); foreach($vwpld0cgp as $vwplm1zxha) { if (substr($vwplm1zxha, 0, 9) == 'cpu cores') { $vwpla6y_1q = intval($vwpla6y_1q) + (int) substr($vwplm1zxha, strpos($vwplm1zxha, ':') + 1); } } } return $vwpla6y_1q; } static function wplav0xd() { echo '<h3>Cron Jobs</h3>'; echo '<div class="indented">'; $vwplbsbk = array(); $vwpld78sfj = get_option('cron', array() ); if (count($vwpld78sfj) ) { foreach ($vwpld78sfj as $vwply3qa1 => $vwplc69y) { if (is_array($vwplc69y) ) { foreach ($vwplc69y as $jobname => $details) { if (stripos($jobname, 'memberium') === 0) { $vwplbsbk[$jobname] = $vwply3qa1; } } } } } echo '<strong style="margin-left:20px;display:inline-block;width:250px;">Cron Job Name</strong><strong>Next Run Time</strong><br>'; if (! empty($vwplbsbk) ) { foreach ($vwplbsbk as $vwplso1pw => $vwplin_i8) { echo '<span style="margin-left:20px;display:inline-block;width:250px;">', $vwplso1pw, '</span>', date("Y-m-d h:i:s", $vwplin_i8), '<br>'; } } echo '</div>'; } static function wplupq17() { echo '<h3>CURL Library Support</h3>'; echo '<div class="indented">'; if (function_exists('curl_version') ) { $vwplz1d5 = curl_version(); echo '<strong>Version</strong>: ', $vwplz1d5['version'], '<br />'; echo '<strong>Version Number</strong>: ', $vwplz1d5['version_number'], '<br />'; echo '<strong>SSL Version</strong>: ', $vwplz1d5['ssl_version'], '<br />'; echo '<strong>LibZ Version</strong>: ', $vwplz1d5['libz_version'], '<br />'; echo '<strong>Age</strong>: ', $vwplz1d5['age'], '<br />'; } else { echo '<p style="color:red;font-weight:bold;">CURL Library Support Missing</p>'; } echo '</div>'; } static function wplgtwa() { global $wpdb; echo '<h3>MySQL Configuration</h3>'; echo '<div class="indented">'; echo '<h3>Database Storage Engines:</h3>'; $vwplx1ap5_ = 'SHOW STORAGE ENGINES;'; $vwplyg7o = $wpdb->get_results($vwplx1ap5_, ARRAY_A); echo '<table>'; echo '<tr>'; echo '<td>Engine Name</td>'; echo '<td>Support</td>'; echo '<td>Comments / Description</td>'; echo '</tr>'; foreach($vwplyg7o as $vwplyio4f) { echo '<tr>'; echo '<td>',$vwplyio4f['Engine'],'</td>'; echo '<td>',$vwplyio4f['Support'],'</td>'; echo '<td>',$vwplyio4f['Comment'],'</td>'; echo '</tr>'; } echo '</table>'; echo '<h3>Cache Configuration</h3>'; $vwplx1ap5_ = "show variables like 'have_query_cache';"; $vwplyio4f = $wpdb->get_results($vwplx1ap5_); echo '<strong>', $vwplyio4f[0]->Variable_name, '</strong> = ', $vwplyio4f[0]->Value, '<br>'; $vwplx1ap5_ = "show variables like '%query%';"; $vwplyg7o = $wpdb->get_results($vwplx1ap5_); foreach($vwplyg7o as $vwplyio4f) { echo '<strong>', $vwplyio4f->Variable_name, '</strong> = ', $vwplyio4f->Value, '<br>'; } echo '</div>'; } static function wplqvqso() { echo '<h3>Debug Log:</h3>'; if (file_exists(MEMBERIUM_DEBUGLOG) ) { $vwplea8r7 = (0 - min(filesize(MEMBERIUM_DEBUGLOG), MB_IN_BYTES) ); echo '<form method="post" action=""><input type="submit" name="delete-debug" value="Delete Debug Log"></form>'; echo '<textarea readonly=readonly cols="100" rows="20">', file_get_contents(MEMBERIUM_DEBUGLOG, null, null, $vwplea8r7), '</textarea>'; } else { echo '<p style="color:red;font-weight:bold;">No debug log found.</p>'; } } static function wplbdu40() { $vwpl_xtgy0 = ini_get('error_log'); if (! empty($vwpl_xtgy0) && file_exists($vwpl_xtgy0) ) { $vwplme910 = (int) filesize($vwpl_xtgy0); $vwplx4m7 = MB_IN_BYTES; $vwplea8r7 = ($vwplme910 > $vwplx4m7) ? $vwplme910 - $vwplx4m7 : $vwplme910; echo '<h3>PHP Error Log:</h3>'; echo '<textarea readonly=readonly cols="100" rows="20">', file_get_contents($vwpl_xtgy0, null, null, $vwplea8r7), '</textarea>'; } } static function wpldbgq4() { echo '<h3>.htaccess</h3>'; if (file_exists(get_home_path() . '.htaccess') ) { echo '<textarea readonly=readonly cols="100" rows="10">', file_get_contents(get_home_path() . '.htaccess'), '</textarea>'; } } static function wplkbkh3() { global $wpdb; $vwplyysi_ = get_option(wpln9_s::wplj7qr() ); $vwpldu3vq1 = wpln9_s::wplc2v0sx($vwplyysi_); echo '<h3>License Status</h3>'; echo '<p class="indented">'; echo '<label>Valid</label>'; echo '<span>', ( (boolean) $vwpldu3vq1['valid'] ? '<strong style="color:green;">Yes</strong>' : '<strong style="color:red;">No</strong>'), '</span><br />'; echo '<label>Active</label>'; echo '<span>', ( (boolean) $vwpldu3vq1['active'] ? '<strong style="color:green;">Yes</strong>' : '<strong style="color:red;">No</strong>'), '</span><br />'; if ( (boolean) $vwpldu3vq1['trial_mode']) { echo '<label>Trial Mode</label>'; echo '<span><strong style="color:red;">TRIAL LICENSE MODE</strong></span><br />'; } echo '<label>Next Check</label>'; echo '<span>', date('F jS, Y @ h:i:s', $vwpldu3vq1['next_check']), '</span><br />'; echo '<label>Renewal Date</label>'; echo '<span>', date('F jS, Y @ h:i:s', $vwpldu3vq1['renewal_date']), '</span><br />'; echo '</p>'; echo '<hr />'; echo '<h3>License Detail</h3>'; echo '<textarea cols="100" rows="10">'; foreach ($vwpldu3vq1 as $vwplyq9i7o => $vwplcjpa) { echo ucwords(str_replace('_', ' ', $vwplyq9i7o) ), ':  ', $vwplcjpa, "\n"; } echo '</textarea>'; } static function wpla83ui() { echo '<h3>Main php.ini</h3>'; if (file_exists(get_home_path() . 'php.ini') ) { echo '<textarea readonly=readonly cols="100" rows="10">', file_get_contents(get_home_path() . 'php.ini'), '</textarea>'; } else { echo '<p>Not Found</p>'; } } static function wpln7zn1t() { $vwplgxrbm = wplz8bid::wplvf1d('memberships'); echo '<h3>Memberships</h3>'; echo '<textarea cols="100" rows="20">', json_encode($vwplgxrbm, JSON_PRETTY_PRINT), '</textarea>'; } static function wplyean1() { echo '<h3>Network</h3>'; echo '<div class="indented">'; $vwplr7zec = array( 'licenseserver.webpowerandlight.com', ); echo '<h3>License Servers</h3>'; echo '<div class="indented">'; $vwpltd6ygi = false; foreach ($vwplr7zec as $vwplff5g) { $vwplc27lp = gethostbyname($vwplff5g); if ($vwplff5g == $vwplc27lp) { $vwplc27lp ='<span style="color:red;">Failed To Resolve</span>'; $vwpltd6ygi = true; } else { $vwplc27lp ='<span style="color:green;">' . $vwplc27lp . '</span>'; } echo '<p>', $vwplff5g, ' resolves to <strong>', $vwplc27lp, '</strong></p>'; } if ($vwpltd6ygi) { echo '<p style="color:red;">One or more hostnames failed to resolve due to DNS issues.</p>'; } $vwplu9a0sb = array( 'https://licenseserver.webpowerandlight.com/getlicense.php', 'https://licenseserver.webpowerandlight.com/memberium-is/current-version.php', ); $vwpltd6ygi = false; foreach ($vwplu9a0sb as $vwplfkojlf) { $vwplyio4f = wp_remote_get($vwplfkojlf); if (is_array($vwplyio4f) ) { } else { echo '<p>', $vwplyio4f->errors['http_request_failed'][0], '</p>'; $vwpltd6ygi = true; } } if (! $vwpltd6ygi) { echo '<p><strong style="color:green;">Connection Successful</strong></p>'; } echo '</div>'; } static function wplajn2() { $vwplevnfg0 = ini_get_all(); if (! empty($vwplevnfg0) ) { ksort($vwplevnfg0); echo '<h3>PHP .ini Settings</h3>'; echo '<table>'; foreach($vwplevnfg0 as $vwplyq9i7o => $vwplcjpa) { if (! empty($vwplcjpa['local_value']) || ! empty($vwplcjpa['global_value']) ) { echo '<tr><td>', $vwplyq9i7o, '</td><td>', isset($vwplcjpa['local_value']) ? $vwplcjpa['local_value'] : $vwplcjpa['global_value'], '</td></tr>'; } } echo '</table>'; } } static function wpln_sn4() { echo '<h3>PHP Modules Loaded</h3>'; echo '<div class="indented">'; echo '<div style="width:600px;">', implode(', ', get_loaded_extensions() ), '</div>'; echo '</div>'; } static function wpld3mn1() { $vwplelob86 = wplz8bid::wplvf1d('settings'); echo '<h3>Settings</h3>'; echo '<textarea cols="100" rows="20">', json_encode($vwplelob86, JSON_PRETTY_PRINT), '</textarea>'; } static function wpll8krsh() { echo '<h3>System Load</h3>'; echo '<div class="indented">'; if (function_exists('sys_getloadavg') ) { $vwplq5zq = sys_getloadavg(); echo '<strong>Last Minute</strong>:  ', $vwplq5zq[0], '<br>'; echo '<strong>Last 5 Minutes</strong>:  ', $vwplq5zq[1], '<br>'; echo '<strong>Last 15 Minutes</strong>:  ', $vwplq5zq[2], '<br>'; } else { echo '<p style="font-weight:bold;color:red;">Operating System missing Load Average Reports.</p>'; } echo '</div>'; echo '<p></p>'; } static function wplhnsx() { $vwpla6y_1q = self::wplbb5c(); $vwplp7gl = php_uname('m'); $vwplbd6m3 = $GLOBALS['wpdb']->db_version(); $vwplm2zjqr = php_uname('n'); $vwplb5of84 = function_exists('ioncube_loader_version') ? ioncube_loader_version() : '<strong style="color:red;">None</strong>'; $vwplj0vp = php_uname('s'); $vwplq9szwu = php_uname('v'); $vwpl_mr8z = phpversion(); $vwplr4d_ = php_sapi_name(); $vwplqsatk2 = isset($_SERVER['SERVER_SOFTWARE']) ? $_SERVER['SERVER_SOFTWARE'] : '<strong style="color:red;">Unknown</strong>'; $vwplgogvie = get_current_user(); $vwpl_wb3 = get_bloginfo('version'); echo '<h3>System Info</h3>'; echo '<div class="indented">'; echo "<strong>Hostname</strong>:  {$vwplm2zjqr}<br>"; echo "<strong>CPU Type</strong>:  {$vwplp7gl}<br>"; echo "<strong>CPU Cores</strong>:  {$vwpla6y_1q}<br>"; echo "<strong>Operating System</strong>:  {$vwplj0vp}<br>"; echo "<strong>Web Server Type</strong>:  {$vwplqsatk2}<br>"; echo "<strong>Username</strong>:  {$vwplgogvie}<br>"; echo "<strong>SAPI</strong>:  {$vwplr4d_}<br>"; echo "<strong>PHP Version</strong>:  {$vwpl_mr8z}<br>"; echo "<strong>IonCube Version</strong>:  {$vwplb5of84}<br>"; echo "<strong>WordPress Version</strong>:  {$vwpl_wb3}<br>"; echo "<strong>Database Version</strong>:  {$vwplbd6m3}<br>"; echo '<p></p>'; echo '<strong>Home Path</strong>:  ', get_home_path(), '<br>'; echo '<strong>Install Point</strong>: ', dirname(MEMBERIUM_HOME), '<br>'; echo '<p></p>'; echo '<strong>Remote Address</strong>:  ', $_SERVER['REMOTE_ADDR'], '<br>'; if (isset($_SERVER['HTTP_X_SUCURI_CLIENTIP']) ) { echo '<strong>Sucuri Client IP</strong>:  ', $_SERVER['HTTP_X_SUCURI_CLIENTIP'], '<br>'; } if (isset($_SERVER['HTTP_X_REAL_IP']) ) { echo '<strong>Real IP</strong>:  ', $_SERVER['HTTP_X_REAL_IP'], '<br>'; } if (isset($_SERVER['HTTP_X_FORWARDED_FOR']) ) { echo '<strong>Forwarded For</strong>:  ', $_SERVER['HTTP_X_FORWARDED_FOR'], '<br>'; } echo '<p></p>'; echo '</div>'; } static function wplbuy51l() { echo '<h3>TLS Support</h3>'; echo '<div class="indented">'; echo '<h3>CURL SSL TLS 1.2 Test</h3>'; $vwplsxifd = curl_init('https://tlstest.paypal.com/'); curl_setopt($vwplsxifd, CURLOPT_RETURNTRANSFER, true); $vwplyio4f = curl_exec($vwplsxifd);  echo '<strong>PayPal Test</strong><br />'; echo $vwplyio4f, '<br /><br />'; $vwplsxifd = curl_init('https://www.howsmyssl.com/a/check'); curl_setopt($vwplsxifd, CURLOPT_RETURNTRANSFER, true); $vwplyio4f = curl_exec($vwplsxifd);  $vwplyio4f = json_decode($vwplyio4f); if (is_object($vwplyio4f) ) { echo '<strong>SSL Protocol Test</strong><br />'; echo '<strong>TLS Version</strong>: ', $vwplyio4f->tls_version, '<br />'; echo '<strong>TLS Compression</strong>: ', $vwplyio4f->tls_compression_supported ? 'Yes' : 'No', '<br />'; if (is_array($vwplyio4f->given_cipher_suites) ) { echo '<strong>Cipher Suites</strong>: ', implode(', ', $vwplyio4f->given_cipher_suites), '<br>'; } } else { echo '<p style="color:red;font-weight:bold;">SSL Protocol Test Failed</p>'; } echo '</div>'; echo '</div>'; } static function wplmq7p_() { echo '<h3>wp-config.php:</h3>'; if (file_exists(get_home_path() . 'wp-config.php') ) { echo '<textarea readonly=readonly cols="100" rows="10">', file_get_contents(get_home_path() . 'wp-config.php'), '</textarea>'; } } }
