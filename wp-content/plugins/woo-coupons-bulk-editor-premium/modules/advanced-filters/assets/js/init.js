jQuery(document).ready(function(){var r=jQuery("#be-filters");if(!r.length)return!0;var e=r.find(".advanced-filters .base");e.removeClass("base"),window.advancedGroupTemplate=e[0].outerHTML,e.remove(),r.on("click",".remove-advanced-filter",function(e){e.preventDefault();var t=jQuery(this).parents(".advanced-field"),a=t.find(".wpse-advanced-filters-field-selector").attr("name");beAddRowsFilter(a+"="),t.remove()}),jQuery("body").on("click","#be-filters .new-advanced-filter",function(e){e.preventDefault();var t=window.advancedGroupTemplate.replace(new RegExp(/\[\]/,"g"),"["+(r.find(".advanced-filters .advanced-filters-list").children().length+1)+"]"),a=r.find(".advanced-filters  .advanced-filters-list .advanced-field").last();a.length?a.after(t):r.find(".advanced-filters  .advanced-filters-list").prepend(t),setTimeout(function(){vgseInitSelect2(r.find(".advanced-filters  .advanced-filters-list .advanced-field select.select2").last())},1e3),r.find(".advanced-filters  .advanced-filters-list").children().show()}),r.find(".new-advanced-filter").last().trigger("click"),r.find(".advanced-filters-toggle").change(function(){jQuery(this).is(":checked")?r.find(".advanced-filters").show():r.find(".advanced-filters").hide()}),jQuery("body").on("change",".wpse-advanced-filters-field-selector",function(){var e=jQuery(this).val(),t=jQuery(this);if(!e||e&&t.data("last-formatted-key")&&e!==t.data("last-formatted-key")){var a=t.attr("name").replace("[key]","[value]");t.parents(".fields-wrap").find(".wpse-advanced-filters-value-selector:gt(0)").remove(),t.parents(".fields-wrap").find(".wpse-advanced-filters-value-selector").replaceWith('<input name="'+a+'" class="wpse-advanced-filters-value-selector" />'),t.data("last-formatted-key","")}e&&(t.parent().find("input.field-source").val(t.find("option:selected").data("source")),t.parent().find(".search-value-wrap input").val(""),vgseInputToFormattedColumnField(e,t.parents(".fields-wrap"),".wpse-advanced-filters-value-selector"),t.data("last-formatted-key",e))})}),jQuery(document).ready(function(){jQuery("body").on("click","[data-start-saved-search]",function(e){e.preventDefault();var t=jQuery(this).data("start-saved-search");vgseRemoveAllFilters(),jQuery("body").data("be-filters",""),beAddRowsFilter(t),vgseFilters.fillSearchForm(t),vgseReloadSpreadsheet()})}),jQuery(document).ready(function(){var r=jQuery("#be-filters");if(!r.length)return!0;var n=jQuery(".vg-toolbar .button-container.run_filters-container .toolbar-submenu");function i(e){return n.find("ul").filter(function(){return jQuery(this).data("key")===e})}function s(){1<n.find("input").length?n.find(".wpse-start-quick-search").show():n.find(".wpse-start-quick-search").hide(),n.find(".wpse-start-quick-search").appendTo(n)}function d(e,t){if(i(t).length)return!0;e.find(".select2").each(function(){jQuery(this).data("select2")&&jQuery(this).select2("destroy")});var a=e.clone(!0);n.append('<ul data-key="'+t+'"></ul>'),a.find(".wpse-advanced-filters-field-selector").length&&a.find(".wpse-advanced-filters-field-selector").val("_sku"),n.find("ul").last().append(a),vgseInitSelect2(e.find(".select2")),vgseInitSelect2(n.find("ul").last().find(".select2")),s()}r.find("li").each(function(){var e=jQuery(this),t=e.find("input,select,textarea").first();if(t.length){var a=t.attr("name");if(a&&"keyword"!==a){var r=-1<vgse_editor_settings.favorite_search_fields.indexOf(a)?"fa-star":"fa-star-o";e.append('<button class="wpse-favorite-search-field" type="button" data-key="'+a+'"><i class="fa '+r+'"></i></button>'),"fa-star"==r&&d(e,a)}}}),jQuery("body").on("click",".wpse-favorite-search-field",function(e){e.preventDefault();var t=jQuery(this);t.find(".fa-star").length?t.find("i").addClass("fa-star-o").removeClass("fa-star"):t.find("i").addClass("fa-star").removeClass("fa-star-o"),t.find(".fa-star").length?d(t.parents("li"),t.data("key")):function(e,t){i(t).remove(),s()}(t.parents("li"),t.data("key"));var a=[];r.find(".wpse-favorite-search-field .fa-star").each(function(){a.push(jQuery(this).parent().data("key"))}),jQuery.post(ajaxurl,{action:"vgse_mark_search_fields_as_favorite",post_type:vgse_editor_settings.post_type,fields:a,nonce:vgse_editor_settings.nonce})})});