jQuery(document).ready(function(){if(!jQuery(".custom-columns-page-content").length)return!0;function e(){jQuery("body").find(".tipso").tipso({size:"small",tooltipHover:!0,background:"#444444",position:"right"})}function o(e){e=e||jQuery(".column-wrapper"),$name=e.find(".name-field"),e.find(".column-title").length||e.prepend('<h3 class="column-title"><span class="text"></span> <i class="fa fa-chevron-down"></i></h3>'),e.find(".column-title .text").text($name.val())}jQuery(".select2").select2({tags:!0,selectOnBlur:!0}),e(),jQuery("body").append('<div id="ohsnap" style="z-index: -1"></div>'),jQuery(".column-wrapper").each(function(){o(jQuery(this))}),jQuery("body").on("change",".column-wrapper .name-field",function(){var e=jQuery(this).parents(".column-wrapper");o(e);var t=e.find(".key-field"),i=e.find(".name-field");if(!t.val()&&i.val()){var n=i.val();n=n.replace(/(\d+)/gi,"").replace(/(\s+)/gi,"_").replace(/[^a-z\_]/gi,"_").toLowerCase(),t.val(n)}}),jQuery("body").on("click",".column-title",function(){jQuery(this).parents(".column-wrapper").find(".column-fields-wrapper").slideToggle()}),$columnTitles=jQuery(".column-title"),1<$columnTitles.length&&$columnTitles.trigger("click"),jQuery("body").on("click",".add-column",function(){jQuery(this).parents("form").find(".column-wrapper:not(:last)").find(".column-fields-wrapper:visible").each(function(){var e=jQuery(this);e.find(".name-field").val()&&e.slideToggle()}),jQuery(".mode-field").trigger("change"),jQuery(this).parents("form").find(".column-wrapper:last").find(".column-title .text").text(""),e(),jQuery(".select2").select2({tags:!0,selectOnBlur:!0})}),jQuery(".repeater").repeater({initEmpty:!1,defaultValues:vg_sheet_editor_custom_columns.default_values,show:function(){jQuery(this).slideDown(),jQuery(this).find(".select2-container").remove(),jQuery(this).find("select.select2").select2({tags:!0,selectOnBlur:!0})},hide:function(e){confirm(vg_sheet_editor_custom_columns.texts.confirm_delete)&&jQuery(this).slideUp(e)},ready:function(e){},isFirstItemUndeletable:!1}),jQuery(".save").click(function(e){e.preventDefault(),loading_ajax({estado:!0});var t=jQuery(this).parents("form");jQuery.post(t.attr("action"),t.serializeArray(),function(e){loading_ajax({estado:!1}),notification({tipo:e.success?"success":"error",mensaje:e.data})})}),jQuery(".mode-field").change(function(){var n=jQuery(this);["read-only","formulas","hide","rename","cell-type","plain-renderer","formatted-renderer","width","data-source"].forEach(function(e,t){var i=".field-container-"+e;n.is(":checked")?jQuery(i).show():jQuery(i).hide()})}),jQuery(".mode-field").trigger("change")}),jQuery(document).ready(function(){if("undefined"==typeof hot||!jQuery(".modal-columns-visibility").length||!vgse_editor_settings.is_administrator)return!0;var e=hot.getSettings().contextMenu;void 0===e.items&&(e.items={}),e.items.wpse_rename_meta_key={name:vgse_editor_settings.texts.edit_meta_key,hidden:function(){if(!hot.getSelected())return!0;var e=hot.colToProp(hot.getSelected()[0][1]),t=vgse_editor_settings.final_spreadsheet_columns_settings[e];return!vgse_editor_settings.is_administrator||!t||"meta_data"!==t.data_type||t.serialized_field_settings},callback:function(e,t,i){!function(e){var t=prompt(vgse_editor_settings.texts.edit_meta_key,e);t&&t!==e?(loading_ajax(!0),jQuery.post(ajaxurl,{action:"vgse_rename_meta_key",nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:vgse_editor_settings.post_type,old_column_key:e,new_column_key:t},function(e){if(loading_ajax(!1),e.success){notification({mensaje:e.data.message});var t=vgse_editor_settings.texts.confirm_column_reload_page.replace("{columns}",e.data.key);confirm(t)&&(window.location.href=jQuery(".wpse-scan-db-link").attr("href")+"&wpse_dont_increase_limit=1")}else notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})})):notification({mensaje:vgse_editor_settings.texts.new_value_empty_or_equal,tipo:"error",tiempo:1e4})}(hot.colToProp(t[0].start.col))}},e.items.wpse_delete_meta_key={name:vgse_editor_settings.texts.delete_meta_key,hidden:function(){if(!hot.getSelected())return!0;var e=hot.colToProp(hot.getSelected()[0][1]),t=vgse_editor_settings.final_spreadsheet_columns_settings[e];return!vgse_editor_settings.is_administrator||!t||"meta_data"!==t.data_type||t.serialized_field_settings||!t.allow_to_hide},callback:function(e,t,i){if(!confirm(vgse_editor_settings.texts.delete_meta_key_confirmation))return!0;vgseColumnsVisibilityInit();var n=hot.colToProp(t[0].start.col);loading_ajax(!0),jQuery.post(ajaxurl,{action:"vgse_delete_meta_key",nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:vgse_editor_settings.post_type,column_key:n},function(e){if(loading_ajax(!1),e.success){notification({mensaje:e.data.message});var t=jQuery(".modal-columns-visibility");t.find('.columns-enabled .js-column-key[value="'+n+'"]').parent("li").appendTo(t.find(".columns-disabled")),t.find(".save_post_type_settings").prop("checked",!0),t.find("form").submit()}else notification({mensaje:e.data.message,tipo:"error",tiempo:6e4})})}},hot.updateSettings({contextMenu:e})});